(function(){const b=document.createElement("link").relList;if(b&&b.supports&&b.supports("modulepreload"))return;for(const C of document.querySelectorAll('link[rel="modulepreload"]'))I(C);new MutationObserver(C=>{for(const T of C)if(T.type==="childList")for(const P of T.addedNodes)P.tagName==="LINK"&&P.rel==="modulepreload"&&I(P)}).observe(document,{childList:!0,subtree:!0});function x(C){const T={};return C.integrity&&(T.integrity=C.integrity),C.referrerPolicy&&(T.referrerPolicy=C.referrerPolicy),C.crossOrigin==="use-credentials"?T.credentials="include":C.crossOrigin==="anonymous"?T.credentials="omit":T.credentials="same-origin",T}function I(C){if(C.ep)return;C.ep=!0;const T=x(C);fetch(C.href,T)}})();var Zl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Uc(m){return m&&m.__esModule&&Object.prototype.hasOwnProperty.call(m,"default")?m.default:m}var wf={exports:{}},Oh={},bf={exports:{}},Sr={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fp;function ug(){if(fp)return Sr;fp=1;var m=Symbol.for("react.element"),b=Symbol.for("react.portal"),x=Symbol.for("react.fragment"),I=Symbol.for("react.strict_mode"),C=Symbol.for("react.profiler"),T=Symbol.for("react.provider"),P=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),R=Symbol.for("react.suspense"),L=Symbol.for("react.memo"),G=Symbol.for("react.lazy"),$=Symbol.iterator;function B(ae){return ae===null||typeof ae!="object"?null:(ae=$&&ae[$]||ae["@@iterator"],typeof ae=="function"?ae:null)}var Z={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Q=Object.assign,V={};function K(ae,fe,Se){this.props=ae,this.context=fe,this.refs=V,this.updater=Se||Z}K.prototype.isReactComponent={},K.prototype.setState=function(ae,fe){if(typeof ae!="object"&&typeof ae!="function"&&ae!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,ae,fe,"setState")},K.prototype.forceUpdate=function(ae){this.updater.enqueueForceUpdate(this,ae,"forceUpdate")};function Y(){}Y.prototype=K.prototype;function ne(ae,fe,Se){this.props=ae,this.context=fe,this.refs=V,this.updater=Se||Z}var ce=ne.prototype=new Y;ce.constructor=ne,Q(ce,K.prototype),ce.isPureReactComponent=!0;var be=Array.isArray,_e=Object.prototype.hasOwnProperty,Ue={current:null},De={key:!0,ref:!0,__self:!0,__source:!0};function Ze(ae,fe,Se){var gt,ct={},dt=null,bt=null;if(fe!=null)for(gt in fe.ref!==void 0&&(bt=fe.ref),fe.key!==void 0&&(dt=""+fe.key),fe)_e.call(fe,gt)&&!De.hasOwnProperty(gt)&&(ct[gt]=fe[gt]);var Vt=arguments.length-2;if(Vt===1)ct.children=Se;else if(1<Vt){for(var At=Array(Vt),Rt=0;Rt<Vt;Rt++)At[Rt]=arguments[Rt+2];ct.children=At}if(ae&&ae.defaultProps)for(gt in Vt=ae.defaultProps,Vt)ct[gt]===void 0&&(ct[gt]=Vt[gt]);return{$$typeof:m,type:ae,key:dt,ref:bt,props:ct,_owner:Ue.current}}function je(ae,fe){return{$$typeof:m,type:ae.type,key:fe,ref:ae.ref,props:ae.props,_owner:ae._owner}}function lt(ae){return typeof ae=="object"&&ae!==null&&ae.$$typeof===m}function vt(ae){var fe={"=":"=0",":":"=2"};return"$"+ae.replace(/[=:]/g,function(Se){return fe[Se]})}var me=/\/+/g;function $e(ae,fe){return typeof ae=="object"&&ae!==null&&ae.key!=null?vt(""+ae.key):fe.toString(36)}function j(ae,fe,Se,gt,ct){var dt=typeof ae;(dt==="undefined"||dt==="boolean")&&(ae=null);var bt=!1;if(ae===null)bt=!0;else switch(dt){case"string":case"number":bt=!0;break;case"object":switch(ae.$$typeof){case m:case b:bt=!0}}if(bt)return bt=ae,ct=ct(bt),ae=gt===""?"."+$e(bt,0):gt,be(ct)?(Se="",ae!=null&&(Se=ae.replace(me,"$&/")+"/"),j(ct,fe,Se,"",function(Rt){return Rt})):ct!=null&&(lt(ct)&&(ct=je(ct,Se+(!ct.key||bt&&bt.key===ct.key?"":(""+ct.key).replace(me,"$&/")+"/")+ae)),fe.push(ct)),1;if(bt=0,gt=gt===""?".":gt+":",be(ae))for(var Vt=0;Vt<ae.length;Vt++){dt=ae[Vt];var At=gt+$e(dt,Vt);bt+=j(dt,fe,Se,At,ct)}else if(At=B(ae),typeof At=="function")for(ae=At.call(ae),Vt=0;!(dt=ae.next()).done;)dt=dt.value,At=gt+$e(dt,Vt++),bt+=j(dt,fe,Se,At,ct);else if(dt==="object")throw fe=String(ae),Error("Objects are not valid as a React child (found: "+(fe==="[object Object]"?"object with keys {"+Object.keys(ae).join(", ")+"}":fe)+"). If you meant to render a collection of children, use an array instead.");return bt}function qe(ae,fe,Se){if(ae==null)return ae;var gt=[],ct=0;return j(ae,gt,"","",function(dt){return fe.call(Se,dt,ct++)}),gt}function ht(ae){if(ae._status===-1){var fe=ae._result;fe=fe(),fe.then(function(Se){(ae._status===0||ae._status===-1)&&(ae._status=1,ae._result=Se)},function(Se){(ae._status===0||ae._status===-1)&&(ae._status=2,ae._result=Se)}),ae._status===-1&&(ae._status=0,ae._result=fe)}if(ae._status===1)return ae._result.default;throw ae._result}var Ke={current:null},st={transition:null},Fe={ReactCurrentDispatcher:Ke,ReactCurrentBatchConfig:st,ReactCurrentOwner:Ue};return Sr.Children={map:qe,forEach:function(ae,fe,Se){qe(ae,function(){fe.apply(this,arguments)},Se)},count:function(ae){var fe=0;return qe(ae,function(){fe++}),fe},toArray:function(ae){return qe(ae,function(fe){return fe})||[]},only:function(ae){if(!lt(ae))throw Error("React.Children.only expected to receive a single React element child.");return ae}},Sr.Component=K,Sr.Fragment=x,Sr.Profiler=C,Sr.PureComponent=ne,Sr.StrictMode=I,Sr.Suspense=R,Sr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Fe,Sr.cloneElement=function(ae,fe,Se){if(ae==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+ae+".");var gt=Q({},ae.props),ct=ae.key,dt=ae.ref,bt=ae._owner;if(fe!=null){if(fe.ref!==void 0&&(dt=fe.ref,bt=Ue.current),fe.key!==void 0&&(ct=""+fe.key),ae.type&&ae.type.defaultProps)var Vt=ae.type.defaultProps;for(At in fe)_e.call(fe,At)&&!De.hasOwnProperty(At)&&(gt[At]=fe[At]===void 0&&Vt!==void 0?Vt[At]:fe[At])}var At=arguments.length-2;if(At===1)gt.children=Se;else if(1<At){Vt=Array(At);for(var Rt=0;Rt<At;Rt++)Vt[Rt]=arguments[Rt+2];gt.children=Vt}return{$$typeof:m,type:ae.type,key:ct,ref:dt,props:gt,_owner:bt}},Sr.createContext=function(ae){return ae={$$typeof:P,_currentValue:ae,_currentValue2:ae,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},ae.Provider={$$typeof:T,_context:ae},ae.Consumer=ae},Sr.createElement=Ze,Sr.createFactory=function(ae){var fe=Ze.bind(null,ae);return fe.type=ae,fe},Sr.createRef=function(){return{current:null}},Sr.forwardRef=function(ae){return{$$typeof:l,render:ae}},Sr.isValidElement=lt,Sr.lazy=function(ae){return{$$typeof:G,_payload:{_status:-1,_result:ae},_init:ht}},Sr.memo=function(ae,fe){return{$$typeof:L,type:ae,compare:fe===void 0?null:fe}},Sr.startTransition=function(ae){var fe=st.transition;st.transition={};try{ae()}finally{st.transition=fe}},Sr.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},Sr.useCallback=function(ae,fe){return Ke.current.useCallback(ae,fe)},Sr.useContext=function(ae){return Ke.current.useContext(ae)},Sr.useDebugValue=function(){},Sr.useDeferredValue=function(ae){return Ke.current.useDeferredValue(ae)},Sr.useEffect=function(ae,fe){return Ke.current.useEffect(ae,fe)},Sr.useId=function(){return Ke.current.useId()},Sr.useImperativeHandle=function(ae,fe,Se){return Ke.current.useImperativeHandle(ae,fe,Se)},Sr.useInsertionEffect=function(ae,fe){return Ke.current.useInsertionEffect(ae,fe)},Sr.useLayoutEffect=function(ae,fe){return Ke.current.useLayoutEffect(ae,fe)},Sr.useMemo=function(ae,fe){return Ke.current.useMemo(ae,fe)},Sr.useReducer=function(ae,fe,Se){return Ke.current.useReducer(ae,fe,Se)},Sr.useRef=function(ae){return Ke.current.useRef(ae)},Sr.useState=function(ae){return Ke.current.useState(ae)},Sr.useSyncExternalStore=function(ae,fe,Se){return Ke.current.useSyncExternalStore(ae,fe,Se)},Sr.useTransition=function(){return Ke.current.useTransition()},Sr.version="18.2.0",Sr}var pp;function Jf(){return pp||(pp=1,bf.exports=ug()),bf.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mp;function cg(){if(mp)return Oh;mp=1;var m=Jf(),b=Symbol.for("react.element"),x=Symbol.for("react.fragment"),I=Object.prototype.hasOwnProperty,C=m.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,T={key:!0,ref:!0,__self:!0,__source:!0};function P(l,R,L){var G,$={},B=null,Z=null;L!==void 0&&(B=""+L),R.key!==void 0&&(B=""+R.key),R.ref!==void 0&&(Z=R.ref);for(G in R)I.call(R,G)&&!T.hasOwnProperty(G)&&($[G]=R[G]);if(l&&l.defaultProps)for(G in R=l.defaultProps,R)$[G]===void 0&&($[G]=R[G]);return{$$typeof:b,type:l,key:B,ref:Z,props:$,_owner:C.current}}return Oh.Fragment=x,Oh.jsx=P,Oh.jsxs=P,Oh}var gp;function hg(){return gp||(gp=1,wf.exports=cg()),wf.exports}var Ut=hg(),Ie=Jf();const ln=Uc(Ie);var Rd={},Sf={exports:{}},ji={},Ef={exports:{}},Tf={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yp;function dg(){return yp||(yp=1,function(m){function b(st,Fe){var ae=st.length;st.push(Fe);e:for(;0<ae;){var fe=ae-1>>>1,Se=st[fe];if(0<C(Se,Fe))st[fe]=Fe,st[ae]=Se,ae=fe;else break e}}function x(st){return st.length===0?null:st[0]}function I(st){if(st.length===0)return null;var Fe=st[0],ae=st.pop();if(ae!==Fe){st[0]=ae;e:for(var fe=0,Se=st.length,gt=Se>>>1;fe<gt;){var ct=2*(fe+1)-1,dt=st[ct],bt=ct+1,Vt=st[bt];if(0>C(dt,ae))bt<Se&&0>C(Vt,dt)?(st[fe]=Vt,st[bt]=ae,fe=bt):(st[fe]=dt,st[ct]=ae,fe=ct);else if(bt<Se&&0>C(Vt,ae))st[fe]=Vt,st[bt]=ae,fe=bt;else break e}}return Fe}function C(st,Fe){var ae=st.sortIndex-Fe.sortIndex;return ae!==0?ae:st.id-Fe.id}if(typeof performance=="object"&&typeof performance.now=="function"){var T=performance;m.unstable_now=function(){return T.now()}}else{var P=Date,l=P.now();m.unstable_now=function(){return P.now()-l}}var R=[],L=[],G=1,$=null,B=3,Z=!1,Q=!1,V=!1,K=typeof setTimeout=="function"?setTimeout:null,Y=typeof clearTimeout=="function"?clearTimeout:null,ne=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function ce(st){for(var Fe=x(L);Fe!==null;){if(Fe.callback===null)I(L);else if(Fe.startTime<=st)I(L),Fe.sortIndex=Fe.expirationTime,b(R,Fe);else break;Fe=x(L)}}function be(st){if(V=!1,ce(st),!Q)if(x(R)!==null)Q=!0,ht(_e);else{var Fe=x(L);Fe!==null&&Ke(be,Fe.startTime-st)}}function _e(st,Fe){Q=!1,V&&(V=!1,Y(Ze),Ze=-1),Z=!0;var ae=B;try{for(ce(Fe),$=x(R);$!==null&&(!($.expirationTime>Fe)||st&&!vt());){var fe=$.callback;if(typeof fe=="function"){$.callback=null,B=$.priorityLevel;var Se=fe($.expirationTime<=Fe);Fe=m.unstable_now(),typeof Se=="function"?$.callback=Se:$===x(R)&&I(R),ce(Fe)}else I(R);$=x(R)}if($!==null)var gt=!0;else{var ct=x(L);ct!==null&&Ke(be,ct.startTime-Fe),gt=!1}return gt}finally{$=null,B=ae,Z=!1}}var Ue=!1,De=null,Ze=-1,je=5,lt=-1;function vt(){return!(m.unstable_now()-lt<je)}function me(){if(De!==null){var st=m.unstable_now();lt=st;var Fe=!0;try{Fe=De(!0,st)}finally{Fe?$e():(Ue=!1,De=null)}}else Ue=!1}var $e;if(typeof ne=="function")$e=function(){ne(me)};else if(typeof MessageChannel<"u"){var j=new MessageChannel,qe=j.port2;j.port1.onmessage=me,$e=function(){qe.postMessage(null)}}else $e=function(){K(me,0)};function ht(st){De=st,Ue||(Ue=!0,$e())}function Ke(st,Fe){Ze=K(function(){st(m.unstable_now())},Fe)}m.unstable_IdlePriority=5,m.unstable_ImmediatePriority=1,m.unstable_LowPriority=4,m.unstable_NormalPriority=3,m.unstable_Profiling=null,m.unstable_UserBlockingPriority=2,m.unstable_cancelCallback=function(st){st.callback=null},m.unstable_continueExecution=function(){Q||Z||(Q=!0,ht(_e))},m.unstable_forceFrameRate=function(st){0>st||125<st?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):je=0<st?Math.floor(1e3/st):5},m.unstable_getCurrentPriorityLevel=function(){return B},m.unstable_getFirstCallbackNode=function(){return x(R)},m.unstable_next=function(st){switch(B){case 1:case 2:case 3:var Fe=3;break;default:Fe=B}var ae=B;B=Fe;try{return st()}finally{B=ae}},m.unstable_pauseExecution=function(){},m.unstable_requestPaint=function(){},m.unstable_runWithPriority=function(st,Fe){switch(st){case 1:case 2:case 3:case 4:case 5:break;default:st=3}var ae=B;B=st;try{return Fe()}finally{B=ae}},m.unstable_scheduleCallback=function(st,Fe,ae){var fe=m.unstable_now();switch(typeof ae=="object"&&ae!==null?(ae=ae.delay,ae=typeof ae=="number"&&0<ae?fe+ae:fe):ae=fe,st){case 1:var Se=-1;break;case 2:Se=250;break;case 5:Se=1073741823;break;case 4:Se=1e4;break;default:Se=5e3}return Se=ae+Se,st={id:G++,callback:Fe,priorityLevel:st,startTime:ae,expirationTime:Se,sortIndex:-1},ae>fe?(st.sortIndex=ae,b(L,st),x(R)===null&&st===x(L)&&(V?(Y(Ze),Ze=-1):V=!0,Ke(be,ae-fe))):(st.sortIndex=Se,b(R,st),Q||Z||(Q=!0,ht(_e))),st},m.unstable_shouldYield=vt,m.unstable_wrapCallback=function(st){var Fe=B;return function(){var ae=B;B=Fe;try{return st.apply(this,arguments)}finally{B=ae}}}}(Tf)),Tf}var _p;function fg(){return _p||(_p=1,Ef.exports=dg()),Ef.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vp;function pg(){if(vp)return ji;vp=1;var m=Jf(),b=fg();function x(t){for(var i="https://reactjs.org/docs/error-decoder.html?invariant="+t,a=1;a<arguments.length;a++)i+="&args[]="+encodeURIComponent(arguments[a]);return"Minified React error #"+t+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var I=new Set,C={};function T(t,i){P(t,i),P(t+"Capture",i)}function P(t,i){for(C[t]=i,t=0;t<i.length;t++)I.add(i[t])}var l=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),R=Object.prototype.hasOwnProperty,L=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,G={},$={};function B(t){return R.call($,t)?!0:R.call(G,t)?!1:L.test(t)?$[t]=!0:(G[t]=!0,!1)}function Z(t,i,a,h){if(a!==null&&a.type===0)return!1;switch(typeof i){case"function":case"symbol":return!0;case"boolean":return h?!1:a!==null?!a.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function Q(t,i,a,h){if(i===null||typeof i>"u"||Z(t,i,a,h))return!0;if(h)return!1;if(a!==null)switch(a.type){case 3:return!i;case 4:return i===!1;case 5:return isNaN(i);case 6:return isNaN(i)||1>i}return!1}function V(t,i,a,h,y,w,E){this.acceptsBooleans=i===2||i===3||i===4,this.attributeName=h,this.attributeNamespace=y,this.mustUseProperty=a,this.propertyName=t,this.type=i,this.sanitizeURL=w,this.removeEmptyString=E}var K={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){K[t]=new V(t,0,!1,t,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var i=t[0];K[i]=new V(i,1,!1,t[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(t){K[t]=new V(t,2,!1,t.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){K[t]=new V(t,2,!1,t,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){K[t]=new V(t,3,!1,t.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(t){K[t]=new V(t,3,!0,t,null,!1,!1)}),["capture","download"].forEach(function(t){K[t]=new V(t,4,!1,t,null,!1,!1)}),["cols","rows","size","span"].forEach(function(t){K[t]=new V(t,6,!1,t,null,!1,!1)}),["rowSpan","start"].forEach(function(t){K[t]=new V(t,5,!1,t.toLowerCase(),null,!1,!1)});var Y=/[\-:]([a-z])/g;function ne(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var i=t.replace(Y,ne);K[i]=new V(i,1,!1,t,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var i=t.replace(Y,ne);K[i]=new V(i,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(t){var i=t.replace(Y,ne);K[i]=new V(i,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(t){K[t]=new V(t,1,!1,t.toLowerCase(),null,!1,!1)}),K.xlinkHref=new V("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(t){K[t]=new V(t,1,!1,t.toLowerCase(),null,!0,!0)});function ce(t,i,a,h){var y=K.hasOwnProperty(i)?K[i]:null;(y!==null?y.type!==0:h||!(2<i.length)||i[0]!=="o"&&i[0]!=="O"||i[1]!=="n"&&i[1]!=="N")&&(Q(i,a,y,h)&&(a=null),h||y===null?B(i)&&(a===null?t.removeAttribute(i):t.setAttribute(i,""+a)):y.mustUseProperty?t[y.propertyName]=a===null?y.type===3?!1:"":a:(i=y.attributeName,h=y.attributeNamespace,a===null?t.removeAttribute(i):(y=y.type,a=y===3||y===4&&a===!0?"":""+a,h?t.setAttributeNS(h,i,a):t.setAttribute(i,a))))}var be=m.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,_e=Symbol.for("react.element"),Ue=Symbol.for("react.portal"),De=Symbol.for("react.fragment"),Ze=Symbol.for("react.strict_mode"),je=Symbol.for("react.profiler"),lt=Symbol.for("react.provider"),vt=Symbol.for("react.context"),me=Symbol.for("react.forward_ref"),$e=Symbol.for("react.suspense"),j=Symbol.for("react.suspense_list"),qe=Symbol.for("react.memo"),ht=Symbol.for("react.lazy"),Ke=Symbol.for("react.offscreen"),st=Symbol.iterator;function Fe(t){return t===null||typeof t!="object"?null:(t=st&&t[st]||t["@@iterator"],typeof t=="function"?t:null)}var ae=Object.assign,fe;function Se(t){if(fe===void 0)try{throw Error()}catch(a){var i=a.stack.trim().match(/\n( *(at )?)/);fe=i&&i[1]||""}return`
`+fe+t}var gt=!1;function ct(t,i){if(!t||gt)return"";gt=!0;var a=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(i)if(i=function(){throw Error()},Object.defineProperty(i.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(i,[])}catch(W){var h=W}Reflect.construct(t,[],i)}else{try{i.call()}catch(W){h=W}t.call(i.prototype)}else{try{throw Error()}catch(W){h=W}t()}}catch(W){if(W&&h&&typeof W.stack=="string"){for(var y=W.stack.split(`
`),w=h.stack.split(`
`),E=y.length-1,z=w.length-1;1<=E&&0<=z&&y[E]!==w[z];)z--;for(;1<=E&&0<=z;E--,z--)if(y[E]!==w[z]){if(E!==1||z!==1)do if(E--,z--,0>z||y[E]!==w[z]){var N=`
`+y[E].replace(" at new "," at ");return t.displayName&&N.includes("<anonymous>")&&(N=N.replace("<anonymous>",t.displayName)),N}while(1<=E&&0<=z);break}}}finally{gt=!1,Error.prepareStackTrace=a}return(t=t?t.displayName||t.name:"")?Se(t):""}function dt(t){switch(t.tag){case 5:return Se(t.type);case 16:return Se("Lazy");case 13:return Se("Suspense");case 19:return Se("SuspenseList");case 0:case 2:case 15:return t=ct(t.type,!1),t;case 11:return t=ct(t.type.render,!1),t;case 1:return t=ct(t.type,!0),t;default:return""}}function bt(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case De:return"Fragment";case Ue:return"Portal";case je:return"Profiler";case Ze:return"StrictMode";case $e:return"Suspense";case j:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case vt:return(t.displayName||"Context")+".Consumer";case lt:return(t._context.displayName||"Context")+".Provider";case me:var i=t.render;return t=t.displayName,t||(t=i.displayName||i.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case qe:return i=t.displayName||null,i!==null?i:bt(t.type)||"Memo";case ht:i=t._payload,t=t._init;try{return bt(t(i))}catch{}}return null}function Vt(t){var i=t.type;switch(t.tag){case 24:return"Cache";case 9:return(i.displayName||"Context")+".Consumer";case 10:return(i._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=i.render,t=t.displayName||t.name||"",i.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return i;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return bt(i);case 8:return i===Ze?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i}return null}function At(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Rt(t){var i=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function $t(t){var i=Rt(t)?"checked":"value",a=Object.getOwnPropertyDescriptor(t.constructor.prototype,i),h=""+t[i];if(!t.hasOwnProperty(i)&&typeof a<"u"&&typeof a.get=="function"&&typeof a.set=="function"){var y=a.get,w=a.set;return Object.defineProperty(t,i,{configurable:!0,get:function(){return y.call(this)},set:function(E){h=""+E,w.call(this,E)}}),Object.defineProperty(t,i,{enumerable:a.enumerable}),{getValue:function(){return h},setValue:function(E){h=""+E},stopTracking:function(){t._valueTracker=null,delete t[i]}}}}function or(t){t._valueTracker||(t._valueTracker=$t(t))}function sr(t){if(!t)return!1;var i=t._valueTracker;if(!i)return!0;var a=i.getValue(),h="";return t&&(h=Rt(t)?t.checked?"true":"false":t.value),t=h,t!==a?(i.setValue(t),!0):!1}function pr(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function O(t,i){var a=i.checked;return ae({},i,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:a??t._wrapperState.initialChecked})}function it(t,i){var a=i.defaultValue==null?"":i.defaultValue,h=i.checked!=null?i.checked:i.defaultChecked;a=At(i.value!=null?i.value:a),t._wrapperState={initialChecked:h,initialValue:a,controlled:i.type==="checkbox"||i.type==="radio"?i.checked!=null:i.value!=null}}function He(t,i){i=i.checked,i!=null&&ce(t,"checked",i,!1)}function de(t,i){He(t,i);var a=At(i.value),h=i.type;if(a!=null)h==="number"?(a===0&&t.value===""||t.value!=a)&&(t.value=""+a):t.value!==""+a&&(t.value=""+a);else if(h==="submit"||h==="reset"){t.removeAttribute("value");return}i.hasOwnProperty("value")?Ee(t,i.type,a):i.hasOwnProperty("defaultValue")&&Ee(t,i.type,At(i.defaultValue)),i.checked==null&&i.defaultChecked!=null&&(t.defaultChecked=!!i.defaultChecked)}function oe(t,i,a){if(i.hasOwnProperty("value")||i.hasOwnProperty("defaultValue")){var h=i.type;if(!(h!=="submit"&&h!=="reset"||i.value!==void 0&&i.value!==null))return;i=""+t._wrapperState.initialValue,a||i===t.value||(t.value=i),t.defaultValue=i}a=t.name,a!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,a!==""&&(t.name=a)}function Ee(t,i,a){(i!=="number"||pr(t.ownerDocument)!==t)&&(a==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+a&&(t.defaultValue=""+a))}var ot=Array.isArray;function ft(t,i,a,h){if(t=t.options,i){i={};for(var y=0;y<a.length;y++)i["$"+a[y]]=!0;for(a=0;a<t.length;a++)y=i.hasOwnProperty("$"+t[a].value),t[a].selected!==y&&(t[a].selected=y),y&&h&&(t[a].defaultSelected=!0)}else{for(a=""+At(a),i=null,y=0;y<t.length;y++){if(t[y].value===a){t[y].selected=!0,h&&(t[y].defaultSelected=!0);return}i!==null||t[y].disabled||(i=t[y])}i!==null&&(i.selected=!0)}}function Ne(t,i){if(i.dangerouslySetInnerHTML!=null)throw Error(x(91));return ae({},i,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function _t(t,i){var a=i.value;if(a==null){if(a=i.children,i=i.defaultValue,a!=null){if(i!=null)throw Error(x(92));if(ot(a)){if(1<a.length)throw Error(x(93));a=a[0]}i=a}i==null&&(i=""),a=i}t._wrapperState={initialValue:At(a)}}function We(t,i){var a=At(i.value),h=At(i.defaultValue);a!=null&&(a=""+a,a!==t.value&&(t.value=a),i.defaultValue==null&&t.defaultValue!==a&&(t.defaultValue=a)),h!=null&&(t.defaultValue=""+h)}function Qe(t){var i=t.textContent;i===t._wrapperState.initialValue&&i!==""&&i!==null&&(t.value=i)}function kt(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Me(t,i){return t==null||t==="http://www.w3.org/1999/xhtml"?kt(i):t==="http://www.w3.org/2000/svg"&&i==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Je,xr=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(i,a,h,y){MSApp.execUnsafeLocalFunction(function(){return t(i,a,h,y)})}:t}(function(t,i){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=i;else{for(Je=Je||document.createElement("div"),Je.innerHTML="<svg>"+i.valueOf().toString()+"</svg>",i=Je.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;i.firstChild;)t.appendChild(i.firstChild)}});function kr(t,i){if(i){var a=t.firstChild;if(a&&a===t.lastChild&&a.nodeType===3){a.nodeValue=i;return}}t.textContent=i}var Wt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},vr=["Webkit","ms","Moz","O"];Object.keys(Wt).forEach(function(t){vr.forEach(function(i){i=i+t.charAt(0).toUpperCase()+t.substring(1),Wt[i]=Wt[t]})});function Qt(t,i,a){return i==null||typeof i=="boolean"||i===""?"":a||typeof i!="number"||i===0||Wt.hasOwnProperty(t)&&Wt[t]?(""+i).trim():i+"px"}function dn(t,i){t=t.style;for(var a in i)if(i.hasOwnProperty(a)){var h=a.indexOf("--")===0,y=Qt(a,i[a],h);a==="float"&&(a="cssFloat"),h?t.setProperty(a,y):t[a]=y}}var Rr=ae({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function yt(t,i){if(i){if(Rr[t]&&(i.children!=null||i.dangerouslySetInnerHTML!=null))throw Error(x(137,t));if(i.dangerouslySetInnerHTML!=null){if(i.children!=null)throw Error(x(60));if(typeof i.dangerouslySetInnerHTML!="object"||!("__html"in i.dangerouslySetInnerHTML))throw Error(x(61))}if(i.style!=null&&typeof i.style!="object")throw Error(x(62))}}function qt(t,i){if(t.indexOf("-")===-1)return typeof i.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Zt=null;function qr(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var fn=null,Lt=null,gr=null;function Ar(t){if(t=M(t)){if(typeof fn!="function")throw Error(x(280));var i=t.stateNode;i&&(i=q(i),fn(t.stateNode,t.type,i))}}function Lr(t){Lt?gr?gr.push(t):gr=[t]:Lt=t}function Kr(){if(Lt){var t=Lt,i=gr;if(gr=Lt=null,Ar(t),i)for(t=0;t<i.length;t++)Ar(i[t])}}function lr(t,i){return t(i)}function ur(){}var An=!1;function Wr(t,i,a){if(An)return t(i,a);An=!0;try{return lr(t,i,a)}finally{An=!1,(Lt!==null||gr!==null)&&(ur(),Kr())}}function gn(t,i){var a=t.stateNode;if(a===null)return null;var h=q(a);if(h===null)return null;a=h[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(h=!h.disabled)||(t=t.type,h=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!h;break e;default:t=!1}if(t)return null;if(a&&typeof a!="function")throw Error(x(231,i,typeof a));return a}var wn=!1;if(l)try{var Hn={};Object.defineProperty(Hn,"passive",{get:function(){wn=!0}}),window.addEventListener("test",Hn,Hn),window.removeEventListener("test",Hn,Hn)}catch{wn=!1}function Di(t,i,a,h,y,w,E,z,N){var W=Array.prototype.slice.call(arguments,3);try{i.apply(a,W)}catch(se){this.onError(se)}}var zn=!1,J=null,D=!1,U=null,X={onError:function(t){zn=!0,J=t}};function re(t,i,a,h,y,w,E,z,N){zn=!1,J=null,Di.apply(X,arguments)}function ve(t,i,a,h,y,w,E,z,N){if(re.apply(this,arguments),zn){if(zn){var W=J;zn=!1,J=null}else throw Error(x(198));D||(D=!0,U=W)}}function Ce(t){var i=t,a=t;if(t.alternate)for(;i.return;)i=i.return;else{t=i;do i=t,(i.flags&4098)!==0&&(a=i.return),t=i.return;while(t)}return i.tag===3?a:null}function ke(t){if(t.tag===13){var i=t.memoizedState;if(i===null&&(t=t.alternate,t!==null&&(i=t.memoizedState)),i!==null)return i.dehydrated}return null}function xe(t){if(Ce(t)!==t)throw Error(x(188))}function ze(t){var i=t.alternate;if(!i){if(i=Ce(t),i===null)throw Error(x(188));return i!==t?null:t}for(var a=t,h=i;;){var y=a.return;if(y===null)break;var w=y.alternate;if(w===null){if(h=y.return,h!==null){a=h;continue}break}if(y.child===w.child){for(w=y.child;w;){if(w===a)return xe(y),t;if(w===h)return xe(y),i;w=w.sibling}throw Error(x(188))}if(a.return!==h.return)a=y,h=w;else{for(var E=!1,z=y.child;z;){if(z===a){E=!0,a=y,h=w;break}if(z===h){E=!0,h=y,a=w;break}z=z.sibling}if(!E){for(z=w.child;z;){if(z===a){E=!0,a=w,h=y;break}if(z===h){E=!0,h=w,a=y;break}z=z.sibling}if(!E)throw Error(x(189))}}if(a.alternate!==h)throw Error(x(190))}if(a.tag!==3)throw Error(x(188));return a.stateNode.current===a?t:i}function Ye(t){return t=ze(t),t!==null?ut(t):null}function ut(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var i=ut(t);if(i!==null)return i;t=t.sibling}return null}var at=b.unstable_scheduleCallback,Dt=b.unstable_cancelCallback,zt=b.unstable_shouldYield,Ft=b.unstable_requestPaint,Et=b.unstable_now,er=b.unstable_getCurrentPriorityLevel,tr=b.unstable_ImmediatePriority,rr=b.unstable_UserBlockingPriority,Xt=b.unstable_NormalPriority,Kt=b.unstable_LowPriority,Yr=b.unstable_IdlePriority,Nr=null,zr=null;function bn(t){if(zr&&typeof zr.onCommitFiberRoot=="function")try{zr.onCommitFiberRoot(Nr,t,void 0,(t.current.flags&128)===128)}catch{}}var ti=Math.clz32?Math.clz32:qc,Xs=Math.log,Cr=Math.LN2;function qc(t){return t>>>=0,t===0?32:31-(Xs(t)/Cr|0)|0}var Lo=64,el=4194304;function Bo(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Ks(t,i){var a=t.pendingLanes;if(a===0)return 0;var h=0,y=t.suspendedLanes,w=t.pingedLanes,E=a&268435455;if(E!==0){var z=E&~y;z!==0?h=Bo(z):(w&=E,w!==0&&(h=Bo(w)))}else E=a&~y,E!==0?h=Bo(E):w!==0&&(h=Bo(w));if(h===0)return 0;if(i!==0&&i!==h&&(i&y)===0&&(y=h&-h,w=i&-i,y>=w||y===16&&(w&4194240)!==0))return i;if((h&4)!==0&&(h|=a&16),i=t.entangledLanes,i!==0)for(t=t.entanglements,i&=h;0<i;)a=31-ti(i),y=1<<a,h|=t[a],i&=~y;return h}function ql(t,i){switch(t){case 1:case 2:case 4:return i+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Wl(t,i){for(var a=t.suspendedLanes,h=t.pingedLanes,y=t.expirationTimes,w=t.pendingLanes;0<w;){var E=31-ti(w),z=1<<E,N=y[E];N===-1?((z&a)===0||(z&h)!==0)&&(y[E]=ql(z,i)):N<=i&&(t.expiredLanes|=z),w&=~z}}function Ys(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Hl(){var t=Lo;return Lo<<=1,(Lo&4194240)===0&&(Lo=64),t}function tl(t){for(var i=[],a=0;31>a;a++)i.push(t);return i}function _i(t,i,a){t.pendingLanes|=i,i!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,i=31-ti(i),t[i]=a}function rl(t,i){var a=t.pendingLanes&~i;t.pendingLanes=i,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=i,t.mutableReadLanes&=i,t.entangledLanes&=i,i=t.entanglements;var h=t.eventTimes;for(t=t.expirationTimes;0<a;){var y=31-ti(a),w=1<<y;i[y]=0,h[y]=-1,t[y]=-1,a&=~w}}function lo(t,i){var a=t.entangledLanes|=i;for(t=t.entanglements;a;){var h=31-ti(a),y=1<<h;y&i|t[h]&i&&(t[h]|=i),a&=~y}}var wr=0;function Js(t){return t&=-t,1<t?4<t?(t&268435455)!==0?16:536870912:4:1}var Qs,Fo,ea,ds,Ur,Oo=!1,fs=[],$i=null,Gi=null,vi=null,No=new Map,ta=new Map,uo=[],Xl="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function nl(t,i){switch(t){case"focusin":case"focusout":$i=null;break;case"dragenter":case"dragleave":Gi=null;break;case"mouseover":case"mouseout":vi=null;break;case"pointerover":case"pointerout":No.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":ta.delete(i.pointerId)}}function Uo(t,i,a,h,y,w){return t===null||t.nativeEvent!==w?(t={blockedOn:i,domEventName:a,eventSystemFlags:h,nativeEvent:w,targetContainers:[y]},i!==null&&(i=M(i),i!==null&&Fo(i)),t):(t.eventSystemFlags|=h,i=t.targetContainers,y!==null&&i.indexOf(y)===-1&&i.push(y),t)}function Kl(t,i,a,h,y){switch(i){case"focusin":return $i=Uo($i,t,i,a,h,y),!0;case"dragenter":return Gi=Uo(Gi,t,i,a,h,y),!0;case"mouseover":return vi=Uo(vi,t,i,a,h,y),!0;case"pointerover":var w=y.pointerId;return No.set(w,Uo(No.get(w)||null,t,i,a,h,y)),!0;case"gotpointercapture":return w=y.pointerId,ta.set(w,Uo(ta.get(w)||null,t,i,a,h,y)),!0}return!1}function Yl(t){var i=A(t.target);if(i!==null){var a=Ce(i);if(a!==null){if(i=a.tag,i===13){if(i=ke(a),i!==null){t.blockedOn=i,Ur(t.priority,function(){ea(a)});return}}else if(i===3&&a.stateNode.current.memoizedState.isDehydrated){t.blockedOn=a.tag===3?a.stateNode.containerInfo:null;return}}}t.blockedOn=null}function yr(t){if(t.blockedOn!==null)return!1;for(var i=t.targetContainers;0<i.length;){var a=ys(t.domEventName,t.eventSystemFlags,i[0],t.nativeEvent);if(a===null){a=t.nativeEvent;var h=new a.constructor(a.type,a);Zt=h,a.target.dispatchEvent(h),Zt=null}else return i=M(a),i!==null&&Fo(i),t.blockedOn=a,!1;i.shift()}return!0}function Uu(t,i,a){yr(t)&&a.delete(i)}function ra(){Oo=!1,$i!==null&&yr($i)&&($i=null),Gi!==null&&yr(Gi)&&(Gi=null),vi!==null&&yr(vi)&&(vi=null),No.forEach(Uu),ta.forEach(Uu)}function Zi(t,i){t.blockedOn===i&&(t.blockedOn=null,Oo||(Oo=!0,b.unstable_scheduleCallback(b.unstable_NormalPriority,ra)))}function ps(t){function i(y){return Zi(y,t)}if(0<fs.length){Zi(fs[0],t);for(var a=1;a<fs.length;a++){var h=fs[a];h.blockedOn===t&&(h.blockedOn=null)}}for($i!==null&&Zi($i,t),Gi!==null&&Zi(Gi,t),vi!==null&&Zi(vi,t),No.forEach(i),ta.forEach(i),a=0;a<uo.length;a++)h=uo[a],h.blockedOn===t&&(h.blockedOn=null);for(;0<uo.length&&(a=uo[0],a.blockedOn===null);)Yl(a),a.blockedOn===null&&uo.shift()}var yn=be.ReactCurrentBatchConfig,ms=!0;function il(t,i,a,h){var y=wr,w=yn.transition;yn.transition=null;try{wr=1,na(t,i,a,h)}finally{wr=y,yn.transition=w}}function ol(t,i,a,h){var y=wr,w=yn.transition;yn.transition=null;try{wr=4,na(t,i,a,h)}finally{wr=y,yn.transition=w}}function na(t,i,a,h){if(ms){var y=ys(t,i,a,h);if(y===null)El(t,i,h,gs,a),nl(t,h);else if(Kl(y,t,i,a,h))h.stopPropagation();else if(nl(t,h),i&4&&-1<Xl.indexOf(t)){for(;y!==null;){var w=M(y);if(w!==null&&Qs(w),w=ys(t,i,a,h),w===null&&El(t,i,h,gs,a),w===y)break;y=w}y!==null&&h.stopPropagation()}else El(t,i,h,null,a)}}var gs=null;function ys(t,i,a,h){if(gs=null,t=qr(h),t=A(t),t!==null)if(i=Ce(t),i===null)t=null;else if(a=i.tag,a===13){if(t=ke(i),t!==null)return t;t=null}else if(a===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;t=null}else i!==t&&(t=null);return gs=t,null}function sl(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(er()){case tr:return 1;case rr:return 4;case Xt:case Kt:return 16;case Yr:return 536870912;default:return 16}default:return 16}}var Ri=null,_s=null,ia=null;function Jl(){if(ia)return ia;var t,i=_s,a=i.length,h,y="value"in Ri?Ri.value:Ri.textContent,w=y.length;for(t=0;t<a&&i[t]===y[t];t++);var E=a-t;for(h=1;h<=E&&i[a-h]===y[w-h];h++);return ia=y.slice(t,1<h?1-h:void 0)}function qi(t){var i=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&i===13&&(t=13)):t=i,t===10&&(t=13),32<=t||t===13?t:0}function al(){return!0}function ju(){return!1}function ri(t){function i(a,h,y,w,E){this._reactName=a,this._targetInst=y,this.type=h,this.nativeEvent=w,this.target=E,this.currentTarget=null;for(var z in t)t.hasOwnProperty(z)&&(a=t[z],this[z]=a?a(w):w[z]);return this.isDefaultPrevented=(w.defaultPrevented!=null?w.defaultPrevented:w.returnValue===!1)?al:ju,this.isPropagationStopped=ju,this}return ae(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var a=this.nativeEvent;a&&(a.preventDefault?a.preventDefault():typeof a.returnValue!="unknown"&&(a.returnValue=!1),this.isDefaultPrevented=al)},stopPropagation:function(){var a=this.nativeEvent;a&&(a.stopPropagation?a.stopPropagation():typeof a.cancelBubble!="unknown"&&(a.cancelBubble=!0),this.isPropagationStopped=al)},persist:function(){},isPersistent:al}),i}var vs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ql=ri(vs),oa=ae({},vs,{view:0,detail:0}),eu=ri(oa),xs,sa,jo,Wi=ae({},oa,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:iu,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==jo&&(jo&&t.type==="mousemove"?(xs=t.screenX-jo.screenX,sa=t.screenY-jo.screenY):sa=xs=0,jo=t),xs)},movementY:function(t){return"movementY"in t?t.movementY:sa}}),tu=ri(Wi),Vu=ae({},Wi,{dataTransfer:0}),ru=ri(Vu),co=ae({},oa,{relatedTarget:0}),ll=ri(co),ws=ae({},vs,{animationName:0,elapsedTime:0,pseudoElement:0}),bs=ri(ws),Jr=ae({},vs,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),nu=ri(Jr),Bt=ae({},vs,{data:0}),Vo=ri(Bt),Gr={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Br={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ho={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function $u(t){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(t):(t=ho[t])?!!i[t]:!1}function iu(){return $u}var Gu=ae({},oa,{key:function(t){if(t.key){var i=Gr[t.key]||t.key;if(i!=="Unidentified")return i}return t.type==="keypress"?(t=qi(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?Br[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:iu,charCode:function(t){return t.type==="keypress"?qi(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?qi(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),Wc=ri(Gu),ou=ae({},Wi,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ss=ri(ou),aa=ae({},oa,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:iu}),ul=ri(aa),la=ae({},vs,{propertyName:0,elapsedTime:0,pseudoElement:0}),Zu=ri(la),cl=ae({},Wi,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),hl=ri(cl),xi=[9,13,27,32],dl=l&&"CompositionEvent"in window,$o=null;l&&"documentMode"in document&&($o=document.documentMode);var qu=l&&"TextEvent"in window&&!$o,Go=l&&(!dl||$o&&8<$o&&11>=$o),Es=" ",ua=!1;function ca(t,i){switch(t){case"keyup":return xi.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function fl(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Zo=!1;function su(t,i){switch(t){case"compositionend":return fl(i);case"keypress":return i.which!==32?null:(ua=!0,Es);case"textInput":return t=i.data,t===Es&&ua?null:t;default:return null}}function pl(t,i){if(Zo)return t==="compositionend"||!dl&&ca(t,i)?(t=Jl(),ia=_s=Ri=null,Zo=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return Go&&i.locale!=="ko"?null:i.data;default:return null}}var ml={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function au(t){var i=t&&t.nodeName&&t.nodeName.toLowerCase();return i==="input"?!!ml[t.type]:i==="textarea"}function ha(t,i,a,h){Lr(h),i=Tl(i,"onChange"),0<i.length&&(a=new Ql("onChange","change",null,a,h),t.push({event:a,listeners:i}))}var wi=null,Hi=null;function gl(t){_a(t,0)}function da(t){var i=F(t);if(sr(i))return t}function fa(t,i){if(t==="change")return i}var lu=!1;if(l){var yl;if(l){var fo="oninput"in document;if(!fo){var uu=document.createElement("div");uu.setAttribute("oninput","return;"),fo=typeof uu.oninput=="function"}yl=fo}else yl=!1;lu=yl&&(!document.documentMode||9<document.documentMode)}function cu(){wi&&(wi.detachEvent("onpropertychange",Ts),Hi=wi=null)}function Ts(t){if(t.propertyName==="value"&&da(Hi)){var i=[];ha(i,Hi,t,qr(t)),Wr(gl,i)}}function pa(t,i,a){t==="focusin"?(cu(),wi=i,Hi=a,wi.attachEvent("onpropertychange",Ts)):t==="focusout"&&cu()}function ni(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return da(Hi)}function Pn(t,i){if(t==="click")return da(i)}function Hc(t,i){if(t==="input"||t==="change")return da(i)}function po(t,i){return t===i&&(t!==0||1/t===1/i)||t!==t&&i!==i}var di=typeof Object.is=="function"?Object.is:po;function bi(t,i){if(di(t,i))return!0;if(typeof t!="object"||t===null||typeof i!="object"||i===null)return!1;var a=Object.keys(t),h=Object.keys(i);if(a.length!==h.length)return!1;for(h=0;h<a.length;h++){var y=a[h];if(!R.call(i,y)||!di(t[y],i[y]))return!1}return!0}function mo(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Wu(t,i){var a=mo(t);t=0;for(var h;a;){if(a.nodeType===3){if(h=t+a.textContent.length,t<=i&&h>=i)return{node:a,offset:i-t};t=h}e:{for(;a;){if(a.nextSibling){a=a.nextSibling;break e}a=a.parentNode}a=void 0}a=mo(a)}}function _l(t,i){return t&&i?t===i?!0:t&&t.nodeType===3?!1:i&&i.nodeType===3?_l(t,i.parentNode):"contains"in t?t.contains(i):t.compareDocumentPosition?!!(t.compareDocumentPosition(i)&16):!1:!1}function Hu(){for(var t=window,i=pr();i instanceof t.HTMLIFrameElement;){try{var a=typeof i.contentWindow.location.href=="string"}catch{a=!1}if(a)t=i.contentWindow;else break;i=pr(t.document)}return i}function vl(t){var i=t&&t.nodeName&&t.nodeName.toLowerCase();return i&&(i==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||i==="textarea"||t.contentEditable==="true")}function qo(t){var i=Hu(),a=t.focusedElem,h=t.selectionRange;if(i!==a&&a&&a.ownerDocument&&_l(a.ownerDocument.documentElement,a)){if(h!==null&&vl(a)){if(i=h.start,t=h.end,t===void 0&&(t=i),"selectionStart"in a)a.selectionStart=i,a.selectionEnd=Math.min(t,a.value.length);else if(t=(i=a.ownerDocument||document)&&i.defaultView||window,t.getSelection){t=t.getSelection();var y=a.textContent.length,w=Math.min(h.start,y);h=h.end===void 0?w:Math.min(h.end,y),!t.extend&&w>h&&(y=h,h=w,w=y),y=Wu(a,w);var E=Wu(a,h);y&&E&&(t.rangeCount!==1||t.anchorNode!==y.node||t.anchorOffset!==y.offset||t.focusNode!==E.node||t.focusOffset!==E.offset)&&(i=i.createRange(),i.setStart(y.node,y.offset),t.removeAllRanges(),w>h?(t.addRange(i),t.extend(E.node,E.offset)):(i.setEnd(E.node,E.offset),t.addRange(i)))}}for(i=[],t=a;t=t.parentNode;)t.nodeType===1&&i.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof a.focus=="function"&&a.focus(),a=0;a<i.length;a++)t=i[a],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var go=l&&"documentMode"in document&&11>=document.documentMode,Pt=null,ma=null,Xi=null,Ki=!1;function ks(t,i,a){var h=a.window===a?a.document:a.nodeType===9?a:a.ownerDocument;Ki||Pt==null||Pt!==pr(h)||(h=Pt,"selectionStart"in h&&vl(h)?h={start:h.selectionStart,end:h.selectionEnd}:(h=(h.ownerDocument&&h.ownerDocument.defaultView||window).getSelection(),h={anchorNode:h.anchorNode,anchorOffset:h.anchorOffset,focusNode:h.focusNode,focusOffset:h.focusOffset}),Xi&&bi(Xi,h)||(Xi=h,h=Tl(ma,"onSelect"),0<h.length&&(i=new Ql("onSelect","select",null,i,a),t.push({event:i,listeners:h}),i.target=Pt)))}function St(t,i){var a={};return a[t.toLowerCase()]=i.toLowerCase(),a["Webkit"+t]="webkit"+i,a["Moz"+t]="moz"+i,a}var yo={animationend:St("Animation","AnimationEnd"),animationiteration:St("Animation","AnimationIteration"),animationstart:St("Animation","AnimationStart"),transitionend:St("Transition","TransitionEnd")},xl={},Xu={};l&&(Xu=document.createElement("div").style,"AnimationEvent"in window||(delete yo.animationend.animation,delete yo.animationiteration.animation,delete yo.animationstart.animation),"TransitionEvent"in window||delete yo.transitionend.transition);function _o(t){if(xl[t])return xl[t];if(!yo[t])return t;var i=yo[t],a;for(a in i)if(i.hasOwnProperty(a)&&a in Xu)return xl[t]=i[a];return t}var hu=_o("animationend"),du=_o("animationiteration"),Ku=_o("animationstart"),Yu=_o("transitionend"),ga=new Map,wl="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Li(t,i){ga.set(t,i),T(i,[t])}for(var ya=0;ya<wl.length;ya++){var Mn=wl[ya],vo=Mn.toLowerCase(),Ju=Mn[0].toUpperCase()+Mn.slice(1);Li(vo,"on"+Ju)}Li(hu,"onAnimationEnd"),Li(du,"onAnimationIteration"),Li(Ku,"onAnimationStart"),Li("dblclick","onDoubleClick"),Li("focusin","onFocus"),Li("focusout","onBlur"),Li(Yu,"onTransitionEnd"),P("onMouseEnter",["mouseout","mouseover"]),P("onMouseLeave",["mouseout","mouseover"]),P("onPointerEnter",["pointerout","pointerover"]),P("onPointerLeave",["pointerout","pointerover"]),T("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),T("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),T("onBeforeInput",["compositionend","keypress","textInput","paste"]),T("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),T("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),T("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Wo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Cs=new Set("cancel close invalid load scroll toggle".split(" ").concat(Wo));function bl(t,i,a){var h=t.type||"unknown-event";t.currentTarget=a,ve(h,i,void 0,t),t.currentTarget=null}function _a(t,i){i=(i&4)!==0;for(var a=0;a<t.length;a++){var h=t[a],y=h.event;h=h.listeners;e:{var w=void 0;if(i)for(var E=h.length-1;0<=E;E--){var z=h[E],N=z.instance,W=z.currentTarget;if(z=z.listener,N!==w&&y.isPropagationStopped())break e;bl(y,z,W),w=N}else for(E=0;E<h.length;E++){if(z=h[E],N=z.instance,W=z.currentTarget,z=z.listener,N!==w&&y.isPropagationStopped())break e;bl(y,z,W),w=N}}}if(D)throw t=U,D=!1,U=null,t}function _r(t,i){var a=i[_];a===void 0&&(a=i[_]=new Set);var h=t+"__bubble";a.has(h)||(Sl(i,t,2,!1),a.add(h))}function Mr(t,i,a){var h=0;i&&(h|=4),Sl(a,t,h,i)}var Ho="_reactListening"+Math.random().toString(36).slice(2);function xo(t){if(!t[Ho]){t[Ho]=!0,I.forEach(function(a){a!=="selectionchange"&&(Cs.has(a)||Mr(a,!1,t),Mr(a,!0,t))});var i=t.nodeType===9?t:t.ownerDocument;i===null||i[Ho]||(i[Ho]=!0,Mr("selectionchange",!1,i))}}function Sl(t,i,a,h){switch(sl(i)){case 1:var y=il;break;case 4:y=ol;break;default:y=na}a=y.bind(null,i,a,t),y=void 0,!wn||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(y=!0),h?y!==void 0?t.addEventListener(i,a,{capture:!0,passive:y}):t.addEventListener(i,a,!0):y!==void 0?t.addEventListener(i,a,{passive:y}):t.addEventListener(i,a,!1)}function El(t,i,a,h,y){var w=h;if((i&1)===0&&(i&2)===0&&h!==null)e:for(;;){if(h===null)return;var E=h.tag;if(E===3||E===4){var z=h.stateNode.containerInfo;if(z===y||z.nodeType===8&&z.parentNode===y)break;if(E===4)for(E=h.return;E!==null;){var N=E.tag;if((N===3||N===4)&&(N=E.stateNode.containerInfo,N===y||N.nodeType===8&&N.parentNode===y))return;E=E.return}for(;z!==null;){if(E=A(z),E===null)return;if(N=E.tag,N===5||N===6){h=w=E;continue e}z=z.parentNode}}h=h.return}Wr(function(){var W=w,se=qr(a),pe=[];e:{var ie=ga.get(t);if(ie!==void 0){var Te=Ql,Le=t;switch(t){case"keypress":if(qi(a)===0)break e;case"keydown":case"keyup":Te=Wc;break;case"focusin":Le="focus",Te=ll;break;case"focusout":Le="blur",Te=ll;break;case"beforeblur":case"afterblur":Te=ll;break;case"click":if(a.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Te=tu;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Te=ru;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Te=ul;break;case hu:case du:case Ku:Te=bs;break;case Yu:Te=Zu;break;case"scroll":Te=eu;break;case"wheel":Te=hl;break;case"copy":case"cut":case"paste":Te=nu;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Te=Ss}var Re=(i&4)!==0,xt=!Re&&t==="scroll",we=Re?ie!==null?ie+"Capture":null:ie;Re=[];for(var ue=W,ge;ue!==null;){ge=ue;var Be=ge.stateNode;if(ge.tag===5&&Be!==null&&(ge=Be,we!==null&&(Be=gn(ue,we),Be!=null&&Re.push(Is(ue,Be,ge)))),xt)break;ue=ue.return}0<Re.length&&(ie=new Te(ie,Le,null,a,se),pe.push({event:ie,listeners:Re}))}}if((i&7)===0){e:{if(ie=t==="mouseover"||t==="pointerover",Te=t==="mouseout"||t==="pointerout",ie&&a!==Zt&&(Le=a.relatedTarget||a.fromElement)&&(A(Le)||Le[p]))break e;if((Te||ie)&&(ie=se.window===se?se:(ie=se.ownerDocument)?ie.defaultView||ie.parentWindow:window,Te?(Le=a.relatedTarget||a.toElement,Te=W,Le=Le?A(Le):null,Le!==null&&(xt=Ce(Le),Le!==xt||Le.tag!==5&&Le.tag!==6)&&(Le=null)):(Te=null,Le=W),Te!==Le)){if(Re=tu,Be="onMouseLeave",we="onMouseEnter",ue="mouse",(t==="pointerout"||t==="pointerover")&&(Re=Ss,Be="onPointerLeave",we="onPointerEnter",ue="pointer"),xt=Te==null?ie:F(Te),ge=Le==null?ie:F(Le),ie=new Re(Be,ue+"leave",Te,a,se),ie.target=xt,ie.relatedTarget=ge,Be=null,A(se)===W&&(Re=new Re(we,ue+"enter",Le,a,se),Re.target=ge,Re.relatedTarget=xt,Be=Re),xt=Be,Te&&Le)t:{for(Re=Te,we=Le,ue=0,ge=Re;ge;ge=Vn(ge))ue++;for(ge=0,Be=we;Be;Be=Vn(Be))ge++;for(;0<ue-ge;)Re=Vn(Re),ue--;for(;0<ge-ue;)we=Vn(we),ge--;for(;ue--;){if(Re===we||we!==null&&Re===we.alternate)break t;Re=Vn(Re),we=Vn(we)}Re=null}else Re=null;Te!==null&&va(pe,ie,Te,Re,!1),Le!==null&&xt!==null&&va(pe,xt,Le,Re,!0)}}e:{if(ie=W?F(W):window,Te=ie.nodeName&&ie.nodeName.toLowerCase(),Te==="select"||Te==="input"&&ie.type==="file")var tt=fa;else if(au(ie))if(lu)tt=Hc;else{tt=ni;var nt=pa}else(Te=ie.nodeName)&&Te.toLowerCase()==="input"&&(ie.type==="checkbox"||ie.type==="radio")&&(tt=Pn);if(tt&&(tt=tt(t,W))){ha(pe,tt,a,se);break e}nt&&nt(t,ie,W),t==="focusout"&&(nt=ie._wrapperState)&&nt.controlled&&ie.type==="number"&&Ee(ie,"number",ie.value)}switch(nt=W?F(W):window,t){case"focusin":(au(nt)||nt.contentEditable==="true")&&(Pt=nt,ma=W,Xi=null);break;case"focusout":Xi=ma=Pt=null;break;case"mousedown":Ki=!0;break;case"contextmenu":case"mouseup":case"dragend":Ki=!1,ks(pe,a,se);break;case"selectionchange":if(go)break;case"keydown":case"keyup":ks(pe,a,se)}var Ge;if(dl)e:{switch(t){case"compositionstart":var mt="onCompositionStart";break e;case"compositionend":mt="onCompositionEnd";break e;case"compositionupdate":mt="onCompositionUpdate";break e}mt=void 0}else Zo?ca(t,a)&&(mt="onCompositionEnd"):t==="keydown"&&a.keyCode===229&&(mt="onCompositionStart");mt&&(Go&&a.locale!=="ko"&&(Zo||mt!=="onCompositionStart"?mt==="onCompositionEnd"&&Zo&&(Ge=Jl()):(Ri=se,_s="value"in Ri?Ri.value:Ri.textContent,Zo=!0)),nt=Tl(W,mt),0<nt.length&&(mt=new Vo(mt,t,null,a,se),pe.push({event:mt,listeners:nt}),Ge?mt.data=Ge:(Ge=fl(a),Ge!==null&&(mt.data=Ge)))),(Ge=qu?su(t,a):pl(t,a))&&(W=Tl(W,"onBeforeInput"),0<W.length&&(se=new Vo("onBeforeInput","beforeinput",null,a,se),pe.push({event:se,listeners:W}),se.data=Ge))}_a(pe,i)})}function Is(t,i,a){return{instance:t,listener:i,currentTarget:a}}function Tl(t,i){for(var a=i+"Capture",h=[];t!==null;){var y=t,w=y.stateNode;y.tag===5&&w!==null&&(y=w,w=gn(t,a),w!=null&&h.unshift(Is(t,w,y)),w=gn(t,i),w!=null&&h.push(Is(t,w,y))),t=t.return}return h}function Vn(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function va(t,i,a,h,y){for(var w=i._reactName,E=[];a!==null&&a!==h;){var z=a,N=z.alternate,W=z.stateNode;if(N!==null&&N===h)break;z.tag===5&&W!==null&&(z=W,y?(N=gn(a,w),N!=null&&E.unshift(Is(a,N,z))):y||(N=gn(a,w),N!=null&&E.push(Is(a,N,z)))),a=a.return}E.length!==0&&t.push({event:i,listeners:E})}var Ot=/\r\n?/g,Gt=/\u0000|\uFFFD/g;function As(t){return(typeof t=="string"?t:""+t).replace(Ot,`
`).replace(Gt,"")}function wo(t,i,a){if(i=As(i),As(t)!==i&&a)throw Error(x(425))}function zs(){}var nn=null,Yi=null;function Dn(t,i){return t==="textarea"||t==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var fu=typeof setTimeout=="function"?setTimeout:void 0,xa=typeof clearTimeout=="function"?clearTimeout:void 0,Dr=typeof Promise=="function"?Promise:void 0,un=typeof queueMicrotask=="function"?queueMicrotask:typeof Dr<"u"?function(t){return Dr.resolve(null).then(t).catch(Qu)}:fu;function Qu(t){setTimeout(function(){throw t})}function bo(t,i){var a=i,h=0;do{var y=a.nextSibling;if(t.removeChild(a),y&&y.nodeType===8)if(a=y.data,a==="/$"){if(h===0){t.removeChild(y),ps(i);return}h--}else a!=="$"&&a!=="$?"&&a!=="$!"||h++;a=y}while(a);ps(i)}function fi(t){for(;t!=null;t=t.nextSibling){var i=t.nodeType;if(i===1||i===3)break;if(i===8){if(i=t.data,i==="$"||i==="$!"||i==="$?")break;if(i==="/$")return null}}return t}function d(t){t=t.previousSibling;for(var i=0;t;){if(t.nodeType===8){var a=t.data;if(a==="$"||a==="$!"||a==="$?"){if(i===0)return t;i--}else a==="/$"&&i++}t=t.previousSibling}return null}var r=Math.random().toString(36).slice(2),s="__reactFiber$"+r,c="__reactProps$"+r,p="__reactContainer$"+r,_="__reactEvents$"+r,S="__reactListeners$"+r,k="__reactHandles$"+r;function A(t){var i=t[s];if(i)return i;for(var a=t.parentNode;a;){if(i=a[p]||a[s]){if(a=i.alternate,i.child!==null||a!==null&&a.child!==null)for(t=d(t);t!==null;){if(a=t[s])return a;t=d(t)}return i}t=a,a=t.parentNode}return null}function M(t){return t=t[s]||t[p],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function F(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(x(33))}function q(t){return t[c]||null}var H=[],le=-1;function te(t){return{current:t}}function ee(t){0>le||(t.current=H[le],H[le]=null,le--)}function ye(t,i){le++,H[le]=t.current,t.current=i}var Ae={},Pe=te(Ae),he=te(!1),Ve=Ae;function Oe(t,i){var a=t.type.contextTypes;if(!a)return Ae;var h=t.stateNode;if(h&&h.__reactInternalMemoizedUnmaskedChildContext===i)return h.__reactInternalMemoizedMaskedChildContext;var y={},w;for(w in a)y[w]=i[w];return h&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=y),y}function Xe(t){return t=t.childContextTypes,t!=null}function rt(){ee(he),ee(Pe)}function pt(t,i,a){if(Pe.current!==Ae)throw Error(x(168));ye(Pe,i),ye(he,a)}function et(t,i,a){var h=t.stateNode;if(i=i.childContextTypes,typeof h.getChildContext!="function")return a;h=h.getChildContext();for(var y in h)if(!(y in i))throw Error(x(108,Vt(t)||"Unknown",y));return ae({},a,h)}function It(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Ae,Ve=Pe.current,ye(Pe,t),ye(he,he.current),!0}function wt(t,i,a){var h=t.stateNode;if(!h)throw Error(x(169));a?(t=et(t,i,Ve),h.__reactInternalMemoizedMergedChildContext=t,ee(he),ee(Pe),ye(Pe,t)):ee(he),ye(he,a)}var Tt=null,Ht=!1,Jt=!1;function jt(t){Tt===null?Tt=[t]:Tt.push(t)}function Ir(t){Ht=!0,jt(t)}function cr(){if(!Jt&&Tt!==null){Jt=!0;var t=0,i=wr;try{var a=Tt;for(wr=1;t<a.length;t++){var h=a[t];do h=h(!0);while(h!==null)}Tt=null,Ht=!1}catch(y){throw Tt!==null&&(Tt=Tt.slice(t+1)),at(tr,cr),y}finally{wr=i,Jt=!1}}return null}var ir=[],ar=0,hr=null,Rn=0,on=[],Qr=0,Sn=null,$n=1,jr="";function En(t,i){ir[ar++]=Rn,ir[ar++]=hr,hr=t,Rn=i}function So(t,i,a){on[Qr++]=$n,on[Qr++]=jr,on[Qr++]=Sn,Sn=t;var h=$n;t=jr;var y=32-ti(h)-1;h&=~(1<<y),a+=1;var w=32-ti(i)+y;if(30<w){var E=y-y%5;w=(h&(1<<E)-1).toString(32),h>>=E,y-=E,$n=1<<32-ti(i)+y|a<<y|h,jr=w+t}else $n=1<<w|a<<y|h,jr=t}function Ps(t){t.return!==null&&(En(t,1),So(t,1,0))}function mr(t){for(;t===hr;)hr=ir[--ar],ir[ar]=null,Rn=ir[--ar],ir[ar]=null;for(;t===Sn;)Sn=on[--Qr],on[Qr]=null,jr=on[--Qr],on[Qr]=null,$n=on[--Qr],on[Qr]=null}var dr=null,Yt=null,nr=!1,Zr=null;function Fr(t,i){var a=ki(5,null,null,0);a.elementType="DELETED",a.stateNode=i,a.return=t,i=t.deletions,i===null?(t.deletions=[a],t.flags|=16):i.push(a)}function ii(t,i){switch(t.tag){case 5:var a=t.type;return i=i.nodeType!==1||a.toLowerCase()!==i.nodeName.toLowerCase()?null:i,i!==null?(t.stateNode=i,dr=t,Yt=fi(i.firstChild),!0):!1;case 6:return i=t.pendingProps===""||i.nodeType!==3?null:i,i!==null?(t.stateNode=i,dr=t,Yt=null,!0):!1;case 13:return i=i.nodeType!==8?null:i,i!==null?(a=Sn!==null?{id:$n,overflow:jr}:null,t.memoizedState={dehydrated:i,treeContext:a,retryLane:1073741824},a=ki(18,null,null,0),a.stateNode=i,a.return=t,t.child=a,dr=t,Yt=null,!0):!1;default:return!1}}function Eo(t){return(t.mode&1)!==0&&(t.flags&128)===0}function To(t){if(nr){var i=Yt;if(i){var a=i;if(!ii(t,i)){if(Eo(t))throw Error(x(418));i=fi(a.nextSibling);var h=dr;i&&ii(t,i)?Fr(h,a):(t.flags=t.flags&-4097|2,nr=!1,dr=t)}}else{if(Eo(t))throw Error(x(418));t.flags=t.flags&-4097|2,nr=!1,dr=t}}}function wa(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;dr=t}function Ms(t){if(t!==dr)return!1;if(!nr)return wa(t),nr=!0,!1;var i;if((i=t.tag!==3)&&!(i=t.tag!==5)&&(i=t.type,i=i!=="head"&&i!=="body"&&!Dn(t.type,t.memoizedProps)),i&&(i=Yt)){if(Eo(t))throw ba(),Error(x(418));for(;i;)Fr(t,i),i=fi(i.nextSibling)}if(wa(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(x(317));e:{for(t=t.nextSibling,i=0;t;){if(t.nodeType===8){var a=t.data;if(a==="/$"){if(i===0){Yt=fi(t.nextSibling);break e}i--}else a!=="$"&&a!=="$!"&&a!=="$?"||i++}t=t.nextSibling}Yt=null}}else Yt=dr?fi(t.stateNode.nextSibling):null;return!0}function ba(){for(var t=Yt;t;)t=fi(t.nextSibling)}function Ln(){Yt=dr=null,nr=!1}function Ds(t){Zr===null?Zr=[t]:Zr.push(t)}var Sa=be.ReactCurrentBatchConfig;function Xn(t,i){if(t&&t.defaultProps){i=ae({},i),t=t.defaultProps;for(var a in t)i[a]===void 0&&(i[a]=t[a]);return i}return i}var ec=te(null),kl=null,ko=null,Rs=null;function Ji(){Rs=ko=kl=null}function Si(t){var i=ec.current;ee(ec),t._currentValue=i}function Co(t,i,a){for(;t!==null;){var h=t.alternate;if((t.childLanes&i)!==i?(t.childLanes|=i,h!==null&&(h.childLanes|=i)):h!==null&&(h.childLanes&i)!==i&&(h.childLanes|=i),t===a)break;t=t.return}}function Ea(t,i){kl=t,Rs=ko=null,t=t.dependencies,t!==null&&t.firstContext!==null&&((t.lanes&i)!==0&&(pi=!0),t.firstContext=null)}function Bn(t){var i=t._currentValue;if(Rs!==t)if(t={context:t,memoizedValue:i,next:null},ko===null){if(kl===null)throw Error(x(308));ko=t,kl.dependencies={lanes:0,firstContext:t}}else ko=ko.next=t;return i}var Ta=null;function tc(t){Ta===null?Ta=[t]:Ta.push(t)}function cn(t,i,a,h){var y=i.interleaved;return y===null?(a.next=a,tc(i)):(a.next=y.next,y.next=a),i.interleaved=a,Qi(t,h)}function Qi(t,i){t.lanes|=i;var a=t.alternate;for(a!==null&&(a.lanes|=i),a=t,t=t.return;t!==null;)t.childLanes|=i,a=t.alternate,a!==null&&(a.childLanes|=i),a=t,t=t.return;return a.tag===3?a.stateNode:null}var Xo=!1;function Ko(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ls(t,i){t=t.updateQueue,i.updateQueue===t&&(i.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Bi(t,i){return{eventTime:t,lane:i,tag:0,payload:null,callback:null,next:null}}function Io(t,i,a){var h=t.updateQueue;if(h===null)return null;if(h=h.shared,(Tr&2)!==0){var y=h.pending;return y===null?i.next=i:(i.next=y.next,y.next=i),h.pending=i,Qi(t,a)}return y=h.interleaved,y===null?(i.next=i,tc(h)):(i.next=y.next,y.next=i),h.interleaved=i,Qi(t,a)}function pu(t,i,a){if(i=i.updateQueue,i!==null&&(i=i.shared,(a&4194240)!==0)){var h=i.lanes;h&=t.pendingLanes,a|=h,i.lanes=a,lo(t,a)}}function Yh(t,i){var a=t.updateQueue,h=t.alternate;if(h!==null&&(h=h.updateQueue,a===h)){var y=null,w=null;if(a=a.firstBaseUpdate,a!==null){do{var E={eventTime:a.eventTime,lane:a.lane,tag:a.tag,payload:a.payload,callback:a.callback,next:null};w===null?y=w=E:w=w.next=E,a=a.next}while(a!==null);w===null?y=w=i:w=w.next=i}else y=w=i;a={baseState:h.baseState,firstBaseUpdate:y,lastBaseUpdate:w,shared:h.shared,effects:h.effects},t.updateQueue=a;return}t=a.lastBaseUpdate,t===null?a.firstBaseUpdate=i:t.next=i,a.lastBaseUpdate=i}function mu(t,i,a,h){var y=t.updateQueue;Xo=!1;var w=y.firstBaseUpdate,E=y.lastBaseUpdate,z=y.shared.pending;if(z!==null){y.shared.pending=null;var N=z,W=N.next;N.next=null,E===null?w=W:E.next=W,E=N;var se=t.alternate;se!==null&&(se=se.updateQueue,z=se.lastBaseUpdate,z!==E&&(z===null?se.firstBaseUpdate=W:z.next=W,se.lastBaseUpdate=N))}if(w!==null){var pe=y.baseState;E=0,se=W=N=null,z=w;do{var ie=z.lane,Te=z.eventTime;if((h&ie)===ie){se!==null&&(se=se.next={eventTime:Te,lane:0,tag:z.tag,payload:z.payload,callback:z.callback,next:null});e:{var Le=t,Re=z;switch(ie=i,Te=a,Re.tag){case 1:if(Le=Re.payload,typeof Le=="function"){pe=Le.call(Te,pe,ie);break e}pe=Le;break e;case 3:Le.flags=Le.flags&-65537|128;case 0:if(Le=Re.payload,ie=typeof Le=="function"?Le.call(Te,pe,ie):Le,ie==null)break e;pe=ae({},pe,ie);break e;case 2:Xo=!0}}z.callback!==null&&z.lane!==0&&(t.flags|=64,ie=y.effects,ie===null?y.effects=[z]:ie.push(z))}else Te={eventTime:Te,lane:ie,tag:z.tag,payload:z.payload,callback:z.callback,next:null},se===null?(W=se=Te,N=pe):se=se.next=Te,E|=ie;if(z=z.next,z===null){if(z=y.shared.pending,z===null)break;ie=z,z=ie.next,ie.next=null,y.lastBaseUpdate=ie,y.shared.pending=null}}while(!0);if(se===null&&(N=pe),y.baseState=N,y.firstBaseUpdate=W,y.lastBaseUpdate=se,i=y.shared.interleaved,i!==null){y=i;do E|=y.lane,y=y.next;while(y!==i)}else w===null&&(y.shared.lanes=0);Us|=E,t.lanes=E,t.memoizedState=pe}}function Jh(t,i,a){if(t=i.effects,i.effects=null,t!==null)for(i=0;i<t.length;i++){var h=t[i],y=h.callback;if(y!==null){if(h.callback=null,h=a,typeof y!="function")throw Error(x(191,y));y.call(h)}}}var rc=new m.Component().refs;function Xc(t,i,a,h){i=t.memoizedState,a=a(h,i),a=a==null?i:ae({},i,a),t.memoizedState=a,t.lanes===0&&(t.updateQueue.baseState=a)}var Cl={isMounted:function(t){return(t=t._reactInternals)?Ce(t)===t:!1},enqueueSetState:function(t,i,a){t=t._reactInternals;var h=ai(),y=js(t),w=Bi(h,y);w.payload=i,a!=null&&(w.callback=a),i=Io(t,w,y),i!==null&&(oo(i,t,y,h),pu(i,t,y))},enqueueReplaceState:function(t,i,a){t=t._reactInternals;var h=ai(),y=js(t),w=Bi(h,y);w.tag=1,w.payload=i,a!=null&&(w.callback=a),i=Io(t,w,y),i!==null&&(oo(i,t,y,h),pu(i,t,y))},enqueueForceUpdate:function(t,i){t=t._reactInternals;var a=ai(),h=js(t),y=Bi(a,h);y.tag=2,i!=null&&(y.callback=i),i=Io(t,y,h),i!==null&&(oo(i,t,h,a),pu(i,t,h))}};function Kc(t,i,a,h,y,w,E){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(h,w,E):i.prototype&&i.prototype.isPureReactComponent?!bi(a,h)||!bi(y,w):!0}function Yc(t,i,a){var h=!1,y=Ae,w=i.contextType;return typeof w=="object"&&w!==null?w=Bn(w):(y=Xe(i)?Ve:Pe.current,h=i.contextTypes,w=(h=h!=null)?Oe(t,y):Ae),i=new i(a,w),t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,i.updater=Cl,t.stateNode=i,i._reactInternals=t,h&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=y,t.__reactInternalMemoizedMaskedChildContext=w),i}function ka(t,i,a,h){t=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(a,h),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(a,h),i.state!==t&&Cl.enqueueReplaceState(i,i.state,null)}function Jc(t,i,a,h){var y=t.stateNode;y.props=a,y.state=t.memoizedState,y.refs=rc,Ko(t);var w=i.contextType;typeof w=="object"&&w!==null?y.context=Bn(w):(w=Xe(i)?Ve:Pe.current,y.context=Oe(t,w)),y.state=t.memoizedState,w=i.getDerivedStateFromProps,typeof w=="function"&&(Xc(t,i,w,a),y.state=t.memoizedState),typeof i.getDerivedStateFromProps=="function"||typeof y.getSnapshotBeforeUpdate=="function"||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(i=y.state,typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount(),i!==y.state&&Cl.enqueueReplaceState(y,y.state,null),mu(t,a,y,h),y.state=t.memoizedState),typeof y.componentDidMount=="function"&&(t.flags|=4194308)}function Yo(t,i,a){if(t=a.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(a._owner){if(a=a._owner,a){if(a.tag!==1)throw Error(x(309));var h=a.stateNode}if(!h)throw Error(x(147,t));var y=h,w=""+t;return i!==null&&i.ref!==null&&typeof i.ref=="function"&&i.ref._stringRef===w?i.ref:(i=function(E){var z=y.refs;z===rc&&(z=y.refs={}),E===null?delete z[w]:z[w]=E},i._stringRef=w,i)}if(typeof t!="string")throw Error(x(284));if(!a._owner)throw Error(x(290,t))}return t}function Ca(t,i){throw t=Object.prototype.toString.call(i),Error(x(31,t==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":t))}function gu(t){var i=t._init;return i(t._payload)}function Qh(t){function i(we,ue){if(t){var ge=we.deletions;ge===null?(we.deletions=[ue],we.flags|=16):ge.push(ue)}}function a(we,ue){if(!t)return null;for(;ue!==null;)i(we,ue),ue=ue.sibling;return null}function h(we,ue){for(we=new Map;ue!==null;)ue.key!==null?we.set(ue.key,ue):we.set(ue.index,ue),ue=ue.sibling;return we}function y(we,ue){return we=ss(we,ue),we.index=0,we.sibling=null,we}function w(we,ue,ge){return we.index=ge,t?(ge=we.alternate,ge!==null?(ge=ge.index,ge<ue?(we.flags|=2,ue):ge):(we.flags|=2,ue)):(we.flags|=1048576,ue)}function E(we){return t&&we.alternate===null&&(we.flags|=2),we}function z(we,ue,ge,Be){return ue===null||ue.tag!==6?(ue=zc(ge,we.mode,Be),ue.return=we,ue):(ue=y(ue,ge),ue.return=we,ue)}function N(we,ue,ge,Be){var tt=ge.type;return tt===De?se(we,ue,ge.props.children,Be,ge.key):ue!==null&&(ue.elementType===tt||typeof tt=="object"&&tt!==null&&tt.$$typeof===ht&&gu(tt)===ue.type)?(Be=y(ue,ge.props),Be.ref=Yo(we,ue,ge),Be.return=we,Be):(Be=zu(ge.type,ge.key,ge.props,null,we.mode,Be),Be.ref=Yo(we,ue,ge),Be.return=we,Be)}function W(we,ue,ge,Be){return ue===null||ue.tag!==4||ue.stateNode.containerInfo!==ge.containerInfo||ue.stateNode.implementation!==ge.implementation?(ue=Pu(ge,we.mode,Be),ue.return=we,ue):(ue=y(ue,ge.children||[]),ue.return=we,ue)}function se(we,ue,ge,Be,tt){return ue===null||ue.tag!==7?(ue=as(ge,we.mode,Be,tt),ue.return=we,ue):(ue=y(ue,ge),ue.return=we,ue)}function pe(we,ue,ge){if(typeof ue=="string"&&ue!==""||typeof ue=="number")return ue=zc(""+ue,we.mode,ge),ue.return=we,ue;if(typeof ue=="object"&&ue!==null){switch(ue.$$typeof){case _e:return ge=zu(ue.type,ue.key,ue.props,null,we.mode,ge),ge.ref=Yo(we,null,ue),ge.return=we,ge;case Ue:return ue=Pu(ue,we.mode,ge),ue.return=we,ue;case ht:var Be=ue._init;return pe(we,Be(ue._payload),ge)}if(ot(ue)||Fe(ue))return ue=as(ue,we.mode,ge,null),ue.return=we,ue;Ca(we,ue)}return null}function ie(we,ue,ge,Be){var tt=ue!==null?ue.key:null;if(typeof ge=="string"&&ge!==""||typeof ge=="number")return tt!==null?null:z(we,ue,""+ge,Be);if(typeof ge=="object"&&ge!==null){switch(ge.$$typeof){case _e:return ge.key===tt?N(we,ue,ge,Be):null;case Ue:return ge.key===tt?W(we,ue,ge,Be):null;case ht:return tt=ge._init,ie(we,ue,tt(ge._payload),Be)}if(ot(ge)||Fe(ge))return tt!==null?null:se(we,ue,ge,Be,null);Ca(we,ge)}return null}function Te(we,ue,ge,Be,tt){if(typeof Be=="string"&&Be!==""||typeof Be=="number")return we=we.get(ge)||null,z(ue,we,""+Be,tt);if(typeof Be=="object"&&Be!==null){switch(Be.$$typeof){case _e:return we=we.get(Be.key===null?ge:Be.key)||null,N(ue,we,Be,tt);case Ue:return we=we.get(Be.key===null?ge:Be.key)||null,W(ue,we,Be,tt);case ht:var nt=Be._init;return Te(we,ue,ge,nt(Be._payload),tt)}if(ot(Be)||Fe(Be))return we=we.get(ge)||null,se(ue,we,Be,tt,null);Ca(ue,Be)}return null}function Le(we,ue,ge,Be){for(var tt=null,nt=null,Ge=ue,mt=ue=0,Ct=null;Ge!==null&&mt<ge.length;mt++){Ge.index>mt?(Ct=Ge,Ge=null):Ct=Ge.sibling;var Mt=ie(we,Ge,ge[mt],Be);if(Mt===null){Ge===null&&(Ge=Ct);break}t&&Ge&&Mt.alternate===null&&i(we,Ge),ue=w(Mt,ue,mt),nt===null?tt=Mt:nt.sibling=Mt,nt=Mt,Ge=Ct}if(mt===ge.length)return a(we,Ge),nr&&En(we,mt),tt;if(Ge===null){for(;mt<ge.length;mt++)Ge=pe(we,ge[mt],Be),Ge!==null&&(ue=w(Ge,ue,mt),nt===null?tt=Ge:nt.sibling=Ge,nt=Ge);return nr&&En(we,mt),tt}for(Ge=h(we,Ge);mt<ge.length;mt++)Ct=Te(Ge,we,mt,ge[mt],Be),Ct!==null&&(t&&Ct.alternate!==null&&Ge.delete(Ct.key===null?mt:Ct.key),ue=w(Ct,ue,mt),nt===null?tt=Ct:nt.sibling=Ct,nt=Ct);return t&&Ge.forEach(function(br){return i(we,br)}),nr&&En(we,mt),tt}function Re(we,ue,ge,Be){var tt=Fe(ge);if(typeof tt!="function")throw Error(x(150));if(ge=tt.call(ge),ge==null)throw Error(x(151));for(var nt=tt=null,Ge=ue,mt=ue=0,Ct=null,Mt=ge.next();Ge!==null&&!Mt.done;mt++,Mt=ge.next()){Ge.index>mt?(Ct=Ge,Ge=null):Ct=Ge.sibling;var br=ie(we,Ge,Mt.value,Be);if(br===null){Ge===null&&(Ge=Ct);break}t&&Ge&&br.alternate===null&&i(we,Ge),ue=w(br,ue,mt),nt===null?tt=br:nt.sibling=br,nt=br,Ge=Ct}if(Mt.done)return a(we,Ge),nr&&En(we,mt),tt;if(Ge===null){for(;!Mt.done;mt++,Mt=ge.next())Mt=pe(we,Mt.value,Be),Mt!==null&&(ue=w(Mt,ue,mt),nt===null?tt=Mt:nt.sibling=Mt,nt=Mt);return nr&&En(we,mt),tt}for(Ge=h(we,Ge);!Mt.done;mt++,Mt=ge.next())Mt=Te(Ge,we,mt,Mt.value,Be),Mt!==null&&(t&&Mt.alternate!==null&&Ge.delete(Mt.key===null?mt:Mt.key),ue=w(Mt,ue,mt),nt===null?tt=Mt:nt.sibling=Mt,nt=Mt);return t&&Ge.forEach(function($r){return i(we,$r)}),nr&&En(we,mt),tt}function xt(we,ue,ge,Be){if(typeof ge=="object"&&ge!==null&&ge.type===De&&ge.key===null&&(ge=ge.props.children),typeof ge=="object"&&ge!==null){switch(ge.$$typeof){case _e:e:{for(var tt=ge.key,nt=ue;nt!==null;){if(nt.key===tt){if(tt=ge.type,tt===De){if(nt.tag===7){a(we,nt.sibling),ue=y(nt,ge.props.children),ue.return=we,we=ue;break e}}else if(nt.elementType===tt||typeof tt=="object"&&tt!==null&&tt.$$typeof===ht&&gu(tt)===nt.type){a(we,nt.sibling),ue=y(nt,ge.props),ue.ref=Yo(we,nt,ge),ue.return=we,we=ue;break e}a(we,nt);break}else i(we,nt);nt=nt.sibling}ge.type===De?(ue=as(ge.props.children,we.mode,Be,ge.key),ue.return=we,we=ue):(Be=zu(ge.type,ge.key,ge.props,null,we.mode,Be),Be.ref=Yo(we,ue,ge),Be.return=we,we=Be)}return E(we);case Ue:e:{for(nt=ge.key;ue!==null;){if(ue.key===nt)if(ue.tag===4&&ue.stateNode.containerInfo===ge.containerInfo&&ue.stateNode.implementation===ge.implementation){a(we,ue.sibling),ue=y(ue,ge.children||[]),ue.return=we,we=ue;break e}else{a(we,ue);break}else i(we,ue);ue=ue.sibling}ue=Pu(ge,we.mode,Be),ue.return=we,we=ue}return E(we);case ht:return nt=ge._init,xt(we,ue,nt(ge._payload),Be)}if(ot(ge))return Le(we,ue,ge,Be);if(Fe(ge))return Re(we,ue,ge,Be);Ca(we,ge)}return typeof ge=="string"&&ge!==""||typeof ge=="number"?(ge=""+ge,ue!==null&&ue.tag===6?(a(we,ue.sibling),ue=y(ue,ge),ue.return=we,we=ue):(a(we,ue),ue=zc(ge,we.mode,Be),ue.return=we,we=ue),E(we)):a(we,ue)}return xt}var Il=Qh(!0),Gn=Qh(!1),_n={},eo=te(_n),Ia=te(_n),Al=te(_n);function to(t){if(t===_n)throw Error(x(174));return t}function Qc(t,i){switch(ye(Al,i),ye(Ia,t),ye(eo,_n),t=i.nodeType,t){case 9:case 11:i=(i=i.documentElement)?i.namespaceURI:Me(null,"");break;default:t=t===8?i.parentNode:i,i=t.namespaceURI||null,t=t.tagName,i=Me(i,t)}ee(eo),ye(eo,i)}function Aa(){ee(eo),ee(Ia),ee(Al)}function eh(t){to(Al.current);var i=to(eo.current),a=Me(i,t.type);i!==a&&(ye(Ia,t),ye(eo,a))}function zl(t){Ia.current===t&&(ee(eo),ee(Ia))}var en=te(0);function yu(t){for(var i=t;i!==null;){if(i.tag===13){var a=i.memoizedState;if(a!==null&&(a=a.dehydrated,a===null||a.data==="$?"||a.data==="$!"))return i}else if(i.tag===19&&i.memoizedProps.revealOrder!==void 0){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===t)break;for(;i.sibling===null;){if(i.return===null||i.return===t)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var nc=[];function th(){for(var t=0;t<nc.length;t++)nc[t]._workInProgressVersionPrimary=null;nc.length=0}var Pl=be.ReactCurrentDispatcher,ic=be.ReactCurrentBatchConfig,Jo=0,Vr=null,Pr=null,Tn=null,oc=!1,_u=!1,vu=0,sc=0;function kn(){throw Error(x(321))}function ac(t,i){if(i===null)return!1;for(var a=0;a<i.length&&a<t.length;a++)if(!di(t[a],i[a]))return!1;return!0}function Qo(t,i,a,h,y,w){if(Jo=w,Vr=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,Pl.current=t===null||t.memoizedState===null?af:Fs,t=a(h,y),_u){w=0;do{if(_u=!1,vu=0,25<=w)throw Error(x(301));w+=1,Tn=Pr=null,i.updateQueue=null,Pl.current=lf,t=a(h,y)}while(_u)}if(Pl.current=mc,i=Pr!==null&&Pr.next!==null,Jo=0,Tn=Pr=Vr=null,oc=!1,i)throw Error(x(300));return t}function za(){var t=vu!==0;return vu=0,t}function Ao(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Tn===null?Vr.memoizedState=Tn=t:Tn=Tn.next=t,Tn}function Fi(){if(Pr===null){var t=Vr.alternate;t=t!==null?t.memoizedState:null}else t=Pr.next;var i=Tn===null?Vr.memoizedState:Tn.next;if(i!==null)Tn=i,Pr=t;else{if(t===null)throw Error(x(310));Pr=t,t={memoizedState:Pr.memoizedState,baseState:Pr.baseState,baseQueue:Pr.baseQueue,queue:Pr.queue,next:null},Tn===null?Vr.memoizedState=Tn=t:Tn=Tn.next=t}return Tn}function xu(t,i){return typeof i=="function"?i(t):i}function rh(t){var i=Fi(),a=i.queue;if(a===null)throw Error(x(311));a.lastRenderedReducer=t;var h=Pr,y=h.baseQueue,w=a.pending;if(w!==null){if(y!==null){var E=y.next;y.next=w.next,w.next=E}h.baseQueue=y=w,a.pending=null}if(y!==null){w=y.next,h=h.baseState;var z=E=null,N=null,W=w;do{var se=W.lane;if((Jo&se)===se)N!==null&&(N=N.next={lane:0,action:W.action,hasEagerState:W.hasEagerState,eagerState:W.eagerState,next:null}),h=W.hasEagerState?W.eagerState:t(h,W.action);else{var pe={lane:se,action:W.action,hasEagerState:W.hasEagerState,eagerState:W.eagerState,next:null};N===null?(z=N=pe,E=h):N=N.next=pe,Vr.lanes|=se,Us|=se}W=W.next}while(W!==null&&W!==w);N===null?E=h:N.next=z,di(h,i.memoizedState)||(pi=!0),i.memoizedState=h,i.baseState=E,i.baseQueue=N,a.lastRenderedState=h}if(t=a.interleaved,t!==null){y=t;do w=y.lane,Vr.lanes|=w,Us|=w,y=y.next;while(y!==t)}else y===null&&(a.lanes=0);return[i.memoizedState,a.dispatch]}function nh(t){var i=Fi(),a=i.queue;if(a===null)throw Error(x(311));a.lastRenderedReducer=t;var h=a.dispatch,y=a.pending,w=i.memoizedState;if(y!==null){a.pending=null;var E=y=y.next;do w=t(w,E.action),E=E.next;while(E!==y);di(w,i.memoizedState)||(pi=!0),i.memoizedState=w,i.baseQueue===null&&(i.baseState=w),a.lastRenderedState=w}return[w,h]}function ed(){}function td(t,i){var a=Vr,h=Fi(),y=i(),w=!di(h.memoizedState,y);if(w&&(h.memoizedState=y,pi=!0),h=h.queue,uc(Pa.bind(null,a,h,t),[t]),h.getSnapshot!==i||w||Tn!==null&&Tn.memoizedState.tag&1){if(a.flags|=2048,Ml(9,rd.bind(null,a,h,y,i),void 0,null),On===null)throw Error(x(349));(Jo&30)!==0||lc(a,i,y)}return y}function lc(t,i,a){t.flags|=16384,t={getSnapshot:i,value:a},i=Vr.updateQueue,i===null?(i={lastEffect:null,stores:null},Vr.updateQueue=i,i.stores=[t]):(a=i.stores,a===null?i.stores=[t]:a.push(t))}function rd(t,i,a,h){i.value=a,i.getSnapshot=h,nd(i)&&tn(t)}function Pa(t,i,a){return a(function(){nd(i)&&tn(t)})}function nd(t){var i=t.getSnapshot;t=t.value;try{var a=i();return!di(t,a)}catch{return!0}}function tn(t){var i=Qi(t,1);i!==null&&oo(i,t,1,-1)}function wu(t){var i=Ao();return typeof t=="function"&&(t=t()),i.memoizedState=i.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:xu,lastRenderedState:t},i.queue=t,t=t.dispatch=sh.bind(null,Vr,t),[i.memoizedState,t]}function Ml(t,i,a,h){return t={tag:t,create:i,destroy:a,deps:h,next:null},i=Vr.updateQueue,i===null?(i={lastEffect:null,stores:null},Vr.updateQueue=i,i.lastEffect=t.next=t):(a=i.lastEffect,a===null?i.lastEffect=t.next=t:(h=a.next,a.next=t,t.next=h,i.lastEffect=t)),t}function bu(){return Fi().memoizedState}function Ma(t,i,a,h){var y=Ao();Vr.flags|=t,y.memoizedState=Ml(1|i,a,void 0,h===void 0?null:h)}function Bs(t,i,a,h){var y=Fi();h=h===void 0?null:h;var w=void 0;if(Pr!==null){var E=Pr.memoizedState;if(w=E.destroy,h!==null&&ac(h,E.deps)){y.memoizedState=Ml(i,a,w,h);return}}Vr.flags|=t,y.memoizedState=Ml(1|i,a,w,h)}function ih(t,i){return Ma(8390656,8,t,i)}function uc(t,i){return Bs(2048,8,t,i)}function Dl(t,i){return Bs(4,2,t,i)}function cc(t,i){return Bs(4,4,t,i)}function hc(t,i){if(typeof i=="function")return t=t(),i(t),function(){i(null)};if(i!=null)return t=t(),i.current=t,function(){i.current=null}}function id(t,i,a){return a=a!=null?a.concat([t]):null,Bs(4,4,hc.bind(null,i,t),a)}function dc(){}function Rl(t,i){var a=Fi();i=i===void 0?null:i;var h=a.memoizedState;return h!==null&&i!==null&&ac(i,h[1])?h[0]:(a.memoizedState=[t,i],t)}function od(t,i){var a=Fi();i=i===void 0?null:i;var h=a.memoizedState;return h!==null&&i!==null&&ac(i,h[1])?h[0]:(t=t(),a.memoizedState=[t,i],t)}function fc(t,i,a){return(Jo&21)===0?(t.baseState&&(t.baseState=!1,pi=!0),t.memoizedState=a):(di(a,i)||(a=Hl(),Vr.lanes|=a,Us|=a,t.baseState=!0),i)}function sf(t,i){var a=wr;wr=a!==0&&4>a?a:4,t(!0);var h=ic.transition;ic.transition={};try{t(!1),i()}finally{wr=a,ic.transition=h}}function pc(){return Fi().memoizedState}function oh(t,i,a){var h=js(t);if(a={lane:h,action:a,hasEagerState:!1,eagerState:null,next:null},sd(t))ad(i,a);else if(a=cn(t,i,a,h),a!==null){var y=ai();oo(a,t,h,y),ld(a,i,h)}}function sh(t,i,a){var h=js(t),y={lane:h,action:a,hasEagerState:!1,eagerState:null,next:null};if(sd(t))ad(i,y);else{var w=t.alternate;if(t.lanes===0&&(w===null||w.lanes===0)&&(w=i.lastRenderedReducer,w!==null))try{var E=i.lastRenderedState,z=w(E,a);if(y.hasEagerState=!0,y.eagerState=z,di(z,E)){var N=i.interleaved;N===null?(y.next=y,tc(i)):(y.next=N.next,N.next=y),i.interleaved=y;return}}catch{}finally{}a=cn(t,i,y,h),a!==null&&(y=ai(),oo(a,t,h,y),ld(a,i,h))}}function sd(t){var i=t.alternate;return t===Vr||i!==null&&i===Vr}function ad(t,i){_u=oc=!0;var a=t.pending;a===null?i.next=i:(i.next=a.next,a.next=i),t.pending=i}function ld(t,i,a){if((a&4194240)!==0){var h=i.lanes;h&=t.pendingLanes,a|=h,i.lanes=a,lo(t,a)}}var mc={readContext:Bn,useCallback:kn,useContext:kn,useEffect:kn,useImperativeHandle:kn,useInsertionEffect:kn,useLayoutEffect:kn,useMemo:kn,useReducer:kn,useRef:kn,useState:kn,useDebugValue:kn,useDeferredValue:kn,useTransition:kn,useMutableSource:kn,useSyncExternalStore:kn,useId:kn,unstable_isNewReconciler:!1},af={readContext:Bn,useCallback:function(t,i){return Ao().memoizedState=[t,i===void 0?null:i],t},useContext:Bn,useEffect:ih,useImperativeHandle:function(t,i,a){return a=a!=null?a.concat([t]):null,Ma(4194308,4,hc.bind(null,i,t),a)},useLayoutEffect:function(t,i){return Ma(4194308,4,t,i)},useInsertionEffect:function(t,i){return Ma(4,2,t,i)},useMemo:function(t,i){var a=Ao();return i=i===void 0?null:i,t=t(),a.memoizedState=[t,i],t},useReducer:function(t,i,a){var h=Ao();return i=a!==void 0?a(i):i,h.memoizedState=h.baseState=i,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:i},h.queue=t,t=t.dispatch=oh.bind(null,Vr,t),[h.memoizedState,t]},useRef:function(t){var i=Ao();return t={current:t},i.memoizedState=t},useState:wu,useDebugValue:dc,useDeferredValue:function(t){return Ao().memoizedState=t},useTransition:function(){var t=wu(!1),i=t[0];return t=sf.bind(null,t[1]),Ao().memoizedState=t,[i,t]},useMutableSource:function(){},useSyncExternalStore:function(t,i,a){var h=Vr,y=Ao();if(nr){if(a===void 0)throw Error(x(407));a=a()}else{if(a=i(),On===null)throw Error(x(349));(Jo&30)!==0||lc(h,i,a)}y.memoizedState=a;var w={value:a,getSnapshot:i};return y.queue=w,ih(Pa.bind(null,h,w,t),[t]),h.flags|=2048,Ml(9,rd.bind(null,h,w,a,i),void 0,null),a},useId:function(){var t=Ao(),i=On.identifierPrefix;if(nr){var a=jr,h=$n;a=(h&~(1<<32-ti(h)-1)).toString(32)+a,i=":"+i+"R"+a,a=vu++,0<a&&(i+="H"+a.toString(32)),i+=":"}else a=sc++,i=":"+i+"r"+a.toString(32)+":";return t.memoizedState=i},unstable_isNewReconciler:!1},Fs={readContext:Bn,useCallback:Rl,useContext:Bn,useEffect:uc,useImperativeHandle:id,useInsertionEffect:Dl,useLayoutEffect:cc,useMemo:od,useReducer:rh,useRef:bu,useState:function(){return rh(xu)},useDebugValue:dc,useDeferredValue:function(t){var i=Fi();return fc(i,Pr.memoizedState,t)},useTransition:function(){var t=rh(xu)[0],i=Fi().memoizedState;return[t,i]},useMutableSource:ed,useSyncExternalStore:td,useId:pc,unstable_isNewReconciler:!1},lf={readContext:Bn,useCallback:Rl,useContext:Bn,useEffect:uc,useImperativeHandle:id,useInsertionEffect:Dl,useLayoutEffect:cc,useMemo:od,useReducer:nh,useRef:bu,useState:function(){return nh(xu)},useDebugValue:dc,useDeferredValue:function(t){var i=Fi();return Pr===null?i.memoizedState=t:fc(i,Pr.memoizedState,t)},useTransition:function(){var t=nh(xu)[0],i=Fi().memoizedState;return[t,i]},useMutableSource:ed,useSyncExternalStore:td,useId:pc,unstable_isNewReconciler:!1};function Da(t,i){try{var a="",h=i;do a+=dt(h),h=h.return;while(h);var y=a}catch(w){y=`
Error generating stack: `+w.message+`
`+w.stack}return{value:t,source:i,stack:y,digest:null}}function Os(t,i,a){return{value:t,source:null,stack:a??null,digest:i??null}}function ah(t,i){try{console.error(i.value)}catch(a){setTimeout(function(){throw a})}}var uf=typeof WeakMap=="function"?WeakMap:Map;function ud(t,i,a){a=Bi(-1,a),a.tag=3,a.payload={element:null};var h=i.value;return a.callback=function(){Ec||(Ec=!0,kh=h),ah(t,i)},a}function lh(t,i,a){a=Bi(-1,a),a.tag=3;var h=t.type.getDerivedStateFromError;if(typeof h=="function"){var y=i.value;a.payload=function(){return h(y)},a.callback=function(){ah(t,i)}}var w=t.stateNode;return w!==null&&typeof w.componentDidCatch=="function"&&(a.callback=function(){ah(t,i),typeof h!="function"&&(ts===null?ts=new Set([this]):ts.add(this));var E=i.stack;this.componentDidCatch(i.value,{componentStack:E!==null?E:""})}),a}function uh(t,i,a){var h=t.pingCache;if(h===null){h=t.pingCache=new uf;var y=new Set;h.set(i,y)}else y=h.get(i),y===void 0&&(y=new Set,h.set(i,y));y.has(a)||(y.add(a),t=ff.bind(null,t,i,a),i.then(t,t))}function cd(t){do{var i;if((i=t.tag===13)&&(i=t.memoizedState,i=i!==null?i.dehydrated!==null:!0),i)return t;t=t.return}while(t!==null);return null}function hd(t,i,a,h,y){return(t.mode&1)===0?(t===i?t.flags|=65536:(t.flags|=128,a.flags|=131072,a.flags&=-52805,a.tag===1&&(a.alternate===null?a.tag=17:(i=Bi(-1,1),i.tag=2,Io(a,i,1))),a.lanes|=1),t):(t.flags|=65536,t.lanes=y,t)}var cf=be.ReactCurrentOwner,pi=!1;function Zn(t,i,a,h){i.child=t===null?Gn(i,null,a,h):Il(i,t.child,a,h)}function Ll(t,i,a,h,y){a=a.render;var w=i.ref;return Ea(i,y),h=Qo(t,i,a,h,w,y),a=za(),t!==null&&!pi?(i.updateQueue=t.updateQueue,i.flags&=-2053,t.lanes&=~y,es(t,i,y)):(nr&&a&&Ps(i),i.flags|=1,Zn(t,i,h,y),i.child)}function gc(t,i,a,h,y){if(t===null){var w=a.type;return typeof w=="function"&&!Ac(w)&&w.defaultProps===void 0&&a.compare===null&&a.defaultProps===void 0?(i.tag=15,i.type=w,dd(t,i,w,h,y)):(t=zu(a.type,null,h,i,i.mode,y),t.ref=i.ref,t.return=i,i.child=t)}if(w=t.child,(t.lanes&y)===0){var E=w.memoizedProps;if(a=a.compare,a=a!==null?a:bi,a(E,h)&&t.ref===i.ref)return es(t,i,y)}return i.flags|=1,t=ss(w,h),t.ref=i.ref,t.return=i,i.child=t}function dd(t,i,a,h,y){if(t!==null){var w=t.memoizedProps;if(bi(w,h)&&t.ref===i.ref)if(pi=!1,i.pendingProps=h=w,(t.lanes&y)!==0)(t.flags&131072)!==0&&(pi=!0);else return i.lanes=t.lanes,es(t,i,y)}return Ra(t,i,a,h,y)}function fd(t,i,a){var h=i.pendingProps,y=h.children,w=t!==null?t.memoizedState:null;if(h.mode==="hidden")if((i.mode&1)===0)i.memoizedState={baseLanes:0,cachePool:null,transitions:null},ye(Ns,oi),oi|=a;else{if((a&1073741824)===0)return t=w!==null?w.baseLanes|a:a,i.lanes=i.childLanes=1073741824,i.memoizedState={baseLanes:t,cachePool:null,transitions:null},i.updateQueue=null,ye(Ns,oi),oi|=t,null;i.memoizedState={baseLanes:0,cachePool:null,transitions:null},h=w!==null?w.baseLanes:a,ye(Ns,oi),oi|=h}else w!==null?(h=w.baseLanes|a,i.memoizedState=null):h=a,ye(Ns,oi),oi|=h;return Zn(t,i,y,a),i.child}function pd(t,i){var a=i.ref;(t===null&&a!==null||t!==null&&t.ref!==a)&&(i.flags|=512,i.flags|=2097152)}function Ra(t,i,a,h,y){var w=Xe(a)?Ve:Pe.current;return w=Oe(i,w),Ea(i,y),a=Qo(t,i,a,h,w,y),h=za(),t!==null&&!pi?(i.updateQueue=t.updateQueue,i.flags&=-2053,t.lanes&=~y,es(t,i,y)):(nr&&h&&Ps(i),i.flags|=1,Zn(t,i,a,y),i.child)}function ch(t,i,a,h,y){if(Xe(a)){var w=!0;It(i)}else w=!1;if(Ea(i,y),i.stateNode===null)vc(t,i),Yc(i,a,h),Jc(i,a,h,y),h=!0;else if(t===null){var E=i.stateNode,z=i.memoizedProps;E.props=z;var N=E.context,W=a.contextType;typeof W=="object"&&W!==null?W=Bn(W):(W=Xe(a)?Ve:Pe.current,W=Oe(i,W));var se=a.getDerivedStateFromProps,pe=typeof se=="function"||typeof E.getSnapshotBeforeUpdate=="function";pe||typeof E.UNSAFE_componentWillReceiveProps!="function"&&typeof E.componentWillReceiveProps!="function"||(z!==h||N!==W)&&ka(i,E,h,W),Xo=!1;var ie=i.memoizedState;E.state=ie,mu(i,h,E,y),N=i.memoizedState,z!==h||ie!==N||he.current||Xo?(typeof se=="function"&&(Xc(i,a,se,h),N=i.memoizedState),(z=Xo||Kc(i,a,z,h,ie,N,W))?(pe||typeof E.UNSAFE_componentWillMount!="function"&&typeof E.componentWillMount!="function"||(typeof E.componentWillMount=="function"&&E.componentWillMount(),typeof E.UNSAFE_componentWillMount=="function"&&E.UNSAFE_componentWillMount()),typeof E.componentDidMount=="function"&&(i.flags|=4194308)):(typeof E.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=h,i.memoizedState=N),E.props=h,E.state=N,E.context=W,h=z):(typeof E.componentDidMount=="function"&&(i.flags|=4194308),h=!1)}else{E=i.stateNode,Ls(t,i),z=i.memoizedProps,W=i.type===i.elementType?z:Xn(i.type,z),E.props=W,pe=i.pendingProps,ie=E.context,N=a.contextType,typeof N=="object"&&N!==null?N=Bn(N):(N=Xe(a)?Ve:Pe.current,N=Oe(i,N));var Te=a.getDerivedStateFromProps;(se=typeof Te=="function"||typeof E.getSnapshotBeforeUpdate=="function")||typeof E.UNSAFE_componentWillReceiveProps!="function"&&typeof E.componentWillReceiveProps!="function"||(z!==pe||ie!==N)&&ka(i,E,h,N),Xo=!1,ie=i.memoizedState,E.state=ie,mu(i,h,E,y);var Le=i.memoizedState;z!==pe||ie!==Le||he.current||Xo?(typeof Te=="function"&&(Xc(i,a,Te,h),Le=i.memoizedState),(W=Xo||Kc(i,a,W,h,ie,Le,N)||!1)?(se||typeof E.UNSAFE_componentWillUpdate!="function"&&typeof E.componentWillUpdate!="function"||(typeof E.componentWillUpdate=="function"&&E.componentWillUpdate(h,Le,N),typeof E.UNSAFE_componentWillUpdate=="function"&&E.UNSAFE_componentWillUpdate(h,Le,N)),typeof E.componentDidUpdate=="function"&&(i.flags|=4),typeof E.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof E.componentDidUpdate!="function"||z===t.memoizedProps&&ie===t.memoizedState||(i.flags|=4),typeof E.getSnapshotBeforeUpdate!="function"||z===t.memoizedProps&&ie===t.memoizedState||(i.flags|=1024),i.memoizedProps=h,i.memoizedState=Le),E.props=h,E.state=Le,E.context=N,h=W):(typeof E.componentDidUpdate!="function"||z===t.memoizedProps&&ie===t.memoizedState||(i.flags|=4),typeof E.getSnapshotBeforeUpdate!="function"||z===t.memoizedProps&&ie===t.memoizedState||(i.flags|=1024),h=!1)}return hh(t,i,a,h,w,y)}function hh(t,i,a,h,y,w){pd(t,i);var E=(i.flags&128)!==0;if(!h&&!E)return y&&wt(i,a,!1),es(t,i,w);h=i.stateNode,cf.current=i;var z=E&&typeof a.getDerivedStateFromError!="function"?null:h.render();return i.flags|=1,t!==null&&E?(i.child=Il(i,t.child,null,w),i.child=Il(i,null,z,w)):Zn(t,i,z,w),i.memoizedState=h.state,y&&wt(i,a,!0),i.child}function md(t){var i=t.stateNode;i.pendingContext?pt(t,i.pendingContext,i.pendingContext!==i.context):i.context&&pt(t,i.context,!1),Qc(t,i.containerInfo)}function gd(t,i,a,h,y){return Ln(),Ds(y),i.flags|=256,Zn(t,i,a,h),i.child}var dh={dehydrated:null,treeContext:null,retryLane:0};function fh(t){return{baseLanes:t,cachePool:null,transitions:null}}function yd(t,i,a){var h=i.pendingProps,y=en.current,w=!1,E=(i.flags&128)!==0,z;if((z=E)||(z=t!==null&&t.memoizedState===null?!1:(y&2)!==0),z?(w=!0,i.flags&=-129):(t===null||t.memoizedState!==null)&&(y|=1),ye(en,y&1),t===null)return To(i),t=i.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?((i.mode&1)===0?i.lanes=1:t.data==="$!"?i.lanes=8:i.lanes=1073741824,null):(E=h.children,t=h.fallback,w?(h=i.mode,w=i.child,E={mode:"hidden",children:E},(h&1)===0&&w!==null?(w.childLanes=0,w.pendingProps=E):w=Wa(E,h,0,null),t=as(t,h,a,null),w.return=i,t.return=i,w.sibling=t,i.child=w,i.child.memoizedState=fh(a),i.memoizedState=dh,t):yc(i,E));if(y=t.memoizedState,y!==null&&(z=y.dehydrated,z!==null))return hf(t,i,E,h,z,y,a);if(w){w=h.fallback,E=i.mode,y=t.child,z=y.sibling;var N={mode:"hidden",children:h.children};return(E&1)===0&&i.child!==y?(h=i.child,h.childLanes=0,h.pendingProps=N,i.deletions=null):(h=ss(y,N),h.subtreeFlags=y.subtreeFlags&14680064),z!==null?w=ss(z,w):(w=as(w,E,a,null),w.flags|=2),w.return=i,h.return=i,h.sibling=w,i.child=h,h=w,w=i.child,E=t.child.memoizedState,E=E===null?fh(a):{baseLanes:E.baseLanes|a,cachePool:null,transitions:E.transitions},w.memoizedState=E,w.childLanes=t.childLanes&~a,i.memoizedState=dh,h}return w=t.child,t=w.sibling,h=ss(w,{mode:"visible",children:h.children}),(i.mode&1)===0&&(h.lanes=a),h.return=i,h.sibling=null,t!==null&&(a=i.deletions,a===null?(i.deletions=[t],i.flags|=16):a.push(t)),i.child=h,i.memoizedState=null,h}function yc(t,i){return i=Wa({mode:"visible",children:i},t.mode,0,null),i.return=t,t.child=i}function Bl(t,i,a,h){return h!==null&&Ds(h),Il(i,t.child,null,a),t=yc(i,i.pendingProps.children),t.flags|=2,i.memoizedState=null,t}function hf(t,i,a,h,y,w,E){if(a)return i.flags&256?(i.flags&=-257,h=Os(Error(x(422))),Bl(t,i,E,h)):i.memoizedState!==null?(i.child=t.child,i.flags|=128,null):(w=h.fallback,y=i.mode,h=Wa({mode:"visible",children:h.children},y,0,null),w=as(w,y,E,null),w.flags|=2,h.return=i,w.return=i,h.sibling=w,i.child=h,(i.mode&1)!==0&&Il(i,t.child,null,E),i.child.memoizedState=fh(E),i.memoizedState=dh,w);if((i.mode&1)===0)return Bl(t,i,E,null);if(y.data==="$!"){if(h=y.nextSibling&&y.nextSibling.dataset,h)var z=h.dgst;return h=z,w=Error(x(419)),h=Os(w,h,void 0),Bl(t,i,E,h)}if(z=(E&t.childLanes)!==0,pi||z){if(h=On,h!==null){switch(E&-E){case 4:y=2;break;case 16:y=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:y=32;break;case 536870912:y=268435456;break;default:y=0}y=(y&(h.suspendedLanes|E))!==0?0:y,y!==0&&y!==w.retryLane&&(w.retryLane=y,Qi(t,y),oo(h,t,y,-1))}return Au(),h=Os(Error(x(421))),Bl(t,i,E,h)}return y.data==="$?"?(i.flags|=128,i.child=t.child,i=pf.bind(null,t),y._reactRetry=i,null):(t=w.treeContext,Yt=fi(y.nextSibling),dr=i,nr=!0,Zr=null,t!==null&&(on[Qr++]=$n,on[Qr++]=jr,on[Qr++]=Sn,$n=t.id,jr=t.overflow,Sn=i),i=yc(i,h.children),i.flags|=4096,i)}function ph(t,i,a){t.lanes|=i;var h=t.alternate;h!==null&&(h.lanes|=i),Co(t.return,i,a)}function _c(t,i,a,h,y){var w=t.memoizedState;w===null?t.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:h,tail:a,tailMode:y}:(w.isBackwards=i,w.rendering=null,w.renderingStartTime=0,w.last=h,w.tail=a,w.tailMode=y)}function mh(t,i,a){var h=i.pendingProps,y=h.revealOrder,w=h.tail;if(Zn(t,i,h.children,a),h=en.current,(h&2)!==0)h=h&1|2,i.flags|=128;else{if(t!==null&&(t.flags&128)!==0)e:for(t=i.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&ph(t,a,i);else if(t.tag===19)ph(t,a,i);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===i)break e;for(;t.sibling===null;){if(t.return===null||t.return===i)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}h&=1}if(ye(en,h),(i.mode&1)===0)i.memoizedState=null;else switch(y){case"forwards":for(a=i.child,y=null;a!==null;)t=a.alternate,t!==null&&yu(t)===null&&(y=a),a=a.sibling;a=y,a===null?(y=i.child,i.child=null):(y=a.sibling,a.sibling=null),_c(i,!1,y,a,w);break;case"backwards":for(a=null,y=i.child,i.child=null;y!==null;){if(t=y.alternate,t!==null&&yu(t)===null){i.child=y;break}t=y.sibling,y.sibling=a,a=y,y=t}_c(i,!0,a,null,w);break;case"together":_c(i,!1,null,null,void 0);break;default:i.memoizedState=null}return i.child}function vc(t,i){(i.mode&1)===0&&t!==null&&(t.alternate=null,i.alternate=null,i.flags|=2)}function es(t,i,a){if(t!==null&&(i.dependencies=t.dependencies),Us|=i.lanes,(a&i.childLanes)===0)return null;if(t!==null&&i.child!==t.child)throw Error(x(153));if(i.child!==null){for(t=i.child,a=ss(t,t.pendingProps),i.child=a,a.return=i;t.sibling!==null;)t=t.sibling,a=a.sibling=ss(t,t.pendingProps),a.return=i;a.sibling=null}return i.child}function df(t,i,a){switch(i.tag){case 3:md(i),Ln();break;case 5:eh(i);break;case 1:Xe(i.type)&&It(i);break;case 4:Qc(i,i.stateNode.containerInfo);break;case 10:var h=i.type._context,y=i.memoizedProps.value;ye(ec,h._currentValue),h._currentValue=y;break;case 13:if(h=i.memoizedState,h!==null)return h.dehydrated!==null?(ye(en,en.current&1),i.flags|=128,null):(a&i.child.childLanes)!==0?yd(t,i,a):(ye(en,en.current&1),t=es(t,i,a),t!==null?t.sibling:null);ye(en,en.current&1);break;case 19:if(h=(a&i.childLanes)!==0,(t.flags&128)!==0){if(h)return mh(t,i,a);i.flags|=128}if(y=i.memoizedState,y!==null&&(y.rendering=null,y.tail=null,y.lastEffect=null),ye(en,en.current),h)break;return null;case 22:case 23:return i.lanes=0,fd(t,i,a)}return es(t,i,a)}var gh,yh,_d,Fl;gh=function(t,i){for(var a=i.child;a!==null;){if(a.tag===5||a.tag===6)t.appendChild(a.stateNode);else if(a.tag!==4&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===i)break;for(;a.sibling===null;){if(a.return===null||a.return===i)return;a=a.return}a.sibling.return=a.return,a=a.sibling}},yh=function(){},_d=function(t,i,a,h){var y=t.memoizedProps;if(y!==h){t=i.stateNode,to(eo.current);var w=null;switch(a){case"input":y=O(t,y),h=O(t,h),w=[];break;case"select":y=ae({},y,{value:void 0}),h=ae({},h,{value:void 0}),w=[];break;case"textarea":y=Ne(t,y),h=Ne(t,h),w=[];break;default:typeof y.onClick!="function"&&typeof h.onClick=="function"&&(t.onclick=zs)}yt(a,h);var E;a=null;for(W in y)if(!h.hasOwnProperty(W)&&y.hasOwnProperty(W)&&y[W]!=null)if(W==="style"){var z=y[W];for(E in z)z.hasOwnProperty(E)&&(a||(a={}),a[E]="")}else W!=="dangerouslySetInnerHTML"&&W!=="children"&&W!=="suppressContentEditableWarning"&&W!=="suppressHydrationWarning"&&W!=="autoFocus"&&(C.hasOwnProperty(W)?w||(w=[]):(w=w||[]).push(W,null));for(W in h){var N=h[W];if(z=y!=null?y[W]:void 0,h.hasOwnProperty(W)&&N!==z&&(N!=null||z!=null))if(W==="style")if(z){for(E in z)!z.hasOwnProperty(E)||N&&N.hasOwnProperty(E)||(a||(a={}),a[E]="");for(E in N)N.hasOwnProperty(E)&&z[E]!==N[E]&&(a||(a={}),a[E]=N[E])}else a||(w||(w=[]),w.push(W,a)),a=N;else W==="dangerouslySetInnerHTML"?(N=N?N.__html:void 0,z=z?z.__html:void 0,N!=null&&z!==N&&(w=w||[]).push(W,N)):W==="children"?typeof N!="string"&&typeof N!="number"||(w=w||[]).push(W,""+N):W!=="suppressContentEditableWarning"&&W!=="suppressHydrationWarning"&&(C.hasOwnProperty(W)?(N!=null&&W==="onScroll"&&_r("scroll",t),w||z===N||(w=[])):(w=w||[]).push(W,N))}a&&(w=w||[]).push("style",a);var W=w;(i.updateQueue=W)&&(i.flags|=4)}},Fl=function(t,i,a,h){a!==h&&(i.flags|=4)};function sn(t,i){if(!nr)switch(t.tailMode){case"hidden":i=t.tail;for(var a=null;i!==null;)i.alternate!==null&&(a=i),i=i.sibling;a===null?t.tail=null:a.sibling=null;break;case"collapsed":a=t.tail;for(var h=null;a!==null;)a.alternate!==null&&(h=a),a=a.sibling;h===null?i||t.tail===null?t.tail=null:t.tail.sibling=null:h.sibling=null}}function Fn(t){var i=t.alternate!==null&&t.alternate.child===t.child,a=0,h=0;if(i)for(var y=t.child;y!==null;)a|=y.lanes|y.childLanes,h|=y.subtreeFlags&14680064,h|=y.flags&14680064,y.return=t,y=y.sibling;else for(y=t.child;y!==null;)a|=y.lanes|y.childLanes,h|=y.subtreeFlags,h|=y.flags,y.return=t,y=y.sibling;return t.subtreeFlags|=h,t.childLanes=a,i}function vd(t,i,a){var h=i.pendingProps;switch(mr(i),i.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Fn(i),null;case 1:return Xe(i.type)&&rt(),Fn(i),null;case 3:return h=i.stateNode,Aa(),ee(he),ee(Pe),th(),h.pendingContext&&(h.context=h.pendingContext,h.pendingContext=null),(t===null||t.child===null)&&(Ms(i)?i.flags|=4:t===null||t.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,Zr!==null&&(Tc(Zr),Zr=null))),yh(t,i),Fn(i),null;case 5:zl(i);var y=to(Al.current);if(a=i.type,t!==null&&i.stateNode!=null)_d(t,i,a,h,y),t.ref!==i.ref&&(i.flags|=512,i.flags|=2097152);else{if(!h){if(i.stateNode===null)throw Error(x(166));return Fn(i),null}if(t=to(eo.current),Ms(i)){h=i.stateNode,a=i.type;var w=i.memoizedProps;switch(h[s]=i,h[c]=w,t=(i.mode&1)!==0,a){case"dialog":_r("cancel",h),_r("close",h);break;case"iframe":case"object":case"embed":_r("load",h);break;case"video":case"audio":for(y=0;y<Wo.length;y++)_r(Wo[y],h);break;case"source":_r("error",h);break;case"img":case"image":case"link":_r("error",h),_r("load",h);break;case"details":_r("toggle",h);break;case"input":it(h,w),_r("invalid",h);break;case"select":h._wrapperState={wasMultiple:!!w.multiple},_r("invalid",h);break;case"textarea":_t(h,w),_r("invalid",h)}yt(a,w),y=null;for(var E in w)if(w.hasOwnProperty(E)){var z=w[E];E==="children"?typeof z=="string"?h.textContent!==z&&(w.suppressHydrationWarning!==!0&&wo(h.textContent,z,t),y=["children",z]):typeof z=="number"&&h.textContent!==""+z&&(w.suppressHydrationWarning!==!0&&wo(h.textContent,z,t),y=["children",""+z]):C.hasOwnProperty(E)&&z!=null&&E==="onScroll"&&_r("scroll",h)}switch(a){case"input":or(h),oe(h,w,!0);break;case"textarea":or(h),Qe(h);break;case"select":case"option":break;default:typeof w.onClick=="function"&&(h.onclick=zs)}h=y,i.updateQueue=h,h!==null&&(i.flags|=4)}else{E=y.nodeType===9?y:y.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=kt(a)),t==="http://www.w3.org/1999/xhtml"?a==="script"?(t=E.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof h.is=="string"?t=E.createElement(a,{is:h.is}):(t=E.createElement(a),a==="select"&&(E=t,h.multiple?E.multiple=!0:h.size&&(E.size=h.size))):t=E.createElementNS(t,a),t[s]=i,t[c]=h,gh(t,i,!1,!1),i.stateNode=t;e:{switch(E=qt(a,h),a){case"dialog":_r("cancel",t),_r("close",t),y=h;break;case"iframe":case"object":case"embed":_r("load",t),y=h;break;case"video":case"audio":for(y=0;y<Wo.length;y++)_r(Wo[y],t);y=h;break;case"source":_r("error",t),y=h;break;case"img":case"image":case"link":_r("error",t),_r("load",t),y=h;break;case"details":_r("toggle",t),y=h;break;case"input":it(t,h),y=O(t,h),_r("invalid",t);break;case"option":y=h;break;case"select":t._wrapperState={wasMultiple:!!h.multiple},y=ae({},h,{value:void 0}),_r("invalid",t);break;case"textarea":_t(t,h),y=Ne(t,h),_r("invalid",t);break;default:y=h}yt(a,y),z=y;for(w in z)if(z.hasOwnProperty(w)){var N=z[w];w==="style"?dn(t,N):w==="dangerouslySetInnerHTML"?(N=N?N.__html:void 0,N!=null&&xr(t,N)):w==="children"?typeof N=="string"?(a!=="textarea"||N!=="")&&kr(t,N):typeof N=="number"&&kr(t,""+N):w!=="suppressContentEditableWarning"&&w!=="suppressHydrationWarning"&&w!=="autoFocus"&&(C.hasOwnProperty(w)?N!=null&&w==="onScroll"&&_r("scroll",t):N!=null&&ce(t,w,N,E))}switch(a){case"input":or(t),oe(t,h,!1);break;case"textarea":or(t),Qe(t);break;case"option":h.value!=null&&t.setAttribute("value",""+At(h.value));break;case"select":t.multiple=!!h.multiple,w=h.value,w!=null?ft(t,!!h.multiple,w,!1):h.defaultValue!=null&&ft(t,!!h.multiple,h.defaultValue,!0);break;default:typeof y.onClick=="function"&&(t.onclick=zs)}switch(a){case"button":case"input":case"select":case"textarea":h=!!h.autoFocus;break e;case"img":h=!0;break e;default:h=!1}}h&&(i.flags|=4)}i.ref!==null&&(i.flags|=512,i.flags|=2097152)}return Fn(i),null;case 6:if(t&&i.stateNode!=null)Fl(t,i,t.memoizedProps,h);else{if(typeof h!="string"&&i.stateNode===null)throw Error(x(166));if(a=to(Al.current),to(eo.current),Ms(i)){if(h=i.stateNode,a=i.memoizedProps,h[s]=i,(w=h.nodeValue!==a)&&(t=dr,t!==null))switch(t.tag){case 3:wo(h.nodeValue,a,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&wo(h.nodeValue,a,(t.mode&1)!==0)}w&&(i.flags|=4)}else h=(a.nodeType===9?a:a.ownerDocument).createTextNode(h),h[s]=i,i.stateNode=h}return Fn(i),null;case 13:if(ee(en),h=i.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(nr&&Yt!==null&&(i.mode&1)!==0&&(i.flags&128)===0)ba(),Ln(),i.flags|=98560,w=!1;else if(w=Ms(i),h!==null&&h.dehydrated!==null){if(t===null){if(!w)throw Error(x(318));if(w=i.memoizedState,w=w!==null?w.dehydrated:null,!w)throw Error(x(317));w[s]=i}else Ln(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;Fn(i),w=!1}else Zr!==null&&(Tc(Zr),Zr=null),w=!0;if(!w)return i.flags&65536?i:null}return(i.flags&128)!==0?(i.lanes=a,i):(h=h!==null,h!==(t!==null&&t.memoizedState!==null)&&h&&(i.child.flags|=8192,(i.mode&1)!==0&&(t===null||(en.current&1)!==0?Cn===0&&(Cn=3):Au())),i.updateQueue!==null&&(i.flags|=4),Fn(i),null);case 4:return Aa(),yh(t,i),t===null&&xo(i.stateNode.containerInfo),Fn(i),null;case 10:return Si(i.type._context),Fn(i),null;case 17:return Xe(i.type)&&rt(),Fn(i),null;case 19:if(ee(en),w=i.memoizedState,w===null)return Fn(i),null;if(h=(i.flags&128)!==0,E=w.rendering,E===null)if(h)sn(w,!1);else{if(Cn!==0||t!==null&&(t.flags&128)!==0)for(t=i.child;t!==null;){if(E=yu(t),E!==null){for(i.flags|=128,sn(w,!1),h=E.updateQueue,h!==null&&(i.updateQueue=h,i.flags|=4),i.subtreeFlags=0,h=a,a=i.child;a!==null;)w=a,t=h,w.flags&=14680066,E=w.alternate,E===null?(w.childLanes=0,w.lanes=t,w.child=null,w.subtreeFlags=0,w.memoizedProps=null,w.memoizedState=null,w.updateQueue=null,w.dependencies=null,w.stateNode=null):(w.childLanes=E.childLanes,w.lanes=E.lanes,w.child=E.child,w.subtreeFlags=0,w.deletions=null,w.memoizedProps=E.memoizedProps,w.memoizedState=E.memoizedState,w.updateQueue=E.updateQueue,w.type=E.type,t=E.dependencies,w.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),a=a.sibling;return ye(en,en.current&1|2),i.child}t=t.sibling}w.tail!==null&&Et()>Na&&(i.flags|=128,h=!0,sn(w,!1),i.lanes=4194304)}else{if(!h)if(t=yu(E),t!==null){if(i.flags|=128,h=!0,a=t.updateQueue,a!==null&&(i.updateQueue=a,i.flags|=4),sn(w,!0),w.tail===null&&w.tailMode==="hidden"&&!E.alternate&&!nr)return Fn(i),null}else 2*Et()-w.renderingStartTime>Na&&a!==1073741824&&(i.flags|=128,h=!0,sn(w,!1),i.lanes=4194304);w.isBackwards?(E.sibling=i.child,i.child=E):(a=w.last,a!==null?a.sibling=E:i.child=E,w.last=E)}return w.tail!==null?(i=w.tail,w.rendering=i,w.tail=i.sibling,w.renderingStartTime=Et(),i.sibling=null,a=en.current,ye(en,h?a&1|2:a&1),i):(Fn(i),null);case 22:case 23:return Ih(),h=i.memoizedState!==null,t!==null&&t.memoizedState!==null!==h&&(i.flags|=8192),h&&(i.mode&1)!==0?(oi&1073741824)!==0&&(Fn(i),i.subtreeFlags&6&&(i.flags|=8192)):Fn(i),null;case 24:return null;case 25:return null}throw Error(x(156,i.tag))}function xd(t,i){switch(mr(i),i.tag){case 1:return Xe(i.type)&&rt(),t=i.flags,t&65536?(i.flags=t&-65537|128,i):null;case 3:return Aa(),ee(he),ee(Pe),th(),t=i.flags,(t&65536)!==0&&(t&128)===0?(i.flags=t&-65537|128,i):null;case 5:return zl(i),null;case 13:if(ee(en),t=i.memoizedState,t!==null&&t.dehydrated!==null){if(i.alternate===null)throw Error(x(340));Ln()}return t=i.flags,t&65536?(i.flags=t&-65537|128,i):null;case 19:return ee(en),null;case 4:return Aa(),null;case 10:return Si(i.type._context),null;case 22:case 23:return Ih(),null;case 24:return null;default:return null}}var Er=!1,an=!1,_h=typeof WeakSet=="function"?WeakSet:Set,Nt=null;function La(t,i){var a=t.ref;if(a!==null)if(typeof a=="function")try{a(null)}catch(h){hn(t,i,h)}else a.current=null}function ro(t,i,a){try{a()}catch(h){hn(t,i,h)}}var Ba=!1;function wd(t,i){if(nn=ms,t=Hu(),vl(t)){if("selectionStart"in t)var a={start:t.selectionStart,end:t.selectionEnd};else e:{a=(a=t.ownerDocument)&&a.defaultView||window;var h=a.getSelection&&a.getSelection();if(h&&h.rangeCount!==0){a=h.anchorNode;var y=h.anchorOffset,w=h.focusNode;h=h.focusOffset;try{a.nodeType,w.nodeType}catch{a=null;break e}var E=0,z=-1,N=-1,W=0,se=0,pe=t,ie=null;t:for(;;){for(var Te;pe!==a||y!==0&&pe.nodeType!==3||(z=E+y),pe!==w||h!==0&&pe.nodeType!==3||(N=E+h),pe.nodeType===3&&(E+=pe.nodeValue.length),(Te=pe.firstChild)!==null;)ie=pe,pe=Te;for(;;){if(pe===t)break t;if(ie===a&&++W===y&&(z=E),ie===w&&++se===h&&(N=E),(Te=pe.nextSibling)!==null)break;pe=ie,ie=pe.parentNode}pe=Te}a=z===-1||N===-1?null:{start:z,end:N}}else a=null}a=a||{start:0,end:0}}else a=null;for(Yi={focusedElem:t,selectionRange:a},ms=!1,Nt=i;Nt!==null;)if(i=Nt,t=i.child,(i.subtreeFlags&1028)!==0&&t!==null)t.return=i,Nt=t;else for(;Nt!==null;){i=Nt;try{var Le=i.alternate;if((i.flags&1024)!==0)switch(i.tag){case 0:case 11:case 15:break;case 1:if(Le!==null){var Re=Le.memoizedProps,xt=Le.memoizedState,we=i.stateNode,ue=we.getSnapshotBeforeUpdate(i.elementType===i.type?Re:Xn(i.type,Re),xt);we.__reactInternalSnapshotBeforeUpdate=ue}break;case 3:var ge=i.stateNode.containerInfo;ge.nodeType===1?ge.textContent="":ge.nodeType===9&&ge.documentElement&&ge.removeChild(ge.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(x(163))}}catch(Be){hn(i,i.return,Be)}if(t=i.sibling,t!==null){t.return=i.return,Nt=t;break}Nt=i.return}return Le=Ba,Ba=!1,Le}function Su(t,i,a){var h=i.updateQueue;if(h=h!==null?h.lastEffect:null,h!==null){var y=h=h.next;do{if((y.tag&t)===t){var w=y.destroy;y.destroy=void 0,w!==void 0&&ro(i,a,w)}y=y.next}while(y!==h)}}function xc(t,i){if(i=i.updateQueue,i=i!==null?i.lastEffect:null,i!==null){var a=i=i.next;do{if((a.tag&t)===t){var h=a.create;a.destroy=h()}a=a.next}while(a!==i)}}function vh(t){var i=t.ref;if(i!==null){var a=t.stateNode;switch(t.tag){case 5:t=a;break;default:t=a}typeof i=="function"?i(t):i.current=t}}function bd(t){var i=t.alternate;i!==null&&(t.alternate=null,bd(i)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(i=t.stateNode,i!==null&&(delete i[s],delete i[c],delete i[_],delete i[S],delete i[k])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function Sd(t){return t.tag===5||t.tag===3||t.tag===4}function Ed(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Sd(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function xh(t,i,a){var h=t.tag;if(h===5||h===6)t=t.stateNode,i?a.nodeType===8?a.parentNode.insertBefore(t,i):a.insertBefore(t,i):(a.nodeType===8?(i=a.parentNode,i.insertBefore(t,a)):(i=a,i.appendChild(t)),a=a._reactRootContainer,a!=null||i.onclick!==null||(i.onclick=zs));else if(h!==4&&(t=t.child,t!==null))for(xh(t,i,a),t=t.sibling;t!==null;)xh(t,i,a),t=t.sibling}function wh(t,i,a){var h=t.tag;if(h===5||h===6)t=t.stateNode,i?a.insertBefore(t,i):a.appendChild(t);else if(h!==4&&(t=t.child,t!==null))for(wh(t,i,a),t=t.sibling;t!==null;)wh(t,i,a),t=t.sibling}var qn=null,mi=!1;function Ei(t,i,a){for(a=a.child;a!==null;)bh(t,i,a),a=a.sibling}function bh(t,i,a){if(zr&&typeof zr.onCommitFiberUnmount=="function")try{zr.onCommitFiberUnmount(Nr,a)}catch{}switch(a.tag){case 5:an||La(a,i);case 6:var h=qn,y=mi;qn=null,Ei(t,i,a),qn=h,mi=y,qn!==null&&(mi?(t=qn,a=a.stateNode,t.nodeType===8?t.parentNode.removeChild(a):t.removeChild(a)):qn.removeChild(a.stateNode));break;case 18:qn!==null&&(mi?(t=qn,a=a.stateNode,t.nodeType===8?bo(t.parentNode,a):t.nodeType===1&&bo(t,a),ps(t)):bo(qn,a.stateNode));break;case 4:h=qn,y=mi,qn=a.stateNode.containerInfo,mi=!0,Ei(t,i,a),qn=h,mi=y;break;case 0:case 11:case 14:case 15:if(!an&&(h=a.updateQueue,h!==null&&(h=h.lastEffect,h!==null))){y=h=h.next;do{var w=y,E=w.destroy;w=w.tag,E!==void 0&&((w&2)!==0||(w&4)!==0)&&ro(a,i,E),y=y.next}while(y!==h)}Ei(t,i,a);break;case 1:if(!an&&(La(a,i),h=a.stateNode,typeof h.componentWillUnmount=="function"))try{h.props=a.memoizedProps,h.state=a.memoizedState,h.componentWillUnmount()}catch(z){hn(a,i,z)}Ei(t,i,a);break;case 21:Ei(t,i,a);break;case 22:a.mode&1?(an=(h=an)||a.memoizedState!==null,Ei(t,i,a),an=h):Ei(t,i,a);break;default:Ei(t,i,a)}}function Td(t){var i=t.updateQueue;if(i!==null){t.updateQueue=null;var a=t.stateNode;a===null&&(a=t.stateNode=new _h),i.forEach(function(h){var y=mf.bind(null,t,h);a.has(h)||(a.add(h),h.then(y,y))})}}function no(t,i){var a=i.deletions;if(a!==null)for(var h=0;h<a.length;h++){var y=a[h];try{var w=t,E=i,z=E;e:for(;z!==null;){switch(z.tag){case 5:qn=z.stateNode,mi=!1;break e;case 3:qn=z.stateNode.containerInfo,mi=!0;break e;case 4:qn=z.stateNode.containerInfo,mi=!0;break e}z=z.return}if(qn===null)throw Error(x(160));bh(w,E,y),qn=null,mi=!1;var N=y.alternate;N!==null&&(N.return=null),y.return=null}catch(W){hn(y,i,W)}}if(i.subtreeFlags&12854)for(i=i.child;i!==null;)kd(i,t),i=i.sibling}function kd(t,i){var a=t.alternate,h=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(no(i,t),io(t),h&4){try{Su(3,t,t.return),xc(3,t)}catch(Re){hn(t,t.return,Re)}try{Su(5,t,t.return)}catch(Re){hn(t,t.return,Re)}}break;case 1:no(i,t),io(t),h&512&&a!==null&&La(a,a.return);break;case 5:if(no(i,t),io(t),h&512&&a!==null&&La(a,a.return),t.flags&32){var y=t.stateNode;try{kr(y,"")}catch(Re){hn(t,t.return,Re)}}if(h&4&&(y=t.stateNode,y!=null)){var w=t.memoizedProps,E=a!==null?a.memoizedProps:w,z=t.type,N=t.updateQueue;if(t.updateQueue=null,N!==null)try{z==="input"&&w.type==="radio"&&w.name!=null&&He(y,w),qt(z,E);var W=qt(z,w);for(E=0;E<N.length;E+=2){var se=N[E],pe=N[E+1];se==="style"?dn(y,pe):se==="dangerouslySetInnerHTML"?xr(y,pe):se==="children"?kr(y,pe):ce(y,se,pe,W)}switch(z){case"input":de(y,w);break;case"textarea":We(y,w);break;case"select":var ie=y._wrapperState.wasMultiple;y._wrapperState.wasMultiple=!!w.multiple;var Te=w.value;Te!=null?ft(y,!!w.multiple,Te,!1):ie!==!!w.multiple&&(w.defaultValue!=null?ft(y,!!w.multiple,w.defaultValue,!0):ft(y,!!w.multiple,w.multiple?[]:"",!1))}y[c]=w}catch(Re){hn(t,t.return,Re)}}break;case 6:if(no(i,t),io(t),h&4){if(t.stateNode===null)throw Error(x(162));y=t.stateNode,w=t.memoizedProps;try{y.nodeValue=w}catch(Re){hn(t,t.return,Re)}}break;case 3:if(no(i,t),io(t),h&4&&a!==null&&a.memoizedState.isDehydrated)try{ps(i.containerInfo)}catch(Re){hn(t,t.return,Re)}break;case 4:no(i,t),io(t);break;case 13:no(i,t),io(t),y=t.child,y.flags&8192&&(w=y.memoizedState!==null,y.stateNode.isHidden=w,!w||y.alternate!==null&&y.alternate.memoizedState!==null||(Sc=Et())),h&4&&Td(t);break;case 22:if(se=a!==null&&a.memoizedState!==null,t.mode&1?(an=(W=an)||se,no(i,t),an=W):no(i,t),io(t),h&8192){if(W=t.memoizedState!==null,(t.stateNode.isHidden=W)&&!se&&(t.mode&1)!==0)for(Nt=t,se=t.child;se!==null;){for(pe=Nt=se;Nt!==null;){switch(ie=Nt,Te=ie.child,ie.tag){case 0:case 11:case 14:case 15:Su(4,ie,ie.return);break;case 1:La(ie,ie.return);var Le=ie.stateNode;if(typeof Le.componentWillUnmount=="function"){h=ie,a=ie.return;try{i=h,Le.props=i.memoizedProps,Le.state=i.memoizedState,Le.componentWillUnmount()}catch(Re){hn(h,a,Re)}}break;case 5:La(ie,ie.return);break;case 22:if(ie.memoizedState!==null){Ol(pe);continue}}Te!==null?(Te.return=ie,Nt=Te):Ol(pe)}se=se.sibling}e:for(se=null,pe=t;;){if(pe.tag===5){if(se===null){se=pe;try{y=pe.stateNode,W?(w=y.style,typeof w.setProperty=="function"?w.setProperty("display","none","important"):w.display="none"):(z=pe.stateNode,N=pe.memoizedProps.style,E=N!=null&&N.hasOwnProperty("display")?N.display:null,z.style.display=Qt("display",E))}catch(Re){hn(t,t.return,Re)}}}else if(pe.tag===6){if(se===null)try{pe.stateNode.nodeValue=W?"":pe.memoizedProps}catch(Re){hn(t,t.return,Re)}}else if((pe.tag!==22&&pe.tag!==23||pe.memoizedState===null||pe===t)&&pe.child!==null){pe.child.return=pe,pe=pe.child;continue}if(pe===t)break e;for(;pe.sibling===null;){if(pe.return===null||pe.return===t)break e;se===pe&&(se=null),pe=pe.return}se===pe&&(se=null),pe.sibling.return=pe.return,pe=pe.sibling}}break;case 19:no(i,t),io(t),h&4&&Td(t);break;case 21:break;default:no(i,t),io(t)}}function io(t){var i=t.flags;if(i&2){try{e:{for(var a=t.return;a!==null;){if(Sd(a)){var h=a;break e}a=a.return}throw Error(x(160))}switch(h.tag){case 5:var y=h.stateNode;h.flags&32&&(kr(y,""),h.flags&=-33);var w=Ed(t);wh(t,w,y);break;case 3:case 4:var E=h.stateNode.containerInfo,z=Ed(t);xh(t,z,E);break;default:throw Error(x(161))}}catch(N){hn(t,t.return,N)}t.flags&=-3}i&4096&&(t.flags&=-4097)}function Sh(t,i,a){Nt=t,Eh(t)}function Eh(t,i,a){for(var h=(t.mode&1)!==0;Nt!==null;){var y=Nt,w=y.child;if(y.tag===22&&h){var E=y.memoizedState!==null||Er;if(!E){var z=y.alternate,N=z!==null&&z.memoizedState!==null||an;z=Er;var W=an;if(Er=E,(an=N)&&!W)for(Nt=y;Nt!==null;)E=Nt,N=E.child,E.tag===22&&E.memoizedState!==null?Fa(y):N!==null?(N.return=E,Nt=N):Fa(y);for(;w!==null;)Nt=w,Eh(w),w=w.sibling;Nt=y,Er=z,an=W}Eu(t)}else(y.subtreeFlags&8772)!==0&&w!==null?(w.return=y,Nt=w):Eu(t)}}function Eu(t){for(;Nt!==null;){var i=Nt;if((i.flags&8772)!==0){var a=i.alternate;try{if((i.flags&8772)!==0)switch(i.tag){case 0:case 11:case 15:an||xc(5,i);break;case 1:var h=i.stateNode;if(i.flags&4&&!an)if(a===null)h.componentDidMount();else{var y=i.elementType===i.type?a.memoizedProps:Xn(i.type,a.memoizedProps);h.componentDidUpdate(y,a.memoizedState,h.__reactInternalSnapshotBeforeUpdate)}var w=i.updateQueue;w!==null&&Jh(i,w,h);break;case 3:var E=i.updateQueue;if(E!==null){if(a=null,i.child!==null)switch(i.child.tag){case 5:a=i.child.stateNode;break;case 1:a=i.child.stateNode}Jh(i,E,a)}break;case 5:var z=i.stateNode;if(a===null&&i.flags&4){a=z;var N=i.memoizedProps;switch(i.type){case"button":case"input":case"select":case"textarea":N.autoFocus&&a.focus();break;case"img":N.src&&(a.src=N.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(i.memoizedState===null){var W=i.alternate;if(W!==null){var se=W.memoizedState;if(se!==null){var pe=se.dehydrated;pe!==null&&ps(pe)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(x(163))}an||i.flags&512&&vh(i)}catch(ie){hn(i,i.return,ie)}}if(i===t){Nt=null;break}if(a=i.sibling,a!==null){a.return=i.return,Nt=a;break}Nt=i.return}}function Ol(t){for(;Nt!==null;){var i=Nt;if(i===t){Nt=null;break}var a=i.sibling;if(a!==null){a.return=i.return,Nt=a;break}Nt=i.return}}function Fa(t){for(;Nt!==null;){var i=Nt;try{switch(i.tag){case 0:case 11:case 15:var a=i.return;try{xc(4,i)}catch(N){hn(i,a,N)}break;case 1:var h=i.stateNode;if(typeof h.componentDidMount=="function"){var y=i.return;try{h.componentDidMount()}catch(N){hn(i,y,N)}}var w=i.return;try{vh(i)}catch(N){hn(i,w,N)}break;case 5:var E=i.return;try{vh(i)}catch(N){hn(i,E,N)}}}catch(N){hn(i,i.return,N)}if(i===t){Nt=null;break}var z=i.sibling;if(z!==null){z.return=i.return,Nt=z;break}Nt=i.return}}var wc=Math.ceil,Oa=be.ReactCurrentDispatcher,Th=be.ReactCurrentOwner,Ti=be.ReactCurrentBatchConfig,Tr=0,On=null,pn=null,Nn=0,oi=0,Ns=te(0),Cn=0,Tu=null,Us=0,Oi=0,bc=0,Ni=null,si=null,Sc=0,Na=1/0,zo=null,Ec=!1,kh=null,ts=null,ku=!1,rs=null,Ua=0,Nl=0,Ul=null,ja=-1,Va=0;function ai(){return(Tr&6)!==0?Et():ja!==-1?ja:ja=Et()}function js(t){return(t.mode&1)===0?1:(Tr&2)!==0&&Nn!==0?Nn&-Nn:Sa.transition!==null?(Va===0&&(Va=Hl()),Va):(t=wr,t!==0||(t=window.event,t=t===void 0?16:sl(t.type)),t)}function oo(t,i,a,h){if(50<Nl)throw Nl=0,Ul=null,Error(x(185));_i(t,a,h),((Tr&2)===0||t!==On)&&(t===On&&((Tr&2)===0&&(Oi|=a),Cn===4&&Vs(t,Nn)),gi(t,h),a===1&&Tr===0&&(i.mode&1)===0&&(Na=Et()+500,Ht&&cr()))}function gi(t,i){var a=t.callbackNode;Wl(t,i);var h=Ks(t,t===On?Nn:0);if(h===0)a!==null&&Dt(a),t.callbackNode=null,t.callbackPriority=0;else if(i=h&-h,t.callbackPriority!==i){if(a!=null&&Dt(a),i===1)t.tag===0?Ir(ns.bind(null,t)):jt(ns.bind(null,t)),un(function(){(Tr&6)===0&&cr()}),a=null;else{switch(Js(h)){case 1:a=tr;break;case 4:a=rr;break;case 16:a=Xt;break;case 536870912:a=Yr;break;default:a=Xt}a=Hr(a,$a.bind(null,t))}t.callbackPriority=i,t.callbackNode=a}}function $a(t,i){if(ja=-1,Va=0,(Tr&6)!==0)throw Error(x(327));var a=t.callbackNode;if(os()&&t.callbackNode!==a)return null;var h=Ks(t,t===On?Nn:0);if(h===0)return null;if((h&30)!==0||(h&t.expiredLanes)!==0||i)i=Cc(t,h);else{i=h;var y=Tr;Tr|=2;var w=Iu();(On!==t||Nn!==i)&&(zo=null,Na=Et()+500,Ga(t,i));do try{zh();break}catch(z){Cd(t,z)}while(!0);Ji(),Oa.current=w,Tr=y,pn!==null?i=0:(On=null,Nn=0,i=Cn)}if(i!==0){if(i===2&&(y=Ys(t),y!==0&&(h=y,i=Cu(t,y))),i===1)throw a=Tu,Ga(t,0),Vs(t,h),gi(t,Et()),a;if(i===6)Vs(t,h);else{if(y=t.current.alternate,(h&30)===0&&!Ch(y)&&(i=Cc(t,h),i===2&&(w=Ys(t),w!==0&&(h=w,i=Cu(t,w))),i===1))throw a=Tu,Ga(t,0),Vs(t,h),gi(t,Et()),a;switch(t.finishedWork=y,t.finishedLanes=h,i){case 0:case 1:throw Error(x(345));case 2:is(t,si,zo);break;case 3:if(Vs(t,h),(h&130023424)===h&&(i=Sc+500-Et(),10<i)){if(Ks(t,0)!==0)break;if(y=t.suspendedLanes,(y&h)!==h){ai(),t.pingedLanes|=t.suspendedLanes&y;break}t.timeoutHandle=fu(is.bind(null,t,si,zo),i);break}is(t,si,zo);break;case 4:if(Vs(t,h),(h&4194240)===h)break;for(i=t.eventTimes,y=-1;0<h;){var E=31-ti(h);w=1<<E,E=i[E],E>y&&(y=E),h&=~w}if(h=y,h=Et()-h,h=(120>h?120:480>h?480:1080>h?1080:1920>h?1920:3e3>h?3e3:4320>h?4320:1960*wc(h/1960))-h,10<h){t.timeoutHandle=fu(is.bind(null,t,si,zo),h);break}is(t,si,zo);break;case 5:is(t,si,zo);break;default:throw Error(x(329))}}}return gi(t,Et()),t.callbackNode===a?$a.bind(null,t):null}function Cu(t,i){var a=Ni;return t.current.memoizedState.isDehydrated&&(Ga(t,i).flags|=256),t=Cc(t,i),t!==2&&(i=si,si=a,i!==null&&Tc(i)),t}function Tc(t){si===null?si=t:si.push.apply(si,t)}function Ch(t){for(var i=t;;){if(i.flags&16384){var a=i.updateQueue;if(a!==null&&(a=a.stores,a!==null))for(var h=0;h<a.length;h++){var y=a[h],w=y.getSnapshot;y=y.value;try{if(!di(w(),y))return!1}catch{return!1}}}if(a=i.child,i.subtreeFlags&16384&&a!==null)a.return=i,i=a;else{if(i===t)break;for(;i.sibling===null;){if(i.return===null||i.return===t)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function Vs(t,i){for(i&=~bc,i&=~Oi,t.suspendedLanes|=i,t.pingedLanes&=~i,t=t.expirationTimes;0<i;){var a=31-ti(i),h=1<<a;t[a]=-1,i&=~h}}function ns(t){if((Tr&6)!==0)throw Error(x(327));os();var i=Ks(t,0);if((i&1)===0)return gi(t,Et()),null;var a=Cc(t,i);if(t.tag!==0&&a===2){var h=Ys(t);h!==0&&(i=h,a=Cu(t,h))}if(a===1)throw a=Tu,Ga(t,0),Vs(t,i),gi(t,Et()),a;if(a===6)throw Error(x(345));return t.finishedWork=t.current.alternate,t.finishedLanes=i,is(t,si,zo),gi(t,Et()),null}function kc(t,i){var a=Tr;Tr|=1;try{return t(i)}finally{Tr=a,Tr===0&&(Na=Et()+500,Ht&&cr())}}function $s(t){rs!==null&&rs.tag===0&&(Tr&6)===0&&os();var i=Tr;Tr|=1;var a=Ti.transition,h=wr;try{if(Ti.transition=null,wr=1,t)return t()}finally{wr=h,Ti.transition=a,Tr=i,(Tr&6)===0&&cr()}}function Ih(){oi=Ns.current,ee(Ns)}function Ga(t,i){t.finishedWork=null,t.finishedLanes=0;var a=t.timeoutHandle;if(a!==-1&&(t.timeoutHandle=-1,xa(a)),pn!==null)for(a=pn.return;a!==null;){var h=a;switch(mr(h),h.tag){case 1:h=h.type.childContextTypes,h!=null&&rt();break;case 3:Aa(),ee(he),ee(Pe),th();break;case 5:zl(h);break;case 4:Aa();break;case 13:ee(en);break;case 19:ee(en);break;case 10:Si(h.type._context);break;case 22:case 23:Ih()}a=a.return}if(On=t,pn=t=ss(t.current,null),Nn=oi=i,Cn=0,Tu=null,bc=Oi=Us=0,si=Ni=null,Ta!==null){for(i=0;i<Ta.length;i++)if(a=Ta[i],h=a.interleaved,h!==null){a.interleaved=null;var y=h.next,w=a.pending;if(w!==null){var E=w.next;w.next=y,h.next=E}a.pending=h}Ta=null}return t}function Cd(t,i){do{var a=pn;try{if(Ji(),Pl.current=mc,oc){for(var h=Vr.memoizedState;h!==null;){var y=h.queue;y!==null&&(y.pending=null),h=h.next}oc=!1}if(Jo=0,Tn=Pr=Vr=null,_u=!1,vu=0,Th.current=null,a===null||a.return===null){Cn=1,Tu=i,pn=null;break}e:{var w=t,E=a.return,z=a,N=i;if(i=Nn,z.flags|=32768,N!==null&&typeof N=="object"&&typeof N.then=="function"){var W=N,se=z,pe=se.tag;if((se.mode&1)===0&&(pe===0||pe===11||pe===15)){var ie=se.alternate;ie?(se.updateQueue=ie.updateQueue,se.memoizedState=ie.memoizedState,se.lanes=ie.lanes):(se.updateQueue=null,se.memoizedState=null)}var Te=cd(E);if(Te!==null){Te.flags&=-257,hd(Te,E,z,w,i),Te.mode&1&&uh(w,W,i),i=Te,N=W;var Le=i.updateQueue;if(Le===null){var Re=new Set;Re.add(N),i.updateQueue=Re}else Le.add(N);break e}else{if((i&1)===0){uh(w,W,i),Au();break e}N=Error(x(426))}}else if(nr&&z.mode&1){var xt=cd(E);if(xt!==null){(xt.flags&65536)===0&&(xt.flags|=256),hd(xt,E,z,w,i),Ds(Da(N,z));break e}}w=N=Da(N,z),Cn!==4&&(Cn=2),Ni===null?Ni=[w]:Ni.push(w),w=E;do{switch(w.tag){case 3:w.flags|=65536,i&=-i,w.lanes|=i;var we=ud(w,N,i);Yh(w,we);break e;case 1:z=N;var ue=w.type,ge=w.stateNode;if((w.flags&128)===0&&(typeof ue.getDerivedStateFromError=="function"||ge!==null&&typeof ge.componentDidCatch=="function"&&(ts===null||!ts.has(ge)))){w.flags|=65536,i&=-i,w.lanes|=i;var Be=lh(w,z,i);Yh(w,Be);break e}}w=w.return}while(w!==null)}Id(a)}catch(tt){i=tt,pn===a&&a!==null&&(pn=a=a.return);continue}break}while(!0)}function Iu(){var t=Oa.current;return Oa.current=mc,t===null?mc:t}function Au(){(Cn===0||Cn===3||Cn===2)&&(Cn=4),On===null||(Us&268435455)===0&&(Oi&268435455)===0||Vs(On,Nn)}function Cc(t,i){var a=Tr;Tr|=2;var h=Iu();(On!==t||Nn!==i)&&(zo=null,Ga(t,i));do try{Ah();break}catch(y){Cd(t,y)}while(!0);if(Ji(),Tr=a,Oa.current=h,pn!==null)throw Error(x(261));return On=null,Nn=0,Cn}function Ah(){for(;pn!==null;)Za(pn)}function zh(){for(;pn!==null&&!zt();)Za(pn)}function Za(t){var i=Ph(t.alternate,t,oi);t.memoizedProps=t.pendingProps,i===null?Id(t):pn=i,Th.current=null}function Id(t){var i=t;do{var a=i.alternate;if(t=i.return,(i.flags&32768)===0){if(a=vd(a,i,oi),a!==null){pn=a;return}}else{if(a=xd(a,i),a!==null){a.flags&=32767,pn=a;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Cn=6,pn=null;return}}if(i=i.sibling,i!==null){pn=i;return}pn=i=t}while(i!==null);Cn===0&&(Cn=5)}function is(t,i,a){var h=wr,y=Ti.transition;try{Ti.transition=null,wr=1,Ad(t,i,a,h)}finally{Ti.transition=y,wr=h}return null}function Ad(t,i,a,h){do os();while(rs!==null);if((Tr&6)!==0)throw Error(x(327));a=t.finishedWork;var y=t.finishedLanes;if(a===null)return null;if(t.finishedWork=null,t.finishedLanes=0,a===t.current)throw Error(x(177));t.callbackNode=null,t.callbackPriority=0;var w=a.lanes|a.childLanes;if(rl(t,w),t===On&&(pn=On=null,Nn=0),(a.subtreeFlags&2064)===0&&(a.flags&2064)===0||ku||(ku=!0,Hr(Xt,function(){return os(),null})),w=(a.flags&15990)!==0,(a.subtreeFlags&15990)!==0||w){w=Ti.transition,Ti.transition=null;var E=wr;wr=1;var z=Tr;Tr|=4,Th.current=null,wd(t,a),kd(a,t),qo(Yi),ms=!!nn,Yi=nn=null,t.current=a,Sh(a),Ft(),Tr=z,wr=E,Ti.transition=w}else t.current=a;if(ku&&(ku=!1,rs=t,Ua=y),w=t.pendingLanes,w===0&&(ts=null),bn(a.stateNode),gi(t,Et()),i!==null)for(h=t.onRecoverableError,a=0;a<i.length;a++)y=i[a],h(y.value,{componentStack:y.stack,digest:y.digest});if(Ec)throw Ec=!1,t=kh,kh=null,t;return(Ua&1)!==0&&t.tag!==0&&os(),w=t.pendingLanes,(w&1)!==0?t===Ul?Nl++:(Nl=0,Ul=t):Nl=0,cr(),null}function os(){if(rs!==null){var t=Js(Ua),i=Ti.transition,a=wr;try{if(Ti.transition=null,wr=16>t?16:t,rs===null)var h=!1;else{if(t=rs,rs=null,Ua=0,(Tr&6)!==0)throw Error(x(331));var y=Tr;for(Tr|=4,Nt=t.current;Nt!==null;){var w=Nt,E=w.child;if((Nt.flags&16)!==0){var z=w.deletions;if(z!==null){for(var N=0;N<z.length;N++){var W=z[N];for(Nt=W;Nt!==null;){var se=Nt;switch(se.tag){case 0:case 11:case 15:Su(8,se,w)}var pe=se.child;if(pe!==null)pe.return=se,Nt=pe;else for(;Nt!==null;){se=Nt;var ie=se.sibling,Te=se.return;if(bd(se),se===W){Nt=null;break}if(ie!==null){ie.return=Te,Nt=ie;break}Nt=Te}}}var Le=w.alternate;if(Le!==null){var Re=Le.child;if(Re!==null){Le.child=null;do{var xt=Re.sibling;Re.sibling=null,Re=xt}while(Re!==null)}}Nt=w}}if((w.subtreeFlags&2064)!==0&&E!==null)E.return=w,Nt=E;else e:for(;Nt!==null;){if(w=Nt,(w.flags&2048)!==0)switch(w.tag){case 0:case 11:case 15:Su(9,w,w.return)}var we=w.sibling;if(we!==null){we.return=w.return,Nt=we;break e}Nt=w.return}}var ue=t.current;for(Nt=ue;Nt!==null;){E=Nt;var ge=E.child;if((E.subtreeFlags&2064)!==0&&ge!==null)ge.return=E,Nt=ge;else e:for(E=ue;Nt!==null;){if(z=Nt,(z.flags&2048)!==0)try{switch(z.tag){case 0:case 11:case 15:xc(9,z)}}catch(tt){hn(z,z.return,tt)}if(z===E){Nt=null;break e}var Be=z.sibling;if(Be!==null){Be.return=z.return,Nt=Be;break e}Nt=z.return}}if(Tr=y,cr(),zr&&typeof zr.onPostCommitFiberRoot=="function")try{zr.onPostCommitFiberRoot(Nr,t)}catch{}h=!0}return h}finally{wr=a,Ti.transition=i}}return!1}function Ic(t,i,a){i=Da(a,i),i=ud(t,i,1),t=Io(t,i,1),i=ai(),t!==null&&(_i(t,1,i),gi(t,i))}function hn(t,i,a){if(t.tag===3)Ic(t,t,a);else for(;i!==null;){if(i.tag===3){Ic(i,t,a);break}else if(i.tag===1){var h=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof h.componentDidCatch=="function"&&(ts===null||!ts.has(h))){t=Da(a,t),t=lh(i,t,1),i=Io(i,t,1),t=ai(),i!==null&&(_i(i,1,t),gi(i,t));break}}i=i.return}}function ff(t,i,a){var h=t.pingCache;h!==null&&h.delete(i),i=ai(),t.pingedLanes|=t.suspendedLanes&a,On===t&&(Nn&a)===a&&(Cn===4||Cn===3&&(Nn&130023424)===Nn&&500>Et()-Sc?Ga(t,0):bc|=a),gi(t,i)}function zd(t,i){i===0&&((t.mode&1)===0?i=1:(i=el,el<<=1,(el&130023424)===0&&(el=4194304)));var a=ai();t=Qi(t,i),t!==null&&(_i(t,i,a),gi(t,a))}function pf(t){var i=t.memoizedState,a=0;i!==null&&(a=i.retryLane),zd(t,a)}function mf(t,i){var a=0;switch(t.tag){case 13:var h=t.stateNode,y=t.memoizedState;y!==null&&(a=y.retryLane);break;case 19:h=t.stateNode;break;default:throw Error(x(314))}h!==null&&h.delete(i),zd(t,a)}var Ph;Ph=function(t,i,a){if(t!==null)if(t.memoizedProps!==i.pendingProps||he.current)pi=!0;else{if((t.lanes&a)===0&&(i.flags&128)===0)return pi=!1,df(t,i,a);pi=(t.flags&131072)!==0}else pi=!1,nr&&(i.flags&1048576)!==0&&So(i,Rn,i.index);switch(i.lanes=0,i.tag){case 2:var h=i.type;vc(t,i),t=i.pendingProps;var y=Oe(i,Pe.current);Ea(i,a),y=Qo(null,i,h,t,y,a);var w=za();return i.flags|=1,typeof y=="object"&&y!==null&&typeof y.render=="function"&&y.$$typeof===void 0?(i.tag=1,i.memoizedState=null,i.updateQueue=null,Xe(h)?(w=!0,It(i)):w=!1,i.memoizedState=y.state!==null&&y.state!==void 0?y.state:null,Ko(i),y.updater=Cl,i.stateNode=y,y._reactInternals=i,Jc(i,h,t,a),i=hh(null,i,h,!0,w,a)):(i.tag=0,nr&&w&&Ps(i),Zn(null,i,y,a),i=i.child),i;case 16:h=i.elementType;e:{switch(vc(t,i),t=i.pendingProps,y=h._init,h=y(h._payload),i.type=h,y=i.tag=Pd(h),t=Xn(h,t),y){case 0:i=Ra(null,i,h,t,a);break e;case 1:i=ch(null,i,h,t,a);break e;case 11:i=Ll(null,i,h,t,a);break e;case 14:i=gc(null,i,h,Xn(h.type,t),a);break e}throw Error(x(306,h,""))}return i;case 0:return h=i.type,y=i.pendingProps,y=i.elementType===h?y:Xn(h,y),Ra(t,i,h,y,a);case 1:return h=i.type,y=i.pendingProps,y=i.elementType===h?y:Xn(h,y),ch(t,i,h,y,a);case 3:e:{if(md(i),t===null)throw Error(x(387));h=i.pendingProps,w=i.memoizedState,y=w.element,Ls(t,i),mu(i,h,null,a);var E=i.memoizedState;if(h=E.element,w.isDehydrated)if(w={element:h,isDehydrated:!1,cache:E.cache,pendingSuspenseBoundaries:E.pendingSuspenseBoundaries,transitions:E.transitions},i.updateQueue.baseState=w,i.memoizedState=w,i.flags&256){y=Da(Error(x(423)),i),i=gd(t,i,h,a,y);break e}else if(h!==y){y=Da(Error(x(424)),i),i=gd(t,i,h,a,y);break e}else for(Yt=fi(i.stateNode.containerInfo.firstChild),dr=i,nr=!0,Zr=null,a=Gn(i,null,h,a),i.child=a;a;)a.flags=a.flags&-3|4096,a=a.sibling;else{if(Ln(),h===y){i=es(t,i,a);break e}Zn(t,i,h,a)}i=i.child}return i;case 5:return eh(i),t===null&&To(i),h=i.type,y=i.pendingProps,w=t!==null?t.memoizedProps:null,E=y.children,Dn(h,y)?E=null:w!==null&&Dn(h,w)&&(i.flags|=32),pd(t,i),Zn(t,i,E,a),i.child;case 6:return t===null&&To(i),null;case 13:return yd(t,i,a);case 4:return Qc(i,i.stateNode.containerInfo),h=i.pendingProps,t===null?i.child=Il(i,null,h,a):Zn(t,i,h,a),i.child;case 11:return h=i.type,y=i.pendingProps,y=i.elementType===h?y:Xn(h,y),Ll(t,i,h,y,a);case 7:return Zn(t,i,i.pendingProps,a),i.child;case 8:return Zn(t,i,i.pendingProps.children,a),i.child;case 12:return Zn(t,i,i.pendingProps.children,a),i.child;case 10:e:{if(h=i.type._context,y=i.pendingProps,w=i.memoizedProps,E=y.value,ye(ec,h._currentValue),h._currentValue=E,w!==null)if(di(w.value,E)){if(w.children===y.children&&!he.current){i=es(t,i,a);break e}}else for(w=i.child,w!==null&&(w.return=i);w!==null;){var z=w.dependencies;if(z!==null){E=w.child;for(var N=z.firstContext;N!==null;){if(N.context===h){if(w.tag===1){N=Bi(-1,a&-a),N.tag=2;var W=w.updateQueue;if(W!==null){W=W.shared;var se=W.pending;se===null?N.next=N:(N.next=se.next,se.next=N),W.pending=N}}w.lanes|=a,N=w.alternate,N!==null&&(N.lanes|=a),Co(w.return,a,i),z.lanes|=a;break}N=N.next}}else if(w.tag===10)E=w.type===i.type?null:w.child;else if(w.tag===18){if(E=w.return,E===null)throw Error(x(341));E.lanes|=a,z=E.alternate,z!==null&&(z.lanes|=a),Co(E,a,i),E=w.sibling}else E=w.child;if(E!==null)E.return=w;else for(E=w;E!==null;){if(E===i){E=null;break}if(w=E.sibling,w!==null){w.return=E.return,E=w;break}E=E.return}w=E}Zn(t,i,y.children,a),i=i.child}return i;case 9:return y=i.type,h=i.pendingProps.children,Ea(i,a),y=Bn(y),h=h(y),i.flags|=1,Zn(t,i,h,a),i.child;case 14:return h=i.type,y=Xn(h,i.pendingProps),y=Xn(h.type,y),gc(t,i,h,y,a);case 15:return dd(t,i,i.type,i.pendingProps,a);case 17:return h=i.type,y=i.pendingProps,y=i.elementType===h?y:Xn(h,y),vc(t,i),i.tag=1,Xe(h)?(t=!0,It(i)):t=!1,Ea(i,a),Yc(i,h,y),Jc(i,h,y,a),hh(null,i,h,!0,t,a);case 19:return mh(t,i,a);case 22:return fd(t,i,a)}throw Error(x(156,i.tag))};function Hr(t,i){return at(t,i)}function qa(t,i,a,h){this.tag=t,this.key=a,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=h,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ki(t,i,a,h){return new qa(t,i,a,h)}function Ac(t){return t=t.prototype,!(!t||!t.isReactComponent)}function Pd(t){if(typeof t=="function")return Ac(t)?1:0;if(t!=null){if(t=t.$$typeof,t===me)return 11;if(t===qe)return 14}return 2}function ss(t,i){var a=t.alternate;return a===null?(a=ki(t.tag,i,t.key,t.mode),a.elementType=t.elementType,a.type=t.type,a.stateNode=t.stateNode,a.alternate=t,t.alternate=a):(a.pendingProps=i,a.type=t.type,a.flags=0,a.subtreeFlags=0,a.deletions=null),a.flags=t.flags&14680064,a.childLanes=t.childLanes,a.lanes=t.lanes,a.child=t.child,a.memoizedProps=t.memoizedProps,a.memoizedState=t.memoizedState,a.updateQueue=t.updateQueue,i=t.dependencies,a.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},a.sibling=t.sibling,a.index=t.index,a.ref=t.ref,a}function zu(t,i,a,h,y,w){var E=2;if(h=t,typeof t=="function")Ac(t)&&(E=1);else if(typeof t=="string")E=5;else e:switch(t){case De:return as(a.children,y,w,i);case Ze:E=8,y|=8;break;case je:return t=ki(12,a,i,y|2),t.elementType=je,t.lanes=w,t;case $e:return t=ki(13,a,i,y),t.elementType=$e,t.lanes=w,t;case j:return t=ki(19,a,i,y),t.elementType=j,t.lanes=w,t;case Ke:return Wa(a,y,w,i);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case lt:E=10;break e;case vt:E=9;break e;case me:E=11;break e;case qe:E=14;break e;case ht:E=16,h=null;break e}throw Error(x(130,t==null?t:typeof t,""))}return i=ki(E,a,i,y),i.elementType=t,i.type=h,i.lanes=w,i}function as(t,i,a,h){return t=ki(7,t,h,i),t.lanes=a,t}function Wa(t,i,a,h){return t=ki(22,t,h,i),t.elementType=Ke,t.lanes=a,t.stateNode={isHidden:!1},t}function zc(t,i,a){return t=ki(6,t,null,i),t.lanes=a,t}function Pu(t,i,a){return i=ki(4,t.children!==null?t.children:[],t.key,i),i.lanes=a,i.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},i}function Md(t,i,a,h,y){this.tag=i,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=tl(0),this.expirationTimes=tl(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=tl(0),this.identifierPrefix=h,this.onRecoverableError=y,this.mutableSourceEagerHydrationData=null}function li(t,i,a,h,y,w,E,z,N){return t=new Md(t,i,a,z,N),i===1?(i=1,w===!0&&(i|=8)):i=0,w=ki(3,null,null,i),t.current=w,w.stateNode=t,w.memoizedState={element:h,isDehydrated:a,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ko(w),t}function Mu(t,i,a){var h=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ue,key:h==null?null:""+h,children:t,containerInfo:i,implementation:a}}function Mh(t){if(!t)return Ae;t=t._reactInternals;e:{if(Ce(t)!==t||t.tag!==1)throw Error(x(170));var i=t;do{switch(i.tag){case 3:i=i.stateNode.context;break e;case 1:if(Xe(i.type)){i=i.stateNode.__reactInternalMemoizedMergedChildContext;break e}}i=i.return}while(i!==null);throw Error(x(171))}if(t.tag===1){var a=t.type;if(Xe(a))return et(t,a,i)}return i}function Dh(t,i,a,h,y,w,E,z,N){return t=li(a,h,!0,t,y,w,E,z,N),t.context=Mh(null),a=t.current,h=ai(),y=js(a),w=Bi(h,y),w.callback=i??null,Io(a,w,y),t.current.lanes=y,_i(t,y,h),gi(t,h),t}function Du(t,i,a,h){var y=i.current,w=ai(),E=js(y);return a=Mh(a),i.context===null?i.context=a:i.pendingContext=a,i=Bi(w,E),i.payload={element:t},h=h===void 0?null:h,h!==null&&(i.callback=h),t=Io(y,i,E),t!==null&&(oo(t,y,E,w),pu(t,y,E)),E}function Ru(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Rh(t,i){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var a=t.retryLane;t.retryLane=a!==0&&a<i?a:i}}function Pc(t,i){Rh(t,i),(t=t.alternate)&&Rh(t,i)}function gf(){return null}var Mc=typeof reportError=="function"?reportError:function(t){console.error(t)};function jl(t){this._internalRoot=t}Gs.prototype.render=jl.prototype.render=function(t){var i=this._internalRoot;if(i===null)throw Error(x(409));Du(t,i,null,null)},Gs.prototype.unmount=jl.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var i=t.containerInfo;$s(function(){Du(null,t,null,null)}),i[p]=null}};function Gs(t){this._internalRoot=t}Gs.prototype.unstable_scheduleHydration=function(t){if(t){var i=ds();t={blockedOn:null,target:t,priority:i};for(var a=0;a<uo.length&&i!==0&&i<uo[a].priority;a++);uo.splice(a,0,t),a===0&&Yl(t)}};function Lu(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Dc(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function n(){}function e(t,i,a,h,y){if(y){if(typeof h=="function"){var w=h;h=function(){var W=Ru(E);w.call(W)}}var E=Dh(i,h,t,0,null,!1,!1,"",n);return t._reactRootContainer=E,t[p]=E.current,xo(t.nodeType===8?t.parentNode:t),$s(),E}for(;y=t.lastChild;)t.removeChild(y);if(typeof h=="function"){var z=h;h=function(){var W=Ru(N);z.call(W)}}var N=li(t,0,!1,null,null,!1,!1,"",n);return t._reactRootContainer=N,t[p]=N.current,xo(t.nodeType===8?t.parentNode:t),$s(function(){Du(i,N,a,h)}),N}function o(t,i,a,h,y){var w=a._reactRootContainer;if(w){var E=w;if(typeof y=="function"){var z=y;y=function(){var N=Ru(E);z.call(N)}}Du(i,E,t,y)}else E=e(a,i,t,y,h);return Ru(E)}Qs=function(t){switch(t.tag){case 3:var i=t.stateNode;if(i.current.memoizedState.isDehydrated){var a=Bo(i.pendingLanes);a!==0&&(lo(i,a|1),gi(i,Et()),(Tr&6)===0&&(Na=Et()+500,cr()))}break;case 13:$s(function(){var h=Qi(t,1);if(h!==null){var y=ai();oo(h,t,1,y)}}),Pc(t,1)}},Fo=function(t){if(t.tag===13){var i=Qi(t,134217728);if(i!==null){var a=ai();oo(i,t,134217728,a)}Pc(t,134217728)}},ea=function(t){if(t.tag===13){var i=js(t),a=Qi(t,i);if(a!==null){var h=ai();oo(a,t,i,h)}Pc(t,i)}},ds=function(){return wr},Ur=function(t,i){var a=wr;try{return wr=t,i()}finally{wr=a}},fn=function(t,i,a){switch(i){case"input":if(de(t,a),i=a.name,a.type==="radio"&&i!=null){for(a=t;a.parentNode;)a=a.parentNode;for(a=a.querySelectorAll("input[name="+JSON.stringify(""+i)+'][type="radio"]'),i=0;i<a.length;i++){var h=a[i];if(h!==t&&h.form===t.form){var y=q(h);if(!y)throw Error(x(90));sr(h),de(h,y)}}}break;case"textarea":We(t,a);break;case"select":i=a.value,i!=null&&ft(t,!!a.multiple,i,!1)}},lr=kc,ur=$s;var u={usingClientEntryPoint:!1,Events:[M,F,q,Lr,Kr,kc]},f={findFiberByHostInstance:A,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},g={bundleType:f.bundleType,version:f.version,rendererPackageName:f.rendererPackageName,rendererConfig:f.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:be.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Ye(t),t===null?null:t.stateNode},findFiberByHostInstance:f.findFiberByHostInstance||gf,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var v=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!v.isDisabled&&v.supportsFiber)try{Nr=v.inject(g),zr=v}catch{}}return ji.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=u,ji.createPortal=function(t,i){var a=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Lu(i))throw Error(x(200));return Mu(t,i,null,a)},ji.createRoot=function(t,i){if(!Lu(t))throw Error(x(299));var a=!1,h="",y=Mc;return i!=null&&(i.unstable_strictMode===!0&&(a=!0),i.identifierPrefix!==void 0&&(h=i.identifierPrefix),i.onRecoverableError!==void 0&&(y=i.onRecoverableError)),i=li(t,1,!1,null,null,a,!1,h,y),t[p]=i.current,xo(t.nodeType===8?t.parentNode:t),new jl(i)},ji.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var i=t._reactInternals;if(i===void 0)throw typeof t.render=="function"?Error(x(188)):(t=Object.keys(t).join(","),Error(x(268,t)));return t=Ye(i),t=t===null?null:t.stateNode,t},ji.flushSync=function(t){return $s(t)},ji.hydrate=function(t,i,a){if(!Dc(i))throw Error(x(200));return o(null,t,i,!0,a)},ji.hydrateRoot=function(t,i,a){if(!Lu(t))throw Error(x(405));var h=a!=null&&a.hydratedSources||null,y=!1,w="",E=Mc;if(a!=null&&(a.unstable_strictMode===!0&&(y=!0),a.identifierPrefix!==void 0&&(w=a.identifierPrefix),a.onRecoverableError!==void 0&&(E=a.onRecoverableError)),i=Dh(i,null,t,1,a??null,y,!1,w,E),t[p]=i.current,xo(t),h)for(t=0;t<h.length;t++)a=h[t],y=a._getVersion,y=y(a._source),i.mutableSourceEagerHydrationData==null?i.mutableSourceEagerHydrationData=[a,y]:i.mutableSourceEagerHydrationData.push(a,y);return new Gs(i)},ji.render=function(t,i,a){if(!Dc(i))throw Error(x(200));return o(null,t,i,!1,a)},ji.unmountComponentAtNode=function(t){if(!Dc(t))throw Error(x(40));return t._reactRootContainer?($s(function(){o(null,null,t,!1,function(){t._reactRootContainer=null,t[p]=null})}),!0):!1},ji.unstable_batchedUpdates=kc,ji.unstable_renderSubtreeIntoContainer=function(t,i,a,h){if(!Dc(a))throw Error(x(200));if(t==null||t._reactInternals===void 0)throw Error(x(38));return o(t,i,a,!1,h)},ji.version="18.2.0-next-9e3b772b8-20220608",ji}var xp;function cm(){if(xp)return Sf.exports;xp=1;function m(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(m)}catch(b){console.error(b)}}return m(),Sf.exports=pg(),Sf.exports}var wp;function mg(){if(wp)return Rd;wp=1;var m=cm();return Rd.createRoot=m.createRoot,Rd.hydrateRoot=m.hydrateRoot,Rd}var gg=mg();const yg=Uc(gg);var Ud={exports:{}},_g=Ud.exports,bp;function vg(){return bp||(bp=1,function(m,b){(function(x,I){m.exports=I()})(_g,function(){var x,I,C;function T(l,R){if(!x)x=R;else if(!I)I=R;else{var L="var sharedChunk = {}; ("+x+")(sharedChunk); ("+I+")(sharedChunk);",G={};x(G),C=R(G),typeof window<"u"&&(C.workerUrl=window.URL.createObjectURL(new Blob([L],{type:"text/javascript"})))}}T(["exports"],function(l){var R=L;function L(n,e,o,u){this.cx=3*n,this.bx=3*(o-n)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(u-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=n,this.p1y=e,this.p2x=o,this.p2y=u}function G(n,e,o,u){const f=new R(n,e,o,u);return function(g){return f.solve(g)}}L.prototype={sampleCurveX:function(n){return((this.ax*n+this.bx)*n+this.cx)*n},sampleCurveY:function(n){return((this.ay*n+this.by)*n+this.cy)*n},sampleCurveDerivativeX:function(n){return(3*this.ax*n+2*this.bx)*n+this.cx},solveCurveX:function(n,e){if(e===void 0&&(e=1e-6),n<0)return 0;if(n>1)return 1;for(var o=n,u=0;u<8;u++){var f=this.sampleCurveX(o)-n;if(Math.abs(f)<e)return o;var g=this.sampleCurveDerivativeX(o);if(Math.abs(g)<1e-6)break;o-=f/g}var v=0,t=1;for(o=n,u=0;u<20&&(f=this.sampleCurveX(o),!(Math.abs(f-n)<e));u++)n>f?v=o:t=o,o=.5*(t-v)+v;return o},solve:function(n,e){return this.sampleCurveY(this.solveCurveX(n,e))}};const $=G(.25,.1,.25,1);function B(n,e,o){return Math.min(o,Math.max(e,n))}function Z(n,e,o){const u=o-e,f=((n-e)%u+u)%u+e;return f===e?o:f}function Q(n,...e){for(const o of e)for(const u in o)n[u]=o[u];return n}let V=1;function K(n,e){n.forEach(o=>{e[o]&&(e[o]=e[o].bind(e))})}function Y(n,e,o){const u={};for(const f in n)u[f]=e.call(o||this,n[f],f,n);return u}function ne(n,e,o){const u={};for(const f in n)e.call(o||this,n[f],f,n)&&(u[f]=n[f]);return u}function ce(n){return Array.isArray(n)?n.map(ce):typeof n=="object"&&n?Y(n,ce):n}const be={};function _e(n){be[n]||(typeof console<"u"&&console.warn(n),be[n]=!0)}function Ue(n,e,o){return(o.y-n.y)*(e.x-n.x)>(e.y-n.y)*(o.x-n.x)}function De(n){let e=0;for(let o,u,f=0,g=n.length,v=g-1;f<g;v=f++)o=n[f],u=n[v],e+=(u.x-o.x)*(o.y+u.y);return e}function Ze(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function je(n){const e={};if(n.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(o,u,f,g)=>{const v=f||g;return e[u]=!v||v.toLowerCase(),""}),e["max-age"]){const o=parseInt(e["max-age"],10);isNaN(o)?delete e["max-age"]:e["max-age"]=o}return e}let lt,vt,me=null;function $e(n){if(me==null){const e=n.navigator?n.navigator.userAgent:null;me=!!n.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return me}function j(n){return typeof ImageBitmap<"u"&&n instanceof ImageBitmap}const qe={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(n){const e=requestAnimationFrame(n);return{cancel:()=>cancelAnimationFrame(e)}},getImageData(n,e=0){const o=window.document.createElement("canvas"),u=o.getContext("2d");if(!u)throw new Error("failed to create canvas 2d context");return o.width=n.width,o.height=n.height,u.drawImage(n,0,0,n.width,n.height),u.getImageData(-e,-e,n.width+2*e,n.height+2*e)},resolveURL:n=>(lt||(lt=document.createElement("a")),lt.href=n,lt.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(vt==null&&(vt=matchMedia("(prefers-reduced-motion: reduce)")),vt.matches)}};var ht=Ke;function Ke(n,e){this.x=n,this.y=e}Ke.prototype={clone:function(){return new Ke(this.x,this.y)},add:function(n){return this.clone()._add(n)},sub:function(n){return this.clone()._sub(n)},multByPoint:function(n){return this.clone()._multByPoint(n)},divByPoint:function(n){return this.clone()._divByPoint(n)},mult:function(n){return this.clone()._mult(n)},div:function(n){return this.clone()._div(n)},rotate:function(n){return this.clone()._rotate(n)},rotateAround:function(n,e){return this.clone()._rotateAround(n,e)},matMult:function(n){return this.clone()._matMult(n)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(n){return this.x===n.x&&this.y===n.y},dist:function(n){return Math.sqrt(this.distSqr(n))},distSqr:function(n){var e=n.x-this.x,o=n.y-this.y;return e*e+o*o},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(n){return Math.atan2(this.y-n.y,this.x-n.x)},angleWith:function(n){return this.angleWithSep(n.x,n.y)},angleWithSep:function(n,e){return Math.atan2(this.x*e-this.y*n,this.x*n+this.y*e)},_matMult:function(n){var e=n[2]*this.x+n[3]*this.y;return this.x=n[0]*this.x+n[1]*this.y,this.y=e,this},_add:function(n){return this.x+=n.x,this.y+=n.y,this},_sub:function(n){return this.x-=n.x,this.y-=n.y,this},_mult:function(n){return this.x*=n,this.y*=n,this},_div:function(n){return this.x/=n,this.y/=n,this},_multByPoint:function(n){return this.x*=n.x,this.y*=n.y,this},_divByPoint:function(n){return this.x/=n.x,this.y/=n.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var n=this.y;return this.y=this.x,this.x=-n,this},_rotate:function(n){var e=Math.cos(n),o=Math.sin(n),u=o*this.x+e*this.y;return this.x=e*this.x-o*this.y,this.y=u,this},_rotateAround:function(n,e){var o=Math.cos(n),u=Math.sin(n),f=e.y+u*(this.x-e.x)+o*(this.y-e.y);return this.x=e.x+o*(this.x-e.x)-u*(this.y-e.y),this.y=f,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Ke.convert=function(n){return n instanceof Ke?n:Array.isArray(n)?new Ke(n[0],n[1]):n};const st={MAX_PARALLEL_IMAGE_REQUESTS:16,REGISTERED_PROTOCOLS:{}},Fe="mapbox-tiles";let ae,fe=500,Se=50;function gt(){typeof caches>"u"||ae||(ae=caches.open(Fe))}let ct=1/0;const dt={supported:!1,testSupport:function(n){!At&&Vt&&(Rt?$t(n):bt=n)}};let bt,Vt,At=!1,Rt=!1;function $t(n){const e=n.createTexture();n.bindTexture(n.TEXTURE_2D,e);try{if(n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,Vt),n.isContextLost())return;dt.supported=!0}catch{}n.deleteTexture(e),At=!0}typeof document<"u"&&(Vt=document.createElement("img"),Vt.onload=function(){bt&&$t(bt),bt=null,Rt=!0},Vt.onerror=function(){At=!0,bt=null},Vt.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const or={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(or);class sr extends Error{constructor(e,o,u,f){super(`AJAXError: ${o} (${e}): ${u}`),this.status=e,this.statusText=o,this.url=u,this.body=f}}const pr=Ze()?()=>self.worker&&self.worker.referrer:()=>(window.location.protocol==="blob:"?window.parent:window).location.href;function O(n,e){const o=new AbortController,u=new Request(n.url,{method:n.method||"GET",body:n.body,credentials:n.credentials,headers:n.headers,referrer:pr(),signal:o.signal});let f=!1,g=!1;return n.type==="json"&&u.headers.set("Accept","application/json"),((v,t,i)=>{g||fetch(u).then(a=>a.ok?((h,y,w)=>{(n.type==="arrayBuffer"?h.arrayBuffer():n.type==="json"?h.json():h.text()).then(E=>{g||(f=!0,e(null,E,h.headers.get("Cache-Control"),h.headers.get("Expires")))}).catch(E=>{g||e(new Error(E.message))})})(a):a.blob().then(h=>e(new sr(a.status,a.statusText,n.url,h)))).catch(a=>{a.code!==20&&e(new Error(a.message))})})(),{cancel:()=>{g=!0,f||o.abort()}}}const it=function(n,e){if(/:\/\//.test(n.url)&&!/^https?:|^file:/.test(n.url)){if(Ze()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",n,e);if(!Ze()){const u=n.url.substring(0,n.url.indexOf("://"));return(st.REGISTERED_PROTOCOLS[u]||O)(n,e)}}if(!(/^file:/.test(o=n.url)||/^file:/.test(pr())&&!/^\w+:/.test(o))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return O(n,e);if(Ze()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",n,e,void 0,!0)}var o;return function(u,f){const g=new XMLHttpRequest;g.open(u.method||"GET",u.url,!0),u.type==="arrayBuffer"&&(g.responseType="arraybuffer");for(const v in u.headers)g.setRequestHeader(v,u.headers[v]);return u.type==="json"&&(g.responseType="text",g.setRequestHeader("Accept","application/json")),g.withCredentials=u.credentials==="include",g.onerror=()=>{f(new Error(g.statusText))},g.onload=()=>{if((g.status>=200&&g.status<300||g.status===0)&&g.response!==null){let v=g.response;if(u.type==="json")try{v=JSON.parse(g.response)}catch(t){return f(t)}f(null,v,g.getResponseHeader("Cache-Control"),g.getResponseHeader("Expires"))}else{const v=new Blob([g.response],{type:g.getResponseHeader("Content-Type")});f(new sr(g.status,g.statusText,u.url,v))}},g.send(u.body),{cancel:()=>g.abort()}}(n,e)},He=function(n,e){return it(Q(n,{type:"arrayBuffer"}),e)};function de(n){const e=window.document.createElement("a");return e.href=n,e.protocol===window.document.location.protocol&&e.host===window.document.location.host}const oe="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let Ee,ot;Ee=[],ot=0;const ft=function(n,e){if(dt.supported&&(n.headers||(n.headers={}),n.headers.accept="image/webp,*/*"),ot>=st.MAX_PARALLEL_IMAGE_REQUESTS){const g={requestParameters:n,callback:e,cancelled:!1,cancel(){this.cancelled=!0}};return Ee.push(g),g}ot++;let o=!1;const u=()=>{if(!o)for(o=!0,ot--;Ee.length&&ot<st.MAX_PARALLEL_IMAGE_REQUESTS;){const g=Ee.shift(),{requestParameters:v,callback:t,cancelled:i}=g;i||(g.cancel=ft(v,t).cancel)}},f=He(n,(g,v,t,i)=>{u(),g?e(g):v&&function(a,h){typeof createImageBitmap=="function"?function(y,w){const E=new Blob([new Uint8Array(y)],{type:"image/png"});createImageBitmap(E).then(z=>{w(null,z)}).catch(z=>{w(new Error(`Could not load image because of ${z.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(a,h):function(y,w){const E=new Image;E.onload=()=>{w(null,E),URL.revokeObjectURL(E.src),E.onload=null,window.requestAnimationFrame(()=>{E.src=oe})},E.onerror=()=>w(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const z=new Blob([new Uint8Array(y)],{type:"image/png"});E.src=y.byteLength?URL.createObjectURL(z):oe}(a,h)}(v,(a,h)=>{a!=null?e(a):h!=null&&e(null,h,{cacheControl:t,expires:i})})});return{cancel:()=>{f.cancel(),u()}}};function Ne(n,e,o){o[n]&&o[n].indexOf(e)!==-1||(o[n]=o[n]||[],o[n].push(e))}function _t(n,e,o){if(o&&o[n]){const u=o[n].indexOf(e);u!==-1&&o[n].splice(u,1)}}class We{constructor(e,o={}){Q(this,o),this.type=e}}class Qe extends We{constructor(e,o={}){super("error",Q({error:e},o))}}class kt{on(e,o){return this._listeners=this._listeners||{},Ne(e,o,this._listeners),this}off(e,o){return _t(e,o,this._listeners),_t(e,o,this._oneTimeListeners),this}once(e,o){return this._oneTimeListeners=this._oneTimeListeners||{},Ne(e,o,this._oneTimeListeners),this}fire(e,o){typeof e=="string"&&(e=new We(e,o||{}));const u=e.type;if(this.listens(u)){e.target=this;const f=this._listeners&&this._listeners[u]?this._listeners[u].slice():[];for(const t of f)t.call(this,e);const g=this._oneTimeListeners&&this._oneTimeListeners[u]?this._oneTimeListeners[u].slice():[];for(const t of g)_t(u,t,this._oneTimeListeners),t.call(this,e);const v=this._eventedParent;v&&(Q(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),v.fire(e))}else e instanceof Qe&&console.error(e.error);return this}listens(e){return this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e)}setEventedParent(e,o){return this._eventedParent=e,this._eventedParentData=o,this}}var Me={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1},elevationOffset:{type:"number",default:450}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};class Je{constructor(e,o,u,f){this.message=(e?`${e}: `:"")+u,f&&(this.identifier=f),o!=null&&o.__line__&&(this.line=o.__line__)}}function xr(n){const e=n.value;return e?[new Je(n.key,e,"constants have been deprecated as of v8")]:[]}function kr(n,...e){for(const o of e)for(const u in o)n[u]=o[u];return n}function Wt(n){return n instanceof Number||n instanceof String||n instanceof Boolean?n.valueOf():n}function vr(n){if(Array.isArray(n))return n.map(vr);if(n instanceof Object&&!(n instanceof Number||n instanceof String||n instanceof Boolean)){const e={};for(const o in n)e[o]=vr(n[o]);return e}return Wt(n)}class Qt extends Error{constructor(e,o){super(o),this.message=o,this.key=e}}class dn{constructor(e,o=[]){this.parent=e,this.bindings={};for(const[u,f]of o)this.bindings[u]=f}concat(e){return new dn(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}const Rr={kind:"null"},yt={kind:"number"},qt={kind:"string"},Zt={kind:"boolean"},qr={kind:"color"},fn={kind:"object"},Lt={kind:"value"},gr={kind:"collator"},Ar={kind:"formatted"},Lr={kind:"padding"},Kr={kind:"resolvedImage"};function lr(n,e){return{kind:"array",itemType:n,N:e}}function ur(n){if(n.kind==="array"){const e=ur(n.itemType);return typeof n.N=="number"?`array<${e}, ${n.N}>`:n.itemType.kind==="value"?"array":`array<${e}>`}return n.kind}const An=[Rr,yt,qt,Zt,qr,Ar,fn,lr(Lt),Lr,Kr];function Wr(n,e){if(e.kind==="error")return null;if(n.kind==="array"){if(e.kind==="array"&&(e.N===0&&e.itemType.kind==="value"||!Wr(n.itemType,e.itemType))&&(typeof n.N!="number"||n.N===e.N))return null}else{if(n.kind===e.kind)return null;if(n.kind==="value"){for(const o of An)if(!Wr(o,e))return null}}return`Expected ${ur(n)} but found ${ur(e)} instead.`}function gn(n,e){return e.some(o=>o.kind===n.kind)}function wn(n,e){return e.some(o=>o==="null"?n===null:o==="array"?Array.isArray(n):o==="object"?n&&!Array.isArray(n)&&typeof n=="object":o===typeof n)}var Hn,Di={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function zn(n){return(n=Math.round(n))<0?0:n>255?255:n}function J(n){return zn(n[n.length-1]==="%"?parseFloat(n)/100*255:parseInt(n))}function D(n){return(e=n[n.length-1]==="%"?parseFloat(n)/100:parseFloat(n))<0?0:e>1?1:e;var e}function U(n,e,o){return o<0?o+=1:o>1&&(o-=1),6*o<1?n+(e-n)*o*6:2*o<1?e:3*o<2?n+(e-n)*(2/3-o)*6:n}try{Hn={}.parseCSSColor=function(n){var e,o=n.replace(/ /g,"").toLowerCase();if(o in Di)return Di[o].slice();if(o[0]==="#")return o.length===4?(e=parseInt(o.substr(1),16))>=0&&e<=4095?[(3840&e)>>4|(3840&e)>>8,240&e|(240&e)>>4,15&e|(15&e)<<4,1]:null:o.length===7&&(e=parseInt(o.substr(1),16))>=0&&e<=16777215?[(16711680&e)>>16,(65280&e)>>8,255&e,1]:null;var u=o.indexOf("("),f=o.indexOf(")");if(u!==-1&&f+1===o.length){var g=o.substr(0,u),v=o.substr(u+1,f-(u+1)).split(","),t=1;switch(g){case"rgba":if(v.length!==4)return null;t=D(v.pop());case"rgb":return v.length!==3?null:[J(v[0]),J(v[1]),J(v[2]),t];case"hsla":if(v.length!==4)return null;t=D(v.pop());case"hsl":if(v.length!==3)return null;var i=(parseFloat(v[0])%360+360)%360/360,a=D(v[1]),h=D(v[2]),y=h<=.5?h*(a+1):h+a-h*a,w=2*h-y;return[zn(255*U(w,y,i+1/3)),zn(255*U(w,y,i)),zn(255*U(w,y,i-1/3)),t];default:return null}}return null}}catch{}class X{constructor(e,o,u,f=1){this.r=e,this.g=o,this.b=u,this.a=f}static parse(e){if(!e)return;if(e instanceof X)return e;if(typeof e!="string")return;const o=Hn(e);return o?new X(o[0]/255*o[3],o[1]/255*o[3],o[2]/255*o[3],o[3]):void 0}toString(){const[e,o,u,f]=this.toArray();return`rgba(${Math.round(e)},${Math.round(o)},${Math.round(u)},${f})`}toArray(){const{r:e,g:o,b:u,a:f}=this;return f===0?[0,0,0,0]:[255*e/f,255*o/f,255*u/f,f]}}X.black=new X(0,0,0,1),X.white=new X(1,1,1,1),X.transparent=new X(0,0,0,0),X.red=new X(1,0,0,1);class re{constructor(e,o,u){this.sensitivity=e?o?"variant":"case":o?"accent":"base",this.locale=u,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,o){return this.collator.compare(e,o)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class ve{constructor(e,o,u,f,g){this.text=e,this.image=o,this.scale=u,this.fontStack=f,this.textColor=g}}class Ce{constructor(e){this.sections=e}static fromString(e){return new Ce([new ve(e,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(e=>e.text.length!==0||e.image&&e.image.name.length!==0)}static factory(e){return e instanceof Ce?e:Ce.fromString(e)}toString(){return this.sections.length===0?"":this.sections.map(e=>e.text).join("")}}class ke{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof ke)return e;if(typeof e=="number")return new ke([e,e,e,e]);if(Array.isArray(e)&&!(e.length<1||e.length>4)){for(const o of e)if(typeof o!="number")return;switch(e.length){case 1:e=[e[0],e[0],e[0],e[0]];break;case 2:e=[e[0],e[1],e[0],e[1]];break;case 3:e=[e[0],e[1],e[2],e[1]]}return new ke(e)}}toString(){return JSON.stringify(this.values)}}class xe{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new xe({name:e,available:!1}):null}}function ze(n,e,o,u){return typeof n=="number"&&n>=0&&n<=255&&typeof e=="number"&&e>=0&&e<=255&&typeof o=="number"&&o>=0&&o<=255?u===void 0||typeof u=="number"&&u>=0&&u<=1?null:`Invalid rgba value [${[n,e,o,u].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof u=="number"?[n,e,o,u]:[n,e,o]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Ye(n){if(n===null||typeof n=="string"||typeof n=="boolean"||typeof n=="number"||n instanceof X||n instanceof re||n instanceof Ce||n instanceof ke||n instanceof xe)return!0;if(Array.isArray(n)){for(const e of n)if(!Ye(e))return!1;return!0}if(typeof n=="object"){for(const e in n)if(!Ye(n[e]))return!1;return!0}return!1}function ut(n){if(n===null)return Rr;if(typeof n=="string")return qt;if(typeof n=="boolean")return Zt;if(typeof n=="number")return yt;if(n instanceof X)return qr;if(n instanceof re)return gr;if(n instanceof Ce)return Ar;if(n instanceof ke)return Lr;if(n instanceof xe)return Kr;if(Array.isArray(n)){const e=n.length;let o;for(const u of n){const f=ut(u);if(o){if(o===f)continue;o=Lt;break}o=f}return lr(o||Lt,e)}return fn}function at(n){const e=typeof n;return n===null?"":e==="string"||e==="number"||e==="boolean"?String(n):n instanceof X||n instanceof Ce||n instanceof ke||n instanceof xe?n.toString():JSON.stringify(n)}class Dt{constructor(e,o){this.type=e,this.value=o}static parse(e,o){if(e.length!==2)return o.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!Ye(e[1]))return o.error("invalid value");const u=e[1];let f=ut(u);const g=o.expectedType;return f.kind!=="array"||f.N!==0||!g||g.kind!=="array"||typeof g.N=="number"&&g.N!==0||(f=g),new Dt(f,u)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class zt{constructor(e){this.name="ExpressionEvaluationError",this.message=e}toJSON(){return this.message}}const Ft={string:qt,number:yt,boolean:Zt,object:fn};class Et{constructor(e,o){this.type=e,this.args=o}static parse(e,o){if(e.length<2)return o.error("Expected at least one argument.");let u,f=1;const g=e[0];if(g==="array"){let t,i;if(e.length>2){const a=e[1];if(typeof a!="string"||!(a in Ft)||a==="object")return o.error('The item type argument of "array" must be one of string, number, boolean',1);t=Ft[a],f++}else t=Lt;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return o.error('The length argument to "array" must be a positive integer literal',2);i=e[2],f++}u=lr(t,i)}else{if(!Ft[g])throw new Error(`Types doesn't contain name = ${g}`);u=Ft[g]}const v=[];for(;f<e.length;f++){const t=o.parse(e[f],f,Lt);if(!t)return null;v.push(t)}return new Et(u,v)}evaluate(e){for(let o=0;o<this.args.length;o++){const u=this.args[o].evaluate(e);if(!Wr(this.type,ut(u)))return u;if(o===this.args.length-1)throw new zt(`Expected value to be of type ${ur(this.type)}, but found ${ur(ut(u))} instead.`)}throw new Error}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}}const er={"to-boolean":Zt,"to-color":qr,"to-number":yt,"to-string":qt};class tr{constructor(e,o){this.type=e,this.args=o}static parse(e,o){if(e.length<2)return o.error("Expected at least one argument.");const u=e[0];if(!er[u])throw new Error(`Can't parse ${u} as it is not part of the known types`);if((u==="to-boolean"||u==="to-string")&&e.length!==2)return o.error("Expected one argument.");const f=er[u],g=[];for(let v=1;v<e.length;v++){const t=o.parse(e[v],v,Lt);if(!t)return null;g.push(t)}return new tr(f,g)}evaluate(e){if(this.type.kind==="boolean")return!!this.args[0].evaluate(e);if(this.type.kind==="color"){let o,u;for(const f of this.args){if(o=f.evaluate(e),u=null,o instanceof X)return o;if(typeof o=="string"){const g=e.parseColor(o);if(g)return g}else if(Array.isArray(o)&&(u=o.length<3||o.length>4?`Invalid rbga value ${JSON.stringify(o)}: expected an array containing either three or four numeric values.`:ze(o[0],o[1],o[2],o[3]),!u))return new X(o[0]/255,o[1]/255,o[2]/255,o[3])}throw new zt(u||`Could not parse color from value '${typeof o=="string"?o:JSON.stringify(o)}'`)}if(this.type.kind==="padding"){let o;for(const u of this.args){o=u.evaluate(e);const f=ke.parse(o);if(f)return f}throw new zt(`Could not parse padding from value '${typeof o=="string"?o:JSON.stringify(o)}'`)}if(this.type.kind==="number"){let o=null;for(const u of this.args){if(o=u.evaluate(e),o===null)return 0;const f=Number(o);if(!isNaN(f))return f}throw new zt(`Could not convert ${JSON.stringify(o)} to number.`)}return this.type.kind==="formatted"?Ce.fromString(at(this.args[0].evaluate(e))):this.type.kind==="resolvedImage"?xe.fromString(at(this.args[0].evaluate(e))):at(this.args[0].evaluate(e))}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}}const rr=["Unknown","Point","LineString","Polygon"];class Xt{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?rr[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(e){let o=this._parseColorCache[e];return o||(o=this._parseColorCache[e]=X.parse(e)),o}}class Kt{constructor(e,o,u,f){this.name=e,this.type=o,this._evaluate=u,this.args=f}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}static parse(e,o){const u=e[0],f=Kt.definitions[u];if(!f)return o.error(`Unknown expression "${u}". If you wanted a literal array, use ["literal", [...]].`,0);const g=Array.isArray(f)?f[0]:f.type,v=Array.isArray(f)?[[f[1],f[2]]]:f.overloads,t=v.filter(([a])=>!Array.isArray(a)||a.length===e.length-1);let i=null;for(const[a,h]of t){i=new Qs(o.registry,o.path,null,o.scope);const y=[];let w=!1;for(let E=1;E<e.length;E++){const z=e[E],N=Array.isArray(a)?a[E-1]:a.type,W=i.parse(z,1+y.length,N);if(!W){w=!0;break}y.push(W)}if(!w)if(Array.isArray(a)&&a.length!==y.length)i.error(`Expected ${a.length} arguments, but found ${y.length} instead.`);else{for(let E=0;E<y.length;E++){const z=Array.isArray(a)?a[E]:a.type,N=y[E];i.concat(E+1).checkSubtype(z,N.type)}if(i.errors.length===0)return new Kt(u,g,h,y)}}if(t.length===1)o.errors.push(...i.errors);else{const a=(t.length?t:v).map(([y])=>{return w=y,Array.isArray(w)?`(${w.map(ur).join(", ")})`:`(${ur(w.type)}...)`;var w}).join(" | "),h=[];for(let y=1;y<e.length;y++){const w=o.parse(e[y],1+h.length);if(!w)return null;h.push(ur(w.type))}o.error(`Expected arguments of type ${a}, but found (${h.join(", ")}) instead.`)}return null}static register(e,o){Kt.definitions=o;for(const u in o)e[u]=Kt}}class Yr{constructor(e,o,u){this.type=gr,this.locale=u,this.caseSensitive=e,this.diacriticSensitive=o}static parse(e,o){if(e.length!==2)return o.error("Expected one argument.");const u=e[1];if(typeof u!="object"||Array.isArray(u))return o.error("Collator options argument must be an object.");const f=o.parse(u["case-sensitive"]!==void 0&&u["case-sensitive"],1,Zt);if(!f)return null;const g=o.parse(u["diacritic-sensitive"]!==void 0&&u["diacritic-sensitive"],1,Zt);if(!g)return null;let v=null;return u.locale&&(v=o.parse(u.locale,1,qt),!v)?null:new Yr(f,g,v)}evaluate(e){return new re(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}}const Nr=8192;function zr(n,e){n[0]=Math.min(n[0],e[0]),n[1]=Math.min(n[1],e[1]),n[2]=Math.max(n[2],e[0]),n[3]=Math.max(n[3],e[1])}function bn(n,e){return!(n[0]<=e[0]||n[2]>=e[2]||n[1]<=e[1]||n[3]>=e[3])}function ti(n,e){const o=(180+n[0])/360,u=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+n[1]*Math.PI/360)))/360,f=Math.pow(2,e.z);return[Math.round(o*f*Nr),Math.round(u*f*Nr)]}function Xs(n,e,o){const u=n[0]-e[0],f=n[1]-e[1],g=n[0]-o[0],v=n[1]-o[1];return u*v-g*f==0&&u*g<=0&&f*v<=0}function Cr(n,e){let o=!1;for(let v=0,t=e.length;v<t;v++){const i=e[v];for(let a=0,h=i.length;a<h-1;a++){if(Xs(n,i[a],i[a+1]))return!1;(f=i[a])[1]>(u=n)[1]!=(g=i[a+1])[1]>u[1]&&u[0]<(g[0]-f[0])*(u[1]-f[1])/(g[1]-f[1])+f[0]&&(o=!o)}}var u,f,g;return o}function qc(n,e){for(let o=0;o<e.length;o++)if(Cr(n,e[o]))return!0;return!1}function Lo(n,e,o,u){const f=u[0]-o[0],g=u[1]-o[1],v=(n[0]-o[0])*g-f*(n[1]-o[1]),t=(e[0]-o[0])*g-f*(e[1]-o[1]);return v>0&&t<0||v<0&&t>0}function el(n,e,o){for(const a of o)for(let h=0;h<a.length-1;++h)if((t=[(v=a[h+1])[0]-(g=a[h])[0],v[1]-g[1]])[0]*(i=[(f=e)[0]-(u=n)[0],f[1]-u[1]])[1]-t[1]*i[0]!=0&&Lo(u,f,g,v)&&Lo(g,v,u,f))return!0;var u,f,g,v,t,i;return!1}function Bo(n,e){for(let o=0;o<n.length;++o)if(!Cr(n[o],e))return!1;for(let o=0;o<n.length-1;++o)if(el(n[o],n[o+1],e))return!1;return!0}function Ks(n,e){for(let o=0;o<e.length;o++)if(Bo(n,e[o]))return!0;return!1}function ql(n,e,o){const u=[];for(let f=0;f<n.length;f++){const g=[];for(let v=0;v<n[f].length;v++){const t=ti(n[f][v],o);zr(e,t),g.push(t)}u.push(g)}return u}function Wl(n,e,o){const u=[];for(let f=0;f<n.length;f++){const g=ql(n[f],e,o);u.push(g)}return u}function Ys(n,e,o,u){if(n[0]<o[0]||n[0]>o[2]){const f=.5*u;let g=n[0]-o[0]>f?-u:o[0]-n[0]>f?u:0;g===0&&(g=n[0]-o[2]>f?-u:o[2]-n[0]>f?u:0),n[0]+=g}zr(e,n)}function Hl(n,e,o,u){const f=Math.pow(2,u.z)*Nr,g=[u.x*Nr,u.y*Nr],v=[];for(const t of n)for(const i of t){const a=[i.x+g[0],i.y+g[1]];Ys(a,e,o,f),v.push(a)}return v}function tl(n,e,o,u){const f=Math.pow(2,u.z)*Nr,g=[u.x*Nr,u.y*Nr],v=[];for(const i of n){const a=[];for(const h of i){const y=[h.x+g[0],h.y+g[1]];zr(e,y),a.push(y)}v.push(a)}if(e[2]-e[0]<=f/2){(t=e)[0]=t[1]=1/0,t[2]=t[3]=-1/0;for(const i of v)for(const a of i)Ys(a,e,o,f)}var t;return v}class _i{constructor(e,o){this.type=Zt,this.geojson=e,this.geometries=o}static parse(e,o){if(e.length!==2)return o.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(Ye(e[1])){const u=e[1];if(u.type==="FeatureCollection")for(let f=0;f<u.features.length;++f){const g=u.features[f].geometry.type;if(g==="Polygon"||g==="MultiPolygon")return new _i(u,u.features[f].geometry)}else if(u.type==="Feature"){const f=u.geometry.type;if(f==="Polygon"||f==="MultiPolygon")return new _i(u,u.geometry)}else if(u.type==="Polygon"||u.type==="MultiPolygon")return new _i(u,u)}return o.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return function(o,u){const f=[1/0,1/0,-1/0,-1/0],g=[1/0,1/0,-1/0,-1/0],v=o.canonicalID();if(u.type==="Polygon"){const t=ql(u.coordinates,g,v),i=Hl(o.geometry(),f,g,v);if(!bn(f,g))return!1;for(const a of i)if(!Cr(a,t))return!1}if(u.type==="MultiPolygon"){const t=Wl(u.coordinates,g,v),i=Hl(o.geometry(),f,g,v);if(!bn(f,g))return!1;for(const a of i)if(!qc(a,t))return!1}return!0}(e,this.geometries);if(e.geometryType()==="LineString")return function(o,u){const f=[1/0,1/0,-1/0,-1/0],g=[1/0,1/0,-1/0,-1/0],v=o.canonicalID();if(u.type==="Polygon"){const t=ql(u.coordinates,g,v),i=tl(o.geometry(),f,g,v);if(!bn(f,g))return!1;for(const a of i)if(!Bo(a,t))return!1}if(u.type==="MultiPolygon"){const t=Wl(u.coordinates,g,v),i=tl(o.geometry(),f,g,v);if(!bn(f,g))return!1;for(const a of i)if(!Ks(a,t))return!1}return!0}(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}function rl(n){if(n instanceof Kt&&(n.name==="get"&&n.args.length===1||n.name==="feature-state"||n.name==="has"&&n.args.length===1||n.name==="properties"||n.name==="geometry-type"||n.name==="id"||/^filter-/.test(n.name))||n instanceof _i)return!1;let e=!0;return n.eachChild(o=>{e&&!rl(o)&&(e=!1)}),e}function lo(n){if(n instanceof Kt&&n.name==="feature-state")return!1;let e=!0;return n.eachChild(o=>{e&&!lo(o)&&(e=!1)}),e}function wr(n,e){if(n instanceof Kt&&e.indexOf(n.name)>=0)return!1;let o=!0;return n.eachChild(u=>{o&&!wr(u,e)&&(o=!1)}),o}class Js{constructor(e,o){this.type=o.type,this.name=e,this.boundExpression=o}static parse(e,o){if(e.length!==2||typeof e[1]!="string")return o.error("'var' expression requires exactly one string literal argument.");const u=e[1];return o.scope.has(u)?new Js(u,o.scope.get(u)):o.error(`Unknown variable "${u}". Make sure "${u}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}}class Qs{constructor(e,o=[],u,f=new dn,g=[]){this.registry=e,this.path=o,this.key=o.map(v=>`[${v}]`).join(""),this.scope=f,this.errors=g,this.expectedType=u}parse(e,o,u,f,g={}){return o?this.concat(o,u,f)._parse(e,g):this._parse(e,g)}_parse(e,o){function u(f,g,v){return v==="assert"?new Et(g,[f]):v==="coerce"?new tr(g,[f]):f}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const f=e[0];if(typeof f!="string")return this.error(`Expression name must be a string, but found ${typeof f} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const g=this.registry[f];if(g){let v=g.parse(e,this);if(!v)return null;if(this.expectedType){const t=this.expectedType,i=v.type;if(t.kind!=="string"&&t.kind!=="number"&&t.kind!=="boolean"&&t.kind!=="object"&&t.kind!=="array"||i.kind!=="value")if(t.kind!=="color"&&t.kind!=="formatted"&&t.kind!=="resolvedImage"||i.kind!=="value"&&i.kind!=="string")if(t.kind!=="padding"||i.kind!=="value"&&i.kind!=="number"&&i.kind!=="array"){if(this.checkSubtype(t,i))return null}else v=u(v,t,o.typeAnnotation||"coerce");else v=u(v,t,o.typeAnnotation||"coerce");else v=u(v,t,o.typeAnnotation||"assert")}if(!(v instanceof Dt)&&v.type.kind!=="resolvedImage"&&Fo(v)){const t=new Xt;try{v=new Dt(v.type,v.evaluate(t))}catch(i){return this.error(i.message),null}}return v}return this.error(`Unknown expression "${f}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof e} instead.`)}concat(e,o,u){const f=typeof e=="number"?this.path.concat(e):this.path,g=u?this.scope.concat(u):this.scope;return new Qs(this.registry,f,o||null,g,this.errors)}error(e,...o){const u=`${this.key}${o.map(f=>`[${f}]`).join("")}`;this.errors.push(new Qt(u,e))}checkSubtype(e,o){const u=Wr(e,o);return u&&this.error(u),u}}function Fo(n){if(n instanceof Js)return Fo(n.boundExpression);if(n instanceof Kt&&n.name==="error"||n instanceof Yr||n instanceof _i)return!1;const e=n instanceof tr||n instanceof Et;let o=!0;return n.eachChild(u=>{o=e?o&&Fo(u):o&&u instanceof Dt}),!!o&&rl(n)&&wr(n,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function ea(n,e){const o=n.length-1;let u,f,g=0,v=o,t=0;for(;g<=v;)if(t=Math.floor((g+v)/2),u=n[t],f=n[t+1],u<=e){if(t===o||e<f)return t;g=t+1}else{if(!(u>e))throw new zt("Input is not a number.");v=t-1}return 0}class ds{constructor(e,o,u){this.type=e,this.input=o,this.labels=[],this.outputs=[];for(const[f,g]of u)this.labels.push(f),this.outputs.push(g)}static parse(e,o){if(e.length-1<4)return o.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return o.error("Expected an even number of arguments.");const u=o.parse(e[1],1,yt);if(!u)return null;const f=[];let g=null;o.expectedType&&o.expectedType.kind!=="value"&&(g=o.expectedType);for(let v=1;v<e.length;v+=2){const t=v===1?-1/0:e[v],i=e[v+1],a=v,h=v+1;if(typeof t!="number")return o.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',a);if(f.length&&f[f.length-1][0]>=t)return o.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',a);const y=o.parse(i,h,g);if(!y)return null;g=g||y.type,f.push([t,y])}return new ds(g,u,f)}evaluate(e){const o=this.labels,u=this.outputs;if(o.length===1)return u[0].evaluate(e);const f=this.input.evaluate(e);if(f<=o[0])return u[0].evaluate(e);const g=o.length;return f>=o[g-1]?u[g-1].evaluate(e):u[ea(o,f)].evaluate(e)}eachChild(e){e(this.input);for(const o of this.outputs)e(o)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}}function Ur(n,e,o){return n*(1-o)+e*o}var Oo=Object.freeze({__proto__:null,number:Ur,color:function(n,e,o){return new X(Ur(n.r,e.r,o),Ur(n.g,e.g,o),Ur(n.b,e.b,o),Ur(n.a,e.a,o))},array:function(n,e,o){return n.map((u,f)=>Ur(u,e[f],o))},padding:function(n,e,o){const u=n.values,f=e.values;return new ke([Ur(u[0],f[0],o),Ur(u[1],f[1],o),Ur(u[2],f[2],o),Ur(u[3],f[3],o)])}});const fs=.95047,$i=1.08883,Gi=4/29,vi=6/29,No=3*vi*vi,ta=Math.PI/180,uo=180/Math.PI;function Xl(n){return n>.008856451679035631?Math.pow(n,1/3):n/No+Gi}function nl(n){return n>vi?n*n*n:No*(n-Gi)}function Uo(n){return 255*(n<=.0031308?12.92*n:1.055*Math.pow(n,1/2.4)-.055)}function Kl(n){return(n/=255)<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4)}function Yl(n){const e=Kl(n.r),o=Kl(n.g),u=Kl(n.b),f=Xl((.4124564*e+.3575761*o+.1804375*u)/fs),g=Xl((.2126729*e+.7151522*o+.072175*u)/1);return{l:116*g-16,a:500*(f-g),b:200*(g-Xl((.0193339*e+.119192*o+.9503041*u)/$i)),alpha:n.a}}function yr(n){let e=(n.l+16)/116,o=isNaN(n.a)?e:e+n.a/500,u=isNaN(n.b)?e:e-n.b/200;return e=1*nl(e),o=fs*nl(o),u=$i*nl(u),new X(Uo(3.2404542*o-1.5371385*e-.4985314*u),Uo(-.969266*o+1.8760108*e+.041556*u),Uo(.0556434*o-.2040259*e+1.0572252*u),n.alpha)}function Uu(n,e,o){const u=e-n;return n+o*(u>180||u<-180?u-360*Math.round(u/360):u)}const ra={forward:Yl,reverse:yr,interpolate:function(n,e,o){return{l:Ur(n.l,e.l,o),a:Ur(n.a,e.a,o),b:Ur(n.b,e.b,o),alpha:Ur(n.alpha,e.alpha,o)}}},Zi={forward:function(n){const{l:e,a:o,b:u}=Yl(n),f=Math.atan2(u,o)*uo;return{h:f<0?f+360:f,c:Math.sqrt(o*o+u*u),l:e,alpha:n.a}},reverse:function(n){const e=n.h*ta,o=n.c;return yr({l:n.l,a:Math.cos(e)*o,b:Math.sin(e)*o,alpha:n.alpha})},interpolate:function(n,e,o){return{h:Uu(n.h,e.h,o),c:Ur(n.c,e.c,o),l:Ur(n.l,e.l,o),alpha:Ur(n.alpha,e.alpha,o)}}};var ps=Object.freeze({__proto__:null,lab:ra,hcl:Zi});class yn{constructor(e,o,u,f,g){this.type=e,this.operator=o,this.interpolation=u,this.input=f,this.labels=[],this.outputs=[];for(const[v,t]of g)this.labels.push(v),this.outputs.push(t)}static interpolationFactor(e,o,u,f){let g=0;if(e.name==="exponential")g=ms(o,e.base,u,f);else if(e.name==="linear")g=ms(o,1,u,f);else if(e.name==="cubic-bezier"){const v=e.controlPoints;g=new R(v[0],v[1],v[2],v[3]).solve(ms(o,1,u,f))}return g}static parse(e,o){let[u,f,g,...v]=e;if(!Array.isArray(f)||f.length===0)return o.error("Expected an interpolation type expression.",1);if(f[0]==="linear")f={name:"linear"};else if(f[0]==="exponential"){const a=f[1];if(typeof a!="number")return o.error("Exponential interpolation requires a numeric base.",1,1);f={name:"exponential",base:a}}else{if(f[0]!=="cubic-bezier")return o.error(`Unknown interpolation type ${String(f[0])}`,1,0);{const a=f.slice(1);if(a.length!==4||a.some(h=>typeof h!="number"||h<0||h>1))return o.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);f={name:"cubic-bezier",controlPoints:a}}}if(e.length-1<4)return o.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return o.error("Expected an even number of arguments.");if(g=o.parse(g,2,yt),!g)return null;const t=[];let i=null;u==="interpolate-hcl"||u==="interpolate-lab"?i=qr:o.expectedType&&o.expectedType.kind!=="value"&&(i=o.expectedType);for(let a=0;a<v.length;a+=2){const h=v[a],y=v[a+1],w=a+3,E=a+4;if(typeof h!="number")return o.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',w);if(t.length&&t[t.length-1][0]>=h)return o.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',w);const z=o.parse(y,E,i);if(!z)return null;i=i||z.type,t.push([h,z])}return i.kind==="number"||i.kind==="color"||i.kind==="padding"||i.kind==="array"&&i.itemType.kind==="number"&&typeof i.N=="number"?new yn(i,u,f,g,t):o.error(`Type ${ur(i)} is not interpolatable.`)}evaluate(e){const o=this.labels,u=this.outputs;if(o.length===1)return u[0].evaluate(e);const f=this.input.evaluate(e);if(f<=o[0])return u[0].evaluate(e);const g=o.length;if(f>=o[g-1])return u[g-1].evaluate(e);const v=ea(o,f),t=yn.interpolationFactor(this.interpolation,f,o[v],o[v+1]),i=u[v].evaluate(e),a=u[v+1].evaluate(e);return this.operator==="interpolate"?Oo[this.type.kind.toLowerCase()](i,a,t):this.operator==="interpolate-hcl"?Zi.reverse(Zi.interpolate(Zi.forward(i),Zi.forward(a),t)):ra.reverse(ra.interpolate(ra.forward(i),ra.forward(a),t))}eachChild(e){e(this.input);for(const o of this.outputs)e(o)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}}function ms(n,e,o,u){const f=u-o,g=n-o;return f===0?0:e===1?g/f:(Math.pow(e,g)-1)/(Math.pow(e,f)-1)}class il{constructor(e,o){this.type=e,this.args=o}static parse(e,o){if(e.length<2)return o.error("Expectected at least one argument.");let u=null;const f=o.expectedType;f&&f.kind!=="value"&&(u=f);const g=[];for(const t of e.slice(1)){const i=o.parse(t,1+g.length,u,void 0,{typeAnnotation:"omit"});if(!i)return null;u=u||i.type,g.push(i)}if(!u)throw new Error("No output type");const v=f&&g.some(t=>Wr(f,t.type));return new il(v?Lt:u,g)}evaluate(e){let o,u=null,f=0;for(const g of this.args)if(f++,u=g.evaluate(e),u&&u instanceof xe&&!u.available&&(o||(o=u.name),u=null,f===this.args.length&&(u=o)),u!==null)break;return u}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}}class ol{constructor(e,o){this.type=o.type,this.bindings=[].concat(e),this.result=o}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const o of this.bindings)e(o[1]);e(this.result)}static parse(e,o){if(e.length<4)return o.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);const u=[];for(let g=1;g<e.length-1;g+=2){const v=e[g];if(typeof v!="string")return o.error(`Expected string, but found ${typeof v} instead.`,g);if(/[^a-zA-Z0-9_]/.test(v))return o.error("Variable names must contain only alphanumeric characters or '_'.",g);const t=o.parse(e[g+1],g+1);if(!t)return null;u.push([v,t])}const f=o.parse(e[e.length-1],e.length-1,o.expectedType,u);return f?new ol(u,f):null}outputDefined(){return this.result.outputDefined()}}class na{constructor(e,o,u){this.type=e,this.index=o,this.input=u}static parse(e,o){if(e.length!==3)return o.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const u=o.parse(e[1],1,yt),f=o.parse(e[2],2,lr(o.expectedType||Lt));return u&&f?new na(f.type.itemType,u,f):null}evaluate(e){const o=this.index.evaluate(e),u=this.input.evaluate(e);if(o<0)throw new zt(`Array index out of bounds: ${o} < 0.`);if(o>=u.length)throw new zt(`Array index out of bounds: ${o} > ${u.length-1}.`);if(o!==Math.floor(o))throw new zt(`Array index must be an integer, but found ${o} instead.`);return u[o]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}}class gs{constructor(e,o){this.type=Zt,this.needle=e,this.haystack=o}static parse(e,o){if(e.length!==3)return o.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const u=o.parse(e[1],1,Lt),f=o.parse(e[2],2,Lt);return u&&f?gn(u.type,[Zt,qt,yt,Rr,Lt])?new gs(u,f):o.error(`Expected first argument to be of type boolean, string, number or null, but found ${ur(u.type)} instead`):null}evaluate(e){const o=this.needle.evaluate(e),u=this.haystack.evaluate(e);if(!u)return!1;if(!wn(o,["boolean","string","number","null"]))throw new zt(`Expected first argument to be of type boolean, string, number or null, but found ${ur(ut(o))} instead.`);if(!wn(u,["string","array"]))throw new zt(`Expected second argument to be of type array or string, but found ${ur(ut(u))} instead.`);return u.indexOf(o)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}}class ys{constructor(e,o,u){this.type=yt,this.needle=e,this.haystack=o,this.fromIndex=u}static parse(e,o){if(e.length<=2||e.length>=5)return o.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const u=o.parse(e[1],1,Lt),f=o.parse(e[2],2,Lt);if(!u||!f)return null;if(!gn(u.type,[Zt,qt,yt,Rr,Lt]))return o.error(`Expected first argument to be of type boolean, string, number or null, but found ${ur(u.type)} instead`);if(e.length===4){const g=o.parse(e[3],3,yt);return g?new ys(u,f,g):null}return new ys(u,f)}evaluate(e){const o=this.needle.evaluate(e),u=this.haystack.evaluate(e);if(!wn(o,["boolean","string","number","null"]))throw new zt(`Expected first argument to be of type boolean, string, number or null, but found ${ur(ut(o))} instead.`);if(!wn(u,["string","array"]))throw new zt(`Expected second argument to be of type array or string, but found ${ur(ut(u))} instead.`);if(this.fromIndex){const f=this.fromIndex.evaluate(e);return u.indexOf(o,f)}return u.indexOf(o)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}}class sl{constructor(e,o,u,f,g,v){this.inputType=e,this.type=o,this.input=u,this.cases=f,this.outputs=g,this.otherwise=v}static parse(e,o){if(e.length<5)return o.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!=1)return o.error("Expected an even number of arguments.");let u,f;o.expectedType&&o.expectedType.kind!=="value"&&(f=o.expectedType);const g={},v=[];for(let a=2;a<e.length-1;a+=2){let h=e[a];const y=e[a+1];Array.isArray(h)||(h=[h]);const w=o.concat(a);if(h.length===0)return w.error("Expected at least one branch label.");for(const z of h){if(typeof z!="number"&&typeof z!="string")return w.error("Branch labels must be numbers or strings.");if(typeof z=="number"&&Math.abs(z)>Number.MAX_SAFE_INTEGER)return w.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof z=="number"&&Math.floor(z)!==z)return w.error("Numeric branch labels must be integer values.");if(u){if(w.checkSubtype(u,ut(z)))return null}else u=ut(z);if(g[String(z)]!==void 0)return w.error("Branch labels must be unique.");g[String(z)]=v.length}const E=o.parse(y,a,f);if(!E)return null;f=f||E.type,v.push(E)}const t=o.parse(e[1],1,Lt);if(!t)return null;const i=o.parse(e[e.length-1],e.length-1,f);return i?t.type.kind!=="value"&&o.concat(1).checkSubtype(u,t.type)?null:new sl(u,f,t,g,v,i):null}evaluate(e){const o=this.input.evaluate(e);return(ut(o)===this.inputType&&this.outputs[this.cases[o]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every(e=>e.outputDefined())&&this.otherwise.outputDefined()}}class Ri{constructor(e,o,u){this.type=e,this.branches=o,this.otherwise=u}static parse(e,o){if(e.length<4)return o.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!=0)return o.error("Expected an odd number of arguments.");let u;o.expectedType&&o.expectedType.kind!=="value"&&(u=o.expectedType);const f=[];for(let v=1;v<e.length-1;v+=2){const t=o.parse(e[v],v,Zt);if(!t)return null;const i=o.parse(e[v+1],v+1,u);if(!i)return null;f.push([t,i]),u=u||i.type}const g=o.parse(e[e.length-1],e.length-1,u);if(!g)return null;if(!u)throw new Error("Can't infer output type");return new Ri(u,f,g)}evaluate(e){for(const[o,u]of this.branches)if(o.evaluate(e))return u.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[o,u]of this.branches)e(o),e(u);e(this.otherwise)}outputDefined(){return this.branches.every(([e,o])=>o.outputDefined())&&this.otherwise.outputDefined()}}class _s{constructor(e,o,u,f){this.type=e,this.input=o,this.beginIndex=u,this.endIndex=f}static parse(e,o){if(e.length<=2||e.length>=5)return o.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const u=o.parse(e[1],1,Lt),f=o.parse(e[2],2,yt);if(!u||!f)return null;if(!gn(u.type,[lr(Lt),qt,Lt]))return o.error(`Expected first argument to be of type array or string, but found ${ur(u.type)} instead`);if(e.length===4){const g=o.parse(e[3],3,yt);return g?new _s(u.type,u,f,g):null}return new _s(u.type,u,f)}evaluate(e){const o=this.input.evaluate(e),u=this.beginIndex.evaluate(e);if(!wn(o,["string","array"]))throw new zt(`Expected first argument to be of type array or string, but found ${ur(ut(o))} instead.`);if(this.endIndex){const f=this.endIndex.evaluate(e);return o.slice(u,f)}return o.slice(u)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}}function ia(n,e){return n==="=="||n==="!="?e.kind==="boolean"||e.kind==="string"||e.kind==="number"||e.kind==="null"||e.kind==="value":e.kind==="string"||e.kind==="number"||e.kind==="value"}function Jl(n,e,o,u){return u.compare(e,o)===0}function qi(n,e,o){const u=n!=="=="&&n!=="!=";return class hm{constructor(g,v,t){this.type=Zt,this.lhs=g,this.rhs=v,this.collator=t,this.hasUntypedArgument=g.type.kind==="value"||v.type.kind==="value"}static parse(g,v){if(g.length!==3&&g.length!==4)return v.error("Expected two or three arguments.");const t=g[0];let i=v.parse(g[1],1,Lt);if(!i)return null;if(!ia(t,i.type))return v.concat(1).error(`"${t}" comparisons are not supported for type '${ur(i.type)}'.`);let a=v.parse(g[2],2,Lt);if(!a)return null;if(!ia(t,a.type))return v.concat(2).error(`"${t}" comparisons are not supported for type '${ur(a.type)}'.`);if(i.type.kind!==a.type.kind&&i.type.kind!=="value"&&a.type.kind!=="value")return v.error(`Cannot compare types '${ur(i.type)}' and '${ur(a.type)}'.`);u&&(i.type.kind==="value"&&a.type.kind!=="value"?i=new Et(a.type,[i]):i.type.kind!=="value"&&a.type.kind==="value"&&(a=new Et(i.type,[a])));let h=null;if(g.length===4){if(i.type.kind!=="string"&&a.type.kind!=="string"&&i.type.kind!=="value"&&a.type.kind!=="value")return v.error("Cannot use collator to compare non-string types.");if(h=v.parse(g[3],3,gr),!h)return null}return new hm(i,a,h)}evaluate(g){const v=this.lhs.evaluate(g),t=this.rhs.evaluate(g);if(u&&this.hasUntypedArgument){const i=ut(v),a=ut(t);if(i.kind!==a.kind||i.kind!=="string"&&i.kind!=="number")throw new zt(`Expected arguments for "${n}" to be (string, string) or (number, number), but found (${i.kind}, ${a.kind}) instead.`)}if(this.collator&&!u&&this.hasUntypedArgument){const i=ut(v),a=ut(t);if(i.kind!=="string"||a.kind!=="string")return e(g,v,t)}return this.collator?o(g,v,t,this.collator.evaluate(g)):e(g,v,t)}eachChild(g){g(this.lhs),g(this.rhs),this.collator&&g(this.collator)}outputDefined(){return!0}}}const al=qi("==",function(n,e,o){return e===o},Jl),ju=qi("!=",function(n,e,o){return e!==o},function(n,e,o,u){return!Jl(0,e,o,u)}),ri=qi("<",function(n,e,o){return e<o},function(n,e,o,u){return u.compare(e,o)<0}),vs=qi(">",function(n,e,o){return e>o},function(n,e,o,u){return u.compare(e,o)>0}),Ql=qi("<=",function(n,e,o){return e<=o},function(n,e,o,u){return u.compare(e,o)<=0}),oa=qi(">=",function(n,e,o){return e>=o},function(n,e,o,u){return u.compare(e,o)>=0});class eu{constructor(e,o,u,f,g){this.type=qt,this.number=e,this.locale=o,this.currency=u,this.minFractionDigits=f,this.maxFractionDigits=g}static parse(e,o){if(e.length!==3)return o.error("Expected two arguments.");const u=o.parse(e[1],1,yt);if(!u)return null;const f=e[2];if(typeof f!="object"||Array.isArray(f))return o.error("NumberFormat options argument must be an object.");let g=null;if(f.locale&&(g=o.parse(f.locale,1,qt),!g))return null;let v=null;if(f.currency&&(v=o.parse(f.currency,1,qt),!v))return null;let t=null;if(f["min-fraction-digits"]&&(t=o.parse(f["min-fraction-digits"],1,yt),!t))return null;let i=null;return f["max-fraction-digits"]&&(i=o.parse(f["max-fraction-digits"],1,yt),!i)?null:new eu(u,g,v,t,i)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}}class xs{constructor(e){this.type=Ar,this.sections=e}static parse(e,o){if(e.length<2)return o.error("Expected at least one argument.");const u=e[1];if(!Array.isArray(u)&&typeof u=="object")return o.error("First argument must be an image or text section.");const f=[];let g=!1;for(let v=1;v<=e.length-1;++v){const t=e[v];if(g&&typeof t=="object"&&!Array.isArray(t)){g=!1;let i=null;if(t["font-scale"]&&(i=o.parse(t["font-scale"],1,yt),!i))return null;let a=null;if(t["text-font"]&&(a=o.parse(t["text-font"],1,lr(qt)),!a))return null;let h=null;if(t["text-color"]&&(h=o.parse(t["text-color"],1,qr),!h))return null;const y=f[f.length-1];y.scale=i,y.font=a,y.textColor=h}else{const i=o.parse(e[v],1,Lt);if(!i)return null;const a=i.type.kind;if(a!=="string"&&a!=="value"&&a!=="null"&&a!=="resolvedImage")return o.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");g=!0,f.push({content:i,scale:null,font:null,textColor:null})}}return new xs(f)}evaluate(e){return new Ce(this.sections.map(o=>{const u=o.content.evaluate(e);return ut(u)===Kr?new ve("",u,null,null,null):new ve(at(u),null,o.scale?o.scale.evaluate(e):null,o.font?o.font.evaluate(e).join(","):null,o.textColor?o.textColor.evaluate(e):null)}))}eachChild(e){for(const o of this.sections)e(o.content),o.scale&&e(o.scale),o.font&&e(o.font),o.textColor&&e(o.textColor)}outputDefined(){return!1}}class sa{constructor(e){this.type=Kr,this.input=e}static parse(e,o){if(e.length!==2)return o.error("Expected two arguments.");const u=o.parse(e[1],1,qt);return u?new sa(u):o.error("No image name provided.")}evaluate(e){const o=this.input.evaluate(e),u=xe.fromString(o);return u&&e.availableImages&&(u.available=e.availableImages.indexOf(o)>-1),u}eachChild(e){e(this.input)}outputDefined(){return!1}}class jo{constructor(e){this.type=yt,this.input=e}static parse(e,o){if(e.length!==2)return o.error(`Expected 1 argument, but found ${e.length-1} instead.`);const u=o.parse(e[1],1);return u?u.type.kind!=="array"&&u.type.kind!=="string"&&u.type.kind!=="value"?o.error(`Expected argument of type string or array, but found ${ur(u.type)} instead.`):new jo(u):null}evaluate(e){const o=this.input.evaluate(e);if(typeof o=="string"||Array.isArray(o))return o.length;throw new zt(`Expected value to be of type string or array, but found ${ur(ut(o))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}}const Wi={"==":al,"!=":ju,">":vs,"<":ri,">=":oa,"<=":Ql,array:Et,at:na,boolean:Et,case:Ri,coalesce:il,collator:Yr,format:xs,image:sa,in:gs,"index-of":ys,interpolate:yn,"interpolate-hcl":yn,"interpolate-lab":yn,length:jo,let:ol,literal:Dt,match:sl,number:Et,"number-format":eu,object:Et,slice:_s,step:ds,string:Et,"to-boolean":tr,"to-color":tr,"to-number":tr,"to-string":tr,var:Js,within:_i};function tu(n,[e,o,u,f]){e=e.evaluate(n),o=o.evaluate(n),u=u.evaluate(n);const g=f?f.evaluate(n):1,v=ze(e,o,u,g);if(v)throw new zt(v);return new X(e/255*g,o/255*g,u/255*g,g)}function Vu(n,e){return n in e}function ru(n,e){const o=e[n];return o===void 0?null:o}function co(n){return{type:n}}function ll(n){return{result:"success",value:n}}function ws(n){return{result:"error",value:n}}function bs(n){return n["property-type"]==="data-driven"||n["property-type"]==="cross-faded-data-driven"}function Jr(n){return!!n.expression&&n.expression.parameters.indexOf("zoom")>-1}function nu(n){return!!n.expression&&n.expression.interpolated}function Bt(n){return n instanceof Number?"number":n instanceof String?"string":n instanceof Boolean?"boolean":Array.isArray(n)?"array":n===null?"null":typeof n}function Vo(n){return typeof n=="object"&&n!==null&&!Array.isArray(n)}function Gr(n){return n}function Br(n,e){const o=e.type==="color",u=n.stops&&typeof n.stops[0][0]=="object",f=u||!(u||n.property!==void 0),g=n.type||(nu(e)?"exponential":"interval");if(o||e.type==="padding"){const a=o?X.parse:ke.parse;(n=kr({},n)).stops&&(n.stops=n.stops.map(h=>[h[0],a(h[1])])),n.default=a(n.default?n.default:e.default)}if(n.colorSpace&&n.colorSpace!=="rgb"&&!ps[n.colorSpace])throw new Error(`Unknown color space: ${n.colorSpace}`);let v,t,i;if(g==="exponential")v=Gu;else if(g==="interval")v=iu;else if(g==="categorical"){v=$u,t=Object.create(null);for(const a of n.stops)t[a[0]]=a[1];i=typeof n.stops[0][0]}else{if(g!=="identity")throw new Error(`Unknown function type "${g}"`);v=Wc}if(u){const a={},h=[];for(let E=0;E<n.stops.length;E++){const z=n.stops[E],N=z[0].zoom;a[N]===void 0&&(a[N]={zoom:N,type:n.type,property:n.property,default:n.default,stops:[]},h.push(N)),a[N].stops.push([z[0].value,z[1]])}const y=[];for(const E of h)y.push([a[E].zoom,Br(a[E],e)]);const w={name:"linear"};return{kind:"composite",interpolationType:w,interpolationFactor:yn.interpolationFactor.bind(void 0,w),zoomStops:y.map(E=>E[0]),evaluate:({zoom:E},z)=>Gu({stops:y,base:n.base},e,E).evaluate(E,z)}}if(f){const a=g==="exponential"?{name:"exponential",base:n.base!==void 0?n.base:1}:null;return{kind:"camera",interpolationType:a,interpolationFactor:yn.interpolationFactor.bind(void 0,a),zoomStops:n.stops.map(h=>h[0]),evaluate:({zoom:h})=>v(n,e,h,t,i)}}return{kind:"source",evaluate(a,h){const y=h&&h.properties?h.properties[n.property]:void 0;return y===void 0?ho(n.default,e.default):v(n,e,y,t,i)}}}function ho(n,e,o){return n!==void 0?n:e!==void 0?e:o!==void 0?o:void 0}function $u(n,e,o,u,f){return ho(typeof o===f?u[o]:void 0,n.default,e.default)}function iu(n,e,o){if(Bt(o)!=="number")return ho(n.default,e.default);const u=n.stops.length;if(u===1||o<=n.stops[0][0])return n.stops[0][1];if(o>=n.stops[u-1][0])return n.stops[u-1][1];const f=ea(n.stops.map(g=>g[0]),o);return n.stops[f][1]}function Gu(n,e,o){const u=n.base!==void 0?n.base:1;if(Bt(o)!=="number")return ho(n.default,e.default);const f=n.stops.length;if(f===1||o<=n.stops[0][0])return n.stops[0][1];if(o>=n.stops[f-1][0])return n.stops[f-1][1];const g=ea(n.stops.map(h=>h[0]),o),v=function(h,y,w,E){const z=E-w,N=h-w;return z===0?0:y===1?N/z:(Math.pow(y,N)-1)/(Math.pow(y,z)-1)}(o,u,n.stops[g][0],n.stops[g+1][0]),t=n.stops[g][1],i=n.stops[g+1][1];let a=Oo[e.type]||Gr;if(n.colorSpace&&n.colorSpace!=="rgb"){const h=ps[n.colorSpace];a=(y,w)=>h.reverse(h.interpolate(h.forward(y),h.forward(w),v))}return typeof t.evaluate=="function"?{evaluate(...h){const y=t.evaluate.apply(void 0,h),w=i.evaluate.apply(void 0,h);if(y!==void 0&&w!==void 0)return a(y,w,v)}}:a(t,i,v)}function Wc(n,e,o){switch(e.type){case"color":o=X.parse(o);break;case"formatted":o=Ce.fromString(o.toString());break;case"resolvedImage":o=xe.fromString(o.toString());break;case"padding":o=ke.parse(o);break;default:Bt(o)===e.type||e.type==="enum"&&e.values[o]||(o=void 0)}return ho(o,n.default,e.default)}Kt.register(Wi,{error:[{kind:"error"},[qt],(n,[e])=>{throw new zt(e.evaluate(n))}],typeof:[qt,[Lt],(n,[e])=>ur(ut(e.evaluate(n)))],"to-rgba":[lr(yt,4),[qr],(n,[e])=>e.evaluate(n).toArray()],rgb:[qr,[yt,yt,yt],tu],rgba:[qr,[yt,yt,yt,yt],tu],has:{type:Zt,overloads:[[[qt],(n,[e])=>Vu(e.evaluate(n),n.properties())],[[qt,fn],(n,[e,o])=>Vu(e.evaluate(n),o.evaluate(n))]]},get:{type:Lt,overloads:[[[qt],(n,[e])=>ru(e.evaluate(n),n.properties())],[[qt,fn],(n,[e,o])=>ru(e.evaluate(n),o.evaluate(n))]]},"feature-state":[Lt,[qt],(n,[e])=>ru(e.evaluate(n),n.featureState||{})],properties:[fn,[],n=>n.properties()],"geometry-type":[qt,[],n=>n.geometryType()],id:[Lt,[],n=>n.id()],zoom:[yt,[],n=>n.globals.zoom],"heatmap-density":[yt,[],n=>n.globals.heatmapDensity||0],"line-progress":[yt,[],n=>n.globals.lineProgress||0],accumulated:[Lt,[],n=>n.globals.accumulated===void 0?null:n.globals.accumulated],"+":[yt,co(yt),(n,e)=>{let o=0;for(const u of e)o+=u.evaluate(n);return o}],"*":[yt,co(yt),(n,e)=>{let o=1;for(const u of e)o*=u.evaluate(n);return o}],"-":{type:yt,overloads:[[[yt,yt],(n,[e,o])=>e.evaluate(n)-o.evaluate(n)],[[yt],(n,[e])=>-e.evaluate(n)]]},"/":[yt,[yt,yt],(n,[e,o])=>e.evaluate(n)/o.evaluate(n)],"%":[yt,[yt,yt],(n,[e,o])=>e.evaluate(n)%o.evaluate(n)],ln2:[yt,[],()=>Math.LN2],pi:[yt,[],()=>Math.PI],e:[yt,[],()=>Math.E],"^":[yt,[yt,yt],(n,[e,o])=>Math.pow(e.evaluate(n),o.evaluate(n))],sqrt:[yt,[yt],(n,[e])=>Math.sqrt(e.evaluate(n))],log10:[yt,[yt],(n,[e])=>Math.log(e.evaluate(n))/Math.LN10],ln:[yt,[yt],(n,[e])=>Math.log(e.evaluate(n))],log2:[yt,[yt],(n,[e])=>Math.log(e.evaluate(n))/Math.LN2],sin:[yt,[yt],(n,[e])=>Math.sin(e.evaluate(n))],cos:[yt,[yt],(n,[e])=>Math.cos(e.evaluate(n))],tan:[yt,[yt],(n,[e])=>Math.tan(e.evaluate(n))],asin:[yt,[yt],(n,[e])=>Math.asin(e.evaluate(n))],acos:[yt,[yt],(n,[e])=>Math.acos(e.evaluate(n))],atan:[yt,[yt],(n,[e])=>Math.atan(e.evaluate(n))],min:[yt,co(yt),(n,e)=>Math.min(...e.map(o=>o.evaluate(n)))],max:[yt,co(yt),(n,e)=>Math.max(...e.map(o=>o.evaluate(n)))],abs:[yt,[yt],(n,[e])=>Math.abs(e.evaluate(n))],round:[yt,[yt],(n,[e])=>{const o=e.evaluate(n);return o<0?-Math.round(-o):Math.round(o)}],floor:[yt,[yt],(n,[e])=>Math.floor(e.evaluate(n))],ceil:[yt,[yt],(n,[e])=>Math.ceil(e.evaluate(n))],"filter-==":[Zt,[qt,Lt],(n,[e,o])=>n.properties()[e.value]===o.value],"filter-id-==":[Zt,[Lt],(n,[e])=>n.id()===e.value],"filter-type-==":[Zt,[qt],(n,[e])=>n.geometryType()===e.value],"filter-<":[Zt,[qt,Lt],(n,[e,o])=>{const u=n.properties()[e.value],f=o.value;return typeof u==typeof f&&u<f}],"filter-id-<":[Zt,[Lt],(n,[e])=>{const o=n.id(),u=e.value;return typeof o==typeof u&&o<u}],"filter->":[Zt,[qt,Lt],(n,[e,o])=>{const u=n.properties()[e.value],f=o.value;return typeof u==typeof f&&u>f}],"filter-id->":[Zt,[Lt],(n,[e])=>{const o=n.id(),u=e.value;return typeof o==typeof u&&o>u}],"filter-<=":[Zt,[qt,Lt],(n,[e,o])=>{const u=n.properties()[e.value],f=o.value;return typeof u==typeof f&&u<=f}],"filter-id-<=":[Zt,[Lt],(n,[e])=>{const o=n.id(),u=e.value;return typeof o==typeof u&&o<=u}],"filter->=":[Zt,[qt,Lt],(n,[e,o])=>{const u=n.properties()[e.value],f=o.value;return typeof u==typeof f&&u>=f}],"filter-id->=":[Zt,[Lt],(n,[e])=>{const o=n.id(),u=e.value;return typeof o==typeof u&&o>=u}],"filter-has":[Zt,[Lt],(n,[e])=>e.value in n.properties()],"filter-has-id":[Zt,[],n=>n.id()!==null&&n.id()!==void 0],"filter-type-in":[Zt,[lr(qt)],(n,[e])=>e.value.indexOf(n.geometryType())>=0],"filter-id-in":[Zt,[lr(Lt)],(n,[e])=>e.value.indexOf(n.id())>=0],"filter-in-small":[Zt,[qt,lr(Lt)],(n,[e,o])=>o.value.indexOf(n.properties()[e.value])>=0],"filter-in-large":[Zt,[qt,lr(Lt)],(n,[e,o])=>function(u,f,g,v){for(;g<=v;){const t=g+v>>1;if(f[t]===u)return!0;f[t]>u?v=t-1:g=t+1}return!1}(n.properties()[e.value],o.value,0,o.value.length-1)],all:{type:Zt,overloads:[[[Zt,Zt],(n,[e,o])=>e.evaluate(n)&&o.evaluate(n)],[co(Zt),(n,e)=>{for(const o of e)if(!o.evaluate(n))return!1;return!0}]]},any:{type:Zt,overloads:[[[Zt,Zt],(n,[e,o])=>e.evaluate(n)||o.evaluate(n)],[co(Zt),(n,e)=>{for(const o of e)if(o.evaluate(n))return!0;return!1}]]},"!":[Zt,[Zt],(n,[e])=>!e.evaluate(n)],"is-supported-script":[Zt,[qt],(n,[e])=>{const o=n.globals&&n.globals.isSupportedScript;return!o||o(e.evaluate(n))}],upcase:[qt,[qt],(n,[e])=>e.evaluate(n).toUpperCase()],downcase:[qt,[qt],(n,[e])=>e.evaluate(n).toLowerCase()],concat:[qt,co(Lt),(n,e)=>e.map(o=>at(o.evaluate(n))).join("")],"resolved-locale":[qt,[gr],(n,[e])=>e.evaluate(n).resolvedLocale()]});class ou{constructor(e,o){this.expression=e,this._warningHistory={},this._evaluator=new Xt,this._defaultValue=o?function(u){return u.type==="color"&&Vo(u.default)?new X(0,0,0,0):u.type==="color"?X.parse(u.default)||null:u.type==="padding"?ke.parse(u.default)||null:u.default===void 0?null:u.default}(o):null,this._enumValues=o&&o.type==="enum"?o.values:null}evaluateWithoutErrorHandling(e,o,u,f,g,v){return this._evaluator.globals=e,this._evaluator.feature=o,this._evaluator.featureState=u,this._evaluator.canonical=f,this._evaluator.availableImages=g||null,this._evaluator.formattedSection=v,this.expression.evaluate(this._evaluator)}evaluate(e,o,u,f,g,v){this._evaluator.globals=e,this._evaluator.feature=o||null,this._evaluator.featureState=u||null,this._evaluator.canonical=f,this._evaluator.availableImages=g||null,this._evaluator.formattedSection=v||null;try{const t=this.expression.evaluate(this._evaluator);if(t==null||typeof t=="number"&&t!=t)return this._defaultValue;if(this._enumValues&&!(t in this._enumValues))throw new zt(`Expected value to be one of ${Object.keys(this._enumValues).map(i=>JSON.stringify(i)).join(", ")}, but found ${JSON.stringify(t)} instead.`);return t}catch(t){return this._warningHistory[t.message]||(this._warningHistory[t.message]=!0,typeof console<"u"&&console.warn(t.message)),this._defaultValue}}}function Ss(n){return Array.isArray(n)&&n.length>0&&typeof n[0]=="string"&&n[0]in Wi}function aa(n,e){const o=new Qs(Wi,[],e?function(f){const g={color:qr,string:qt,number:yt,enum:qt,boolean:Zt,formatted:Ar,padding:Lr,resolvedImage:Kr};return f.type==="array"?lr(g[f.value]||Lt,f.length):g[f.type]}(e):void 0),u=o.parse(n,void 0,void 0,void 0,e&&e.type==="string"?{typeAnnotation:"coerce"}:void 0);return u?ll(new ou(u,e)):ws(o.errors)}class ul{constructor(e,o){this.kind=e,this._styleExpression=o,this.isStateDependent=e!=="constant"&&!lo(o.expression)}evaluateWithoutErrorHandling(e,o,u,f,g,v){return this._styleExpression.evaluateWithoutErrorHandling(e,o,u,f,g,v)}evaluate(e,o,u,f,g,v){return this._styleExpression.evaluate(e,o,u,f,g,v)}}class la{constructor(e,o,u,f){this.kind=e,this.zoomStops=u,this._styleExpression=o,this.isStateDependent=e!=="camera"&&!lo(o.expression),this.interpolationType=f}evaluateWithoutErrorHandling(e,o,u,f,g,v){return this._styleExpression.evaluateWithoutErrorHandling(e,o,u,f,g,v)}evaluate(e,o,u,f,g,v){return this._styleExpression.evaluate(e,o,u,f,g,v)}interpolationFactor(e,o,u){return this.interpolationType?yn.interpolationFactor(this.interpolationType,e,o,u):0}}function Zu(n,e){const o=aa(n,e);if(o.result==="error")return o;const u=o.value.expression,f=rl(u);if(!f&&!bs(e))return ws([new Qt("","data expressions not supported")]);const g=wr(u,["zoom"]);if(!g&&!Jr(e))return ws([new Qt("","zoom expressions not supported")]);const v=hl(u);return v||g?v instanceof Qt?ws([v]):v instanceof yn&&!nu(e)?ws([new Qt("",'"interpolate" expressions cannot be used with this property')]):ll(v?new la(f?"camera":"composite",o.value,v.labels,v instanceof yn?v.interpolation:void 0):new ul(f?"constant":"source",o.value)):ws([new Qt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class cl{constructor(e,o){this._parameters=e,this._specification=o,kr(this,Br(this._parameters,this._specification))}static deserialize(e){return new cl(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}}function hl(n){let e=null;if(n instanceof ol)e=hl(n.result);else if(n instanceof il){for(const o of n.args)if(e=hl(o),e)break}else(n instanceof ds||n instanceof yn)&&n.input instanceof Kt&&n.input.name==="zoom"&&(e=n);return e instanceof Qt||n.eachChild(o=>{const u=hl(o);u instanceof Qt?e=u:!e&&u?e=new Qt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&u&&e!==u&&(e=new Qt("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),e}function xi(n){const e=n.key,o=n.value,u=n.valueSpec||{},f=n.objectElementValidators||{},g=n.style,v=n.styleSpec;let t=[];const i=Bt(o);if(i!=="object")return[new Je(e,o,`object expected, ${i} found`)];for(const a in o){const h=a.split(".")[0],y=u[h]||u["*"];let w;if(f[h])w=f[h];else if(u[h])w=Pn;else if(f["*"])w=f["*"];else{if(!u["*"]){t.push(new Je(e,o[a],`unknown property "${a}"`));continue}w=Pn}t=t.concat(w({key:(e&&`${e}.`)+a,value:o[a],valueSpec:y,style:g,styleSpec:v,object:o,objectKey:a},o))}for(const a in u)f[a]||u[a].required&&u[a].default===void 0&&o[a]===void 0&&t.push(new Je(e,o,`missing required property "${a}"`));return t}function dl(n){const e=n.value,o=n.valueSpec,u=n.style,f=n.styleSpec,g=n.key,v=n.arrayElementValidator||Pn;if(Bt(e)!=="array")return[new Je(g,e,`array expected, ${Bt(e)} found`)];if(o.length&&e.length!==o.length)return[new Je(g,e,`array length ${o.length} expected, length ${e.length} found`)];if(o["min-length"]&&e.length<o["min-length"])return[new Je(g,e,`array length at least ${o["min-length"]} expected, length ${e.length} found`)];let t={type:o.value,values:o.values};f.$version<7&&(t.function=o.function),Bt(o.value)==="object"&&(t=o.value);let i=[];for(let a=0;a<e.length;a++)i=i.concat(v({array:e,arrayIndex:a,value:e[a],valueSpec:t,style:u,styleSpec:f,key:`${g}[${a}]`}));return i}function $o(n){const e=n.key,o=n.value,u=n.valueSpec;let f=Bt(o);return f==="number"&&o!=o&&(f="NaN"),f!=="number"?[new Je(e,o,`number expected, ${f} found`)]:"minimum"in u&&o<u.minimum?[new Je(e,o,`${o} is less than the minimum value ${u.minimum}`)]:"maximum"in u&&o>u.maximum?[new Je(e,o,`${o} is greater than the maximum value ${u.maximum}`)]:[]}function qu(n){const e=n.valueSpec,o=Wt(n.value.type);let u,f,g,v={};const t=o!=="categorical"&&n.value.property===void 0,i=!t,a=Bt(n.value.stops)==="array"&&Bt(n.value.stops[0])==="array"&&Bt(n.value.stops[0][0])==="object",h=xi({key:n.key,value:n.value,valueSpec:n.styleSpec.function,style:n.style,styleSpec:n.styleSpec,objectElementValidators:{stops:function(E){if(o==="identity")return[new Je(E.key,E.value,'identity function may not have a "stops" property')];let z=[];const N=E.value;return z=z.concat(dl({key:E.key,value:N,valueSpec:E.valueSpec,style:E.style,styleSpec:E.styleSpec,arrayElementValidator:y})),Bt(N)==="array"&&N.length===0&&z.push(new Je(E.key,N,"array must have at least one stop")),z},default:function(E){return Pn({key:E.key,value:E.value,valueSpec:e,style:E.style,styleSpec:E.styleSpec})}}});return o==="identity"&&t&&h.push(new Je(n.key,n.value,'missing required property "property"')),o==="identity"||n.value.stops||h.push(new Je(n.key,n.value,'missing required property "stops"')),o==="exponential"&&n.valueSpec.expression&&!nu(n.valueSpec)&&h.push(new Je(n.key,n.value,"exponential functions not supported")),n.styleSpec.$version>=8&&(i&&!bs(n.valueSpec)?h.push(new Je(n.key,n.value,"property functions not supported")):t&&!Jr(n.valueSpec)&&h.push(new Je(n.key,n.value,"zoom functions not supported"))),o!=="categorical"&&!a||n.value.property!==void 0||h.push(new Je(n.key,n.value,'"property" property is required')),h;function y(E){let z=[];const N=E.value,W=E.key;if(Bt(N)!=="array")return[new Je(W,N,`array expected, ${Bt(N)} found`)];if(N.length!==2)return[new Je(W,N,`array length 2 expected, length ${N.length} found`)];if(a){if(Bt(N[0])!=="object")return[new Je(W,N,`object expected, ${Bt(N[0])} found`)];if(N[0].zoom===void 0)return[new Je(W,N,"object stop key must have zoom")];if(N[0].value===void 0)return[new Je(W,N,"object stop key must have value")];if(g&&g>Wt(N[0].zoom))return[new Je(W,N[0].zoom,"stop zoom values must appear in ascending order")];Wt(N[0].zoom)!==g&&(g=Wt(N[0].zoom),f=void 0,v={}),z=z.concat(xi({key:`${W}[0]`,value:N[0],valueSpec:{zoom:{}},style:E.style,styleSpec:E.styleSpec,objectElementValidators:{zoom:$o,value:w}}))}else z=z.concat(w({key:`${W}[0]`,value:N[0],style:E.style,styleSpec:E.styleSpec},N));return Ss(vr(N[1]))?z.concat([new Je(`${W}[1]`,N[1],"expressions are not allowed in function stops.")]):z.concat(Pn({key:`${W}[1]`,value:N[1],valueSpec:e,style:E.style,styleSpec:E.styleSpec}))}function w(E,z){const N=Bt(E.value),W=Wt(E.value),se=E.value!==null?E.value:z;if(u){if(N!==u)return[new Je(E.key,se,`${N} stop domain type must match previous stop domain type ${u}`)]}else u=N;if(N!=="number"&&N!=="string"&&N!=="boolean")return[new Je(E.key,se,"stop domain value must be a number, string, or boolean")];if(N!=="number"&&o!=="categorical"){let pe=`number expected, ${N} found`;return bs(e)&&o===void 0&&(pe+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Je(E.key,se,pe)]}return o!=="categorical"||N!=="number"||isFinite(W)&&Math.floor(W)===W?o!=="categorical"&&N==="number"&&f!==void 0&&W<f?[new Je(E.key,se,"stop domain values must appear in ascending order")]:(f=W,o==="categorical"&&W in v?[new Je(E.key,se,"stop domain values must be unique")]:(v[W]=!0,[])):[new Je(E.key,se,`integer expected, found ${W}`)]}}function Go(n){const e=(n.expressionContext==="property"?Zu:aa)(vr(n.value),n.valueSpec);if(e.result==="error")return e.value.map(u=>new Je(`${n.key}${u.key}`,n.value,u.message));const o=e.value.expression||e.value._styleExpression.expression;if(n.expressionContext==="property"&&n.propertyKey==="text-font"&&!o.outputDefined())return[new Je(n.key,n.value,`Invalid data expression for "${n.propertyKey}". Output values must be contained as literals within the expression.`)];if(n.expressionContext==="property"&&n.propertyType==="layout"&&!lo(o))return[new Je(n.key,n.value,'"feature-state" data expressions are not supported with layout properties.')];if(n.expressionContext==="filter"&&!lo(o))return[new Je(n.key,n.value,'"feature-state" data expressions are not supported with filters.')];if(n.expressionContext&&n.expressionContext.indexOf("cluster")===0){if(!wr(o,["zoom","feature-state"]))return[new Je(n.key,n.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(n.expressionContext==="cluster-initial"&&!rl(o))return[new Je(n.key,n.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Es(n){const e=n.key,o=n.value,u=n.valueSpec,f=[];return Array.isArray(u.values)?u.values.indexOf(Wt(o))===-1&&f.push(new Je(e,o,`expected one of [${u.values.join(", ")}], ${JSON.stringify(o)} found`)):Object.keys(u.values).indexOf(Wt(o))===-1&&f.push(new Je(e,o,`expected one of [${Object.keys(u.values).join(", ")}], ${JSON.stringify(o)} found`)),f}function ua(n){if(n===!0||n===!1)return!0;if(!Array.isArray(n)||n.length===0)return!1;switch(n[0]){case"has":return n.length>=2&&n[1]!=="$id"&&n[1]!=="$type";case"in":return n.length>=3&&(typeof n[1]!="string"||Array.isArray(n[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return n.length!==3||Array.isArray(n[1])||Array.isArray(n[2]);case"any":case"all":for(const e of n.slice(1))if(!ua(e)&&typeof e!="boolean")return!1;return!0;default:return!0}}const ca={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function fl(n){if(n==null)return{filter:()=>!0,needGeometry:!1};ua(n)||(n=pl(n));const e=aa(n,ca);if(e.result==="error")throw new Error(e.value.map(o=>`${o.key}: ${o.message}`).join(", "));return{filter:(o,u,f)=>e.value.evaluate(o,u,{},f),needGeometry:su(n)}}function Zo(n,e){return n<e?-1:n>e?1:0}function su(n){if(!Array.isArray(n))return!1;if(n[0]==="within")return!0;for(let e=1;e<n.length;e++)if(su(n[e]))return!0;return!1}function pl(n){if(!n)return!0;const e=n[0];return n.length<=1?e!=="any":e==="=="?ml(n[1],n[2],"=="):e==="!="?wi(ml(n[1],n[2],"==")):e==="<"||e===">"||e==="<="||e===">="?ml(n[1],n[2],e):e==="any"?(o=n.slice(1),["any"].concat(o.map(pl))):e==="all"?["all"].concat(n.slice(1).map(pl)):e==="none"?["all"].concat(n.slice(1).map(pl).map(wi)):e==="in"?au(n[1],n.slice(2)):e==="!in"?wi(au(n[1],n.slice(2))):e==="has"?ha(n[1]):e==="!has"?wi(ha(n[1])):e!=="within"||n;var o}function ml(n,e,o){switch(n){case"$type":return[`filter-type-${o}`,e];case"$id":return[`filter-id-${o}`,e];default:return[`filter-${o}`,n,e]}}function au(n,e){if(e.length===0)return!1;switch(n){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(o=>typeof o!=typeof e[0])?["filter-in-large",n,["literal",e.sort(Zo)]]:["filter-in-small",n,["literal",e]]}}function ha(n){switch(n){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",n]}}function wi(n){return["!",n]}function Hi(n){return ua(vr(n.value))?Go(kr({},n,{expressionContext:"filter",valueSpec:{value:"boolean"}})):gl(n)}function gl(n){const e=n.value,o=n.key;if(Bt(e)!=="array")return[new Je(o,e,`array expected, ${Bt(e)} found`)];const u=n.styleSpec;let f,g=[];if(e.length<1)return[new Je(o,e,"filter array must have at least 1 element")];switch(g=g.concat(Es({key:`${o}[0]`,value:e[0],valueSpec:u.filter_operator,style:n.style,styleSpec:n.styleSpec})),Wt(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&Wt(e[1])==="$type"&&g.push(new Je(o,e,`"$type" cannot be use with operator "${e[0]}"`));case"==":case"!=":e.length!==3&&g.push(new Je(o,e,`filter array for operator "${e[0]}" must have 3 elements`));case"in":case"!in":e.length>=2&&(f=Bt(e[1]),f!=="string"&&g.push(new Je(`${o}[1]`,e[1],`string expected, ${f} found`)));for(let v=2;v<e.length;v++)f=Bt(e[v]),Wt(e[1])==="$type"?g=g.concat(Es({key:`${o}[${v}]`,value:e[v],valueSpec:u.geometry_type,style:n.style,styleSpec:n.styleSpec})):f!=="string"&&f!=="number"&&f!=="boolean"&&g.push(new Je(`${o}[${v}]`,e[v],`string, number, or boolean expected, ${f} found`));break;case"any":case"all":case"none":for(let v=1;v<e.length;v++)g=g.concat(gl({key:`${o}[${v}]`,value:e[v],style:n.style,styleSpec:n.styleSpec}));break;case"has":case"!has":f=Bt(e[1]),e.length!==2?g.push(new Je(o,e,`filter array for "${e[0]}" operator must have 2 elements`)):f!=="string"&&g.push(new Je(`${o}[1]`,e[1],`string expected, ${f} found`));break;case"within":f=Bt(e[1]),e.length!==2?g.push(new Je(o,e,`filter array for "${e[0]}" operator must have 2 elements`)):f!=="object"&&g.push(new Je(`${o}[1]`,e[1],`object expected, ${f} found`))}return g}function da(n,e){const o=n.key,u=n.style,f=n.styleSpec,g=n.value,v=n.objectKey,t=f[`${e}_${n.layerType}`];if(!t)return[];const i=v.match(/^(.*)-transition$/);if(e==="paint"&&i&&t[i[1]]&&t[i[1]].transition)return Pn({key:o,value:g,valueSpec:f.transition,style:u,styleSpec:f});const a=n.valueSpec||t[v];if(!a)return[new Je(o,g,`unknown property "${v}"`)];let h;if(Bt(g)==="string"&&bs(a)&&!a.tokens&&(h=/^{([^}]+)}$/.exec(g)))return[new Je(o,g,`"${v}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(h[1])} }\`.`)];const y=[];return n.layerType==="symbol"&&(v==="text-field"&&u&&!u.glyphs&&y.push(new Je(o,g,'use of "text-field" requires a style "glyphs" property')),v==="text-font"&&Vo(vr(g))&&Wt(g.type)==="identity"&&y.push(new Je(o,g,'"text-font" does not support identity functions'))),y.concat(Pn({key:n.key,value:g,valueSpec:a,style:u,styleSpec:f,expressionContext:"property",propertyType:e,propertyKey:v}))}function fa(n){return da(n,"paint")}function lu(n){return da(n,"layout")}function yl(n){let e=[];const o=n.value,u=n.key,f=n.style,g=n.styleSpec;o.type||o.ref||e.push(new Je(u,o,'either "type" or "ref" is required'));let v=Wt(o.type);const t=Wt(o.ref);if(o.id){const i=Wt(o.id);for(let a=0;a<n.arrayIndex;a++){const h=f.layers[a];Wt(h.id)===i&&e.push(new Je(u,o.id,`duplicate layer id "${o.id}", previously used at line ${h.id.__line__}`))}}if("ref"in o){let i;["type","source","source-layer","filter","layout"].forEach(a=>{a in o&&e.push(new Je(u,o[a],`"${a}" is prohibited for ref layers`))}),f.layers.forEach(a=>{Wt(a.id)===t&&(i=a)}),i?i.ref?e.push(new Je(u,o.ref,"ref cannot reference another ref layer")):v=Wt(i.type):e.push(new Je(u,o.ref,`ref layer "${t}" not found`))}else if(v!=="background")if(o.source){const i=f.sources&&f.sources[o.source],a=i&&Wt(i.type);i?a==="vector"&&v==="raster"?e.push(new Je(u,o.source,`layer "${o.id}" requires a raster source`)):a==="raster"&&v!=="raster"?e.push(new Je(u,o.source,`layer "${o.id}" requires a vector source`)):a!=="vector"||o["source-layer"]?a==="raster-dem"&&v!=="hillshade"?e.push(new Je(u,o.source,"raster-dem source can only be used with layer type 'hillshade'.")):v!=="line"||!o.paint||!o.paint["line-gradient"]||a==="geojson"&&i.lineMetrics||e.push(new Je(u,o,`layer "${o.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):e.push(new Je(u,o,`layer "${o.id}" must specify a "source-layer"`)):e.push(new Je(u,o.source,`source "${o.source}" not found`))}else e.push(new Je(u,o,'missing required property "source"'));return e=e.concat(xi({key:u,value:o,valueSpec:g.layer,style:n.style,styleSpec:n.styleSpec,objectElementValidators:{"*":()=>[],type:()=>Pn({key:`${u}.type`,value:o.type,valueSpec:g.layer.type,style:n.style,styleSpec:n.styleSpec,object:o,objectKey:"type"}),filter:Hi,layout:i=>xi({layer:o,key:i.key,value:i.value,style:i.style,styleSpec:i.styleSpec,objectElementValidators:{"*":a=>lu(kr({layerType:v},a))}}),paint:i=>xi({layer:o,key:i.key,value:i.value,style:i.style,styleSpec:i.styleSpec,objectElementValidators:{"*":a=>fa(kr({layerType:v},a))}})}})),e}function fo(n){const e=n.value,o=n.key,u=Bt(e);return u!=="string"?[new Je(o,e,`string expected, ${u} found`)]:[]}const uu={promoteId:function({key:n,value:e}){if(Bt(e)==="string")return fo({key:n,value:e});{const o=[];for(const u in e)o.push(...fo({key:`${n}.${u}`,value:e[u]}));return o}}};function cu(n){const e=n.value,o=n.key,u=n.styleSpec,f=n.style;if(!e.type)return[new Je(o,e,'"type" is required')];const g=Wt(e.type);let v;switch(g){case"vector":case"raster":case"raster-dem":return v=xi({key:o,value:e,valueSpec:u[`source_${g.replace("-","_")}`],style:n.style,styleSpec:u,objectElementValidators:uu}),v;case"geojson":if(v=xi({key:o,value:e,valueSpec:u.source_geojson,style:f,styleSpec:u,objectElementValidators:uu}),e.cluster)for(const t in e.clusterProperties){const[i,a]=e.clusterProperties[t],h=typeof i=="string"?[i,["accumulated"],["get",t]]:i;v.push(...Go({key:`${o}.${t}.map`,value:a,expressionContext:"cluster-map"})),v.push(...Go({key:`${o}.${t}.reduce`,value:h,expressionContext:"cluster-reduce"}))}return v;case"video":return xi({key:o,value:e,valueSpec:u.source_video,style:f,styleSpec:u});case"image":return xi({key:o,value:e,valueSpec:u.source_image,style:f,styleSpec:u});case"canvas":return[new Je(o,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Es({key:`${o}.type`,value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function Ts(n){const e=n.value,o=n.styleSpec,u=o.light,f=n.style;let g=[];const v=Bt(e);if(e===void 0)return g;if(v!=="object")return g=g.concat([new Je("light",e,`object expected, ${v} found`)]),g;for(const t in e){const i=t.match(/^(.*)-transition$/);g=g.concat(i&&u[i[1]]&&u[i[1]].transition?Pn({key:t,value:e[t],valueSpec:o.transition,style:f,styleSpec:o}):u[t]?Pn({key:t,value:e[t],valueSpec:u[t],style:f,styleSpec:o}):[new Je(t,e[t],`unknown property "${t}"`)])}return g}function pa(n){const e=n.value,o=n.styleSpec,u=o.terrain,f=n.style;let g=[];const v=Bt(e);if(e===void 0)return g;if(v!=="object")return g=g.concat([new Je("terrain",e,`object expected, ${v} found`)]),g;for(const t in e)g=g.concat(u[t]?Pn({key:t,value:e[t],valueSpec:u[t],style:f,styleSpec:o}):[new Je(t,e[t],`unknown property "${t}"`)]);return g}const ni={"*":()=>[],array:dl,boolean:function(n){const e=n.value,o=n.key,u=Bt(e);return u!=="boolean"?[new Je(o,e,`boolean expected, ${u} found`)]:[]},number:$o,color:function(n){const e=n.key,o=n.value,u=Bt(o);return u!=="string"?[new Je(e,o,`color expected, ${u} found`)]:Hn(o)===null?[new Je(e,o,`color expected, "${o}" found`)]:[]},constants:xr,enum:Es,filter:Hi,function:qu,layer:yl,object:xi,source:cu,light:Ts,terrain:pa,string:fo,formatted:function(n){return fo(n).length===0?[]:Go(n)},resolvedImage:function(n){return fo(n).length===0?[]:Go(n)},padding:function(n){const e=n.key,o=n.value;if(Bt(o)==="array"){if(o.length<1||o.length>4)return[new Je(e,o,`padding requires 1 to 4 values; ${o.length} values found`)];const u={type:"number"};let f=[];for(let g=0;g<o.length;g++)f=f.concat(Pn({key:`${e}[${g}]`,value:o[g],valueSpec:u}));return f}return $o({key:e,value:o,valueSpec:{}})}};function Pn(n){const e=n.value,o=n.valueSpec,u=n.styleSpec;return o.expression&&Vo(Wt(e))?qu(n):o.expression&&Ss(vr(e))?Go(n):o.type&&ni[o.type]?ni[o.type](n):xi(kr({},n,{valueSpec:o.type?u[o.type]:o}))}function Hc(n){const e=n.value,o=n.key,u=fo(n);return u.length||(e.indexOf("{fontstack}")===-1&&u.push(new Je(o,e,'"glyphs" url must include a "{fontstack}" token')),e.indexOf("{range}")===-1&&u.push(new Je(o,e,'"glyphs" url must include a "{range}" token'))),u}function po(n,e=Me){let o=[];return o=o.concat(Pn({key:"",value:n,valueSpec:e.$root,styleSpec:e,style:n,objectElementValidators:{glyphs:Hc,"*":()=>[]}})),n.constants&&(o=o.concat(xr({key:"constants",value:n.constants}))),di(o)}function di(n){return[].concat(n).sort((e,o)=>e.line-o.line)}function bi(n){return function(...e){return di(n.apply(this,e))}}po.source=bi(cu),po.light=bi(Ts),po.terrain=bi(pa),po.layer=bi(yl),po.filter=bi(Hi),po.paintProperty=bi(fa),po.layoutProperty=bi(lu);const mo=po,Wu=mo.light,_l=mo.paintProperty,Hu=mo.layoutProperty;function vl(n,e){let o=!1;if(e&&e.length)for(const u of e)n.fire(new Qe(new Error(u.message))),o=!0;return o}class qo{constructor(e,o,u){const f=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;const v=new Int32Array(this.arrayBuffer);e=v[0],this.d=(o=v[1])+2*(u=v[2]);for(let i=0;i<this.d*this.d;i++){const a=v[3+i],h=v[3+i+1];f.push(a===h?null:v.subarray(a,h))}const t=v[3+f.length+1];this.keys=v.subarray(v[3+f.length],t),this.bboxes=v.subarray(t),this.insert=this._insertReadonly}else{this.d=o+2*u;for(let v=0;v<this.d*this.d;v++)f.push([]);this.keys=[],this.bboxes=[]}this.n=o,this.extent=e,this.padding=u,this.scale=o/e,this.uid=0;const g=u/o*e;this.min=-g,this.max=e+g}insert(e,o,u,f,g){this._forEachCell(o,u,f,g,this._insertCell,this.uid++,void 0,void 0),this.keys.push(e),this.bboxes.push(o),this.bboxes.push(u),this.bboxes.push(f),this.bboxes.push(g)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(e,o,u,f,g,v){this.cells[g].push(v)}query(e,o,u,f,g){const v=this.min,t=this.max;if(e<=v&&o<=v&&t<=u&&t<=f&&!g)return Array.prototype.slice.call(this.keys);{const i=[];return this._forEachCell(e,o,u,f,this._queryCell,i,{},g),i}}_queryCell(e,o,u,f,g,v,t,i){const a=this.cells[g];if(a!==null){const h=this.keys,y=this.bboxes;for(let w=0;w<a.length;w++){const E=a[w];if(t[E]===void 0){const z=4*E;(i?i(y[z+0],y[z+1],y[z+2],y[z+3]):e<=y[z+2]&&o<=y[z+3]&&u>=y[z+0]&&f>=y[z+1])?(t[E]=!0,v.push(h[E])):t[E]=!1}}}}_forEachCell(e,o,u,f,g,v,t,i){const a=this._convertToCellCoord(e),h=this._convertToCellCoord(o),y=this._convertToCellCoord(u),w=this._convertToCellCoord(f);for(let E=a;E<=y;E++)for(let z=h;z<=w;z++){const N=this.d*z+E;if((!i||i(this._convertFromCellCoord(E),this._convertFromCellCoord(z),this._convertFromCellCoord(E+1),this._convertFromCellCoord(z+1)))&&g.call(this,e,o,u,f,N,v,t,i))return}}_convertFromCellCoord(e){return(e-this.padding)/this.scale}_convertToCellCoord(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const e=this.cells,o=3+this.cells.length+1+1;let u=0;for(let v=0;v<this.cells.length;v++)u+=this.cells[v].length;const f=new Int32Array(o+u+this.keys.length+this.bboxes.length);f[0]=this.extent,f[1]=this.n,f[2]=this.padding;let g=o;for(let v=0;v<e.length;v++){const t=e[v];f[3+v]=g,f.set(t,g),g+=t.length}return f[3+e.length]=g,f.set(this.keys,g),g+=this.keys.length,f[3+e.length+1]=g,f.set(this.bboxes,g),g+=this.bboxes.length,f.buffer}static serialize(e,o){const u=e.toArrayBuffer();return o&&o.push(u),{buffer:u}}static deserialize(e){return new qo(e.buffer)}}const go={};function Pt(n,e,o={}){if(go[n])throw new Error(`${n} is already registered.`);Object.defineProperty(e,"_classRegistryKey",{value:n,writeable:!1}),go[n]={klass:e,omit:o.omit||[],shallow:o.shallow||[]}}Pt("Object",Object),Pt("TransferableGridIndex",qo),Pt("Color",X),Pt("Error",Error),Pt("AJAXError",sr),Pt("ResolvedImage",xe),Pt("StylePropertyFunction",cl),Pt("StyleExpression",ou,{omit:["_evaluator"]}),Pt("ZoomDependentExpression",la),Pt("ZoomConstantExpression",ul),Pt("CompoundExpression",Kt,{omit:["_evaluate"]});for(const n in Wi)Wi[n]._classRegistryKey||Pt(`Expression_${n}`,Wi[n]);function ma(n){return n&&typeof ArrayBuffer<"u"&&(n instanceof ArrayBuffer||n.constructor&&n.constructor.name==="ArrayBuffer")}function Xi(n,e){if(n==null||typeof n=="boolean"||typeof n=="number"||typeof n=="string"||n instanceof Boolean||n instanceof Number||n instanceof String||n instanceof Date||n instanceof RegExp||n instanceof Blob)return n;if(ma(n)||j(n))return e&&e.push(n),n;if(ArrayBuffer.isView(n)){const o=n;return e&&e.push(o.buffer),o}if(n instanceof ImageData)return e&&e.push(n.data.buffer),n;if(Array.isArray(n)){const o=[];for(const u of n)o.push(Xi(u,e));return o}if(typeof n=="object"){const o=n.constructor,u=o._classRegistryKey;if(!u)throw new Error("can't serialize object of unregistered class");if(!go[u])throw new Error(`${u} is not registered.`);const f=o.serialize?o.serialize(n,e):{};if(o.serialize){if(e&&f===e[e.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const g in n){if(!n.hasOwnProperty(g)||go[u].omit.indexOf(g)>=0)continue;const v=n[g];f[g]=go[u].shallow.indexOf(g)>=0?v:Xi(v,e)}n instanceof Error&&(f.message=n.message)}if(f.$name)throw new Error("$name property is reserved for worker serialization logic.");return u!=="Object"&&(f.$name=u),f}throw new Error("can't serialize object of type "+typeof n)}function Ki(n){if(n==null||typeof n=="boolean"||typeof n=="number"||typeof n=="string"||n instanceof Boolean||n instanceof Number||n instanceof String||n instanceof Date||n instanceof RegExp||n instanceof Blob||ma(n)||j(n)||ArrayBuffer.isView(n)||n instanceof ImageData)return n;if(Array.isArray(n))return n.map(Ki);if(typeof n=="object"){const e=n.$name||"Object";if(!go[e])throw new Error(`can't deserialize unregistered class ${e}`);const{klass:o}=go[e];if(!o)throw new Error(`can't deserialize unregistered class ${e}`);if(o.deserialize)return o.deserialize(n);const u=Object.create(o.prototype);for(const f of Object.keys(n)){if(f==="$name")continue;const g=n[f];u[f]=go[e].shallow.indexOf(f)>=0?g:Ki(g)}return u}throw new Error("can't deserialize object of type "+typeof n)}class ks{constructor(){this.first=!0}update(e,o){const u=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=u,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=u,!0):(this.lastFloorZoom>u?(this.lastIntegerZoom=u+1,this.lastIntegerZoomTime=o):this.lastFloorZoom<u&&(this.lastIntegerZoom=u,this.lastIntegerZoomTime=o),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=u,!0))}}const St={"Latin-1 Supplement":n=>n>=128&&n<=255,Arabic:n=>n>=1536&&n<=1791,"Arabic Supplement":n=>n>=1872&&n<=1919,"Arabic Extended-A":n=>n>=2208&&n<=2303,"Hangul Jamo":n=>n>=4352&&n<=4607,"Unified Canadian Aboriginal Syllabics":n=>n>=5120&&n<=5759,Khmer:n=>n>=6016&&n<=6143,"Unified Canadian Aboriginal Syllabics Extended":n=>n>=6320&&n<=6399,"General Punctuation":n=>n>=8192&&n<=8303,"Letterlike Symbols":n=>n>=8448&&n<=8527,"Number Forms":n=>n>=8528&&n<=8591,"Miscellaneous Technical":n=>n>=8960&&n<=9215,"Control Pictures":n=>n>=9216&&n<=9279,"Optical Character Recognition":n=>n>=9280&&n<=9311,"Enclosed Alphanumerics":n=>n>=9312&&n<=9471,"Geometric Shapes":n=>n>=9632&&n<=9727,"Miscellaneous Symbols":n=>n>=9728&&n<=9983,"Miscellaneous Symbols and Arrows":n=>n>=11008&&n<=11263,"CJK Radicals Supplement":n=>n>=11904&&n<=12031,"Kangxi Radicals":n=>n>=12032&&n<=12255,"Ideographic Description Characters":n=>n>=12272&&n<=12287,"CJK Symbols and Punctuation":n=>n>=12288&&n<=12351,Hiragana:n=>n>=12352&&n<=12447,Katakana:n=>n>=12448&&n<=12543,Bopomofo:n=>n>=12544&&n<=12591,"Hangul Compatibility Jamo":n=>n>=12592&&n<=12687,Kanbun:n=>n>=12688&&n<=12703,"Bopomofo Extended":n=>n>=12704&&n<=12735,"CJK Strokes":n=>n>=12736&&n<=12783,"Katakana Phonetic Extensions":n=>n>=12784&&n<=12799,"Enclosed CJK Letters and Months":n=>n>=12800&&n<=13055,"CJK Compatibility":n=>n>=13056&&n<=13311,"CJK Unified Ideographs Extension A":n=>n>=13312&&n<=19903,"Yijing Hexagram Symbols":n=>n>=19904&&n<=19967,"CJK Unified Ideographs":n=>n>=19968&&n<=40959,"Yi Syllables":n=>n>=40960&&n<=42127,"Yi Radicals":n=>n>=42128&&n<=42191,"Hangul Jamo Extended-A":n=>n>=43360&&n<=43391,"Hangul Syllables":n=>n>=44032&&n<=55215,"Hangul Jamo Extended-B":n=>n>=55216&&n<=55295,"Private Use Area":n=>n>=57344&&n<=63743,"CJK Compatibility Ideographs":n=>n>=63744&&n<=64255,"Arabic Presentation Forms-A":n=>n>=64336&&n<=65023,"Vertical Forms":n=>n>=65040&&n<=65055,"CJK Compatibility Forms":n=>n>=65072&&n<=65103,"Small Form Variants":n=>n>=65104&&n<=65135,"Arabic Presentation Forms-B":n=>n>=65136&&n<=65279,"Halfwidth and Fullwidth Forms":n=>n>=65280&&n<=65519};function yo(n){for(const e of n)if(_o(e.charCodeAt(0)))return!0;return!1}function xl(n){for(const e of n)if(!Xu(e.charCodeAt(0)))return!1;return!0}function Xu(n){return!(St.Arabic(n)||St["Arabic Supplement"](n)||St["Arabic Extended-A"](n)||St["Arabic Presentation Forms-A"](n)||St["Arabic Presentation Forms-B"](n))}function _o(n){return!(n!==746&&n!==747&&(n<4352||!(St["Bopomofo Extended"](n)||St.Bopomofo(n)||St["CJK Compatibility Forms"](n)&&!(n>=65097&&n<=65103)||St["CJK Compatibility Ideographs"](n)||St["CJK Compatibility"](n)||St["CJK Radicals Supplement"](n)||St["CJK Strokes"](n)||!(!St["CJK Symbols and Punctuation"](n)||n>=12296&&n<=12305||n>=12308&&n<=12319||n===12336)||St["CJK Unified Ideographs Extension A"](n)||St["CJK Unified Ideographs"](n)||St["Enclosed CJK Letters and Months"](n)||St["Hangul Compatibility Jamo"](n)||St["Hangul Jamo Extended-A"](n)||St["Hangul Jamo Extended-B"](n)||St["Hangul Jamo"](n)||St["Hangul Syllables"](n)||St.Hiragana(n)||St["Ideographic Description Characters"](n)||St.Kanbun(n)||St["Kangxi Radicals"](n)||St["Katakana Phonetic Extensions"](n)||St.Katakana(n)&&n!==12540||!(!St["Halfwidth and Fullwidth Forms"](n)||n===65288||n===65289||n===65293||n>=65306&&n<=65310||n===65339||n===65341||n===65343||n>=65371&&n<=65503||n===65507||n>=65512&&n<=65519)||!(!St["Small Form Variants"](n)||n>=65112&&n<=65118||n>=65123&&n<=65126)||St["Unified Canadian Aboriginal Syllabics"](n)||St["Unified Canadian Aboriginal Syllabics Extended"](n)||St["Vertical Forms"](n)||St["Yijing Hexagram Symbols"](n)||St["Yi Syllables"](n)||St["Yi Radicals"](n))))}function hu(n){return!(_o(n)||function(e){return!!(St["Latin-1 Supplement"](e)&&(e===167||e===169||e===174||e===177||e===188||e===189||e===190||e===215||e===247)||St["General Punctuation"](e)&&(e===8214||e===8224||e===8225||e===8240||e===8241||e===8251||e===8252||e===8258||e===8263||e===8264||e===8265||e===8273)||St["Letterlike Symbols"](e)||St["Number Forms"](e)||St["Miscellaneous Technical"](e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||e===9003||e>=9085&&e<=9114||e>=9150&&e<=9165||e===9167||e>=9169&&e<=9179||e>=9186&&e<=9215)||St["Control Pictures"](e)&&e!==9251||St["Optical Character Recognition"](e)||St["Enclosed Alphanumerics"](e)||St["Geometric Shapes"](e)||St["Miscellaneous Symbols"](e)&&!(e>=9754&&e<=9759)||St["Miscellaneous Symbols and Arrows"](e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||St["CJK Symbols and Punctuation"](e)||St.Katakana(e)||St["Private Use Area"](e)||St["CJK Compatibility Forms"](e)||St["Small Form Variants"](e)||St["Halfwidth and Fullwidth Forms"](e)||e===8734||e===8756||e===8757||e>=9984&&e<=10087||e>=10102&&e<=10131||e===65532||e===65533)}(n))}function du(n){return n>=1424&&n<=2303||St["Arabic Presentation Forms-A"](n)||St["Arabic Presentation Forms-B"](n)}function Ku(n,e){return!(!e&&du(n)||n>=2304&&n<=3583||n>=3840&&n<=4255||St.Khmer(n))}function Yu(n){for(const e of n)if(du(e.charCodeAt(0)))return!0;return!1}const ga="deferred",wl="loading",Li="loaded";let ya=null,Mn="unavailable",vo=null;const Ju=function(n){n&&typeof n=="string"&&n.indexOf("NetworkError")>-1&&(Mn="error"),ya&&ya(n)};function Wo(){Cs.fire(new We("pluginStateChange",{pluginStatus:Mn,pluginURL:vo}))}const Cs=new kt,bl=function(){return Mn},_a=function(){if(Mn!==ga||!vo)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Mn=wl,Wo(),vo&&He({url:vo},n=>{n?Ju(n):(Mn=Li,Wo())})},_r={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>Mn===Li||_r.applyArabicShaping!=null,isLoading:()=>Mn===wl,setState(n){if(!Ze())throw new Error("Cannot set the state of the rtl-text-plugin when not in the web-worker context");Mn=n.pluginStatus,vo=n.pluginURL},isParsed(){if(!Ze())throw new Error("rtl-text-plugin is only parsed on the worker-threads");return _r.applyArabicShaping!=null&&_r.processBidirectionalText!=null&&_r.processStyledBidirectionalText!=null},getPluginURL(){if(!Ze())throw new Error("rtl-text-plugin url can only be queried from the worker threads");return vo}};class Mr{constructor(e,o){this.zoom=e,o?(this.now=o.now,this.fadeDuration=o.fadeDuration,this.zoomHistory=o.zoomHistory,this.transition=o.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new ks,this.transition={})}isSupportedScript(e){return function(o,u){for(const f of o)if(!Ku(f.charCodeAt(0),u))return!1;return!0}(e,_r.isLoaded())}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const e=this.zoom,o=e-Math.floor(e),u=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:o+(1-o)*u}:{fromScale:.5,toScale:1,t:1-(1-u)*o}}}class Ho{constructor(e,o){this.property=e,this.value=o,this.expression=function(u,f){if(Vo(u))return new cl(u,f);if(Ss(u)){const g=Zu(u,f);if(g.result==="error")throw new Error(g.value.map(v=>`${v.key}: ${v.message}`).join(", "));return g.value}{let g=u;return f.type==="color"&&typeof u=="string"?g=X.parse(u):f.type!=="padding"||typeof u!="number"&&!Array.isArray(u)||(g=ke.parse(u)),{kind:"constant",evaluate:()=>g}}}(o===void 0?e.specification.default:o,e.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(e,o,u){return this.property.possiblyEvaluate(this,e,o,u)}}class xo{constructor(e){this.property=e,this.value=new Ho(e,void 0)}transitioned(e,o){return new El(this.property,this.value,o,Q({},e.transition,this.transition),e.now)}untransitioned(){return new El(this.property,this.value,null,{},0)}}class Sl{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)}getValue(e){return ce(this._values[e].value.value)}setValue(e,o){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new xo(this._values[e].property)),this._values[e].value=new Ho(this._values[e].property,o===null?void 0:ce(o))}getTransition(e){return ce(this._values[e].transition)}setTransition(e,o){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new xo(this._values[e].property)),this._values[e].transition=ce(o)||void 0}serialize(){const e={};for(const o of Object.keys(this._values)){const u=this.getValue(o);u!==void 0&&(e[o]=u);const f=this.getTransition(o);f!==void 0&&(e[`${o}-transition`]=f)}return e}transitioned(e,o){const u=new Is(this._properties);for(const f of Object.keys(this._values))u._values[f]=this._values[f].transitioned(e,o._values[f]);return u}untransitioned(){const e=new Is(this._properties);for(const o of Object.keys(this._values))e._values[o]=this._values[o].untransitioned();return e}}class El{constructor(e,o,u,f,g){this.property=e,this.value=o,this.begin=g+f.delay||0,this.end=this.begin+f.duration||0,e.specification.transition&&(f.delay||f.duration)&&(this.prior=u)}possiblyEvaluate(e,o,u){const f=e.now||0,g=this.value.possiblyEvaluate(e,o,u),v=this.prior;if(v){if(f>this.end)return this.prior=null,g;if(this.value.isDataDriven())return this.prior=null,g;if(f<this.begin)return v.possiblyEvaluate(e,o,u);{const t=(f-this.begin)/(this.end-this.begin);return this.property.interpolate(v.possiblyEvaluate(e,o,u),g,function(i){if(i<=0)return 0;if(i>=1)return 1;const a=i*i,h=a*i;return 4*(i<.5?h:3*(i-a)+h-.75)}(t))}}return g}}class Is{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,o,u){const f=new va(this._properties);for(const g of Object.keys(this._values))f._values[g]=this._values[g].possiblyEvaluate(e,o,u);return f}hasTransition(){for(const e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}}class Tl{constructor(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)}getValue(e){return ce(this._values[e].value)}setValue(e,o){this._values[e]=new Ho(this._values[e].property,o===null?void 0:ce(o))}serialize(){const e={};for(const o of Object.keys(this._values)){const u=this.getValue(o);u!==void 0&&(e[o]=u)}return e}possiblyEvaluate(e,o,u){const f=new va(this._properties);for(const g of Object.keys(this._values))f._values[g]=this._values[g].possiblyEvaluate(e,o,u);return f}}class Vn{constructor(e,o,u){this.property=e,this.value=o,this.parameters=u}isConstant(){return this.value.kind==="constant"}constantOr(e){return this.value.kind==="constant"?this.value.value:e}evaluate(e,o,u,f){return this.property.evaluate(this.value,this.parameters,e,o,u,f)}}class va{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}}class Ot{constructor(e){this.specification=e}possiblyEvaluate(e,o){if(e.isDataDriven())throw new Error("Value should not be data driven");return e.expression.evaluate(o)}interpolate(e,o,u){const f=Oo[this.specification.type];return f?f(e,o,u):e}}class Gt{constructor(e,o){this.specification=e,this.overrides=o}possiblyEvaluate(e,o,u,f){return new Vn(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(o,null,{},u,f)}:e.expression,o)}interpolate(e,o,u){if(e.value.kind!=="constant"||o.value.kind!=="constant")return e;if(e.value.value===void 0||o.value.value===void 0)return new Vn(this,{kind:"constant",value:void 0},e.parameters);const f=Oo[this.specification.type];return f?new Vn(this,{kind:"constant",value:f(e.value.value,o.value.value,u)},e.parameters):e}evaluate(e,o,u,f,g,v){return e.kind==="constant"?e.value:e.evaluate(o,u,f,g,v)}}class As extends Gt{possiblyEvaluate(e,o,u,f){if(e.value===void 0)return new Vn(this,{kind:"constant",value:void 0},o);if(e.expression.kind==="constant"){const g=e.expression.evaluate(o,null,{},u,f),v=e.property.specification.type==="resolvedImage"&&typeof g!="string"?g.name:g,t=this._calculate(v,v,v,o);return new Vn(this,{kind:"constant",value:t},o)}if(e.expression.kind==="camera"){const g=this._calculate(e.expression.evaluate({zoom:o.zoom-1}),e.expression.evaluate({zoom:o.zoom}),e.expression.evaluate({zoom:o.zoom+1}),o);return new Vn(this,{kind:"constant",value:g},o)}return new Vn(this,e.expression,o)}evaluate(e,o,u,f,g,v){if(e.kind==="source"){const t=e.evaluate(o,u,f,g,v);return this._calculate(t,t,t,o)}return e.kind==="composite"?this._calculate(e.evaluate({zoom:Math.floor(o.zoom)-1},u,f),e.evaluate({zoom:Math.floor(o.zoom)},u,f),e.evaluate({zoom:Math.floor(o.zoom)+1},u,f),o):e.value}_calculate(e,o,u,f){return f.zoom>f.zoomHistory.lastIntegerZoom?{from:e,to:o}:{from:u,to:o}}interpolate(e){return e}}class wo{constructor(e){this.specification=e}possiblyEvaluate(e,o,u,f){if(e.value!==void 0){if(e.expression.kind==="constant"){const g=e.expression.evaluate(o,null,{},u,f);return this._calculate(g,g,g,o)}return this._calculate(e.expression.evaluate(new Mr(Math.floor(o.zoom-1),o)),e.expression.evaluate(new Mr(Math.floor(o.zoom),o)),e.expression.evaluate(new Mr(Math.floor(o.zoom+1),o)),o)}}_calculate(e,o,u,f){return f.zoom>f.zoomHistory.lastIntegerZoom?{from:e,to:o}:{from:u,to:o}}interpolate(e){return e}}class zs{constructor(e){this.specification=e}possiblyEvaluate(e,o,u,f){return!!e.expression.evaluate(o,null,{},u,f)}interpolate(){return!1}}class nn{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const o in e){const u=e[o];u.specification.overridable&&this.overridableProperties.push(o);const f=this.defaultPropertyValues[o]=new Ho(u,void 0),g=this.defaultTransitionablePropertyValues[o]=new xo(u);this.defaultTransitioningPropertyValues[o]=g.untransitioned(),this.defaultPossiblyEvaluatedValues[o]=f.possiblyEvaluate({})}}}Pt("DataDrivenProperty",Gt),Pt("DataConstantProperty",Ot),Pt("CrossFadedDataDrivenProperty",As),Pt("CrossFadedProperty",wo),Pt("ColorRampProperty",zs);const Yi="-transition";class Dn extends kt{constructor(e,o){if(super(),this.id=e.id,this.type=e.type,this._featureFilter={filter:()=>!0,needGeometry:!1},e.type!=="custom"&&(this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,e.type!=="background"&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),o.layout&&(this._unevaluatedLayout=new Tl(o.layout)),o.paint)){this._transitionablePaint=new Sl(o.paint);for(const u in e.paint)this.setPaintProperty(u,e.paint[u],{validate:!1});for(const u in e.layout)this.setLayoutProperty(u,e.layout[u],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new va(o.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(e){return e==="visibility"?this.visibility:this._unevaluatedLayout.getValue(e)}setLayoutProperty(e,o,u={}){o!=null&&this._validate(Hu,`layers.${this.id}.layout.${e}`,e,o,u)||(e!=="visibility"?this._unevaluatedLayout.setValue(e,o):this.visibility=o)}getPaintProperty(e){return e.endsWith(Yi)?this._transitionablePaint.getTransition(e.slice(0,-Yi.length)):this._transitionablePaint.getValue(e)}setPaintProperty(e,o,u={}){if(o!=null&&this._validate(_l,`layers.${this.id}.paint.${e}`,e,o,u))return!1;if(e.endsWith(Yi))return this._transitionablePaint.setTransition(e.slice(0,-Yi.length),o||void 0),!1;{const f=this._transitionablePaint._values[e],g=f.property.specification["property-type"]==="cross-faded-data-driven",v=f.value.isDataDriven(),t=f.value;this._transitionablePaint.setValue(e,o),this._handleSpecialPaintPropertyUpdate(e);const i=this._transitionablePaint._values[e].value;return i.isDataDriven()||v||g||this._handleOverridablePaintPropertyUpdate(e,t,i)}}_handleSpecialPaintPropertyUpdate(e){}_handleOverridablePaintPropertyUpdate(e,o,u){return!1}isHidden(e){return!!(this.minzoom&&e<this.minzoom)||!!(this.maxzoom&&e>=this.maxzoom)||this.visibility==="none"}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,o){e.getCrossfadeParameters&&(this._crossfadeParameters=e.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,o)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,o)}serialize(){const e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),ne(e,(o,u)=>!(o===void 0||u==="layout"&&!Object.keys(o).length||u==="paint"&&!Object.keys(o).length))}_validate(e,o,u,f,g={}){return(!g||g.validate!==!1)&&vl(this,e.call(mo,{key:o,layerType:this.type,objectKey:u,value:f,styleSpec:Me,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const e in this.paint._values){const o=this.paint.get(e);if(o instanceof Vn&&bs(o.property.specification)&&(o.value.kind==="source"||o.value.kind==="composite")&&o.value.isStateDependent)return!0}return!1}}const fu={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class xa{constructor(e,o){this._structArray=e,this._pos1=o*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Dr{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,o){return e._trim(),o&&(e.isTransferred=!0,o.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){const o=Object.create(this.prototype);return o.arrayBuffer=e.arrayBuffer,o.length=e.length,o.capacity=e.arrayBuffer.byteLength/o.bytesPerElement,o._refreshViews(),o}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const o=this.uint8;this._refreshViews(),o&&this.uint8.set(o)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function un(n,e=1){let o=0,u=0;return{members:n.map(f=>{const g=fu[f.type].BYTES_PER_ELEMENT,v=o=Qu(o,Math.max(e,g)),t=f.components||1;return u=Math.max(u,g),o+=g*t,{name:f.name,type:f.type,components:t,offset:v}}),size:Qu(o,Math.max(u,e)),alignment:e}}function Qu(n,e){return Math.ceil(n/e)*e}class bo extends Dr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,o){const u=this.length;return this.resize(u+1),this.emplace(u,e,o)}emplace(e,o,u){const f=2*e;return this.int16[f+0]=o,this.int16[f+1]=u,e}}bo.prototype.bytesPerElement=4,Pt("StructArrayLayout2i4",bo);class fi extends Dr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,o,u,f){const g=this.length;return this.resize(g+1),this.emplace(g,e,o,u,f)}emplace(e,o,u,f,g){const v=4*e;return this.int16[v+0]=o,this.int16[v+1]=u,this.int16[v+2]=f,this.int16[v+3]=g,e}}fi.prototype.bytesPerElement=8,Pt("StructArrayLayout4i8",fi);class d extends Dr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,o,u,f,g,v){const t=this.length;return this.resize(t+1),this.emplace(t,e,o,u,f,g,v)}emplace(e,o,u,f,g,v,t){const i=6*e;return this.int16[i+0]=o,this.int16[i+1]=u,this.int16[i+2]=f,this.int16[i+3]=g,this.int16[i+4]=v,this.int16[i+5]=t,e}}d.prototype.bytesPerElement=12,Pt("StructArrayLayout2i4i12",d);class r extends Dr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,o,u,f,g,v){const t=this.length;return this.resize(t+1),this.emplace(t,e,o,u,f,g,v)}emplace(e,o,u,f,g,v,t){const i=4*e,a=8*e;return this.int16[i+0]=o,this.int16[i+1]=u,this.uint8[a+4]=f,this.uint8[a+5]=g,this.uint8[a+6]=v,this.uint8[a+7]=t,e}}r.prototype.bytesPerElement=8,Pt("StructArrayLayout2i4ub8",r);class s extends Dr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,o){const u=this.length;return this.resize(u+1),this.emplace(u,e,o)}emplace(e,o,u){const f=2*e;return this.float32[f+0]=o,this.float32[f+1]=u,e}}s.prototype.bytesPerElement=8,Pt("StructArrayLayout2f8",s);class c extends Dr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,o,u,f,g,v,t,i,a,h){const y=this.length;return this.resize(y+1),this.emplace(y,e,o,u,f,g,v,t,i,a,h)}emplace(e,o,u,f,g,v,t,i,a,h,y){const w=10*e;return this.uint16[w+0]=o,this.uint16[w+1]=u,this.uint16[w+2]=f,this.uint16[w+3]=g,this.uint16[w+4]=v,this.uint16[w+5]=t,this.uint16[w+6]=i,this.uint16[w+7]=a,this.uint16[w+8]=h,this.uint16[w+9]=y,e}}c.prototype.bytesPerElement=20,Pt("StructArrayLayout10ui20",c);class p extends Dr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,o,u,f,g,v,t,i,a,h,y,w){const E=this.length;return this.resize(E+1),this.emplace(E,e,o,u,f,g,v,t,i,a,h,y,w)}emplace(e,o,u,f,g,v,t,i,a,h,y,w,E){const z=12*e;return this.int16[z+0]=o,this.int16[z+1]=u,this.int16[z+2]=f,this.int16[z+3]=g,this.uint16[z+4]=v,this.uint16[z+5]=t,this.uint16[z+6]=i,this.uint16[z+7]=a,this.int16[z+8]=h,this.int16[z+9]=y,this.int16[z+10]=w,this.int16[z+11]=E,e}}p.prototype.bytesPerElement=24,Pt("StructArrayLayout4i4ui4i24",p);class _ extends Dr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,o,u){const f=this.length;return this.resize(f+1),this.emplace(f,e,o,u)}emplace(e,o,u,f){const g=3*e;return this.float32[g+0]=o,this.float32[g+1]=u,this.float32[g+2]=f,e}}_.prototype.bytesPerElement=12,Pt("StructArrayLayout3f12",_);class S extends Dr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){const o=this.length;return this.resize(o+1),this.emplace(o,e)}emplace(e,o){return this.uint32[1*e+0]=o,e}}S.prototype.bytesPerElement=4,Pt("StructArrayLayout1ul4",S);class k extends Dr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,o,u,f,g,v,t,i,a){const h=this.length;return this.resize(h+1),this.emplace(h,e,o,u,f,g,v,t,i,a)}emplace(e,o,u,f,g,v,t,i,a,h){const y=10*e,w=5*e;return this.int16[y+0]=o,this.int16[y+1]=u,this.int16[y+2]=f,this.int16[y+3]=g,this.int16[y+4]=v,this.int16[y+5]=t,this.uint32[w+3]=i,this.uint16[y+8]=a,this.uint16[y+9]=h,e}}k.prototype.bytesPerElement=20,Pt("StructArrayLayout6i1ul2ui20",k);class A extends Dr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,o,u,f,g,v){const t=this.length;return this.resize(t+1),this.emplace(t,e,o,u,f,g,v)}emplace(e,o,u,f,g,v,t){const i=6*e;return this.int16[i+0]=o,this.int16[i+1]=u,this.int16[i+2]=f,this.int16[i+3]=g,this.int16[i+4]=v,this.int16[i+5]=t,e}}A.prototype.bytesPerElement=12,Pt("StructArrayLayout2i2i2i12",A);class M extends Dr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,o,u,f,g){const v=this.length;return this.resize(v+1),this.emplace(v,e,o,u,f,g)}emplace(e,o,u,f,g,v){const t=4*e,i=8*e;return this.float32[t+0]=o,this.float32[t+1]=u,this.float32[t+2]=f,this.int16[i+6]=g,this.int16[i+7]=v,e}}M.prototype.bytesPerElement=16,Pt("StructArrayLayout2f1f2i16",M);class F extends Dr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,o,u,f){const g=this.length;return this.resize(g+1),this.emplace(g,e,o,u,f)}emplace(e,o,u,f,g){const v=12*e,t=3*e;return this.uint8[v+0]=o,this.uint8[v+1]=u,this.float32[t+1]=f,this.float32[t+2]=g,e}}F.prototype.bytesPerElement=12,Pt("StructArrayLayout2ub2f12",F);class q extends Dr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,o,u){const f=this.length;return this.resize(f+1),this.emplace(f,e,o,u)}emplace(e,o,u,f){const g=3*e;return this.uint16[g+0]=o,this.uint16[g+1]=u,this.uint16[g+2]=f,e}}q.prototype.bytesPerElement=6,Pt("StructArrayLayout3ui6",q);class H extends Dr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,o,u,f,g,v,t,i,a,h,y,w,E,z,N,W,se){const pe=this.length;return this.resize(pe+1),this.emplace(pe,e,o,u,f,g,v,t,i,a,h,y,w,E,z,N,W,se)}emplace(e,o,u,f,g,v,t,i,a,h,y,w,E,z,N,W,se,pe){const ie=24*e,Te=12*e,Le=48*e;return this.int16[ie+0]=o,this.int16[ie+1]=u,this.uint16[ie+2]=f,this.uint16[ie+3]=g,this.uint32[Te+2]=v,this.uint32[Te+3]=t,this.uint32[Te+4]=i,this.uint16[ie+10]=a,this.uint16[ie+11]=h,this.uint16[ie+12]=y,this.float32[Te+7]=w,this.float32[Te+8]=E,this.uint8[Le+36]=z,this.uint8[Le+37]=N,this.uint8[Le+38]=W,this.uint32[Te+10]=se,this.int16[ie+22]=pe,e}}H.prototype.bytesPerElement=48,Pt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",H);class le extends Dr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,o,u,f,g,v,t,i,a,h,y,w,E,z,N,W,se,pe,ie,Te,Le,Re,xt,we,ue,ge,Be,tt){const nt=this.length;return this.resize(nt+1),this.emplace(nt,e,o,u,f,g,v,t,i,a,h,y,w,E,z,N,W,se,pe,ie,Te,Le,Re,xt,we,ue,ge,Be,tt)}emplace(e,o,u,f,g,v,t,i,a,h,y,w,E,z,N,W,se,pe,ie,Te,Le,Re,xt,we,ue,ge,Be,tt,nt){const Ge=34*e,mt=17*e;return this.int16[Ge+0]=o,this.int16[Ge+1]=u,this.int16[Ge+2]=f,this.int16[Ge+3]=g,this.int16[Ge+4]=v,this.int16[Ge+5]=t,this.int16[Ge+6]=i,this.int16[Ge+7]=a,this.uint16[Ge+8]=h,this.uint16[Ge+9]=y,this.uint16[Ge+10]=w,this.uint16[Ge+11]=E,this.uint16[Ge+12]=z,this.uint16[Ge+13]=N,this.uint16[Ge+14]=W,this.uint16[Ge+15]=se,this.uint16[Ge+16]=pe,this.uint16[Ge+17]=ie,this.uint16[Ge+18]=Te,this.uint16[Ge+19]=Le,this.uint16[Ge+20]=Re,this.uint16[Ge+21]=xt,this.uint16[Ge+22]=we,this.uint32[mt+12]=ue,this.float32[mt+13]=ge,this.float32[mt+14]=Be,this.float32[mt+15]=tt,this.float32[mt+16]=nt,e}}le.prototype.bytesPerElement=68,Pt("StructArrayLayout8i15ui1ul4f68",le);class te extends Dr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){const o=this.length;return this.resize(o+1),this.emplace(o,e)}emplace(e,o){return this.float32[1*e+0]=o,e}}te.prototype.bytesPerElement=4,Pt("StructArrayLayout1f4",te);class ee extends Dr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,o,u){const f=this.length;return this.resize(f+1),this.emplace(f,e,o,u)}emplace(e,o,u,f){const g=3*e;return this.int16[g+0]=o,this.int16[g+1]=u,this.int16[g+2]=f,e}}ee.prototype.bytesPerElement=6,Pt("StructArrayLayout3i6",ee);class ye extends Dr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,o,u){const f=this.length;return this.resize(f+1),this.emplace(f,e,o,u)}emplace(e,o,u,f){const g=4*e;return this.uint32[2*e+0]=o,this.uint16[g+2]=u,this.uint16[g+3]=f,e}}ye.prototype.bytesPerElement=8,Pt("StructArrayLayout1ul2ui8",ye);class Ae extends Dr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,o){const u=this.length;return this.resize(u+1),this.emplace(u,e,o)}emplace(e,o,u){const f=2*e;return this.uint16[f+0]=o,this.uint16[f+1]=u,e}}Ae.prototype.bytesPerElement=4,Pt("StructArrayLayout2ui4",Ae);class Pe extends Dr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){const o=this.length;return this.resize(o+1),this.emplace(o,e)}emplace(e,o){return this.uint16[1*e+0]=o,e}}Pe.prototype.bytesPerElement=2,Pt("StructArrayLayout1ui2",Pe);class he extends Dr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,o,u,f){const g=this.length;return this.resize(g+1),this.emplace(g,e,o,u,f)}emplace(e,o,u,f,g){const v=4*e;return this.float32[v+0]=o,this.float32[v+1]=u,this.float32[v+2]=f,this.float32[v+3]=g,e}}he.prototype.bytesPerElement=16,Pt("StructArrayLayout4f16",he);class Ve extends xa{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new ht(this.anchorPointX,this.anchorPointY)}}Ve.prototype.size=20;class Oe extends k{get(e){return new Ve(this,e)}}Pt("CollisionBoxArray",Oe);class Xe extends xa{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(e){this._structArray.uint8[this._pos1+37]=e}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(e){this._structArray.uint8[this._pos1+38]=e}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(e){this._structArray.uint32[this._pos4+10]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}Xe.prototype.size=48;class rt extends H{get(e){return new Xe(this,e)}}Pt("PlacedSymbolArray",rt);class pt extends xa{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(e){this._structArray.uint32[this._pos4+12]=e}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get textOffset0(){return this._structArray.float32[this._pos4+14]}get textOffset1(){return this._structArray.float32[this._pos4+15]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+16]}}pt.prototype.size=68;class et extends le{get(e){return new pt(this,e)}}Pt("SymbolInstanceArray",et);class It extends te{getoffsetX(e){return this.float32[1*e+0]}}Pt("GlyphOffsetArray",It);class wt extends ee{getx(e){return this.int16[3*e+0]}gety(e){return this.int16[3*e+1]}gettileUnitDistanceFromAnchor(e){return this.int16[3*e+2]}}Pt("SymbolLineVertexArray",wt);class Tt extends xa{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}Tt.prototype.size=8;class Ht extends ye{get(e){return new Tt(this,e)}}Pt("FeatureIndexArray",Ht);class Jt extends bo{}class jt extends bo{}class Ir extends bo{}class cr extends d{}class ir extends r{}class ar extends s{}class hr extends c{}class Rn extends p{}class on extends _{}class Qr extends S{}class Sn extends A{}class $n extends F{}class jr extends q{}class En extends Ae{}const So=un([{name:"a_pos",components:2,type:"Int16"}],4),{members:Ps}=So;class mr{constructor(e=[]){this.segments=e}prepareSegment(e,o,u,f){let g=this.segments[this.segments.length-1];return e>mr.MAX_VERTEX_ARRAY_LENGTH&&_e(`Max vertices per segment is ${mr.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${e}`),(!g||g.vertexLength+e>mr.MAX_VERTEX_ARRAY_LENGTH||g.sortKey!==f)&&(g={vertexOffset:o.length,primitiveOffset:u.length,vertexLength:0,primitiveLength:0},f!==void 0&&(g.sortKey=f),this.segments.push(g)),g}get(){return this.segments}destroy(){for(const e of this.segments)for(const o in e.vaos)e.vaos[o].destroy()}static simpleSegment(e,o,u,f){return new mr([{vertexOffset:e,primitiveOffset:o,vertexLength:u,primitiveLength:f,vaos:{},sortKey:0}])}}function dr(n,e){return 256*(n=B(Math.floor(n),0,255))+B(Math.floor(e),0,255)}mr.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Pt("SegmentVector",mr);const Yt=un([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var nr={exports:{}},Zr={exports:{}};Zr.exports=function(n,e){var o,u,f,g,v,t,i,a;for(u=n.length-(o=3&n.length),f=e,v=3432918353,t=461845907,a=0;a<u;)i=255&n.charCodeAt(a)|(255&n.charCodeAt(++a))<<8|(255&n.charCodeAt(++a))<<16|(255&n.charCodeAt(++a))<<24,++a,f=27492+(65535&(g=5*(65535&(f=(f^=i=(65535&(i=(i=(65535&i)*v+(((i>>>16)*v&65535)<<16)&4294967295)<<15|i>>>17))*t+(((i>>>16)*t&65535)<<16)&4294967295)<<13|f>>>19))+((5*(f>>>16)&65535)<<16)&4294967295))+((58964+(g>>>16)&65535)<<16);switch(i=0,o){case 3:i^=(255&n.charCodeAt(a+2))<<16;case 2:i^=(255&n.charCodeAt(a+1))<<8;case 1:f^=i=(65535&(i=(i=(65535&(i^=255&n.charCodeAt(a)))*v+(((i>>>16)*v&65535)<<16)&4294967295)<<15|i>>>17))*t+(((i>>>16)*t&65535)<<16)&4294967295}return f^=n.length,f=2246822507*(65535&(f^=f>>>16))+((2246822507*(f>>>16)&65535)<<16)&4294967295,f=3266489909*(65535&(f^=f>>>13))+((3266489909*(f>>>16)&65535)<<16)&4294967295,(f^=f>>>16)>>>0};var Fr={exports:{}};Fr.exports=function(n,e){for(var o,u=n.length,f=e^u,g=0;u>=4;)o=1540483477*(65535&(o=255&n.charCodeAt(g)|(255&n.charCodeAt(++g))<<8|(255&n.charCodeAt(++g))<<16|(255&n.charCodeAt(++g))<<24))+((1540483477*(o>>>16)&65535)<<16),f=1540483477*(65535&f)+((1540483477*(f>>>16)&65535)<<16)^(o=1540483477*(65535&(o^=o>>>24))+((1540483477*(o>>>16)&65535)<<16)),u-=4,++g;switch(u){case 3:f^=(255&n.charCodeAt(g+2))<<16;case 2:f^=(255&n.charCodeAt(g+1))<<8;case 1:f=1540483477*(65535&(f^=255&n.charCodeAt(g)))+((1540483477*(f>>>16)&65535)<<16)}return f=1540483477*(65535&(f^=f>>>13))+((1540483477*(f>>>16)&65535)<<16),(f^=f>>>15)>>>0};var ii=Zr.exports,Eo=Fr.exports;nr.exports=ii,nr.exports.murmur3=ii,nr.exports.murmur2=Eo;class To{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(e,o,u,f){this.ids.push(wa(e)),this.positions.push(o,u,f)}getPositions(e){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const o=wa(e);let u=0,f=this.ids.length-1;for(;u<f;){const v=u+f>>1;this.ids[v]>=o?f=v:u=v+1}const g=[];for(;this.ids[u]===o;)g.push({index:this.positions[3*u],start:this.positions[3*u+1],end:this.positions[3*u+2]}),u++;return g}static serialize(e,o){const u=new Float64Array(e.ids),f=new Uint32Array(e.positions);return Ms(u,f,0,u.length-1),o&&o.push(u.buffer,f.buffer),{ids:u,positions:f}}static deserialize(e){const o=new To;return o.ids=e.ids,o.positions=e.positions,o.indexed=!0,o}}function wa(n){const e=+n;return!isNaN(e)&&e<=Number.MAX_SAFE_INTEGER?e:nr.exports(String(n))}function Ms(n,e,o,u){for(;o<u;){const f=n[o+u>>1];let g=o-1,v=u+1;for(;;){do g++;while(n[g]<f);do v--;while(n[v]>f);if(g>=v)break;ba(n,g,v),ba(e,3*g,3*v),ba(e,3*g+1,3*v+1),ba(e,3*g+2,3*v+2)}v-o<u-v?(Ms(n,e,o,v),o=v+1):(Ms(n,e,v+1,u),u=v)}}function ba(n,e,o){const u=n[e];n[e]=n[o],n[o]=u}Pt("FeaturePositionMap",To);class Ln{constructor(e,o){this.gl=e.gl,this.location=o}}class Ds extends Ln{constructor(e,o){super(e,o),this.current=0}set(e){this.current!==e&&(this.current=e,this.gl.uniform1f(this.location,e))}}class Sa extends Ln{constructor(e,o){super(e,o),this.current=[0,0,0,0]}set(e){e[0]===this.current[0]&&e[1]===this.current[1]&&e[2]===this.current[2]&&e[3]===this.current[3]||(this.current=e,this.gl.uniform4f(this.location,e[0],e[1],e[2],e[3]))}}class Xn extends Ln{constructor(e,o){super(e,o),this.current=X.transparent}set(e){e.r===this.current.r&&e.g===this.current.g&&e.b===this.current.b&&e.a===this.current.a||(this.current=e,this.gl.uniform4f(this.location,e.r,e.g,e.b,e.a))}}const ec=new Float32Array(16);function kl(n){return[dr(255*n.r,255*n.g),dr(255*n.b,255*n.a)]}class ko{constructor(e,o,u){this.value=e,this.uniformNames=o.map(f=>`u_${f}`),this.type=u}setUniform(e,o,u){e.set(u.constantOr(this.value))}getBinding(e,o,u){return this.type==="color"?new Xn(e,o):new Ds(e,o)}}class Rs{constructor(e,o){this.uniformNames=o.map(u=>`u_${u}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(e,o){this.pixelRatioFrom=o.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=o.tlbr,this.patternTo=e.tlbr}setUniform(e,o,u,f){const g=f==="u_pattern_to"?this.patternTo:f==="u_pattern_from"?this.patternFrom:f==="u_pixel_ratio_to"?this.pixelRatioTo:f==="u_pixel_ratio_from"?this.pixelRatioFrom:null;g&&e.set(g)}getBinding(e,o,u){return u.substr(0,9)==="u_pattern"?new Sa(e,o):new Ds(e,o)}}class Ji{constructor(e,o,u,f){this.expression=e,this.type=u,this.maxValue=0,this.paintVertexAttributes=o.map(g=>({name:`a_${g}`,type:"Float32",components:u==="color"?2:1,offset:0})),this.paintVertexArray=new f}populatePaintArray(e,o,u,f,g){const v=this.paintVertexArray.length,t=this.expression.evaluate(new Mr(0),o,{},f,[],g);this.paintVertexArray.resize(e),this._setPaintValue(v,e,t)}updatePaintArray(e,o,u,f){const g=this.expression.evaluate({zoom:0},u,f);this._setPaintValue(e,o,g)}_setPaintValue(e,o,u){if(this.type==="color"){const f=kl(u);for(let g=e;g<o;g++)this.paintVertexArray.emplace(g,f[0],f[1])}else{for(let f=e;f<o;f++)this.paintVertexArray.emplace(f,u);this.maxValue=Math.max(this.maxValue,Math.abs(u))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Si{constructor(e,o,u,f,g,v){this.expression=e,this.uniformNames=o.map(t=>`u_${t}_t`),this.type=u,this.useIntegerZoom=f,this.zoom=g,this.maxValue=0,this.paintVertexAttributes=o.map(t=>({name:`a_${t}`,type:"Float32",components:u==="color"?4:2,offset:0})),this.paintVertexArray=new v}populatePaintArray(e,o,u,f,g){const v=this.expression.evaluate(new Mr(this.zoom),o,{},f,[],g),t=this.expression.evaluate(new Mr(this.zoom+1),o,{},f,[],g),i=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(i,e,v,t)}updatePaintArray(e,o,u,f){const g=this.expression.evaluate({zoom:this.zoom},u,f),v=this.expression.evaluate({zoom:this.zoom+1},u,f);this._setPaintValue(e,o,g,v)}_setPaintValue(e,o,u,f){if(this.type==="color"){const g=kl(u),v=kl(f);for(let t=e;t<o;t++)this.paintVertexArray.emplace(t,g[0],g[1],v[0],v[1])}else{for(let g=e;g<o;g++)this.paintVertexArray.emplace(g,u,f);this.maxValue=Math.max(this.maxValue,Math.abs(u),Math.abs(f))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,o){const u=this.useIntegerZoom?Math.floor(o.zoom):o.zoom,f=B(this.expression.interpolationFactor(u,this.zoom,this.zoom+1),0,1);e.set(f)}getBinding(e,o,u){return new Ds(e,o)}}class Co{constructor(e,o,u,f,g,v){this.expression=e,this.type=o,this.useIntegerZoom=u,this.zoom=f,this.layerId=v,this.zoomInPaintVertexArray=new g,this.zoomOutPaintVertexArray=new g}populatePaintArray(e,o,u){const f=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(f,e,o.patterns&&o.patterns[this.layerId],u)}updatePaintArray(e,o,u,f,g){this._setPaintValues(e,o,u.patterns&&u.patterns[this.layerId],g)}_setPaintValues(e,o,u,f){if(!f||!u)return;const{min:g,mid:v,max:t}=u,i=f[g],a=f[v],h=f[t];if(i&&a&&h)for(let y=e;y<o;y++)this.zoomInPaintVertexArray.emplace(y,a.tl[0],a.tl[1],a.br[0],a.br[1],i.tl[0],i.tl[1],i.br[0],i.br[1],a.pixelRatio,i.pixelRatio),this.zoomOutPaintVertexArray.emplace(y,a.tl[0],a.tl[1],a.br[0],a.br[1],h.tl[0],h.tl[1],h.br[0],h.br[1],a.pixelRatio,h.pixelRatio)}upload(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,Yt.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,Yt.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Ea{constructor(e,o,u){this.binders={},this._buffers=[];const f=[];for(const g in e.paint._values){if(!u(g))continue;const v=e.paint.get(g);if(!(v instanceof Vn&&bs(v.property.specification)))continue;const t=Ta(g,e.type),i=v.value,a=v.property.specification.type,h=v.property.useIntegerZoom,y=v.property.specification["property-type"],w=y==="cross-faded"||y==="cross-faded-data-driven";if(i.kind==="constant")this.binders[g]=w?new Rs(i.value,t):new ko(i.value,t,a),f.push(`/u_${g}`);else if(i.kind==="source"||w){const E=tc(g,a,"source");this.binders[g]=w?new Co(i,a,h,o,E,e.id):new Ji(i,t,a,E),f.push(`/a_${g}`)}else{const E=tc(g,a,"composite");this.binders[g]=new Si(i,t,a,h,o,E),f.push(`/z_${g}`)}}this.cacheKey=f.sort().join("")}getMaxValue(e){const o=this.binders[e];return o instanceof Ji||o instanceof Si?o.maxValue:0}populatePaintArrays(e,o,u,f,g){for(const v in this.binders){const t=this.binders[v];(t instanceof Ji||t instanceof Si||t instanceof Co)&&t.populatePaintArray(e,o,u,f,g)}}setConstantPatternPositions(e,o){for(const u in this.binders){const f=this.binders[u];f instanceof Rs&&f.setConstantPatternPositions(e,o)}}updatePaintArrays(e,o,u,f,g){let v=!1;for(const t in e){const i=o.getPositions(t);for(const a of i){const h=u.feature(a.index);for(const y in this.binders){const w=this.binders[y];if((w instanceof Ji||w instanceof Si||w instanceof Co)&&w.expression.isStateDependent===!0){const E=f.paint.get(y);w.expression=E.value,w.updatePaintArray(a.start,a.end,h,e[t],g),v=!0}}}}return v}defines(){const e=[];for(const o in this.binders){const u=this.binders[o];(u instanceof ko||u instanceof Rs)&&e.push(...u.uniformNames.map(f=>`#define HAS_UNIFORM_${f}`))}return e}getBinderAttributes(){const e=[];for(const o in this.binders){const u=this.binders[o];if(u instanceof Ji||u instanceof Si)for(let f=0;f<u.paintVertexAttributes.length;f++)e.push(u.paintVertexAttributes[f].name);else if(u instanceof Co)for(let f=0;f<Yt.members.length;f++)e.push(Yt.members[f].name)}return e}getBinderUniforms(){const e=[];for(const o in this.binders){const u=this.binders[o];if(u instanceof ko||u instanceof Rs||u instanceof Si)for(const f of u.uniformNames)e.push(f)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e,o){const u=[];for(const f in this.binders){const g=this.binders[f];if(g instanceof ko||g instanceof Rs||g instanceof Si){for(const v of g.uniformNames)if(o[v]){const t=g.getBinding(e,o[v],v);u.push({name:v,property:f,binding:t})}}}return u}setUniforms(e,o,u,f){for(const{name:g,property:v,binding:t}of o)this.binders[v].setUniform(t,f,u.get(v),g)}updatePaintBuffers(e){this._buffers=[];for(const o in this.binders){const u=this.binders[o];if(e&&u instanceof Co){const f=e.fromScale===2?u.zoomInPaintVertexBuffer:u.zoomOutPaintVertexBuffer;f&&this._buffers.push(f)}else(u instanceof Ji||u instanceof Si)&&u.paintVertexBuffer&&this._buffers.push(u.paintVertexBuffer)}}upload(e){for(const o in this.binders){const u=this.binders[o];(u instanceof Ji||u instanceof Si||u instanceof Co)&&u.upload(e)}this.updatePaintBuffers()}destroy(){for(const e in this.binders){const o=this.binders[e];(o instanceof Ji||o instanceof Si||o instanceof Co)&&o.destroy()}}}class Bn{constructor(e,o,u=()=>!0){this.programConfigurations={};for(const f of e)this.programConfigurations[f.id]=new Ea(f,o,u);this.needsUpload=!1,this._featureMap=new To,this._bufferOffset=0}populatePaintArrays(e,o,u,f,g,v){for(const t in this.programConfigurations)this.programConfigurations[t].populatePaintArrays(e,o,f,g,v);o.id!==void 0&&this._featureMap.add(o.id,u,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,o,u,f){for(const g of u)this.needsUpload=this.programConfigurations[g.id].updatePaintArrays(e,this._featureMap,o,g,f)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(const o in this.programConfigurations)this.programConfigurations[o].upload(e);this.needsUpload=!1}}destroy(){for(const e in this.programConfigurations)this.programConfigurations[e].destroy()}}function Ta(n,e){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[n]||[n.replace(`${e}-`,"").replace(/-/g,"_")]}function tc(n,e,o){const u={color:{source:s,composite:he},number:{source:te,composite:s}},f=function(g){return{"line-pattern":{source:hr,composite:hr},"fill-pattern":{source:hr,composite:hr},"fill-extrusion-pattern":{source:hr,composite:hr}}[g]}(n);return f&&f[o]||u[e][o]}Pt("ConstantBinder",ko),Pt("CrossFadedConstantBinder",Rs),Pt("SourceExpressionBinder",Ji),Pt("CrossFadedCompositeBinder",Co),Pt("CompositeExpressionBinder",Si),Pt("ProgramConfiguration",Ea,{omit:["_buffers"]}),Pt("ProgramConfigurationSet",Bn);var cn=8192;const Qi=Math.pow(2,14)-1,Xo=-Qi-1;function Ko(n){const e=cn/n.extent,o=n.loadGeometry();for(let u=0;u<o.length;u++){const f=o[u];for(let g=0;g<f.length;g++){const v=f[g],t=Math.round(v.x*e),i=Math.round(v.y*e);v.x=B(t,Xo,Qi),v.y=B(i,Xo,Qi),(t<v.x||t>v.x+1||i<v.y||i>v.y+1)&&_e("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return o}function Ls(n,e){return{type:n.type,id:n.id,properties:n.properties,geometry:e?Ko(n):[]}}function Bi(n,e,o,u,f){n.emplaceBack(2*e+(u+1)/2,2*o+(f+1)/2)}class Io{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(o=>o.id),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new jt,this.indexArray=new jr,this.segments=new mr,this.programConfigurations=new Bn(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(e,o,u){const f=this.layers[0],g=[];let v=null,t=!1;f.type==="circle"&&(v=f.layout.get("circle-sort-key"),t=!v.isConstant());for(const{feature:i,id:a,index:h,sourceLayerIndex:y}of e){const w=this.layers[0]._featureFilter.needGeometry,E=Ls(i,w);if(!this.layers[0]._featureFilter.filter(new Mr(this.zoom),E,u))continue;const z=t?v.evaluate(E,{},u):void 0,N={id:a,properties:i.properties,type:i.type,sourceLayerIndex:y,index:h,geometry:w?E.geometry:Ko(i),patterns:{},sortKey:z};g.push(N)}t&&g.sort((i,a)=>i.sortKey-a.sortKey);for(const i of g){const{geometry:a,index:h,sourceLayerIndex:y}=i,w=e[h].feature;this.addFeature(i,a,h,u),o.featureIndex.insert(w,a,h,y,this.index)}}update(e,o,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,o,this.stateDependentLayers,u)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Ps),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,o,u,f){for(const g of o)for(const v of g){const t=v.x,i=v.y;if(t<0||t>=cn||i<0||i>=cn)continue;const a=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),h=a.vertexLength;Bi(this.layoutVertexArray,t,i,-1,-1),Bi(this.layoutVertexArray,t,i,1,-1),Bi(this.layoutVertexArray,t,i,1,1),Bi(this.layoutVertexArray,t,i,-1,1),this.indexArray.emplaceBack(h,h+1,h+2),this.indexArray.emplaceBack(h,h+3,h+2),a.vertexLength+=4,a.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,u,{},f)}}function pu(n,e){for(let o=0;o<n.length;o++)if(ka(e,n[o]))return!0;for(let o=0;o<e.length;o++)if(ka(n,e[o]))return!0;return!!rc(n,e)}function Yh(n,e,o){return!!ka(n,e)||!!Cl(e,n,o)}function mu(n,e){if(n.length===1)return Yc(e,n[0]);for(let o=0;o<e.length;o++){const u=e[o];for(let f=0;f<u.length;f++)if(ka(n,u[f]))return!0}for(let o=0;o<n.length;o++)if(Yc(e,n[o]))return!0;for(let o=0;o<e.length;o++)if(rc(n,e[o]))return!0;return!1}function Jh(n,e,o){if(n.length>1){if(rc(n,e))return!0;for(let u=0;u<e.length;u++)if(Cl(e[u],n,o))return!0}for(let u=0;u<n.length;u++)if(Cl(n[u],e,o))return!0;return!1}function rc(n,e){if(n.length===0||e.length===0)return!1;for(let o=0;o<n.length-1;o++){const u=n[o],f=n[o+1];for(let g=0;g<e.length-1;g++)if(Xc(u,f,e[g],e[g+1]))return!0}return!1}function Xc(n,e,o,u){return Ue(n,o,u)!==Ue(e,o,u)&&Ue(n,e,o)!==Ue(n,e,u)}function Cl(n,e,o){const u=o*o;if(e.length===1)return n.distSqr(e[0])<u;for(let f=1;f<e.length;f++)if(Kc(n,e[f-1],e[f])<u)return!0;return!1}function Kc(n,e,o){const u=e.distSqr(o);if(u===0)return n.distSqr(e);const f=((n.x-e.x)*(o.x-e.x)+(n.y-e.y)*(o.y-e.y))/u;return n.distSqr(f<0?e:f>1?o:o.sub(e)._mult(f)._add(e))}function Yc(n,e){let o,u,f,g=!1;for(let v=0;v<n.length;v++){o=n[v];for(let t=0,i=o.length-1;t<o.length;i=t++)u=o[t],f=o[i],u.y>e.y!=f.y>e.y&&e.x<(f.x-u.x)*(e.y-u.y)/(f.y-u.y)+u.x&&(g=!g)}return g}function ka(n,e){let o=!1;for(let u=0,f=n.length-1;u<n.length;f=u++){const g=n[u],v=n[f];g.y>e.y!=v.y>e.y&&e.x<(v.x-g.x)*(e.y-g.y)/(v.y-g.y)+g.x&&(o=!o)}return o}function Jc(n,e,o){const u=o[0],f=o[2];if(n.x<u.x&&e.x<u.x||n.x>f.x&&e.x>f.x||n.y<u.y&&e.y<u.y||n.y>f.y&&e.y>f.y)return!1;const g=Ue(n,e,o[0]);return g!==Ue(n,e,o[1])||g!==Ue(n,e,o[2])||g!==Ue(n,e,o[3])}function Yo(n,e,o){const u=e.paint.get(n).value;return u.kind==="constant"?u.value:o.programConfigurations.get(e.id).getMaxValue(n)}function Ca(n){return Math.sqrt(n[0]*n[0]+n[1]*n[1])}function gu(n,e,o,u,f){if(!e[0]&&!e[1])return n;const g=ht.convert(e)._mult(f);o==="viewport"&&g._rotate(-u);const v=[];for(let t=0;t<n.length;t++)v.push(n[t].sub(g));return v}Pt("CircleBucket",Io,{omit:["layers"]});const Qh=new nn({"circle-sort-key":new Gt(Me.layout_circle["circle-sort-key"])});var Il={paint:new nn({"circle-radius":new Gt(Me.paint_circle["circle-radius"]),"circle-color":new Gt(Me.paint_circle["circle-color"]),"circle-blur":new Gt(Me.paint_circle["circle-blur"]),"circle-opacity":new Gt(Me.paint_circle["circle-opacity"]),"circle-translate":new Ot(Me.paint_circle["circle-translate"]),"circle-translate-anchor":new Ot(Me.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Ot(Me.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Ot(Me.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Gt(Me.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Gt(Me.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Gt(Me.paint_circle["circle-stroke-opacity"])}),layout:Qh},Gn=1e-6,_n=typeof Float32Array<"u"?Float32Array:Array;function eo(){var n=new _n(9);return _n!=Float32Array&&(n[1]=0,n[2]=0,n[3]=0,n[5]=0,n[6]=0,n[7]=0),n[0]=1,n[4]=1,n[8]=1,n}function Ia(n){return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function Al(n,e,o){var u=e[0],f=e[1],g=e[2],v=e[3],t=e[4],i=e[5],a=e[6],h=e[7],y=e[8],w=e[9],E=e[10],z=e[11],N=e[12],W=e[13],se=e[14],pe=e[15],ie=o[0],Te=o[1],Le=o[2],Re=o[3];return n[0]=ie*u+Te*t+Le*y+Re*N,n[1]=ie*f+Te*i+Le*w+Re*W,n[2]=ie*g+Te*a+Le*E+Re*se,n[3]=ie*v+Te*h+Le*z+Re*pe,n[4]=(ie=o[4])*u+(Te=o[5])*t+(Le=o[6])*y+(Re=o[7])*N,n[5]=ie*f+Te*i+Le*w+Re*W,n[6]=ie*g+Te*a+Le*E+Re*se,n[7]=ie*v+Te*h+Le*z+Re*pe,n[8]=(ie=o[8])*u+(Te=o[9])*t+(Le=o[10])*y+(Re=o[11])*N,n[9]=ie*f+Te*i+Le*w+Re*W,n[10]=ie*g+Te*a+Le*E+Re*se,n[11]=ie*v+Te*h+Le*z+Re*pe,n[12]=(ie=o[12])*u+(Te=o[13])*t+(Le=o[14])*y+(Re=o[15])*N,n[13]=ie*f+Te*i+Le*w+Re*W,n[14]=ie*g+Te*a+Le*E+Re*se,n[15]=ie*v+Te*h+Le*z+Re*pe,n}Math.hypot||(Math.hypot=function(){for(var n=0,e=arguments.length;e--;)n+=arguments[e]*arguments[e];return Math.sqrt(n)});var to,Qc=Al;function Aa(){var n=new _n(3);return _n!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n}function eh(n,e,o){var u=new _n(3);return u[0]=n,u[1]=e,u[2]=o,u}function zl(n,e,o){var u=e[0],f=e[1],g=e[2],v=e[3];return n[0]=o[0]*u+o[4]*f+o[8]*g+o[12]*v,n[1]=o[1]*u+o[5]*f+o[9]*g+o[13]*v,n[2]=o[2]*u+o[6]*f+o[10]*g+o[14]*v,n[3]=o[3]*u+o[7]*f+o[11]*g+o[15]*v,n}function en(){var n=new _n(4);return _n!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n[3]=1,n}function yu(n,e){const o=zl([],[n.x,n.y,0,1],e);return new ht(o[0]/o[3],o[1]/o[3])}Aa(),to=new _n(4),_n!=Float32Array&&(to[0]=0,to[1]=0,to[2]=0,to[3]=0),Aa(),eh(1,0,0),eh(0,1,0),en(),en(),eo(),function(){var n;n=new _n(2),_n!=Float32Array&&(n[0]=0,n[1]=0)}();class nc extends Io{}Pt("HeatmapBucket",nc,{omit:["layers"]});var th={paint:new nn({"heatmap-radius":new Gt(Me.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Gt(Me.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Ot(Me.paint_heatmap["heatmap-intensity"]),"heatmap-color":new zs(Me.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Ot(Me.paint_heatmap["heatmap-opacity"])})};function Pl(n,{width:e,height:o},u,f){if(f){if(f instanceof Uint8ClampedArray)f=new Uint8Array(f.buffer);else if(f.length!==e*o*u)throw new RangeError(`mismatched image size. expected: ${f.length} but got: ${e*o*u}`)}else f=new Uint8Array(e*o*u);return n.width=e,n.height=o,n.data=f,n}function ic(n,{width:e,height:o},u){if(e===n.width&&o===n.height)return;const f=Pl({},{width:e,height:o},u);Jo(n,f,{x:0,y:0},{x:0,y:0},{width:Math.min(n.width,e),height:Math.min(n.height,o)},u),n.width=e,n.height=o,n.data=f.data}function Jo(n,e,o,u,f,g){if(f.width===0||f.height===0)return e;if(f.width>n.width||f.height>n.height||o.x>n.width-f.width||o.y>n.height-f.height)throw new RangeError("out of range source coordinates for image copy");if(f.width>e.width||f.height>e.height||u.x>e.width-f.width||u.y>e.height-f.height)throw new RangeError("out of range destination coordinates for image copy");const v=n.data,t=e.data;if(v===t)throw new Error("srcData equals dstData, so image is already copied");for(let i=0;i<f.height;i++){const a=((o.y+i)*n.width+o.x)*g,h=((u.y+i)*e.width+u.x)*g;for(let y=0;y<f.width*g;y++)t[h+y]=v[a+y]}return e}class Vr{constructor(e,o){Pl(this,e,1,o)}resize(e){ic(this,e,1)}clone(){return new Vr({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,o,u,f,g){Jo(e,o,u,f,g,1)}}class Pr{constructor(e,o){Pl(this,e,4,o)}resize(e){ic(this,e,4)}replace(e,o){o?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e}clone(){return new Pr({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,o,u,f,g){Jo(e,o,u,f,g,4)}}function Tn(n){const e={},o=n.resolution||256,u=n.clips?n.clips.length:1,f=n.image||new Pr({width:o,height:u});if(Math.log(o)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${o}`);const g=(v,t,i)=>{e[n.evaluationKey]=i;const a=n.expression.evaluate(e);f.data[v+t+0]=Math.floor(255*a.r/a.a),f.data[v+t+1]=Math.floor(255*a.g/a.a),f.data[v+t+2]=Math.floor(255*a.b/a.a),f.data[v+t+3]=Math.floor(255*a.a)};if(n.clips)for(let v=0,t=0;v<u;++v,t+=4*o)for(let i=0,a=0;i<o;i++,a+=4){const h=i/(o-1),{start:y,end:w}=n.clips[v];g(t,a,y*(1-h)+w*h)}else for(let v=0,t=0;v<o;v++,t+=4)g(0,t,v/(o-1));return f}Pt("AlphaImage",Vr),Pt("RGBAImage",Pr);var oc={paint:new nn({"hillshade-illumination-direction":new Ot(Me.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Ot(Me.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Ot(Me.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Ot(Me.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Ot(Me.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Ot(Me.paint_hillshade["hillshade-accent-color"])})};const _u=un([{name:"a_pos",components:2,type:"Int16"}],4),{members:vu}=_u;var sc={exports:{}};function kn(n,e,o){o=o||2;var u,f,g,v,t,i,a,h=e&&e.length,y=h?e[0]*o:n.length,w=ac(n,0,y,o,!0),E=[];if(!w||w.next===w.prev)return E;if(h&&(w=function(N,W,se,pe){var ie,Te,Le,Re=[];for(ie=0,Te=W.length;ie<Te;ie++)(Le=ac(N,W[ie]*pe,ie<Te-1?W[ie+1]*pe:N.length,pe,!1))===Le.next&&(Le.steiner=!0),Re.push(rd(Le));for(Re.sort(nh),ie=0;ie<Re.length;ie++)se=ed(Re[ie],se);return se}(n,e,w,o)),n.length>80*o){u=g=n[0],f=v=n[1];for(var z=o;z<y;z+=o)(t=n[z])<u&&(u=t),(i=n[z+1])<f&&(f=i),t>g&&(g=t),i>v&&(v=i);a=(a=Math.max(g-u,v-f))!==0?32767/a:0}return za(w,E,o,u,f,a,0),E}function ac(n,e,o,u,f){var g,v;if(f===hc(n,e,o,u)>0)for(g=e;g<o;g+=u)v=uc(g,n[g],n[g+1],v);else for(g=o-u;g>=e;g-=u)v=uc(g,n[g],n[g+1],v);return v&&wu(v,v.next)&&(Dl(v),v=v.next),v}function Qo(n,e){if(!n)return n;e||(e=n);var o,u=n;do if(o=!1,u.steiner||!wu(u,u.next)&&tn(u.prev,u,u.next)!==0)u=u.next;else{if(Dl(u),(u=e=u.prev)===u.next)break;o=!0}while(o||u!==e);return e}function za(n,e,o,u,f,g,v){if(n){!v&&g&&function(h,y,w,E){var z=h;do z.z===0&&(z.z=lc(z.x,z.y,y,w,E)),z.prevZ=z.prev,z.nextZ=z.next,z=z.next;while(z!==h);z.prevZ.nextZ=null,z.prevZ=null,function(N){var W,se,pe,ie,Te,Le,Re,xt,we=1;do{for(se=N,N=null,Te=null,Le=0;se;){for(Le++,pe=se,Re=0,W=0;W<we&&(Re++,pe=pe.nextZ);W++);for(xt=we;Re>0||xt>0&&pe;)Re!==0&&(xt===0||!pe||se.z<=pe.z)?(ie=se,se=se.nextZ,Re--):(ie=pe,pe=pe.nextZ,xt--),Te?Te.nextZ=ie:N=ie,ie.prevZ=Te,Te=ie;se=pe}Te.nextZ=null,we*=2}while(Le>1)}(z)}(n,u,f,g);for(var t,i,a=n;n.prev!==n.next;)if(t=n.prev,i=n.next,g?Fi(n,u,f,g):Ao(n))e.push(t.i/o|0),e.push(n.i/o|0),e.push(i.i/o|0),Dl(n),n=i.next,a=i.next;else if((n=i)===a){v?v===1?za(n=xu(Qo(n),e,o),e,o,u,f,g,2):v===2&&rh(n,e,o,u,f,g):za(Qo(n),e,o,u,f,g,1);break}}}function Ao(n){var e=n.prev,o=n,u=n.next;if(tn(e,o,u)>=0)return!1;for(var f=e.x,g=o.x,v=u.x,t=e.y,i=o.y,a=u.y,h=f<g?f<v?f:v:g<v?g:v,y=t<i?t<a?t:a:i<a?i:a,w=f>g?f>v?f:v:g>v?g:v,E=t>i?t>a?t:a:i>a?i:a,z=u.next;z!==e;){if(z.x>=h&&z.x<=w&&z.y>=y&&z.y<=E&&Pa(f,t,g,i,v,a,z.x,z.y)&&tn(z.prev,z,z.next)>=0)return!1;z=z.next}return!0}function Fi(n,e,o,u){var f=n.prev,g=n,v=n.next;if(tn(f,g,v)>=0)return!1;for(var t=f.x,i=g.x,a=v.x,h=f.y,y=g.y,w=v.y,E=t<i?t<a?t:a:i<a?i:a,z=h<y?h<w?h:w:y<w?y:w,N=t>i?t>a?t:a:i>a?i:a,W=h>y?h>w?h:w:y>w?y:w,se=lc(E,z,e,o,u),pe=lc(N,W,e,o,u),ie=n.prevZ,Te=n.nextZ;ie&&ie.z>=se&&Te&&Te.z<=pe;){if(ie.x>=E&&ie.x<=N&&ie.y>=z&&ie.y<=W&&ie!==f&&ie!==v&&Pa(t,h,i,y,a,w,ie.x,ie.y)&&tn(ie.prev,ie,ie.next)>=0||(ie=ie.prevZ,Te.x>=E&&Te.x<=N&&Te.y>=z&&Te.y<=W&&Te!==f&&Te!==v&&Pa(t,h,i,y,a,w,Te.x,Te.y)&&tn(Te.prev,Te,Te.next)>=0))return!1;Te=Te.nextZ}for(;ie&&ie.z>=se;){if(ie.x>=E&&ie.x<=N&&ie.y>=z&&ie.y<=W&&ie!==f&&ie!==v&&Pa(t,h,i,y,a,w,ie.x,ie.y)&&tn(ie.prev,ie,ie.next)>=0)return!1;ie=ie.prevZ}for(;Te&&Te.z<=pe;){if(Te.x>=E&&Te.x<=N&&Te.y>=z&&Te.y<=W&&Te!==f&&Te!==v&&Pa(t,h,i,y,a,w,Te.x,Te.y)&&tn(Te.prev,Te,Te.next)>=0)return!1;Te=Te.nextZ}return!0}function xu(n,e,o){var u=n;do{var f=u.prev,g=u.next.next;!wu(f,g)&&Ml(f,u,u.next,g)&&Bs(f,g)&&Bs(g,f)&&(e.push(f.i/o|0),e.push(u.i/o|0),e.push(g.i/o|0),Dl(u),Dl(u.next),u=n=g),u=u.next}while(u!==n);return Qo(u)}function rh(n,e,o,u,f,g){var v=n;do{for(var t=v.next.next;t!==v.prev;){if(v.i!==t.i&&nd(v,t)){var i=ih(v,t);return v=Qo(v,v.next),i=Qo(i,i.next),za(v,e,o,u,f,g,0),void za(i,e,o,u,f,g,0)}t=t.next}v=v.next}while(v!==n)}function nh(n,e){return n.x-e.x}function ed(n,e){var o=function(f,g){var v,t=g,i=f.x,a=f.y,h=-1/0;do{if(a<=t.y&&a>=t.next.y&&t.next.y!==t.y){var y=t.x+(a-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(y<=i&&y>h&&(h=y,v=t.x<t.next.x?t:t.next,y===i))return v}t=t.next}while(t!==g);if(!v)return null;var w,E=v,z=v.x,N=v.y,W=1/0;t=v;do i>=t.x&&t.x>=z&&i!==t.x&&Pa(a<N?i:h,a,z,N,a<N?h:i,a,t.x,t.y)&&(w=Math.abs(a-t.y)/(i-t.x),Bs(t,f)&&(w<W||w===W&&(t.x>v.x||t.x===v.x&&td(v,t)))&&(v=t,W=w)),t=t.next;while(t!==E);return v}(n,e);if(!o)return e;var u=ih(o,n);return Qo(u,u.next),Qo(o,o.next)}function td(n,e){return tn(n.prev,n,e.prev)<0&&tn(e.next,n,n.next)<0}function lc(n,e,o,u,f){return(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=(n-o)*f|0)|n<<8))|n<<4))|n<<2))|n<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-u)*f|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function rd(n){var e=n,o=n;do(e.x<o.x||e.x===o.x&&e.y<o.y)&&(o=e),e=e.next;while(e!==n);return o}function Pa(n,e,o,u,f,g,v,t){return(f-v)*(e-t)>=(n-v)*(g-t)&&(n-v)*(u-t)>=(o-v)*(e-t)&&(o-v)*(g-t)>=(f-v)*(u-t)}function nd(n,e){return n.next.i!==e.i&&n.prev.i!==e.i&&!function(o,u){var f=o;do{if(f.i!==o.i&&f.next.i!==o.i&&f.i!==u.i&&f.next.i!==u.i&&Ml(f,f.next,o,u))return!0;f=f.next}while(f!==o);return!1}(n,e)&&(Bs(n,e)&&Bs(e,n)&&function(o,u){var f=o,g=!1,v=(o.x+u.x)/2,t=(o.y+u.y)/2;do f.y>t!=f.next.y>t&&f.next.y!==f.y&&v<(f.next.x-f.x)*(t-f.y)/(f.next.y-f.y)+f.x&&(g=!g),f=f.next;while(f!==o);return g}(n,e)&&(tn(n.prev,n,e.prev)||tn(n,e.prev,e))||wu(n,e)&&tn(n.prev,n,n.next)>0&&tn(e.prev,e,e.next)>0)}function tn(n,e,o){return(e.y-n.y)*(o.x-e.x)-(e.x-n.x)*(o.y-e.y)}function wu(n,e){return n.x===e.x&&n.y===e.y}function Ml(n,e,o,u){var f=Ma(tn(n,e,o)),g=Ma(tn(n,e,u)),v=Ma(tn(o,u,n)),t=Ma(tn(o,u,e));return f!==g&&v!==t||!(f!==0||!bu(n,o,e))||!(g!==0||!bu(n,u,e))||!(v!==0||!bu(o,n,u))||!(t!==0||!bu(o,e,u))}function bu(n,e,o){return e.x<=Math.max(n.x,o.x)&&e.x>=Math.min(n.x,o.x)&&e.y<=Math.max(n.y,o.y)&&e.y>=Math.min(n.y,o.y)}function Ma(n){return n>0?1:n<0?-1:0}function Bs(n,e){return tn(n.prev,n,n.next)<0?tn(n,e,n.next)>=0&&tn(n,n.prev,e)>=0:tn(n,e,n.prev)<0||tn(n,n.next,e)<0}function ih(n,e){var o=new cc(n.i,n.x,n.y),u=new cc(e.i,e.x,e.y),f=n.next,g=e.prev;return n.next=e,e.prev=n,o.next=f,f.prev=o,u.next=o,o.prev=u,g.next=u,u.prev=g,u}function uc(n,e,o,u){var f=new cc(n,e,o);return u?(f.next=u.next,f.prev=u,u.next.prev=f,u.next=f):(f.prev=f,f.next=f),f}function Dl(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function cc(n,e,o){this.i=n,this.x=e,this.y=o,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function hc(n,e,o,u){for(var f=0,g=e,v=o-u;g<o;g+=u)f+=(n[v]-n[g])*(n[g+1]+n[v+1]),v=g;return f}function id(n,e,o,u,f){dc(n,e,o,u||n.length-1,f||od)}function dc(n,e,o,u,f){for(;u>o;){if(u-o>600){var g=u-o+1,v=e-o+1,t=Math.log(g),i=.5*Math.exp(2*t/3),a=.5*Math.sqrt(t*i*(g-i)/g)*(v-g/2<0?-1:1);dc(n,e,Math.max(o,Math.floor(e-v*i/g+a)),Math.min(u,Math.floor(e+(g-v)*i/g+a)),f)}var h=n[e],y=o,w=u;for(Rl(n,o,e),f(n[u],h)>0&&Rl(n,o,u);y<w;){for(Rl(n,y,w),y++,w--;f(n[y],h)<0;)y++;for(;f(n[w],h)>0;)w--}f(n[o],h)===0?Rl(n,o,w):Rl(n,++w,u),w<=e&&(o=w+1),e<=w&&(u=w-1)}}function Rl(n,e,o){var u=n[e];n[e]=n[o],n[o]=u}function od(n,e){return n<e?-1:n>e?1:0}function fc(n,e){const o=n.length;if(o<=1)return[n];const u=[];let f,g;for(let v=0;v<o;v++){const t=De(n[v]);t!==0&&(n[v].area=Math.abs(t),g===void 0&&(g=t<0),g===t<0?(f&&u.push(f),f=[n[v]]):f.push(n[v]))}if(f&&u.push(f),e>1)for(let v=0;v<u.length;v++)u[v].length<=e||(id(u[v],e,1,u[v].length-1,sf),u[v]=u[v].slice(0,e));return u}function sf(n,e){return e.area-n.area}function pc(n,e,o){const u=o.patternDependencies;let f=!1;for(const g of e){const v=g.paint.get(`${n}-pattern`);v.isConstant()||(f=!0);const t=v.constantOr(null);t&&(f=!0,u[t.to]=!0,u[t.from]=!0)}return f}function oh(n,e,o,u,f){const g=f.patternDependencies;for(const v of e){const t=v.paint.get(`${n}-pattern`).value;if(t.kind!=="constant"){let i=t.evaluate({zoom:u-1},o,{},f.availableImages),a=t.evaluate({zoom:u},o,{},f.availableImages),h=t.evaluate({zoom:u+1},o,{},f.availableImages);i=i&&i.name?i.name:i,a=a&&a.name?a.name:a,h=h&&h.name?h.name:h,g[i]=!0,g[a]=!0,g[h]=!0,o.patterns[v.id]={min:i,mid:a,max:h}}}return o}sc.exports=kn,sc.exports.default=kn,kn.deviation=function(n,e,o,u){var f=e&&e.length,g=Math.abs(hc(n,0,f?e[0]*o:n.length,o));if(f)for(var v=0,t=e.length;v<t;v++)g-=Math.abs(hc(n,e[v]*o,v<t-1?e[v+1]*o:n.length,o));var i=0;for(v=0;v<u.length;v+=3){var a=u[v]*o,h=u[v+1]*o,y=u[v+2]*o;i+=Math.abs((n[a]-n[y])*(n[h+1]-n[a+1])-(n[a]-n[h])*(n[y+1]-n[a+1]))}return g===0&&i===0?0:Math.abs((i-g)/g)},kn.flatten=function(n){for(var e=n[0][0].length,o={vertices:[],holes:[],dimensions:e},u=0,f=0;f<n.length;f++){for(var g=0;g<n[f].length;g++)for(var v=0;v<e;v++)o.vertices.push(n[f][g][v]);f>0&&o.holes.push(u+=n[f-1].length)}return o};class sh{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(o=>o.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Ir,this.indexArray=new jr,this.indexArray2=new En,this.programConfigurations=new Bn(e.layers,e.zoom),this.segments=new mr,this.segments2=new mr,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(e,o,u){this.hasPattern=pc("fill",this.layers,o);const f=this.layers[0].layout.get("fill-sort-key"),g=!f.isConstant(),v=[];for(const{feature:t,id:i,index:a,sourceLayerIndex:h}of e){const y=this.layers[0]._featureFilter.needGeometry,w=Ls(t,y);if(!this.layers[0]._featureFilter.filter(new Mr(this.zoom),w,u))continue;const E=g?f.evaluate(w,{},u,o.availableImages):void 0,z={id:i,properties:t.properties,type:t.type,sourceLayerIndex:h,index:a,geometry:y?w.geometry:Ko(t),patterns:{},sortKey:E};v.push(z)}g&&v.sort((t,i)=>t.sortKey-i.sortKey);for(const t of v){const{geometry:i,index:a,sourceLayerIndex:h}=t;if(this.hasPattern){const y=oh("fill",this.layers,t,this.zoom,o);this.patternFeatures.push(y)}else this.addFeature(t,i,a,u,{});o.featureIndex.insert(e[a].feature,i,a,h,this.index)}}update(e,o,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,o,this.stateDependentLayers,u)}addFeatures(e,o,u){for(const f of this.patternFeatures)this.addFeature(f,f.geometry,f.index,o,u)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,vu),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,o,u,f,g){for(const v of fc(o,500)){let t=0;for(const E of v)t+=E.length;const i=this.segments.prepareSegment(t,this.layoutVertexArray,this.indexArray),a=i.vertexLength,h=[],y=[];for(const E of v){if(E.length===0)continue;E!==v[0]&&y.push(h.length/2);const z=this.segments2.prepareSegment(E.length,this.layoutVertexArray,this.indexArray2),N=z.vertexLength;this.layoutVertexArray.emplaceBack(E[0].x,E[0].y),this.indexArray2.emplaceBack(N+E.length-1,N),h.push(E[0].x),h.push(E[0].y);for(let W=1;W<E.length;W++)this.layoutVertexArray.emplaceBack(E[W].x,E[W].y),this.indexArray2.emplaceBack(N+W-1,N+W),h.push(E[W].x),h.push(E[W].y);z.vertexLength+=E.length,z.primitiveLength+=E.length}const w=sc.exports(h,y);for(let E=0;E<w.length;E+=3)this.indexArray.emplaceBack(a+w[E],a+w[E+1],a+w[E+2]);i.vertexLength+=t,i.primitiveLength+=w.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,u,g,f)}}Pt("FillBucket",sh,{omit:["layers","patternFeatures"]});const sd=new nn({"fill-sort-key":new Gt(Me.layout_fill["fill-sort-key"])});var ad={paint:new nn({"fill-antialias":new Ot(Me.paint_fill["fill-antialias"]),"fill-opacity":new Gt(Me.paint_fill["fill-opacity"]),"fill-color":new Gt(Me.paint_fill["fill-color"]),"fill-outline-color":new Gt(Me.paint_fill["fill-outline-color"]),"fill-translate":new Ot(Me.paint_fill["fill-translate"]),"fill-translate-anchor":new Ot(Me.paint_fill["fill-translate-anchor"]),"fill-pattern":new As(Me.paint_fill["fill-pattern"])}),layout:sd};const ld=un([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),mc=un([{name:"a_centroid",components:2,type:"Int16"}],4),{members:af}=ld;var Fs={},lf=ht,Da=Os;function Os(n,e,o,u,f){this.properties={},this.extent=o,this.type=0,this._pbf=n,this._geometry=-1,this._keys=u,this._values=f,n.readFields(ah,this,e)}function ah(n,e,o){n==1?e.id=o.readVarint():n==2?function(u,f){for(var g=u.readVarint()+u.pos;u.pos<g;){var v=f._keys[u.readVarint()],t=f._values[u.readVarint()];f.properties[v]=t}}(o,e):n==3?e.type=o.readVarint():n==4&&(e._geometry=o.pos)}function uf(n){for(var e,o,u=0,f=0,g=n.length,v=g-1;f<g;v=f++)u+=((o=n[v]).x-(e=n[f]).x)*(e.y+o.y);return u}Os.types=["Unknown","Point","LineString","Polygon"],Os.prototype.loadGeometry=function(){var n=this._pbf;n.pos=this._geometry;for(var e,o=n.readVarint()+n.pos,u=1,f=0,g=0,v=0,t=[];n.pos<o;){if(f<=0){var i=n.readVarint();u=7&i,f=i>>3}if(f--,u===1||u===2)g+=n.readSVarint(),v+=n.readSVarint(),u===1&&(e&&t.push(e),e=[]),e.push(new lf(g,v));else{if(u!==7)throw new Error("unknown command "+u);e&&e.push(e[0].clone())}}return e&&t.push(e),t},Os.prototype.bbox=function(){var n=this._pbf;n.pos=this._geometry;for(var e=n.readVarint()+n.pos,o=1,u=0,f=0,g=0,v=1/0,t=-1/0,i=1/0,a=-1/0;n.pos<e;){if(u<=0){var h=n.readVarint();o=7&h,u=h>>3}if(u--,o===1||o===2)(f+=n.readSVarint())<v&&(v=f),f>t&&(t=f),(g+=n.readSVarint())<i&&(i=g),g>a&&(a=g);else if(o!==7)throw new Error("unknown command "+o)}return[v,i,t,a]},Os.prototype.toGeoJSON=function(n,e,o){var u,f,g=this.extent*Math.pow(2,o),v=this.extent*n,t=this.extent*e,i=this.loadGeometry(),a=Os.types[this.type];function h(E){for(var z=0;z<E.length;z++){var N=E[z];E[z]=[360*(N.x+v)/g-180,360/Math.PI*Math.atan(Math.exp((180-360*(N.y+t)/g)*Math.PI/180))-90]}}switch(this.type){case 1:var y=[];for(u=0;u<i.length;u++)y[u]=i[u][0];h(i=y);break;case 2:for(u=0;u<i.length;u++)h(i[u]);break;case 3:for(i=function(E){var z=E.length;if(z<=1)return[E];for(var N,W,se=[],pe=0;pe<z;pe++){var ie=uf(E[pe]);ie!==0&&(W===void 0&&(W=ie<0),W===ie<0?(N&&se.push(N),N=[E[pe]]):N.push(E[pe]))}return N&&se.push(N),se}(i),u=0;u<i.length;u++)for(f=0;f<i[u].length;f++)h(i[u][f])}i.length===1?i=i[0]:a="Multi"+a;var w={type:"Feature",geometry:{type:a,coordinates:i},properties:this.properties};return"id"in this&&(w.id=this.id),w};var ud=Da,lh=uh;function uh(n,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=n,this._keys=[],this._values=[],this._features=[],n.readFields(cd,this,e),this.length=this._features.length}function cd(n,e,o){n===15?e.version=o.readVarint():n===1?e.name=o.readString():n===5?e.extent=o.readVarint():n===2?e._features.push(o.pos):n===3?e._keys.push(o.readString()):n===4&&e._values.push(function(u){for(var f=null,g=u.readVarint()+u.pos;u.pos<g;){var v=u.readVarint()>>3;f=v===1?u.readString():v===2?u.readFloat():v===3?u.readDouble():v===4?u.readVarint64():v===5?u.readVarint():v===6?u.readSVarint():v===7?u.readBoolean():null}return f}(o))}uh.prototype.feature=function(n){if(n<0||n>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[n];var e=this._pbf.readVarint()+this._pbf.pos;return new ud(this._pbf,e,this.extent,this._keys,this._values)};var hd=lh;function cf(n,e,o){if(n===3){var u=new hd(o,o.readVarint()+o.pos);u.length&&(e[u.name]=u)}}Fs.VectorTile=function(n,e){this.layers=n.readFields(cf,{},e)},Fs.VectorTileFeature=Da,Fs.VectorTileLayer=lh;const pi=Fs.VectorTileFeature.types,Zn=Math.pow(2,13);function Ll(n,e,o,u,f,g,v,t){n.emplaceBack(e,o,2*Math.floor(u*Zn)+v,f*Zn*2,g*Zn*2,Math.round(t))}class gc{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(o=>o.id),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new cr,this.centroidVertexArray=new Jt,this.indexArray=new jr,this.programConfigurations=new Bn(e.layers,e.zoom),this.segments=new mr,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(e,o,u){this.features=[],this.hasPattern=pc("fill-extrusion",this.layers,o);for(const{feature:f,id:g,index:v,sourceLayerIndex:t}of e){const i=this.layers[0]._featureFilter.needGeometry,a=Ls(f,i);if(!this.layers[0]._featureFilter.filter(new Mr(this.zoom),a,u))continue;const h={id:g,sourceLayerIndex:t,index:v,geometry:i?a.geometry:Ko(f),properties:f.properties,type:f.type,patterns:{}};this.hasPattern?this.features.push(oh("fill-extrusion",this.layers,h,this.zoom,o)):this.addFeature(h,h.geometry,v,u,{}),o.featureIndex.insert(f,h.geometry,v,t,this.index,!0)}}addFeatures(e,o,u){for(const f of this.features){const{geometry:g}=f;this.addFeature(f,g,f.index,o,u)}}update(e,o,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,o,this.stateDependentLayers,u)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,af),this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,mc.members,!0),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(e,o,u,f,g){const v={x:0,y:0,vertexCount:0};for(const t of fc(o,500)){let i=0;for(const z of t)i+=z.length;let a=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const z of t){if(z.length===0||fd(z))continue;let N=0;for(let W=0;W<z.length;W++){const se=z[W];if(W>=1){const pe=z[W-1];if(!dd(se,pe)){a.vertexLength+4>mr.MAX_VERTEX_ARRAY_LENGTH&&(a=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const ie=se.sub(pe)._perp()._unit(),Te=pe.dist(se);N+Te>32768&&(N=0),Ll(this.layoutVertexArray,se.x,se.y,ie.x,ie.y,0,0,N),Ll(this.layoutVertexArray,se.x,se.y,ie.x,ie.y,0,1,N),v.x+=2*se.x,v.y+=2*se.y,v.vertexCount+=2,N+=Te,Ll(this.layoutVertexArray,pe.x,pe.y,ie.x,ie.y,0,0,N),Ll(this.layoutVertexArray,pe.x,pe.y,ie.x,ie.y,0,1,N),v.x+=2*pe.x,v.y+=2*pe.y,v.vertexCount+=2;const Le=a.vertexLength;this.indexArray.emplaceBack(Le,Le+2,Le+1),this.indexArray.emplaceBack(Le+1,Le+2,Le+3),a.vertexLength+=4,a.primitiveLength+=2}}}}if(a.vertexLength+i>mr.MAX_VERTEX_ARRAY_LENGTH&&(a=this.segments.prepareSegment(i,this.layoutVertexArray,this.indexArray)),pi[e.type]!=="Polygon")continue;const h=[],y=[],w=a.vertexLength;for(const z of t)if(z.length!==0){z!==t[0]&&y.push(h.length/2);for(let N=0;N<z.length;N++){const W=z[N];Ll(this.layoutVertexArray,W.x,W.y,0,0,1,1,0),v.x+=W.x,v.y+=W.y,v.vertexCount+=1,h.push(W.x),h.push(W.y)}}const E=sc.exports(h,y);for(let z=0;z<E.length;z+=3)this.indexArray.emplaceBack(w+E[z],w+E[z+2],w+E[z+1]);a.primitiveLength+=E.length/3,a.vertexLength+=i}for(let t=0;t<v.vertexCount;t++)this.centroidVertexArray.emplaceBack(Math.floor(v.x/v.vertexCount),Math.floor(v.y/v.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,u,g,f)}}function dd(n,e){return n.x===e.x&&(n.x<0||n.x>cn)||n.y===e.y&&(n.y<0||n.y>cn)}function fd(n){return n.every(e=>e.x<0)||n.every(e=>e.x>cn)||n.every(e=>e.y<0)||n.every(e=>e.y>cn)}Pt("FillExtrusionBucket",gc,{omit:["layers","features"]});var pd={paint:new nn({"fill-extrusion-opacity":new Ot(Me["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Gt(Me["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Ot(Me["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Ot(Me["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new As(Me["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Gt(Me["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Gt(Me["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Ot(Me["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})};function Ra(n,e){return n.x*e.x+n.y*e.y}function ch(n,e){if(n.length===1){let o=0;const u=e[o++];let f;for(;!f||u.equals(f);)if(f=e[o++],!f)return 1/0;for(;o<e.length;o++){const g=e[o],v=n[0],t=f.sub(u),i=g.sub(u),a=v.sub(u),h=Ra(t,t),y=Ra(t,i),w=Ra(i,i),E=Ra(a,t),z=Ra(a,i),N=h*w-y*y,W=(w*E-y*z)/N,se=(h*z-y*E)/N,pe=u.z*(1-W-se)+f.z*W+g.z*se;if(isFinite(pe))return pe}return 1/0}{let o=1/0;for(const u of e)o=Math.min(o,u.z);return o}}const hh=un([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:md}=hh,gd=un([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:dh}=gd,fh=Fs.VectorTileFeature.types,yd=Math.cos(Math.PI/180*37.5),yc=Math.pow(2,14)/.5;class Bl{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(o=>o.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(o=>{this.gradients[o.id]={}}),this.layoutVertexArray=new ir,this.layoutVertexArray2=new ar,this.indexArray=new jr,this.programConfigurations=new Bn(e.layers,e.zoom),this.segments=new mr,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(e,o,u){this.hasPattern=pc("line",this.layers,o);const f=this.layers[0].layout.get("line-sort-key"),g=!f.isConstant(),v=[];for(const{feature:t,id:i,index:a,sourceLayerIndex:h}of e){const y=this.layers[0]._featureFilter.needGeometry,w=Ls(t,y);if(!this.layers[0]._featureFilter.filter(new Mr(this.zoom),w,u))continue;const E=g?f.evaluate(w,{},u):void 0,z={id:i,properties:t.properties,type:t.type,sourceLayerIndex:h,index:a,geometry:y?w.geometry:Ko(t),patterns:{},sortKey:E};v.push(z)}g&&v.sort((t,i)=>t.sortKey-i.sortKey);for(const t of v){const{geometry:i,index:a,sourceLayerIndex:h}=t;if(this.hasPattern){const y=oh("line",this.layers,t,this.zoom,o);this.patternFeatures.push(y)}else this.addFeature(t,i,a,u,{});o.featureIndex.insert(e[a].feature,i,a,h,this.index)}}update(e,o,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,o,this.stateDependentLayers,u)}addFeatures(e,o,u){for(const f of this.patternFeatures)this.addFeature(f,f.geometry,f.index,o,u)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,dh)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,md),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}addFeature(e,o,u,f,g){const v=this.layers[0].layout,t=v.get("line-join").evaluate(e,{}),i=v.get("line-cap"),a=v.get("line-miter-limit"),h=v.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(const y of o)this.addLine(y,e,t,i,a,h);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,u,g,f)}addLine(e,o,u,f,g,v){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let se=0;se<e.length-1;se++)this.totalDistance+=e[se].dist(e[se+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const t=fh[o.type]==="Polygon";let i=e.length;for(;i>=2&&e[i-1].equals(e[i-2]);)i--;let a=0;for(;a<i-1&&e[a].equals(e[a+1]);)a++;if(i<(t?3:2))return;u==="bevel"&&(g=1.05);const h=this.overscaling<=16?122880/(512*this.overscaling):0,y=this.segments.prepareSegment(10*i,this.layoutVertexArray,this.indexArray);let w,E,z,N,W;this.e1=this.e2=-1,t&&(w=e[i-2],W=e[a].sub(w)._unit()._perp());for(let se=a;se<i;se++){if(z=se===i-1?t?e[a+1]:void 0:e[se+1],z&&e[se].equals(z))continue;W&&(N=W),w&&(E=w),w=e[se],W=z?z.sub(w)._unit()._perp():N,N=N||W;let pe=N.add(W);pe.x===0&&pe.y===0||pe._unit();const ie=N.x*W.x+N.y*W.y,Te=pe.x*W.x+pe.y*W.y,Le=Te!==0?1/Te:1/0,Re=2*Math.sqrt(2-2*Te),xt=Te<yd&&E&&z,we=N.x*W.y-N.y*W.x>0;if(xt&&se>a){const Be=w.dist(E);if(Be>2*h){const tt=w.sub(w.sub(E)._mult(h/Be)._round());this.updateDistance(E,tt),this.addCurrentVertex(tt,N,0,0,y),E=tt}}const ue=E&&z;let ge=ue?u:t?"butt":f;if(ue&&ge==="round"&&(Le<v?ge="miter":Le<=2&&(ge="fakeround")),ge==="miter"&&Le>g&&(ge="bevel"),ge==="bevel"&&(Le>2&&(ge="flipbevel"),Le<g&&(ge="miter")),E&&this.updateDistance(E,w),ge==="miter")pe._mult(Le),this.addCurrentVertex(w,pe,0,0,y);else if(ge==="flipbevel"){if(Le>100)pe=W.mult(-1);else{const Be=Le*N.add(W).mag()/N.sub(W).mag();pe._perp()._mult(Be*(we?-1:1))}this.addCurrentVertex(w,pe,0,0,y),this.addCurrentVertex(w,pe.mult(-1),0,0,y)}else if(ge==="bevel"||ge==="fakeround"){const Be=-Math.sqrt(Le*Le-1),tt=we?Be:0,nt=we?0:Be;if(E&&this.addCurrentVertex(w,N,tt,nt,y),ge==="fakeround"){const Ge=Math.round(180*Re/Math.PI/20);for(let mt=1;mt<Ge;mt++){let Ct=mt/Ge;if(Ct!==.5){const br=Ct-.5;Ct+=Ct*br*(Ct-1)*((1.0904+ie*(ie*(3.55645-1.43519*ie)-3.2452))*br*br+(.848013+ie*(.215638*ie-1.06021)))}const Mt=W.sub(N)._mult(Ct)._add(N)._unit()._mult(we?-1:1);this.addHalfVertex(w,Mt.x,Mt.y,!1,we,0,y)}}z&&this.addCurrentVertex(w,W,-tt,-nt,y)}else if(ge==="butt")this.addCurrentVertex(w,pe,0,0,y);else if(ge==="square"){const Be=E?1:-1;this.addCurrentVertex(w,pe,Be,Be,y)}else ge==="round"&&(E&&(this.addCurrentVertex(w,N,0,0,y),this.addCurrentVertex(w,N,1,1,y,!0)),z&&(this.addCurrentVertex(w,W,-1,-1,y,!0),this.addCurrentVertex(w,W,0,0,y)));if(xt&&se<i-1){const Be=w.dist(z);if(Be>2*h){const tt=w.add(z.sub(w)._mult(h/Be)._round());this.updateDistance(w,tt),this.addCurrentVertex(tt,W,0,0,y),w=tt}}}}addCurrentVertex(e,o,u,f,g,v=!1){const t=o.y*f-o.x,i=-o.y-o.x*f;this.addHalfVertex(e,o.x+o.y*u,o.y-o.x*u,v,!1,u,g),this.addHalfVertex(e,t,i,v,!0,-f,g),this.distance>yc/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(e,o,u,f,g,v))}addHalfVertex({x:e,y:o},u,f,g,v,t,i){const a=.5*(this.lineClips?this.scaledDistance*(yc-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((e<<1)+(g?1:0),(o<<1)+(v?1:0),Math.round(63*u)+128,Math.round(63*f)+128,1+(t===0?0:t<0?-1:1)|(63&a)<<2,a>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const h=i.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,h),i.primitiveLength++),v?this.e2=h:this.e1=h}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(e,o){this.distance+=e.dist(o),this.updateScaledDistance()}}Pt("LineBucket",Bl,{omit:["layers","patternFeatures"]});const hf=new nn({"line-cap":new Ot(Me.layout_line["line-cap"]),"line-join":new Gt(Me.layout_line["line-join"]),"line-miter-limit":new Ot(Me.layout_line["line-miter-limit"]),"line-round-limit":new Ot(Me.layout_line["line-round-limit"]),"line-sort-key":new Gt(Me.layout_line["line-sort-key"])});var ph={paint:new nn({"line-opacity":new Gt(Me.paint_line["line-opacity"]),"line-color":new Gt(Me.paint_line["line-color"]),"line-translate":new Ot(Me.paint_line["line-translate"]),"line-translate-anchor":new Ot(Me.paint_line["line-translate-anchor"]),"line-width":new Gt(Me.paint_line["line-width"]),"line-gap-width":new Gt(Me.paint_line["line-gap-width"]),"line-offset":new Gt(Me.paint_line["line-offset"]),"line-blur":new Gt(Me.paint_line["line-blur"]),"line-dasharray":new wo(Me.paint_line["line-dasharray"]),"line-pattern":new As(Me.paint_line["line-pattern"]),"line-gradient":new zs(Me.paint_line["line-gradient"])}),layout:hf};const _c=new class extends Gt{possiblyEvaluate(n,e){return e=new Mr(Math.floor(e.zoom),{now:e.now,fadeDuration:e.fadeDuration,zoomHistory:e.zoomHistory,transition:e.transition}),super.possiblyEvaluate(n,e)}evaluate(n,e,o,u){return e=Q({},e,{zoom:Math.floor(e.zoom)}),super.evaluate(n,e,o,u)}}(ph.paint.properties["line-width"].specification);function mh(n,e){return e>0?e+2*n:n}_c.useIntegerZoom=!0;const vc=un([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),es=un([{name:"a_projected_pos",components:3,type:"Float32"}],4);un([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const df=un([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);un([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const gh=un([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),yh=un([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function _d(n,e,o){return n.sections.forEach(u=>{u.text=function(f,g,v){const t=g.layout.get("text-transform").evaluate(v,{});return t==="uppercase"?f=f.toLocaleUpperCase():t==="lowercase"&&(f=f.toLocaleLowerCase()),_r.applyArabicShaping&&(f=_r.applyArabicShaping(f)),f}(u.text,e,o)}),n}un([{name:"triangle",components:3,type:"Uint16"}]),un([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),un([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),un([{type:"Float32",name:"offsetX"}]),un([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);const Fl={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"};var sn=24,Fn=Er,vd=function(n,e,o,u,f){var g,v,t=8*f-u-1,i=(1<<t)-1,a=i>>1,h=-7,y=f-1,w=-1,E=n[e+y];for(y+=w,g=E&(1<<-h)-1,E>>=-h,h+=t;h>0;g=256*g+n[e+y],y+=w,h-=8);for(v=g&(1<<-h)-1,g>>=-h,h+=u;h>0;v=256*v+n[e+y],y+=w,h-=8);if(g===0)g=1-a;else{if(g===i)return v?NaN:1/0*(E?-1:1);v+=Math.pow(2,u),g-=a}return(E?-1:1)*v*Math.pow(2,g-u)},xd=function(n,e,o,u,f,g){var v,t,i,a=8*g-f-1,h=(1<<a)-1,y=h>>1,w=f===23?Math.pow(2,-24)-Math.pow(2,-77):0,E=0,z=1,N=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(t=isNaN(e)?1:0,v=h):(v=Math.floor(Math.log(e)/Math.LN2),e*(i=Math.pow(2,-v))<1&&(v--,i*=2),(e+=v+y>=1?w/i:w*Math.pow(2,1-y))*i>=2&&(v++,i/=2),v+y>=h?(t=0,v=h):v+y>=1?(t=(e*i-1)*Math.pow(2,f),v+=y):(t=e*Math.pow(2,y-1)*Math.pow(2,f),v=0));f>=8;n[o+E]=255&t,E+=z,t/=256,f-=8);for(v=v<<f|t,a+=f;a>0;n[o+E]=255&v,E+=z,v/=256,a-=8);n[o+E-z]|=128*N};function Er(n){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(n)?n:new Uint8Array(n||0),this.pos=0,this.type=0,this.length=this.buf.length}Er.Varint=0,Er.Fixed64=1,Er.Bytes=2,Er.Fixed32=5;var an,_h=4294967296,Nt=1/_h,La=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function ro(n){return n.type===Er.Bytes?n.readVarint()+n.pos:n.pos+1}function Ba(n,e,o){return o?4294967296*e+(n>>>0):4294967296*(e>>>0)+(n>>>0)}function wd(n,e,o){var u=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));o.realloc(u);for(var f=o.pos-1;f>=n;f--)o.buf[f+u]=o.buf[f]}function Su(n,e){for(var o=0;o<n.length;o++)e.writeVarint(n[o])}function xc(n,e){for(var o=0;o<n.length;o++)e.writeSVarint(n[o])}function vh(n,e){for(var o=0;o<n.length;o++)e.writeFloat(n[o])}function bd(n,e){for(var o=0;o<n.length;o++)e.writeDouble(n[o])}function Sd(n,e){for(var o=0;o<n.length;o++)e.writeBoolean(n[o])}function Ed(n,e){for(var o=0;o<n.length;o++)e.writeFixed32(n[o])}function xh(n,e){for(var o=0;o<n.length;o++)e.writeSFixed32(n[o])}function wh(n,e){for(var o=0;o<n.length;o++)e.writeFixed64(n[o])}function qn(n,e){for(var o=0;o<n.length;o++)e.writeSFixed64(n[o])}function mi(n,e){return(n[e]|n[e+1]<<8|n[e+2]<<16)+16777216*n[e+3]}function Ei(n,e,o){n[o]=e,n[o+1]=e>>>8,n[o+2]=e>>>16,n[o+3]=e>>>24}function bh(n,e){return(n[e]|n[e+1]<<8|n[e+2]<<16)+(n[e+3]<<24)}function Td(n,e,o){n===1&&o.readMessage(no,e)}function no(n,e,o){if(n===3){const{id:u,bitmap:f,width:g,height:v,left:t,top:i,advance:a}=o.readMessage(kd,{});e.push({id:u,bitmap:new Vr({width:g+6,height:v+6},f),metrics:{width:g,height:v,left:t,top:i,advance:a}})}}function kd(n,e,o){n===1?e.id=o.readVarint():n===2?e.bitmap=o.readBytes():n===3?e.width=o.readVarint():n===4?e.height=o.readVarint():n===5?e.left=o.readSVarint():n===6?e.top=o.readSVarint():n===7&&(e.advance=o.readVarint())}function io(n){let e=0,o=0;for(const v of n)e+=v.w*v.h,o=Math.max(o,v.w);n.sort((v,t)=>t.h-v.h);const u=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),o),h:1/0}];let f=0,g=0;for(const v of n)for(let t=u.length-1;t>=0;t--){const i=u[t];if(!(v.w>i.w||v.h>i.h)){if(v.x=i.x,v.y=i.y,g=Math.max(g,v.y+v.h),f=Math.max(f,v.x+v.w),v.w===i.w&&v.h===i.h){const a=u.pop();t<u.length&&(u[t]=a)}else v.h===i.h?(i.x+=v.w,i.w-=v.w):v.w===i.w?(i.y+=v.h,i.h-=v.h):(u.push({x:i.x+v.w,y:i.y,w:i.w-v.w,h:v.h}),i.y+=v.h,i.h-=v.h);break}}return{w:f,h:g,fill:e/(f*g)||0}}Er.prototype={destroy:function(){this.buf=null},readFields:function(n,e,o){for(o=o||this.length;this.pos<o;){var u=this.readVarint(),f=u>>3,g=this.pos;this.type=7&u,n(f,e,this),this.pos===g&&this.skip(u)}return e},readMessage:function(n,e){return this.readFields(n,e,this.readVarint()+this.pos)},readFixed32:function(){var n=mi(this.buf,this.pos);return this.pos+=4,n},readSFixed32:function(){var n=bh(this.buf,this.pos);return this.pos+=4,n},readFixed64:function(){var n=mi(this.buf,this.pos)+mi(this.buf,this.pos+4)*_h;return this.pos+=8,n},readSFixed64:function(){var n=mi(this.buf,this.pos)+bh(this.buf,this.pos+4)*_h;return this.pos+=8,n},readFloat:function(){var n=vd(this.buf,this.pos,!0,23,4);return this.pos+=4,n},readDouble:function(){var n=vd(this.buf,this.pos,!0,52,8);return this.pos+=8,n},readVarint:function(n){var e,o,u=this.buf;return e=127&(o=u[this.pos++]),o<128?e:(e|=(127&(o=u[this.pos++]))<<7,o<128?e:(e|=(127&(o=u[this.pos++]))<<14,o<128?e:(e|=(127&(o=u[this.pos++]))<<21,o<128?e:function(f,g,v){var t,i,a=v.buf;if(t=(112&(i=a[v.pos++]))>>4,i<128||(t|=(127&(i=a[v.pos++]))<<3,i<128)||(t|=(127&(i=a[v.pos++]))<<10,i<128)||(t|=(127&(i=a[v.pos++]))<<17,i<128)||(t|=(127&(i=a[v.pos++]))<<24,i<128)||(t|=(1&(i=a[v.pos++]))<<31,i<128))return Ba(f,t,g);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(o=u[this.pos]))<<28,n,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var n=this.readVarint();return n%2==1?(n+1)/-2:n/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var n=this.readVarint()+this.pos,e=this.pos;return this.pos=n,n-e>=12&&La?function(o,u,f){return La.decode(o.subarray(u,f))}(this.buf,e,n):function(o,u,f){for(var g="",v=u;v<f;){var t,i,a,h=o[v],y=null,w=h>239?4:h>223?3:h>191?2:1;if(v+w>f)break;w===1?h<128&&(y=h):w===2?(192&(t=o[v+1]))==128&&(y=(31&h)<<6|63&t)<=127&&(y=null):w===3?(i=o[v+2],(192&(t=o[v+1]))==128&&(192&i)==128&&((y=(15&h)<<12|(63&t)<<6|63&i)<=2047||y>=55296&&y<=57343)&&(y=null)):w===4&&(i=o[v+2],a=o[v+3],(192&(t=o[v+1]))==128&&(192&i)==128&&(192&a)==128&&((y=(15&h)<<18|(63&t)<<12|(63&i)<<6|63&a)<=65535||y>=1114112)&&(y=null)),y===null?(y=65533,w=1):y>65535&&(y-=65536,g+=String.fromCharCode(y>>>10&1023|55296),y=56320|1023&y),g+=String.fromCharCode(y),v+=w}return g}(this.buf,e,n)},readBytes:function(){var n=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,n);return this.pos=n,e},readPackedVarint:function(n,e){if(this.type!==Er.Bytes)return n.push(this.readVarint(e));var o=ro(this);for(n=n||[];this.pos<o;)n.push(this.readVarint(e));return n},readPackedSVarint:function(n){if(this.type!==Er.Bytes)return n.push(this.readSVarint());var e=ro(this);for(n=n||[];this.pos<e;)n.push(this.readSVarint());return n},readPackedBoolean:function(n){if(this.type!==Er.Bytes)return n.push(this.readBoolean());var e=ro(this);for(n=n||[];this.pos<e;)n.push(this.readBoolean());return n},readPackedFloat:function(n){if(this.type!==Er.Bytes)return n.push(this.readFloat());var e=ro(this);for(n=n||[];this.pos<e;)n.push(this.readFloat());return n},readPackedDouble:function(n){if(this.type!==Er.Bytes)return n.push(this.readDouble());var e=ro(this);for(n=n||[];this.pos<e;)n.push(this.readDouble());return n},readPackedFixed32:function(n){if(this.type!==Er.Bytes)return n.push(this.readFixed32());var e=ro(this);for(n=n||[];this.pos<e;)n.push(this.readFixed32());return n},readPackedSFixed32:function(n){if(this.type!==Er.Bytes)return n.push(this.readSFixed32());var e=ro(this);for(n=n||[];this.pos<e;)n.push(this.readSFixed32());return n},readPackedFixed64:function(n){if(this.type!==Er.Bytes)return n.push(this.readFixed64());var e=ro(this);for(n=n||[];this.pos<e;)n.push(this.readFixed64());return n},readPackedSFixed64:function(n){if(this.type!==Er.Bytes)return n.push(this.readSFixed64());var e=ro(this);for(n=n||[];this.pos<e;)n.push(this.readSFixed64());return n},skip:function(n){var e=7&n;if(e===Er.Varint)for(;this.buf[this.pos++]>127;);else if(e===Er.Bytes)this.pos=this.readVarint()+this.pos;else if(e===Er.Fixed32)this.pos+=4;else{if(e!==Er.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(n,e){this.writeVarint(n<<3|e)},realloc:function(n){for(var e=this.length||16;e<this.pos+n;)e*=2;if(e!==this.length){var o=new Uint8Array(e);o.set(this.buf),this.buf=o,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(n){this.realloc(4),Ei(this.buf,n,this.pos),this.pos+=4},writeSFixed32:function(n){this.realloc(4),Ei(this.buf,n,this.pos),this.pos+=4},writeFixed64:function(n){this.realloc(8),Ei(this.buf,-1&n,this.pos),Ei(this.buf,Math.floor(n*Nt),this.pos+4),this.pos+=8},writeSFixed64:function(n){this.realloc(8),Ei(this.buf,-1&n,this.pos),Ei(this.buf,Math.floor(n*Nt),this.pos+4),this.pos+=8},writeVarint:function(n){(n=+n||0)>268435455||n<0?function(e,o){var u,f;if(e>=0?(u=e%4294967296|0,f=e/4294967296|0):(f=~(-e/4294967296),4294967295^(u=~(-e%4294967296))?u=u+1|0:(u=0,f=f+1|0)),e>=18446744073709552e3||e<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");o.realloc(10),function(g,v,t){t.buf[t.pos++]=127&g|128,g>>>=7,t.buf[t.pos++]=127&g|128,g>>>=7,t.buf[t.pos++]=127&g|128,g>>>=7,t.buf[t.pos++]=127&g|128,t.buf[t.pos]=127&(g>>>=7)}(u,0,o),function(g,v){var t=(7&g)<<4;v.buf[v.pos++]|=t|((g>>>=3)?128:0),g&&(v.buf[v.pos++]=127&g|((g>>>=7)?128:0),g&&(v.buf[v.pos++]=127&g|((g>>>=7)?128:0),g&&(v.buf[v.pos++]=127&g|((g>>>=7)?128:0),g&&(v.buf[v.pos++]=127&g|((g>>>=7)?128:0),g&&(v.buf[v.pos++]=127&g)))))}(f,o)}(n,this):(this.realloc(4),this.buf[this.pos++]=127&n|(n>127?128:0),n<=127||(this.buf[this.pos++]=127&(n>>>=7)|(n>127?128:0),n<=127||(this.buf[this.pos++]=127&(n>>>=7)|(n>127?128:0),n<=127||(this.buf[this.pos++]=n>>>7&127))))},writeSVarint:function(n){this.writeVarint(n<0?2*-n-1:2*n)},writeBoolean:function(n){this.writeVarint(!!n)},writeString:function(n){n=String(n),this.realloc(4*n.length),this.pos++;var e=this.pos;this.pos=function(u,f,g){for(var v,t,i=0;i<f.length;i++){if((v=f.charCodeAt(i))>55295&&v<57344){if(!t){v>56319||i+1===f.length?(u[g++]=239,u[g++]=191,u[g++]=189):t=v;continue}if(v<56320){u[g++]=239,u[g++]=191,u[g++]=189,t=v;continue}v=t-55296<<10|v-56320|65536,t=null}else t&&(u[g++]=239,u[g++]=191,u[g++]=189,t=null);v<128?u[g++]=v:(v<2048?u[g++]=v>>6|192:(v<65536?u[g++]=v>>12|224:(u[g++]=v>>18|240,u[g++]=v>>12&63|128),u[g++]=v>>6&63|128),u[g++]=63&v|128)}return g}(this.buf,n,this.pos);var o=this.pos-e;o>=128&&wd(e,o,this),this.pos=e-1,this.writeVarint(o),this.pos+=o},writeFloat:function(n){this.realloc(4),xd(this.buf,n,this.pos,!0,23,4),this.pos+=4},writeDouble:function(n){this.realloc(8),xd(this.buf,n,this.pos,!0,52,8),this.pos+=8},writeBytes:function(n){var e=n.length;this.writeVarint(e),this.realloc(e);for(var o=0;o<e;o++)this.buf[this.pos++]=n[o]},writeRawMessage:function(n,e){this.pos++;var o=this.pos;n(e,this);var u=this.pos-o;u>=128&&wd(o,u,this),this.pos=o-1,this.writeVarint(u),this.pos+=u},writeMessage:function(n,e,o){this.writeTag(n,Er.Bytes),this.writeRawMessage(e,o)},writePackedVarint:function(n,e){e.length&&this.writeMessage(n,Su,e)},writePackedSVarint:function(n,e){e.length&&this.writeMessage(n,xc,e)},writePackedBoolean:function(n,e){e.length&&this.writeMessage(n,Sd,e)},writePackedFloat:function(n,e){e.length&&this.writeMessage(n,vh,e)},writePackedDouble:function(n,e){e.length&&this.writeMessage(n,bd,e)},writePackedFixed32:function(n,e){e.length&&this.writeMessage(n,Ed,e)},writePackedSFixed32:function(n,e){e.length&&this.writeMessage(n,xh,e)},writePackedFixed64:function(n,e){e.length&&this.writeMessage(n,wh,e)},writePackedSFixed64:function(n,e){e.length&&this.writeMessage(n,qn,e)},writeBytesField:function(n,e){this.writeTag(n,Er.Bytes),this.writeBytes(e)},writeFixed32Field:function(n,e){this.writeTag(n,Er.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(n,e){this.writeTag(n,Er.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(n,e){this.writeTag(n,Er.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(n,e){this.writeTag(n,Er.Fixed64),this.writeSFixed64(e)},writeVarintField:function(n,e){this.writeTag(n,Er.Varint),this.writeVarint(e)},writeSVarintField:function(n,e){this.writeTag(n,Er.Varint),this.writeSVarint(e)},writeStringField:function(n,e){this.writeTag(n,Er.Bytes),this.writeString(e)},writeFloatField:function(n,e){this.writeTag(n,Er.Fixed32),this.writeFloat(e)},writeDoubleField:function(n,e){this.writeTag(n,Er.Fixed64),this.writeDouble(e)},writeBooleanField:function(n,e){this.writeVarintField(n,!!e)}};class Sh{constructor(e,{pixelRatio:o,version:u,stretchX:f,stretchY:g,content:v}){this.paddedRect=e,this.pixelRatio=o,this.stretchX=f,this.stretchY=g,this.content=v,this.version=u}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class Eh{constructor(e,o){const u={},f={};this.haveRenderCallbacks=[];const g=[];this.addImages(e,u,g),this.addImages(o,f,g);const{w:v,h:t}=io(g),i=new Pr({width:v||1,height:t||1});for(const a in e){const h=e[a],y=u[a].paddedRect;Pr.copy(h.data,i,{x:0,y:0},{x:y.x+1,y:y.y+1},h.data)}for(const a in o){const h=o[a],y=f[a].paddedRect,w=y.x+1,E=y.y+1,z=h.data.width,N=h.data.height;Pr.copy(h.data,i,{x:0,y:0},{x:w,y:E},h.data),Pr.copy(h.data,i,{x:0,y:N-1},{x:w,y:E-1},{width:z,height:1}),Pr.copy(h.data,i,{x:0,y:0},{x:w,y:E+N},{width:z,height:1}),Pr.copy(h.data,i,{x:z-1,y:0},{x:w-1,y:E},{width:1,height:N}),Pr.copy(h.data,i,{x:0,y:0},{x:w+z,y:E},{width:1,height:N})}this.image=i,this.iconPositions=u,this.patternPositions=f}addImages(e,o,u){for(const f in e){const g=e[f],v={x:0,y:0,w:g.data.width+2,h:g.data.height+2};u.push(v),o[f]=new Sh(v,g),g.hasRenderCallback&&this.haveRenderCallbacks.push(f)}}patchUpdatedImages(e,o){e.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const u in e.updatedImages)this.patchUpdatedImage(this.iconPositions[u],e.getImage(u),o),this.patchUpdatedImage(this.patternPositions[u],e.getImage(u),o)}patchUpdatedImage(e,o,u){if(!e||!o||e.version===o.version)return;e.version=o.version;const[f,g]=e.tl;u.update(o.data,void 0,{x:f,y:g})}}Pt("ImagePosition",Sh),Pt("ImageAtlas",Eh),l.WritingMode=void 0,(an=l.WritingMode||(l.WritingMode={}))[an.none=0]="none",an[an.horizontal=1]="horizontal",an[an.vertical=2]="vertical",an[an.horizontalOnly=3]="horizontalOnly";const Eu=-17;class Ol{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(e,o){const u=new Ol;return u.scale=e||1,u.fontStack=o,u}static forImage(e){const o=new Ol;return o.imageName=e,o}}class Fa{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(e,o){const u=new Fa;for(let f=0;f<e.sections.length;f++){const g=e.sections[f];g.image?u.addImageSection(g):u.addTextSection(g,o)}return u}length(){return this.text.length}getSection(e){return this.sections[this.sectionIndex[e]]}getSectionIndex(e){return this.sectionIndex[e]}getCharCode(e){return this.text.charCodeAt(e)}verticalizePunctuation(){this.text=function(e){let o="";for(let u=0;u<e.length;u++){const f=e.charCodeAt(u+1)||null,g=e.charCodeAt(u-1)||null;o+=f&&hu(f)&&!Fl[e[u+1]]||g&&hu(g)&&!Fl[e[u-1]]||!Fl[e[u]]?e[u]:Fl[e[u]]}return o}(this.text)}trim(){let e=0;for(let u=0;u<this.text.length&&Oa[this.text.charCodeAt(u)];u++)e++;let o=this.text.length;for(let u=this.text.length-1;u>=0&&u>=e&&Oa[this.text.charCodeAt(u)];u--)o--;this.text=this.text.substring(e,o),this.sectionIndex=this.sectionIndex.slice(e,o)}substring(e,o){const u=new Fa;return u.text=this.text.substring(e,o),u.sectionIndex=this.sectionIndex.slice(e,o),u.sections=this.sections,u}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((e,o)=>Math.max(e,this.sections[o].scale),0)}addTextSection(e,o){this.text+=e.text,this.sections.push(Ol.forText(e.scale,e.fontStack||o));const u=this.sections.length-1;for(let f=0;f<e.text.length;++f)this.sectionIndex.push(u)}addImageSection(e){const o=e.image?e.image.name:"";if(o.length===0)return void _e("Can't add FormattedSection with an empty image.");const u=this.getNextImageSectionCharCode();u?(this.text+=String.fromCharCode(u),this.sections.push(Ol.forImage(o)),this.sectionIndex.push(this.sections.length-1)):_e("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function wc(n,e,o,u,f,g,v,t,i,a,h,y,w,E,z,N){const W=Fa.fromFeature(n,f);let se;y===l.WritingMode.vertical&&W.verticalizePunctuation();const{processBidirectionalText:pe,processStyledBidirectionalText:ie}=_r;if(pe&&W.sections.length===1){se=[];const Re=pe(W.toString(),oi(W,a,g,e,u,E,z));for(const xt of Re){const we=new Fa;we.text=xt,we.sections=W.sections;for(let ue=0;ue<xt.length;ue++)we.sectionIndex.push(0);se.push(we)}}else if(ie){se=[];const Re=ie(W.text,W.sectionIndex,oi(W,a,g,e,u,E,z));for(const xt of Re){const we=new Fa;we.text=xt[0],we.sectionIndex=xt[1],we.sections=W.sections,se.push(we)}}else se=function(Re,xt){const we=[],ue=Re.text;let ge=0;for(const Be of xt)we.push(Re.substring(ge,Be)),ge=Be;return ge<ue.length&&we.push(Re.substring(ge,ue.length)),we}(W,oi(W,a,g,e,u,E,z));const Te=[],Le={positionedLines:Te,text:W.toString(),top:h[1],bottom:h[1],left:h[0],right:h[0],writingMode:y,iconsInText:!1,verticalizable:!1};return function(Re,xt,we,ue,ge,Be,tt,nt,Ge,mt,Ct,Mt){let br=0,$r=Eu,In=0,so=0;const Kn=nt==="right"?1:nt==="left"?0:.5;let vn=0;for(const xn of ge){xn.trim();const Jn=xn.getMaxScale(),ci=(Jn-1)*sn,yi={positionedGlyphs:[],lineOffset:0};Re.positionedLines[vn]=yi;const Ii=yi.positionedGlyphs;let Ai=0;if(!xn.length()){$r+=Be,++vn;continue}for(let jn=0;jn<xn.length();jn++){const fr=xn.getSection(jn),Ui=xn.getSectionIndex(jn),Qn=xn.getCharCode(jn);let hi=0,Po=null,ls=null,us=null,Ha=sn;const Mo=!(Ge===l.WritingMode.horizontal||!Ct&&!_o(Qn)||Ct&&(Oa[Qn]||(Un=Qn,St.Arabic(Un)||St["Arabic Supplement"](Un)||St["Arabic Extended-A"](Un)||St["Arabic Presentation Forms-A"](Un)||St["Arabic Presentation Forms-B"](Un))));if(fr.imageName){const ao=ue[fr.imageName];if(!ao)continue;us=fr.imageName,Re.iconsInText=Re.iconsInText||!0,ls=ao.paddedRect;const zi=ao.displaySize;fr.scale=fr.scale*sn/Mt,Po={width:zi[0],height:zi[1],left:1,top:-3,advance:Mo?zi[1]:zi[0]},hi=ci+(sn-zi[1]*fr.scale),Ha=Po.advance;const Xa=Mo?zi[0]*fr.scale-sn*Jn:zi[1]*fr.scale-sn*Jn;Xa>0&&Xa>Ai&&(Ai=Xa)}else{const ao=we[fr.fontStack],zi=ao&&ao[Qn];if(zi&&zi.rect)ls=zi.rect,Po=zi.metrics;else{const Xa=xt[fr.fontStack],Lh=Xa&&Xa[Qn];if(!Lh)continue;Po=Lh.metrics}hi=(Jn-fr.scale)*sn}Mo?(Re.verticalizable=!0,Ii.push({glyph:Qn,imageName:us,x:br,y:$r+hi,vertical:Mo,scale:fr.scale,fontStack:fr.fontStack,sectionIndex:Ui,metrics:Po,rect:ls}),br+=Ha*fr.scale+mt):(Ii.push({glyph:Qn,imageName:us,x:br,y:$r+hi,vertical:Mo,scale:fr.scale,fontStack:fr.fontStack,sectionIndex:Ui,metrics:Po,rect:ls}),br+=Po.advance*fr.scale+mt)}Ii.length!==0&&(In=Math.max(br-mt,In),Cn(Ii,0,Ii.length-1,Kn,Ai)),br=0;const rn=Be*Jn+Ai;yi.lineOffset=Math.max(Ai,ci),$r+=rn,so=Math.max(rn,so),++vn}var Un;const Yn=$r-Eu,{horizontalAlign:ui,verticalAlign:Ci}=Ns(tt);(function(xn,Jn,ci,yi,Ii,Ai,rn,jn,fr){const Ui=(Jn-ci)*Ii;let Qn=0;Qn=Ai!==rn?-jn*yi-Eu:(-yi*fr+.5)*rn;for(const hi of xn)for(const Po of hi.positionedGlyphs)Po.x+=Ui,Po.y+=Qn})(Re.positionedLines,Kn,ui,Ci,In,so,Be,Yn,ge.length),Re.top+=-Ci*Yn,Re.bottom=Re.top+Yn,Re.left+=-ui*In,Re.right=Re.left+In}(Le,e,o,u,se,v,t,i,y,a,w,N),!function(Re){for(const xt of Re)if(xt.positionedGlyphs.length!==0)return!1;return!0}(Te)&&Le}const Oa={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Th={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function Ti(n,e,o,u,f,g){if(e.imageName){const v=u[e.imageName];return v?v.displaySize[0]*e.scale*sn/g+f:0}{const v=o[e.fontStack],t=v&&v[n];return t?t.metrics.advance*e.scale+f:0}}function Tr(n,e,o,u){const f=Math.pow(n-e,2);return u?n<e?f/2:2*f:f+Math.abs(o)*o}function On(n,e,o){let u=0;return n===10&&(u-=1e4),o&&(u+=150),n!==40&&n!==65288||(u+=50),e!==41&&e!==65289||(u+=50),u}function pn(n,e,o,u,f,g){let v=null,t=Tr(e,o,f,g);for(const i of u){const a=Tr(e-i.x,o,f,g)+i.badness;a<=t&&(v=i,t=a)}return{index:n,x:e,priorBreak:v,badness:t}}function Nn(n){return n?Nn(n.priorBreak).concat(n.index):[]}function oi(n,e,o,u,f,g,v){if(g!=="point")return[];if(!n)return[];const t=[],i=function(w,E,z,N,W,se){let pe=0;for(let ie=0;ie<w.length();ie++){const Te=w.getSection(ie);pe+=Ti(w.getCharCode(ie),Te,N,W,E,se)}return pe/Math.max(1,Math.ceil(pe/z))}(n,e,o,u,f,v),a=n.text.indexOf("​")>=0;let h=0;for(let w=0;w<n.length();w++){const E=n.getSection(w),z=n.getCharCode(w);if(Oa[z]||(h+=Ti(z,E,u,f,e,v)),w<n.length()-1){const N=!((y=z)<11904||!(St["Bopomofo Extended"](y)||St.Bopomofo(y)||St["CJK Compatibility Forms"](y)||St["CJK Compatibility Ideographs"](y)||St["CJK Compatibility"](y)||St["CJK Radicals Supplement"](y)||St["CJK Strokes"](y)||St["CJK Symbols and Punctuation"](y)||St["CJK Unified Ideographs Extension A"](y)||St["CJK Unified Ideographs"](y)||St["Enclosed CJK Letters and Months"](y)||St["Halfwidth and Fullwidth Forms"](y)||St.Hiragana(y)||St["Ideographic Description Characters"](y)||St["Kangxi Radicals"](y)||St["Katakana Phonetic Extensions"](y)||St.Katakana(y)||St["Vertical Forms"](y)||St["Yi Radicals"](y)||St["Yi Syllables"](y)));(Th[z]||N||E.imageName)&&t.push(pn(w+1,h,i,t,On(z,n.getCharCode(w+1),N&&a),!1))}}var y;return Nn(pn(n.length(),h,i,t,0,!0))}function Ns(n){let e=.5,o=.5;switch(n){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(n){case"bottom":case"bottom-right":case"bottom-left":o=1;break;case"top":case"top-right":case"top-left":o=0}return{horizontalAlign:e,verticalAlign:o}}function Cn(n,e,o,u,f){if(!u&&!f)return;const g=n[o],v=(n[o].x+g.metrics.advance*g.scale)*u;for(let t=e;t<=o;t++)n[t].x-=v,n[t].y+=f}function Tu(n,e,o){const{horizontalAlign:u,verticalAlign:f}=Ns(o),g=e[0]-n.displaySize[0]*u,v=e[1]-n.displaySize[1]*f;return{image:n,top:v,bottom:v+n.displaySize[1],left:g,right:g+n.displaySize[0]}}function Us(n,e,o,u,f,g){const v=n.image;let t;if(v.content){const W=v.content,se=v.pixelRatio||1;t=[W[0]/se,W[1]/se,v.displaySize[0]-W[2]/se,v.displaySize[1]-W[3]/se]}const i=e.left*g,a=e.right*g;let h,y,w,E;o==="width"||o==="both"?(E=f[0]+i-u[3],y=f[0]+a+u[1]):(E=f[0]+(i+a-v.displaySize[0])/2,y=E+v.displaySize[0]);const z=e.top*g,N=e.bottom*g;return o==="height"||o==="both"?(h=f[1]+z-u[0],w=f[1]+N+u[2]):(h=f[1]+(z+N-v.displaySize[1])/2,w=h+v.displaySize[1]),{image:v,top:h,right:y,bottom:w,left:E,collisionPadding:t}}const Oi=128;function bc(n,e){const{expression:o}=e;if(o.kind==="constant")return{kind:"constant",layoutSize:o.evaluate(new Mr(n+1))};if(o.kind==="source")return{kind:"source"};{const{zoomStops:u,interpolationType:f}=o;let g=0;for(;g<u.length&&u[g]<=n;)g++;g=Math.max(0,g-1);let v=g;for(;v<u.length&&u[v]<n+1;)v++;v=Math.min(u.length-1,v);const t=u[g],i=u[v];return o.kind==="composite"?{kind:"composite",minZoom:t,maxZoom:i,interpolationType:f}:{kind:"camera",minZoom:t,maxZoom:i,minSize:o.evaluate(new Mr(t)),maxSize:o.evaluate(new Mr(i)),interpolationType:f}}}class Ni extends ht{constructor(e,o,u,f){super(e,o),this.angle=u,f!==void 0&&(this.segment=f)}clone(){return new Ni(this.x,this.y,this.angle,this.segment)}}function si(n,e,o,u,f){if(e.segment===void 0)return!0;let g=e,v=e.segment+1,t=0;for(;t>-o/2;){if(v--,v<0)return!1;t-=n[v].dist(g),g=n[v]}t+=n[v].dist(n[v+1]),v++;const i=[];let a=0;for(;t<o/2;){const h=n[v],y=n[v+1];if(!y)return!1;let w=n[v-1].angleTo(h)-h.angleTo(y);for(w=Math.abs((w+3*Math.PI)%(2*Math.PI)-Math.PI),i.push({distance:t,angleDelta:w}),a+=w;t-i[0].distance>u;)a-=i.shift().angleDelta;if(a>f)return!1;v++,t+=h.dist(y)}return!0}function Sc(n){let e=0;for(let o=0;o<n.length-1;o++)e+=n[o].dist(n[o+1]);return e}function Na(n,e,o){return n?.6*e*o:0}function zo(n,e){return Math.max(n?n.right-n.left:0,e?e.right-e.left:0)}function Ec(n,e,o,u,f,g){const v=Na(o,f,g),t=zo(o,u)*g;let i=0;const a=Sc(n)/2;for(let h=0;h<n.length-1;h++){const y=n[h],w=n[h+1],E=y.dist(w);if(i+E>a){const z=(a-i)/E,N=Ur(y.x,w.x,z),W=Ur(y.y,w.y,z),se=new Ni(N,W,w.angleTo(y),h);return se._round(),!v||si(n,se,t,v,e)?se:void 0}i+=E}}function kh(n,e,o,u,f,g,v,t,i){const a=Na(u,g,v),h=zo(u,f),y=h*v,w=n[0].x===0||n[0].x===i||n[0].y===0||n[0].y===i;return e-y<e/4&&(e=y+e/4),ts(n,w?e/2*t%e:(h/2+2*g)*v*t%e,e,a,o,y,w,!1,i)}function ts(n,e,o,u,f,g,v,t,i){const a=g/2,h=Sc(n);let y=0,w=e-o,E=[];for(let z=0;z<n.length-1;z++){const N=n[z],W=n[z+1],se=N.dist(W),pe=W.angleTo(N);for(;w+o<y+se;){w+=o;const ie=(w-y)/se,Te=Ur(N.x,W.x,ie),Le=Ur(N.y,W.y,ie);if(Te>=0&&Te<i&&Le>=0&&Le<i&&w-a>=0&&w+a<=h){const Re=new Ni(Te,Le,pe,z);Re._round(),u&&!si(n,Re,g,u,f)||E.push(Re)}}y+=se}return t||E.length||v||(E=ts(n,y/2,o,u,f,g,v,!0,i)),E}function ku(n,e,o,u,f){const g=[];for(let v=0;v<n.length;v++){const t=n[v];let i;for(let a=0;a<t.length-1;a++){let h=t[a],y=t[a+1];h.x<e&&y.x<e||(h.x<e?h=new ht(e,h.y+(e-h.x)/(y.x-h.x)*(y.y-h.y))._round():y.x<e&&(y=new ht(e,h.y+(e-h.x)/(y.x-h.x)*(y.y-h.y))._round()),h.y<o&&y.y<o||(h.y<o?h=new ht(h.x+(o-h.y)/(y.y-h.y)*(y.x-h.x),o)._round():y.y<o&&(y=new ht(h.x+(o-h.y)/(y.y-h.y)*(y.x-h.x),o)._round()),h.x>=u&&y.x>=u||(h.x>=u?h=new ht(u,h.y+(u-h.x)/(y.x-h.x)*(y.y-h.y))._round():y.x>=u&&(y=new ht(u,h.y+(u-h.x)/(y.x-h.x)*(y.y-h.y))._round()),h.y>=f&&y.y>=f||(h.y>=f?h=new ht(h.x+(f-h.y)/(y.y-h.y)*(y.x-h.x),f)._round():y.y>=f&&(y=new ht(h.x+(f-h.y)/(y.y-h.y)*(y.x-h.x),f)._round()),i&&h.equals(i[i.length-1])||(i=[h],g.push(i)),i.push(y)))))}}return g}function rs(n,e,o,u){const f=[],g=n.image,v=g.pixelRatio,t=g.paddedRect.w-2,i=g.paddedRect.h-2,a=n.right-n.left,h=n.bottom-n.top,y=g.stretchX||[[0,t]],w=g.stretchY||[[0,i]],E=(Be,tt)=>Be+tt[1]-tt[0],z=y.reduce(E,0),N=w.reduce(E,0),W=t-z,se=i-N;let pe=0,ie=z,Te=0,Le=N,Re=0,xt=W,we=0,ue=se;if(g.content&&u){const Be=g.content;pe=Ua(y,0,Be[0]),Te=Ua(w,0,Be[1]),ie=Ua(y,Be[0],Be[2]),Le=Ua(w,Be[1],Be[3]),Re=Be[0]-pe,we=Be[1]-Te,xt=Be[2]-Be[0]-ie,ue=Be[3]-Be[1]-Le}const ge=(Be,tt,nt,Ge)=>{const mt=Ul(Be.stretch-pe,ie,a,n.left),Ct=ja(Be.fixed-Re,xt,Be.stretch,z),Mt=Ul(tt.stretch-Te,Le,h,n.top),br=ja(tt.fixed-we,ue,tt.stretch,N),$r=Ul(nt.stretch-pe,ie,a,n.left),In=ja(nt.fixed-Re,xt,nt.stretch,z),so=Ul(Ge.stretch-Te,Le,h,n.top),Kn=ja(Ge.fixed-we,ue,Ge.stretch,N),vn=new ht(mt,Mt),Un=new ht($r,Mt),Yn=new ht($r,so),ui=new ht(mt,so),Ci=new ht(Ct/v,br/v),xn=new ht(In/v,Kn/v),Jn=e*Math.PI/180;if(Jn){const Ii=Math.sin(Jn),Ai=Math.cos(Jn),rn=[Ai,-Ii,Ii,Ai];vn._matMult(rn),Un._matMult(rn),ui._matMult(rn),Yn._matMult(rn)}const ci=Be.stretch+Be.fixed,yi=tt.stretch+tt.fixed;return{tl:vn,tr:Un,bl:ui,br:Yn,tex:{x:g.paddedRect.x+1+ci,y:g.paddedRect.y+1+yi,w:nt.stretch+nt.fixed-ci,h:Ge.stretch+Ge.fixed-yi},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Ci,pixelOffsetBR:xn,minFontScaleX:xt/v/a,minFontScaleY:ue/v/h,isSDF:o}};if(u&&(g.stretchX||g.stretchY)){const Be=Nl(y,W,z),tt=Nl(w,se,N);for(let nt=0;nt<Be.length-1;nt++){const Ge=Be[nt],mt=Be[nt+1];for(let Ct=0;Ct<tt.length-1;Ct++)f.push(ge(Ge,tt[Ct],mt,tt[Ct+1]))}}else f.push(ge({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:t+1},{fixed:0,stretch:i+1}));return f}function Ua(n,e,o){let u=0;for(const f of n)u+=Math.max(e,Math.min(o,f[1]))-Math.max(e,Math.min(o,f[0]));return u}function Nl(n,e,o){const u=[{fixed:-1,stretch:0}];for(const[f,g]of n){const v=u[u.length-1];u.push({fixed:f-v.stretch,stretch:v.stretch}),u.push({fixed:f-v.stretch,stretch:v.stretch+(g-f)})}return u.push({fixed:e+1,stretch:o}),u}function Ul(n,e,o,u){return n/e*o+u}function ja(n,e,o,u){return n-e*o/u}Pt("Anchor",Ni);class Va{constructor(e,o,u,f,g,v,t,i,a,h){if(this.boxStartIndex=e.length,a){let y=v.top,w=v.bottom;const E=v.collisionPadding;E&&(y-=E[1],w+=E[3]);let z=w-y;z>0&&(z=Math.max(10,z),this.circleDiameter=z)}else{let y=v.top*t-i[0],w=v.bottom*t+i[2],E=v.left*t-i[3],z=v.right*t+i[1];const N=v.collisionPadding;if(N&&(E-=N[0]*t,y-=N[1]*t,z+=N[2]*t,w+=N[3]*t),h){const W=new ht(E,y),se=new ht(z,y),pe=new ht(E,w),ie=new ht(z,w),Te=h*Math.PI/180;W._rotate(Te),se._rotate(Te),pe._rotate(Te),ie._rotate(Te),E=Math.min(W.x,se.x,pe.x,ie.x),z=Math.max(W.x,se.x,pe.x,ie.x),y=Math.min(W.y,se.y,pe.y,ie.y),w=Math.max(W.y,se.y,pe.y,ie.y)}e.emplaceBack(o.x,o.y,E,y,z,w,u,f,g)}this.boxEndIndex=e.length}}class ai{constructor(e=[],o=js){if(this.data=e,this.length=this.data.length,this.compare=o,this.length>0)for(let u=(this.length>>1)-1;u>=0;u--)this._down(u)}push(e){this.data.push(e),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const e=this.data[0],o=this.data.pop();return this.length--,this.length>0&&(this.data[0]=o,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:o,compare:u}=this,f=o[e];for(;e>0;){const g=e-1>>1,v=o[g];if(u(f,v)>=0)break;o[e]=v,e=g}o[e]=f}_down(e){const{data:o,compare:u}=this,f=this.length>>1,g=o[e];for(;e<f;){let v=1+(e<<1),t=o[v];const i=v+1;if(i<this.length&&u(o[i],t)<0&&(v=i,t=o[i]),u(t,g)>=0)break;o[e]=t,e=v}o[e]=g}}function js(n,e){return n<e?-1:n>e?1:0}function oo(n,e=1,o=!1){let u=1/0,f=1/0,g=-1/0,v=-1/0;const t=n[0];for(let E=0;E<t.length;E++){const z=t[E];(!E||z.x<u)&&(u=z.x),(!E||z.y<f)&&(f=z.y),(!E||z.x>g)&&(g=z.x),(!E||z.y>v)&&(v=z.y)}const i=Math.min(g-u,v-f);let a=i/2;const h=new ai([],gi);if(i===0)return new ht(u,f);for(let E=u;E<g;E+=i)for(let z=f;z<v;z+=i)h.push(new $a(E+a,z+a,a,n));let y=function(E){let z=0,N=0,W=0;const se=E[0];for(let pe=0,ie=se.length,Te=ie-1;pe<ie;Te=pe++){const Le=se[pe],Re=se[Te],xt=Le.x*Re.y-Re.x*Le.y;N+=(Le.x+Re.x)*xt,W+=(Le.y+Re.y)*xt,z+=3*xt}return new $a(N/z,W/z,0,E)}(n),w=h.length;for(;h.length;){const E=h.pop();(E.d>y.d||!y.d)&&(y=E,o&&console.log("found best %d after %d probes",Math.round(1e4*E.d)/1e4,w)),E.max-y.d<=e||(a=E.h/2,h.push(new $a(E.p.x-a,E.p.y-a,a,n)),h.push(new $a(E.p.x+a,E.p.y-a,a,n)),h.push(new $a(E.p.x-a,E.p.y+a,a,n)),h.push(new $a(E.p.x+a,E.p.y+a,a,n)),w+=4)}return o&&(console.log(`num probes: ${w}`),console.log(`best distance: ${y.d}`)),y.p}function gi(n,e){return e.max-n.max}function $a(n,e,o,u){this.p=new ht(n,e),this.h=o,this.d=function(f,g){let v=!1,t=1/0;for(let i=0;i<g.length;i++){const a=g[i];for(let h=0,y=a.length,w=y-1;h<y;w=h++){const E=a[h],z=a[w];E.y>f.y!=z.y>f.y&&f.x<(z.x-E.x)*(f.y-E.y)/(z.y-E.y)+E.x&&(v=!v),t=Math.min(t,Kc(f,E,z))}}return(v?1:-1)*Math.sqrt(t)}(this.p,u),this.max=this.d+this.h*Math.SQRT2}const Cu=Number.POSITIVE_INFINITY;function Tc(n,e){return e[1]!==Cu?function(o,u,f){let g=0,v=0;switch(u=Math.abs(u),f=Math.abs(f),o){case"top-right":case"top-left":case"top":v=f-7;break;case"bottom-right":case"bottom-left":case"bottom":v=7-f}switch(o){case"top-right":case"bottom-right":case"right":g=-u;break;case"top-left":case"bottom-left":case"left":g=u}return[g,v]}(n,e[0],e[1]):function(o,u){let f=0,g=0;u<0&&(u=0);const v=u/Math.sqrt(2);switch(o){case"top-right":case"top-left":g=v-7;break;case"bottom-right":case"bottom-left":g=7-v;break;case"bottom":g=7-u;break;case"top":g=u-7}switch(o){case"top-right":case"bottom-right":f=-v;break;case"top-left":case"bottom-left":f=v;break;case"left":f=u;break;case"right":f=-u}return[f,g]}(n,e[0])}function Ch(n){switch(n){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Vs(n,e,o,u,f,g,v,t,i,a,h){let y=g.textMaxSize.evaluate(e,{});y===void 0&&(y=v);const w=n.layers[0].layout,E=w.get("icon-offset").evaluate(e,{},h),z=$s(o.horizontal),N=v/24,W=n.tilePixelRatio*N,se=n.tilePixelRatio*y/24,pe=n.tilePixelRatio*t,ie=n.tilePixelRatio*w.get("symbol-spacing"),Te=w.get("text-padding")*n.tilePixelRatio,Le=function(Ge,mt,Ct,Mt=1){const br=Ge.get("icon-padding").evaluate(mt,{},Ct),$r=br&&br.values;return[$r[0]*Mt,$r[1]*Mt,$r[2]*Mt,$r[3]*Mt]}(w,e,h,n.tilePixelRatio),Re=w.get("text-max-angle")/180*Math.PI,xt=w.get("text-rotation-alignment")!=="viewport"&&w.get("symbol-placement")!=="point",we=w.get("icon-rotation-alignment")==="map"&&w.get("symbol-placement")!=="point",ue=w.get("symbol-placement"),ge=ie/2,Be=w.get("icon-text-fit");let tt;u&&Be!=="none"&&(n.allowVerticalPlacement&&o.vertical&&(tt=Us(u,o.vertical,Be,w.get("icon-text-fit-padding"),E,N)),z&&(u=Us(u,z,Be,w.get("icon-text-fit-padding"),E,N)));const nt=(Ge,mt)=>{mt.x<0||mt.x>=cn||mt.y<0||mt.y>=cn||function(Ct,Mt,br,$r,In,so,Kn,vn,Un,Yn,ui,Ci,xn,Jn,ci,yi,Ii,Ai,rn,jn,fr,Ui,Qn,hi,Po){const ls=Ct.addToLineVertexArray(Mt,br);let us,Ha,Mo,ao,zi=0,Xa=0,Lh=0,lp=0,yf=-1,_f=-1;const Ka={};let up=nr.exports(""),vf=0,xf=0;if(vn._unevaluatedLayout.getValue("text-radial-offset")===void 0?[vf,xf]=vn.layout.get("text-offset").evaluate(fr,{},hi).map(Pi=>Pi*sn):(vf=vn.layout.get("text-radial-offset").evaluate(fr,{},hi)*sn,xf=Cu),Ct.allowVerticalPlacement&&$r.vertical){const Pi=vn.layout.get("text-rotate").evaluate(fr,{},hi)+90;Mo=new Va(Un,Mt,Yn,ui,Ci,$r.vertical,xn,Jn,ci,Pi),Kn&&(ao=new Va(Un,Mt,Yn,ui,Ci,Kn,Ii,Ai,ci,Pi))}if(In){const Pi=vn.layout.get("icon-rotate").evaluate(fr,{}),Zs=vn.layout.get("icon-text-fit")!=="none",Bh=rs(In,Pi,Qn,Zs),Fh=Kn?rs(Kn,Pi,Qn,Zs):void 0;Ha=new Va(Un,Mt,Yn,ui,Ci,In,Ii,Ai,!1,Pi),zi=4*Bh.length;const dp=Ct.iconSizeData;let Bu=null;dp.kind==="source"?(Bu=[Oi*vn.layout.get("icon-size").evaluate(fr,{})],Bu[0]>ns&&_e(`${Ct.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):dp.kind==="composite"&&(Bu=[Oi*Ui.compositeIconSizes[0].evaluate(fr,{},hi),Oi*Ui.compositeIconSizes[1].evaluate(fr,{},hi)],(Bu[0]>ns||Bu[1]>ns)&&_e(`${Ct.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),Ct.addSymbols(Ct.icon,Bh,Bu,jn,rn,fr,l.WritingMode.none,Mt,ls.lineStartIndex,ls.lineLength,-1,hi),yf=Ct.icon.placedSymbolArray.length-1,Fh&&(Xa=4*Fh.length,Ct.addSymbols(Ct.icon,Fh,Bu,jn,rn,fr,l.WritingMode.vertical,Mt,ls.lineStartIndex,ls.lineLength,-1,hi),_f=Ct.icon.placedSymbolArray.length-1)}const cp=Object.keys($r.horizontal);for(const Pi of cp){const Zs=$r.horizontal[Pi];if(!us){up=nr.exports(Zs.text);const Fh=vn.layout.get("text-rotate").evaluate(fr,{},hi);us=new Va(Un,Mt,Yn,ui,Ci,Zs,xn,Jn,ci,Fh)}const Bh=Zs.positionedLines.length===1;if(Lh+=kc(Ct,Mt,Zs,so,vn,ci,fr,yi,ls,$r.vertical?l.WritingMode.horizontal:l.WritingMode.horizontalOnly,Bh?cp:[Pi],Ka,yf,Ui,hi),Bh)break}$r.vertical&&(lp+=kc(Ct,Mt,$r.vertical,so,vn,ci,fr,yi,ls,l.WritingMode.vertical,["vertical"],Ka,_f,Ui,hi));const tg=us?us.boxStartIndex:Ct.collisionBoxArray.length,rg=us?us.boxEndIndex:Ct.collisionBoxArray.length,ng=Mo?Mo.boxStartIndex:Ct.collisionBoxArray.length,ig=Mo?Mo.boxEndIndex:Ct.collisionBoxArray.length,og=Ha?Ha.boxStartIndex:Ct.collisionBoxArray.length,sg=Ha?Ha.boxEndIndex:Ct.collisionBoxArray.length,ag=ao?ao.boxStartIndex:Ct.collisionBoxArray.length,lg=ao?ao.boxEndIndex:Ct.collisionBoxArray.length;let cs=-1;const Dd=(Pi,Zs)=>Pi&&Pi.circleDiameter?Math.max(Pi.circleDiameter,Zs):Zs;cs=Dd(us,cs),cs=Dd(Mo,cs),cs=Dd(Ha,cs),cs=Dd(ao,cs);const hp=cs>-1?1:0;hp&&(cs*=Po/sn),Ct.glyphOffsetArray.length>=Za.MAX_GLYPHS&&_e("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),fr.sortKey!==void 0&&Ct.addToSortKeyRanges(Ct.symbolInstances.length,fr.sortKey),Ct.symbolInstances.emplaceBack(Mt.x,Mt.y,Ka.right>=0?Ka.right:-1,Ka.center>=0?Ka.center:-1,Ka.left>=0?Ka.left:-1,Ka.vertical||-1,yf,_f,up,tg,rg,ng,ig,og,sg,ag,lg,Yn,Lh,lp,zi,Xa,hp,0,xn,vf,xf,cs)}(n,mt,Ge,o,u,f,tt,n.layers[0],n.collisionBoxArray,e.index,e.sourceLayerIndex,n.index,W,[Te,Te,Te,Te],xt,i,pe,Le,we,E,e,g,a,h,v)};if(ue==="line")for(const Ge of ku(e.geometry,0,0,cn,cn)){const mt=kh(Ge,ie,Re,o.vertical||z,u,24,se,n.overscaling,cn);for(const Ct of mt){const Mt=z;Mt&&Ih(n,Mt.text,ge,Ct)||nt(Ge,Ct)}}else if(ue==="line-center"){for(const Ge of e.geometry)if(Ge.length>1){const mt=Ec(Ge,Re,o.vertical||z,u,24,se);mt&&nt(Ge,mt)}}else if(e.type==="Polygon")for(const Ge of fc(e.geometry,0)){const mt=oo(Ge,16);nt(Ge[0],new Ni(mt.x,mt.y,0))}else if(e.type==="LineString")for(const Ge of e.geometry)nt(Ge,new Ni(Ge[0].x,Ge[0].y,0));else if(e.type==="Point")for(const Ge of e.geometry)for(const mt of Ge)nt([mt],new Ni(mt.x,mt.y,0))}const ns=32640;function kc(n,e,o,u,f,g,v,t,i,a,h,y,w,E,z){const N=function(pe,ie,Te,Le,Re,xt,we,ue){const ge=Le.layout.get("text-rotate").evaluate(xt,{})*Math.PI/180,Be=[];for(const tt of ie.positionedLines)for(const nt of tt.positionedGlyphs){if(!nt.rect)continue;const Ge=nt.rect||{};let mt=4,Ct=!0,Mt=1,br=0;const $r=(Re||ue)&&nt.vertical,In=nt.metrics.advance*nt.scale/2;if(ue&&ie.verticalizable){const rn=(nt.scale-1)*sn,jn=(sn-nt.metrics.width*nt.scale)/2;br=tt.lineOffset/2-(nt.imageName?-jn:rn)}if(nt.imageName){const rn=we[nt.imageName];Ct=rn.sdf,Mt=rn.pixelRatio,mt=1/Mt}const so=Re?[nt.x+In,nt.y]:[0,0];let Kn=Re?[0,0]:[nt.x+In+Te[0],nt.y+Te[1]-br],vn=[0,0];$r&&(vn=Kn,Kn=[0,0]);const Un=(nt.metrics.left-mt)*nt.scale-In+Kn[0],Yn=(-nt.metrics.top-mt)*nt.scale+Kn[1],ui=Un+Ge.w*nt.scale/Mt,Ci=Yn+Ge.h*nt.scale/Mt,xn=new ht(Un,Yn),Jn=new ht(ui,Yn),ci=new ht(Un,Ci),yi=new ht(ui,Ci);if($r){const rn=new ht(-In,In-Eu),jn=-Math.PI/2,fr=12-In,Ui=new ht(22-fr,-(nt.imageName?fr:0)),Qn=new ht(...vn);xn._rotateAround(jn,rn)._add(Ui)._add(Qn),Jn._rotateAround(jn,rn)._add(Ui)._add(Qn),ci._rotateAround(jn,rn)._add(Ui)._add(Qn),yi._rotateAround(jn,rn)._add(Ui)._add(Qn)}if(ge){const rn=Math.sin(ge),jn=Math.cos(ge),fr=[jn,-rn,rn,jn];xn._matMult(fr),Jn._matMult(fr),ci._matMult(fr),yi._matMult(fr)}const Ii=new ht(0,0),Ai=new ht(0,0);Be.push({tl:xn,tr:Jn,bl:ci,br:yi,tex:Ge,writingMode:ie.writingMode,glyphOffset:so,sectionIndex:nt.sectionIndex,isSDF:Ct,pixelOffsetTL:Ii,pixelOffsetBR:Ai,minFontScaleX:0,minFontScaleY:0})}return Be}(0,o,t,f,g,v,u,n.allowVerticalPlacement),W=n.textSizeData;let se=null;W.kind==="source"?(se=[Oi*f.layout.get("text-size").evaluate(v,{})],se[0]>ns&&_e(`${n.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):W.kind==="composite"&&(se=[Oi*E.compositeTextSizes[0].evaluate(v,{},z),Oi*E.compositeTextSizes[1].evaluate(v,{},z)],(se[0]>ns||se[1]>ns)&&_e(`${n.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),n.addSymbols(n.text,N,se,t,g,v,a,e,i.lineStartIndex,i.lineLength,w,z);for(const pe of h)y[pe]=n.text.placedSymbolArray.length-1;return 4*N.length}function $s(n){for(const e in n)return n[e];return null}function Ih(n,e,o,u){const f=n.compareText;if(e in f){const g=f[e];for(let v=g.length-1;v>=0;v--)if(u.dist(g[v])<o)return!0}else f[e]=[];return f[e].push(u),!1}const Ga=Fs.VectorTileFeature.types,Cd=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Iu(n,e,o,u,f,g,v,t,i,a,h,y,w){const E=t?Math.min(ns,Math.round(t[0])):0,z=t?Math.min(ns,Math.round(t[1])):0;n.emplaceBack(e,o,Math.round(32*u),Math.round(32*f),g,v,(E<<1)+(i?1:0),z,16*a,16*h,256*y,256*w)}function Au(n,e,o){n.emplaceBack(e.x,e.y,o),n.emplaceBack(e.x,e.y,o),n.emplaceBack(e.x,e.y,o),n.emplaceBack(e.x,e.y,o)}function Cc(n){for(const e of n.sections)if(Yu(e.text))return!0;return!1}class Ah{constructor(e){this.layoutVertexArray=new Rn,this.indexArray=new jr,this.programConfigurations=e,this.segments=new mr,this.dynamicLayoutVertexArray=new on,this.opacityVertexArray=new Qr,this.placedSymbolArray=new rt}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(e,o,u,f){this.isEmpty()||(u&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,vc.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,o),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,es.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,Cd,!0),this.opacityVertexBuffer.itemSize=1),(u||f)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Pt("SymbolBuffers",Ah);class zh{constructor(e,o,u){this.layoutVertexArray=new e,this.layoutAttributes=o,this.indexArray=new u,this.segments=new mr,this.collisionVertexArray=new $n}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,df.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Pt("CollisionBuffers",zh);class Za{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(v=>v.id),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Ia([]),this.placementViewportMatrix=Ia([]);const o=this.layers[0]._unevaluatedLayout._values;this.textSizeData=bc(this.zoom,o["text-size"]),this.iconSizeData=bc(this.zoom,o["icon-size"]);const u=this.layers[0].layout,f=u.get("symbol-sort-key"),g=u.get("symbol-z-order");this.canOverlap=Ic(u,"text-overlap","text-allow-overlap")!=="never"||Ic(u,"icon-overlap","icon-allow-overlap")!=="never"||u.get("text-ignore-placement")||u.get("icon-ignore-placement"),this.sortFeaturesByKey=g!=="viewport-y"&&!f.isConstant(),this.sortFeaturesByY=(g==="viewport-y"||g==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,u.get("symbol-placement")==="point"&&(this.writingModes=u.get("text-writing-mode").map(v=>l.WritingMode[v])),this.stateDependentLayerIds=this.layers.filter(v=>v.isStateDependent()).map(v=>v.id),this.sourceID=e.sourceID}createArrays(){this.text=new Ah(new Bn(this.layers,this.zoom,e=>/^text/.test(e))),this.icon=new Ah(new Bn(this.layers,this.zoom,e=>/^icon/.test(e))),this.glyphOffsetArray=new It,this.lineVertexArray=new wt,this.symbolInstances=new et}calculateGlyphDependencies(e,o,u,f,g){for(let v=0;v<e.length;v++)if(o[e.charCodeAt(v)]=!0,(u||f)&&g){const t=Fl[e.charAt(v)];t&&(o[t.charCodeAt(0)]=!0)}}populate(e,o,u){const f=this.layers[0],g=f.layout,v=g.get("text-font"),t=g.get("text-field"),i=g.get("icon-image"),a=(t.value.kind!=="constant"||t.value.value instanceof Ce&&!t.value.value.isEmpty()||t.value.value.toString().length>0)&&(v.value.kind!=="constant"||v.value.value.length>0),h=i.value.kind!=="constant"||!!i.value.value||Object.keys(i.parameters).length>0,y=g.get("symbol-sort-key");if(this.features=[],!a&&!h)return;const w=o.iconDependencies,E=o.glyphDependencies,z=o.availableImages,N=new Mr(this.zoom);for(const{feature:W,id:se,index:pe,sourceLayerIndex:ie}of e){const Te=f._featureFilter.needGeometry,Le=Ls(W,Te);if(!f._featureFilter.filter(N,Le,u))continue;let Re,xt;if(Te||(Le.geometry=Ko(W)),a){const ue=f.getValueAndResolveTokens("text-field",Le,u,z),ge=Ce.factory(ue);Cc(ge)&&(this.hasRTLText=!0),(!this.hasRTLText||bl()==="unavailable"||this.hasRTLText&&_r.isParsed())&&(Re=_d(ge,f,Le))}if(h){const ue=f.getValueAndResolveTokens("icon-image",Le,u,z);xt=ue instanceof xe?ue:xe.fromString(ue)}if(!Re&&!xt)continue;const we=this.sortFeaturesByKey?y.evaluate(Le,{},u):void 0;if(this.features.push({id:se,text:Re,icon:xt,index:pe,sourceLayerIndex:ie,geometry:Le.geometry,properties:W.properties,type:Ga[W.type],sortKey:we}),xt&&(w[xt.name]=!0),Re){const ue=v.evaluate(Le,{},u).join(","),ge=g.get("text-rotation-alignment")!=="viewport"&&g.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(l.WritingMode.vertical)>=0;for(const Be of Re.sections)if(Be.image)w[Be.image.name]=!0;else{const tt=yo(Re.toString()),nt=Be.fontStack||ue,Ge=E[nt]=E[nt]||{};this.calculateGlyphDependencies(Be.text,Ge,ge,this.allowVerticalPlacement,tt)}}}g.get("symbol-placement")==="line"&&(this.features=function(W){const se={},pe={},ie=[];let Te=0;function Le(ue){ie.push(W[ue]),Te++}function Re(ue,ge,Be){const tt=pe[ue];return delete pe[ue],pe[ge]=tt,ie[tt].geometry[0].pop(),ie[tt].geometry[0]=ie[tt].geometry[0].concat(Be[0]),tt}function xt(ue,ge,Be){const tt=se[ge];return delete se[ge],se[ue]=tt,ie[tt].geometry[0].shift(),ie[tt].geometry[0]=Be[0].concat(ie[tt].geometry[0]),tt}function we(ue,ge,Be){const tt=Be?ge[0][ge[0].length-1]:ge[0][0];return`${ue}:${tt.x}:${tt.y}`}for(let ue=0;ue<W.length;ue++){const ge=W[ue],Be=ge.geometry,tt=ge.text?ge.text.toString():null;if(!tt){Le(ue);continue}const nt=we(tt,Be),Ge=we(tt,Be,!0);if(nt in pe&&Ge in se&&pe[nt]!==se[Ge]){const mt=xt(nt,Ge,Be),Ct=Re(nt,Ge,ie[mt].geometry);delete se[nt],delete pe[Ge],pe[we(tt,ie[Ct].geometry,!0)]=Ct,ie[mt].geometry=null}else nt in pe?Re(nt,Ge,Be):Ge in se?xt(nt,Ge,Be):(Le(ue),se[nt]=Te-1,pe[Ge]=Te-1)}return ie.filter(ue=>ue.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((W,se)=>W.sortKey-se.sortKey)}update(e,o,u){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,o,this.layers,u),this.icon.programConfigurations.updatePaintArrays(e,o,this.layers,u))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,o){const u=this.lineVertexArray.length;if(e.segment!==void 0){let f=e.dist(o[e.segment+1]),g=e.dist(o[e.segment]);const v={};for(let t=e.segment+1;t<o.length;t++)v[t]={x:o[t].x,y:o[t].y,tileUnitDistanceFromAnchor:f},t<o.length-1&&(f+=o[t+1].dist(o[t]));for(let t=e.segment||0;t>=0;t--)v[t]={x:o[t].x,y:o[t].y,tileUnitDistanceFromAnchor:g},t>0&&(g+=o[t-1].dist(o[t]));for(let t=0;t<o.length;t++){const i=v[t];this.lineVertexArray.emplaceBack(i.x,i.y,i.tileUnitDistanceFromAnchor)}}return{lineStartIndex:u,lineLength:this.lineVertexArray.length-u}}addSymbols(e,o,u,f,g,v,t,i,a,h,y,w){const E=e.indexArray,z=e.layoutVertexArray,N=e.segments.prepareSegment(4*o.length,z,E,this.canOverlap?v.sortKey:void 0),W=this.glyphOffsetArray.length,se=N.vertexLength,pe=this.allowVerticalPlacement&&t===l.WritingMode.vertical?Math.PI/2:0,ie=v.text&&v.text.sections;for(let Te=0;Te<o.length;Te++){const{tl:Le,tr:Re,bl:xt,br:we,tex:ue,pixelOffsetTL:ge,pixelOffsetBR:Be,minFontScaleX:tt,minFontScaleY:nt,glyphOffset:Ge,isSDF:mt,sectionIndex:Ct}=o[Te],Mt=N.vertexLength,br=Ge[1];Iu(z,i.x,i.y,Le.x,br+Le.y,ue.x,ue.y,u,mt,ge.x,ge.y,tt,nt),Iu(z,i.x,i.y,Re.x,br+Re.y,ue.x+ue.w,ue.y,u,mt,Be.x,ge.y,tt,nt),Iu(z,i.x,i.y,xt.x,br+xt.y,ue.x,ue.y+ue.h,u,mt,ge.x,Be.y,tt,nt),Iu(z,i.x,i.y,we.x,br+we.y,ue.x+ue.w,ue.y+ue.h,u,mt,Be.x,Be.y,tt,nt),Au(e.dynamicLayoutVertexArray,i,pe),E.emplaceBack(Mt,Mt+1,Mt+2),E.emplaceBack(Mt+1,Mt+2,Mt+3),N.vertexLength+=4,N.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Ge[0]),Te!==o.length-1&&Ct===o[Te+1].sectionIndex||e.programConfigurations.populatePaintArrays(z.length,v,v.index,{},w,ie&&ie[Ct])}e.placedSymbolArray.emplaceBack(i.x,i.y,W,this.glyphOffsetArray.length-W,se,a,h,i.segment,u?u[0]:0,u?u[1]:0,f[0],f[1],t,0,!1,0,y)}_addCollisionDebugVertex(e,o,u,f,g,v){return o.emplaceBack(0,0),e.emplaceBack(u.x,u.y,f,g,Math.round(v.x),Math.round(v.y))}addCollisionDebugVertices(e,o,u,f,g,v,t){const i=g.segments.prepareSegment(4,g.layoutVertexArray,g.indexArray),a=i.vertexLength,h=g.layoutVertexArray,y=g.collisionVertexArray,w=t.anchorX,E=t.anchorY;this._addCollisionDebugVertex(h,y,v,w,E,new ht(e,o)),this._addCollisionDebugVertex(h,y,v,w,E,new ht(u,o)),this._addCollisionDebugVertex(h,y,v,w,E,new ht(u,f)),this._addCollisionDebugVertex(h,y,v,w,E,new ht(e,f)),i.vertexLength+=4;const z=g.indexArray;z.emplaceBack(a,a+1),z.emplaceBack(a+1,a+2),z.emplaceBack(a+2,a+3),z.emplaceBack(a+3,a),i.primitiveLength+=4}addDebugCollisionBoxes(e,o,u,f){for(let g=e;g<o;g++){const v=this.collisionBoxArray.get(g);this.addCollisionDebugVertices(v.x1,v.y1,v.x2,v.y2,f?this.textCollisionBox:this.iconCollisionBox,v.anchorPoint,u)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new zh(Sn,gh.members,En),this.iconCollisionBox=new zh(Sn,gh.members,En);for(let e=0;e<this.symbolInstances.length;e++){const o=this.symbolInstances.get(e);this.addDebugCollisionBoxes(o.textBoxStartIndex,o.textBoxEndIndex,o,!0),this.addDebugCollisionBoxes(o.verticalTextBoxStartIndex,o.verticalTextBoxEndIndex,o,!0),this.addDebugCollisionBoxes(o.iconBoxStartIndex,o.iconBoxEndIndex,o,!1),this.addDebugCollisionBoxes(o.verticalIconBoxStartIndex,o.verticalIconBoxEndIndex,o,!1)}}_deserializeCollisionBoxesForSymbol(e,o,u,f,g,v,t,i,a){const h={};for(let y=o;y<u;y++){const w=e.get(y);h.textBox={x1:w.x1,y1:w.y1,x2:w.x2,y2:w.y2,anchorPointX:w.anchorPointX,anchorPointY:w.anchorPointY},h.textFeatureIndex=w.featureIndex;break}for(let y=f;y<g;y++){const w=e.get(y);h.verticalTextBox={x1:w.x1,y1:w.y1,x2:w.x2,y2:w.y2,anchorPointX:w.anchorPointX,anchorPointY:w.anchorPointY},h.verticalTextFeatureIndex=w.featureIndex;break}for(let y=v;y<t;y++){const w=e.get(y);h.iconBox={x1:w.x1,y1:w.y1,x2:w.x2,y2:w.y2,anchorPointX:w.anchorPointX,anchorPointY:w.anchorPointY},h.iconFeatureIndex=w.featureIndex;break}for(let y=i;y<a;y++){const w=e.get(y);h.verticalIconBox={x1:w.x1,y1:w.y1,x2:w.x2,y2:w.y2,anchorPointX:w.anchorPointX,anchorPointY:w.anchorPointY},h.verticalIconFeatureIndex=w.featureIndex;break}return h}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let o=0;o<this.symbolInstances.length;o++){const u=this.symbolInstances.get(o);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,u.textBoxStartIndex,u.textBoxEndIndex,u.verticalTextBoxStartIndex,u.verticalTextBoxEndIndex,u.iconBoxStartIndex,u.iconBoxEndIndex,u.verticalIconBoxStartIndex,u.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(e,o){const u=e.placedSymbolArray.get(o),f=u.vertexStartIndex+4*u.numGlyphs;for(let g=u.vertexStartIndex;g<f;g+=4)e.indexArray.emplaceBack(g,g+1,g+2),e.indexArray.emplaceBack(g+1,g+2,g+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const o=Math.sin(e),u=Math.cos(e),f=[],g=[],v=[];for(let t=0;t<this.symbolInstances.length;++t){v.push(t);const i=this.symbolInstances.get(t);f.push(0|Math.round(o*i.anchorX+u*i.anchorY)),g.push(i.featureIndex)}return v.sort((t,i)=>f[t]-f[i]||g[i]-g[t]),v}addToSortKeyRanges(e,o){const u=this.sortKeyRanges[this.sortKeyRanges.length-1];u&&u.sortKey===o?u.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:o,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const o of this.symbolInstanceIndexes){const u=this.symbolInstances.get(o);this.featureSortOrder.push(u.featureIndex),[u.rightJustifiedTextSymbolIndex,u.centerJustifiedTextSymbolIndex,u.leftJustifiedTextSymbolIndex].forEach((f,g,v)=>{f>=0&&v.indexOf(f)===g&&this.addIndicesForPlacedSymbol(this.text,f)}),u.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,u.verticalPlacedTextSymbolIndex),u.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,u.placedIconSymbolIndex),u.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,u.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}Pt("SymbolBucket",Za,{omit:["layers","collisionBoxArray","features","compareText"]}),Za.MAX_GLYPHS=65535,Za.addDynamicAttributes=Au;const Id=new nn({"symbol-placement":new Ot(Me.layout_symbol["symbol-placement"]),"symbol-spacing":new Ot(Me.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Ot(Me.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Gt(Me.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Ot(Me.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Ot(Me.layout_symbol["icon-allow-overlap"]),"icon-overlap":new Ot(Me.layout_symbol["icon-overlap"]),"icon-ignore-placement":new Ot(Me.layout_symbol["icon-ignore-placement"]),"icon-optional":new Ot(Me.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Ot(Me.layout_symbol["icon-rotation-alignment"]),"icon-size":new Gt(Me.layout_symbol["icon-size"]),"icon-text-fit":new Ot(Me.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Ot(Me.layout_symbol["icon-text-fit-padding"]),"icon-image":new Gt(Me.layout_symbol["icon-image"]),"icon-rotate":new Gt(Me.layout_symbol["icon-rotate"]),"icon-padding":new Gt(Me.layout_symbol["icon-padding"]),"icon-keep-upright":new Ot(Me.layout_symbol["icon-keep-upright"]),"icon-offset":new Gt(Me.layout_symbol["icon-offset"]),"icon-anchor":new Gt(Me.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Ot(Me.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Ot(Me.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Ot(Me.layout_symbol["text-rotation-alignment"]),"text-field":new Gt(Me.layout_symbol["text-field"]),"text-font":new Gt(Me.layout_symbol["text-font"]),"text-size":new Gt(Me.layout_symbol["text-size"]),"text-max-width":new Gt(Me.layout_symbol["text-max-width"]),"text-line-height":new Ot(Me.layout_symbol["text-line-height"]),"text-letter-spacing":new Gt(Me.layout_symbol["text-letter-spacing"]),"text-justify":new Gt(Me.layout_symbol["text-justify"]),"text-radial-offset":new Gt(Me.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Ot(Me.layout_symbol["text-variable-anchor"]),"text-anchor":new Gt(Me.layout_symbol["text-anchor"]),"text-max-angle":new Ot(Me.layout_symbol["text-max-angle"]),"text-writing-mode":new Ot(Me.layout_symbol["text-writing-mode"]),"text-rotate":new Gt(Me.layout_symbol["text-rotate"]),"text-padding":new Ot(Me.layout_symbol["text-padding"]),"text-keep-upright":new Ot(Me.layout_symbol["text-keep-upright"]),"text-transform":new Gt(Me.layout_symbol["text-transform"]),"text-offset":new Gt(Me.layout_symbol["text-offset"]),"text-allow-overlap":new Ot(Me.layout_symbol["text-allow-overlap"]),"text-overlap":new Ot(Me.layout_symbol["text-overlap"]),"text-ignore-placement":new Ot(Me.layout_symbol["text-ignore-placement"]),"text-optional":new Ot(Me.layout_symbol["text-optional"])});var is={paint:new nn({"icon-opacity":new Gt(Me.paint_symbol["icon-opacity"]),"icon-color":new Gt(Me.paint_symbol["icon-color"]),"icon-halo-color":new Gt(Me.paint_symbol["icon-halo-color"]),"icon-halo-width":new Gt(Me.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Gt(Me.paint_symbol["icon-halo-blur"]),"icon-translate":new Ot(Me.paint_symbol["icon-translate"]),"icon-translate-anchor":new Ot(Me.paint_symbol["icon-translate-anchor"]),"text-opacity":new Gt(Me.paint_symbol["text-opacity"]),"text-color":new Gt(Me.paint_symbol["text-color"],{runtimeType:qr,getOverride:n=>n.textColor,hasOverride:n=>!!n.textColor}),"text-halo-color":new Gt(Me.paint_symbol["text-halo-color"]),"text-halo-width":new Gt(Me.paint_symbol["text-halo-width"]),"text-halo-blur":new Gt(Me.paint_symbol["text-halo-blur"]),"text-translate":new Ot(Me.paint_symbol["text-translate"]),"text-translate-anchor":new Ot(Me.paint_symbol["text-translate-anchor"])}),layout:Id};class Ad{constructor(e){if(e.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=e.property.overrides?e.property.overrides.runtimeType:Rr,this.defaultValue=e}evaluate(e){if(e.formattedSection){const o=this.defaultValue.property.overrides;if(o&&o.hasOverride(e.formattedSection))return o.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Pt("FormatSectionOverride",Ad,{omit:["defaultValue"]});class os extends Dn{constructor(e){super(e,is)}recalculate(e,o){if(super.recalculate(e,o),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const u=this.layout.get("text-writing-mode");if(u){const f=[];for(const g of u)f.indexOf(g)<0&&f.push(g);this.layout._values["text-writing-mode"]=f}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(e,o,u,f){const g=this.layout.get(e).evaluate(o,{},u,f),v=this._unevaluatedLayout._values[e];return v.isDataDriven()||Ss(v.value)||!g?g:function(t,i){return i.replace(/{([^{}]+)}/g,(a,h)=>h in t?String(t[h]):"")}(o.properties,g)}createBucket(e){return new Za(e)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const e of is.paint.overridableProperties){if(!os.hasPaintOverride(this.layout,e))continue;const o=this.paint.get(e),u=new Ad(o),f=new ou(u,o.property.specification);let g=null;g=o.value.kind==="constant"||o.value.kind==="source"?new ul("source",f):new la("composite",f,o.value.zoomStops),this.paint._values[e]=new Vn(o.property,g,o.parameters)}}_handleOverridablePaintPropertyUpdate(e,o,u){return!(!this.layout||o.isDataDriven()||u.isDataDriven())&&os.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,o){const u=e.get("text-field"),f=is.paint.properties[o];let g=!1;const v=t=>{for(const i of t)if(f.overrides&&f.overrides.hasOverride(i))return void(g=!0)};if(u.value.kind==="constant"&&u.value.value instanceof Ce)v(u.value.value.sections);else if(u.value.kind==="source"){const t=a=>{g||(a instanceof Dt&&ut(a.value)===Ar?v(a.value.sections):a instanceof xs?v(a.sections):a.eachChild(t))},i=u.value;i._styleExpression&&t(i._styleExpression.expression)}return g}}function Ic(n,e,o){let u="never";const f=n.get(e);return f?u=f:n.get(o)&&(u="always"),u}var hn={paint:new nn({"background-color":new Ot(Me.paint_background["background-color"]),"background-pattern":new wo(Me.paint_background["background-pattern"]),"background-opacity":new Ot(Me.paint_background["background-opacity"])})},ff={paint:new nn({"raster-opacity":new Ot(Me.paint_raster["raster-opacity"]),"raster-hue-rotate":new Ot(Me.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Ot(Me.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Ot(Me.paint_raster["raster-brightness-max"]),"raster-saturation":new Ot(Me.paint_raster["raster-saturation"]),"raster-contrast":new Ot(Me.paint_raster["raster-contrast"]),"raster-resampling":new Ot(Me.paint_raster["raster-resampling"]),"raster-fade-duration":new Ot(Me.paint_raster["raster-fade-duration"])})};class zd extends Dn{constructor(e){super(e,{}),this.onAdd=o=>{this.implementation.onAdd&&this.implementation.onAdd(o,o.painter.context.gl)},this.onRemove=o=>{this.implementation.onRemove&&this.implementation.onRemove(o,o.painter.context.gl)},this.implementation=e}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}const pf={circle:class extends Dn{constructor(n){super(n,Il)}createBucket(n){return new Io(n)}queryRadius(n){const e=n;return Yo("circle-radius",this,e)+Yo("circle-stroke-width",this,e)+Ca(this.paint.get("circle-translate"))}queryIntersectsFeature(n,e,o,u,f,g,v,t){const i=gu(n,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),g.angle,v),a=this.paint.get("circle-radius").evaluate(e,o)+this.paint.get("circle-stroke-width").evaluate(e,o),h=this.paint.get("circle-pitch-alignment")==="map",y=h?i:function(E,z){return E.map(N=>yu(N,z))}(i,t),w=h?a*v:a;for(const E of u)for(const z of E){const N=h?z:yu(z,t);let W=w;const se=zl([],[z.x,z.y,0,1],t);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?W*=se[3]/g.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(W*=g.cameraToCenterDistance/se[3]),Yh(y,N,W))return!0}return!1}},heatmap:class extends Dn{constructor(n){super(n,th),this._updateColorRamp()}createBucket(n){return new nc(n)}_handleSpecialPaintPropertyUpdate(n){n==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Tn({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}},hillshade:class extends Dn{constructor(n){super(n,oc)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}},fill:class extends Dn{constructor(n){super(n,ad)}recalculate(n,e){super.recalculate(n,e);const o=this.paint._values["fill-outline-color"];o.value.kind==="constant"&&o.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(n){return new sh(n)}queryRadius(){return Ca(this.paint.get("fill-translate"))}queryIntersectsFeature(n,e,o,u,f,g,v){return mu(gu(n,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),g.angle,v),u)}isTileClipped(){return!0}},"fill-extrusion":class extends Dn{constructor(n){super(n,pd)}createBucket(n){return new gc(n)}queryRadius(){return Ca(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(n,e,o,u,f,g,v,t){const i=gu(n,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),g.angle,v),a=this.paint.get("fill-extrusion-height").evaluate(e,o),h=this.paint.get("fill-extrusion-base").evaluate(e,o),y=function(E,z,N,W){const se=[];for(const pe of E){const ie=[pe.x,pe.y,0,1];zl(ie,ie,z),se.push(new ht(ie[0]/ie[3],ie[1]/ie[3]))}return se}(i,t),w=function(E,z,N,W){const se=[],pe=[],ie=W[8]*z,Te=W[9]*z,Le=W[10]*z,Re=W[11]*z,xt=W[8]*N,we=W[9]*N,ue=W[10]*N,ge=W[11]*N;for(const Be of E){const tt=[],nt=[];for(const Ge of Be){const mt=Ge.x,Ct=Ge.y,Mt=W[0]*mt+W[4]*Ct+W[12],br=W[1]*mt+W[5]*Ct+W[13],$r=W[2]*mt+W[6]*Ct+W[14],In=W[3]*mt+W[7]*Ct+W[15],so=$r+Le,Kn=In+Re,vn=Mt+xt,Un=br+we,Yn=$r+ue,ui=In+ge,Ci=new ht((Mt+ie)/Kn,(br+Te)/Kn);Ci.z=so/Kn,tt.push(Ci);const xn=new ht(vn/ui,Un/ui);xn.z=Yn/ui,nt.push(xn)}se.push(tt),pe.push(nt)}return[se,pe]}(u,h,a,t);return function(E,z,N){let W=1/0;mu(N,z)&&(W=ch(N,z[0]));for(let se=0;se<z.length;se++){const pe=z[se],ie=E[se];for(let Te=0;Te<pe.length-1;Te++){const Le=pe[Te],Re=[Le,pe[Te+1],ie[Te+1],ie[Te],Le];pu(N,Re)&&(W=Math.min(W,ch(N,Re)))}}return W!==1/0&&W}(w[0],w[1],y)}},line:class extends Dn{constructor(n){super(n,ph),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(n){n==="line-gradient"&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof ds,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER)}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(n,e){super.recalculate(n,e),this.paint._values["line-floorwidth"]=_c.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,n)}createBucket(n){return new Bl(n)}queryRadius(n){const e=n,o=mh(Yo("line-width",this,e),Yo("line-gap-width",this,e)),u=Yo("line-offset",this,e);return o/2+Math.abs(u)+Ca(this.paint.get("line-translate"))}queryIntersectsFeature(n,e,o,u,f,g,v){const t=gu(n,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),g.angle,v),i=v/2*mh(this.paint.get("line-width").evaluate(e,o),this.paint.get("line-gap-width").evaluate(e,o)),a=this.paint.get("line-offset").evaluate(e,o);return a&&(u=function(h,y){const w=[];for(let E=0;E<h.length;E++){const z=h[E],N=[];for(let W=0;W<z.length;W++){const se=z[W-1],pe=z[W],ie=z[W+1],Te=W===0?new ht(0,0):pe.sub(se)._unit()._perp(),Le=W===z.length-1?new ht(0,0):ie.sub(pe)._unit()._perp(),Re=Te._add(Le)._unit(),xt=Re.x*Le.x+Re.y*Le.y;xt!==0&&Re._mult(1/xt),N.push(Re._mult(y)._add(pe))}w.push(N)}return w}(u,a*v)),function(h,y,w){for(let E=0;E<y.length;E++){const z=y[E];if(h.length>=3){for(let N=0;N<z.length;N++)if(ka(h,z[N]))return!0}if(Jh(h,z,w))return!0}return!1}(t,u,i)}isTileClipped(){return!0}},symbol:os,background:class extends Dn{constructor(n){super(n,hn)}},raster:class extends Dn{constructor(n){super(n,ff)}}};class mf{constructor(e){this._callback=e,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){delete this._channel,this._callback=()=>{}}}const Ph=63710088e-1;class Hr{constructor(e,o){if(isNaN(e)||isNaN(o))throw new Error(`Invalid LngLat object: (${e}, ${o})`);if(this.lng=+e,this.lat=+o,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Hr(Z(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(e){const o=Math.PI/180,u=this.lat*o,f=e.lat*o,g=Math.sin(u)*Math.sin(f)+Math.cos(u)*Math.cos(f)*Math.cos((e.lng-this.lng)*o);return Ph*Math.acos(Math.min(g,1))}toBounds(e=0){const o=360*e/40075017,u=o/Math.cos(Math.PI/180*this.lat);return new qa(new Hr(this.lng-u,this.lat-o),new Hr(this.lng+u,this.lat+o))}static convert(e){if(e instanceof Hr)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new Hr(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new Hr(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class qa{constructor(e,o){e&&(o?this.setSouthWest(e).setNorthEast(o):e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1]))}setNorthEast(e){return this._ne=e instanceof Hr?new Hr(e.lng,e.lat):Hr.convert(e),this}setSouthWest(e){return this._sw=e instanceof Hr?new Hr(e.lng,e.lat):Hr.convert(e),this}extend(e){const o=this._sw,u=this._ne;let f,g;if(e instanceof Hr)f=e,g=e;else{if(!(e instanceof qa))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(qa.convert(e)):this.extend(Hr.convert(e)):this;if(f=e._sw,g=e._ne,!f||!g)return this}return o||u?(o.lng=Math.min(f.lng,o.lng),o.lat=Math.min(f.lat,o.lat),u.lng=Math.max(g.lng,u.lng),u.lat=Math.max(g.lat,u.lat)):(this._sw=new Hr(f.lng,f.lat),this._ne=new Hr(g.lng,g.lat)),this}getCenter(){return new Hr((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new Hr(this.getWest(),this.getNorth())}getSouthEast(){return new Hr(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:o,lat:u}=Hr.convert(e);let f=this._sw.lng<=o&&o<=this._ne.lng;return this._sw.lng>this._ne.lng&&(f=this._sw.lng>=o&&o>=this._ne.lng),this._sw.lat<=u&&u<=this._ne.lat&&f}static convert(e){return e instanceof qa?e:e&&new qa(e)}}const ki=2*Math.PI*Ph;function Ac(n){return ki*Math.cos(n*Math.PI/180)}function Pd(n){return(180+n)/360}function ss(n){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+n*Math.PI/360)))/360}function zu(n,e){return n/Ac(e)}function as(n){return 360/Math.PI*Math.atan(Math.exp((180-360*n)*Math.PI/180))-90}class Wa{constructor(e,o,u=0){this.x=+e,this.y=+o,this.z=+u}static fromLngLat(e,o=0){const u=Hr.convert(e);return new Wa(Pd(u.lng),ss(u.lat),zu(o,u.lat))}toLngLat(){return new Hr(360*this.x-180,as(this.y))}toAltitude(){return this.z*Ac(as(this.y))}meterInMercatorCoordinateUnits(){return 1/ki*(e=as(this.y),1/Math.cos(e*Math.PI/180));var e}}function zc(n,e,o){var u=2*Math.PI*6378137/256/Math.pow(2,o);return[n*u-2*Math.PI*6378137/2,e*u-2*Math.PI*6378137/2]}class Pu{constructor(e,o,u){if(e<0||e>25||u<0||u>=Math.pow(2,e)||o<0||o>=Math.pow(2,e))throw new Error(`x=${o}, y=${u}, z=${e} outside of bounds. 0<=x<${Math.pow(2,e)}, 0<=y<${Math.pow(2,e)} 0<=z<=25 `);this.z=e,this.x=o,this.y=u,this.key=Mu(0,e,e,o,u)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,o,u){const f=(v=this.y,t=this.z,i=zc(256*(g=this.x),256*(v=Math.pow(2,t)-v-1),t),a=zc(256*(g+1),256*(v+1),t),i[0]+","+i[1]+","+a[0]+","+a[1]);var g,v,t,i,a;const h=function(y,w,E){let z,N="";for(let W=y;W>0;W--)z=1<<W-1,N+=(w&z?1:0)+(E&z?2:0);return N}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(u==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,o>1?"@2x":"").replace(/{quadkey}/g,h).replace(/{bbox-epsg-3857}/g,f)}isChildOf(e){const o=this.z-e.z;return o>0&&e.x===this.x>>o&&e.y===this.y>>o}getTilePoint(e){const o=Math.pow(2,this.z);return new ht((e.x*o-this.x)*cn,(e.y*o-this.y)*cn)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Md{constructor(e,o){this.wrap=e,this.canonical=o,this.key=Mu(e,o.z,o.z,o.x,o.y)}}class li{constructor(e,o,u,f,g){if(e<u)throw new Error(`overscaledZ should be >= z; overscaledZ = ${e}; z = ${u}`);this.overscaledZ=e,this.wrap=o,this.canonical=new Pu(u,+f,+g),this.key=Mu(o,e,u,f,g)}clone(){return new li(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){if(e>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${e}; overscaledZ = ${this.overscaledZ}`);const o=this.canonical.z-e;return e>this.canonical.z?new li(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new li(e,this.wrap,e,this.canonical.x>>o,this.canonical.y>>o)}calculateScaledKey(e,o){if(e>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${e}; overscaledZ = ${this.overscaledZ}`);const u=this.canonical.z-e;return e>this.canonical.z?Mu(this.wrap*+o,e,this.canonical.z,this.canonical.x,this.canonical.y):Mu(this.wrap*+o,e,e,this.canonical.x>>u,this.canonical.y>>u)}isChildOf(e){if(e.wrap!==this.wrap)return!1;const o=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>o&&e.canonical.y===this.canonical.y>>o}children(e){if(this.overscaledZ>=e)return[new li(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const o=this.canonical.z+1,u=2*this.canonical.x,f=2*this.canonical.y;return[new li(o,this.wrap,o,u,f),new li(o,this.wrap,o,u+1,f),new li(o,this.wrap,o,u,f+1),new li(o,this.wrap,o,u+1,f+1)]}isLessThan(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}wrapped(){return new li(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new li(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Md(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(e){return this.canonical.getTilePoint(new Wa(e.x-this.wrap,e.y))}}function Mu(n,e,o,u,f){(n*=2)<0&&(n=-1*n-1);const g=1<<o;return(g*g*n+g*f+u).toString(36)+o.toString(36)+e.toString(36)}Pt("CanonicalTileID",Pu),Pt("OverscaledTileID",li,{omit:["posMatrix"]});class Mh{constructor(e,o,u){if(this.uid=e,o.height!==o.width)throw new RangeError("DEM tiles must be square");if(u&&u!=="mapbox"&&u!=="terrarium")return void _e(`"${u}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=o.height;const f=this.dim=o.height-2;this.data=new Uint32Array(o.data.buffer),this.encoding=u||"mapbox";for(let g=0;g<f;g++)this.data[this._idx(-1,g)]=this.data[this._idx(0,g)],this.data[this._idx(f,g)]=this.data[this._idx(f-1,g)],this.data[this._idx(g,-1)]=this.data[this._idx(g,0)],this.data[this._idx(g,f)]=this.data[this._idx(g,f-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(f,-1)]=this.data[this._idx(f-1,0)],this.data[this._idx(-1,f)]=this.data[this._idx(0,f-1)],this.data[this._idx(f,f)]=this.data[this._idx(f-1,f-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let g=0;g<f;g++)for(let v=0;v<f;v++){const t=this.get(g,v);t>this.max&&(this.max=t),t<this.min&&(this.min=t)}}get(e,o){const u=new Uint8Array(this.data.buffer),f=4*this._idx(e,o);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(u[f],u[f+1],u[f+2])}getUnpackVector(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]}_idx(e,o){if(e<-1||e>=this.dim+1||o<-1||o>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(o+1)*this.stride+(e+1)}_unpackMapbox(e,o,u){return(256*e*256+256*o+u)/10-1e4}_unpackTerrarium(e,o,u){return 256*e+o+u/256-32768}getPixels(){return new Pr({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(e,o,u){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let f=o*this.dim,g=o*this.dim+this.dim,v=u*this.dim,t=u*this.dim+this.dim;switch(o){case-1:f=g-1;break;case 1:g=f+1}switch(u){case-1:v=t-1;break;case 1:t=v+1}const i=-o*this.dim,a=-u*this.dim;for(let h=v;h<t;h++)for(let y=f;y<g;y++)this.data[this._idx(y,h)]=e.data[this._idx(y+i,h+a)]}}Pt("DEMData",Mh);class Dh{constructor(e){this._stringToNumber={},this._numberToString=[];for(let o=0;o<e.length;o++){const u=e[o];this._stringToNumber[u]=o,this._numberToString[o]=u}}encode(e){return this._stringToNumber[e]}decode(e){if(e>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${e} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[e]}}class Du{constructor(e,o,u,f,g){this.type="Feature",this._vectorTileFeature=e,e._z=o,e._x=u,e._y=f,this.properties=e.properties,this.id=g}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){const e={geometry:this.geometry};for(const o in this)o!=="_geometry"&&o!=="_vectorTileFeature"&&(e[o]=this[o]);return e}}class Ru{constructor(e,o){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new qo(cn,16,0),this.grid3D=new qo(cn,16,0),this.featureIndexArray=new Ht,this.promoteId=o}insert(e,o,u,f,g,v){const t=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(u,f,g);const i=v?this.grid3D:this.grid;for(let a=0;a<o.length;a++){const h=o[a],y=[1/0,1/0,-1/0,-1/0];for(let w=0;w<h.length;w++){const E=h[w];y[0]=Math.min(y[0],E.x),y[1]=Math.min(y[1],E.y),y[2]=Math.max(y[2],E.x),y[3]=Math.max(y[3],E.y)}y[0]<cn&&y[1]<cn&&y[2]>=0&&y[3]>=0&&i.insert(t,y[0],y[1],y[2],y[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new Fs.VectorTile(new Fn(this.rawTileData)).layers,this.sourceLayerCoder=new Dh(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(e,o,u,f){this.loadVTLayers();const g=e.params||{},v=cn/e.tileSize/e.scale,t=fl(g.filter),i=e.queryGeometry,a=e.queryPadding*v,h=Pc(i),y=this.grid.query(h.minX-a,h.minY-a,h.maxX+a,h.maxY+a),w=Pc(e.cameraQueryGeometry),E=this.grid3D.query(w.minX-a,w.minY-a,w.maxX+a,w.maxY+a,(W,se,pe,ie)=>function(Te,Le,Re,xt,we){for(const ge of Te)if(Le<=ge.x&&Re<=ge.y&&xt>=ge.x&&we>=ge.y)return!0;const ue=[new ht(Le,Re),new ht(Le,we),new ht(xt,we),new ht(xt,Re)];if(Te.length>2){for(const ge of ue)if(ka(Te,ge))return!0}for(let ge=0;ge<Te.length-1;ge++)if(Jc(Te[ge],Te[ge+1],ue))return!0;return!1}(e.cameraQueryGeometry,W-a,se-a,pe+a,ie+a));for(const W of E)y.push(W);y.sort(gf);const z={};let N;for(let W=0;W<y.length;W++){const se=y[W];if(se===N)continue;N=se;const pe=this.featureIndexArray.get(se);let ie=null;this.loadMatchingFeature(z,pe.bucketIndex,pe.sourceLayerIndex,pe.featureIndex,t,g.layers,g.availableImages,o,u,f,(Te,Le,Re)=>(ie||(ie=Ko(Te)),Le.queryIntersectsFeature(i,Te,Re,ie,this.z,e.transform,v,e.pixelPosMatrix)))}return z}loadMatchingFeature(e,o,u,f,g,v,t,i,a,h,y){const w=this.bucketLayerIDs[o];if(v&&!function(W,se){for(let pe=0;pe<W.length;pe++)if(se.indexOf(W[pe])>=0)return!0;return!1}(v,w))return;const E=this.sourceLayerCoder.decode(u),z=this.vtLayers[E].feature(f);if(g.needGeometry){const W=Ls(z,!0);if(!g.filter(new Mr(this.tileID.overscaledZ),W,this.tileID.canonical))return}else if(!g.filter(new Mr(this.tileID.overscaledZ),z))return;const N=this.getId(z,E);for(let W=0;W<w.length;W++){const se=w[W];if(v&&v.indexOf(se)<0)continue;const pe=i[se];if(!pe)continue;let ie={};N&&h&&(ie=h.getState(pe.sourceLayer||"_geojsonTileLayer",N));const Te=Q({},a[se]);Te.paint=Rh(Te.paint,pe.paint,z,ie,t),Te.layout=Rh(Te.layout,pe.layout,z,ie,t);const Le=!y||y(z,pe,ie);if(!Le)continue;const Re=new Du(z,this.z,this.x,this.y,N);Re.layer=Te;let xt=e[se];xt===void 0&&(xt=e[se]=[]),xt.push({featureIndex:f,feature:Re,intersectionZ:Le})}}lookupSymbolFeatures(e,o,u,f,g,v,t,i){const a={};this.loadVTLayers();const h=fl(g);for(const y of e)this.loadMatchingFeature(a,u,f,y,h,v,t,i,o);return a}hasLayer(e){for(const o of this.bucketLayerIDs)for(const u of o)if(e===u)return!0;return!1}getId(e,o){let u=e.id;return this.promoteId&&(u=e.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[o]],typeof u=="boolean"&&(u=Number(u))),u}}function Rh(n,e,o,u,f){return Y(n,(g,v)=>{const t=e instanceof va?e.get(v):null;return t&&t.evaluate?t.evaluate(o,u,f):t})}function Pc(n){let e=1/0,o=1/0,u=-1/0,f=-1/0;for(const g of n)e=Math.min(e,g.x),o=Math.min(o,g.y),u=Math.max(u,g.x),f=Math.max(f,g.y);return{minX:e,minY:o,maxX:u,maxY:f}}function gf(n,e){return e-n}var Mc;Pt("FeatureIndex",Ru,{omit:["rawTileData","sourceLayerCoder"]}),l.PerformanceMarkers=void 0,(Mc=l.PerformanceMarkers||(l.PerformanceMarkers={})).create="create",Mc.load="load",Mc.fullLoad="fullLoad";let jl=null,Gs=[];const Lu=1e3/30,Dc={mark(n){performance.mark(n)},frame(n){const e=n;jl!=null&&Gs.push(e-jl),jl=e},clearMetrics(){jl=null,Gs=[],performance.clearMeasures("loadTime"),performance.clearMeasures("fullLoadTime");for(const n in l.PerformanceMarkers)performance.clearMarks(l.PerformanceMarkers[n])},getPerformanceMetrics(){performance.measure("loadTime",l.PerformanceMarkers.create,l.PerformanceMarkers.load),performance.measure("fullLoadTime",l.PerformanceMarkers.create,l.PerformanceMarkers.fullLoad);const n=performance.getEntriesByName("loadTime")[0].duration,e=performance.getEntriesByName("fullLoadTime")[0].duration,o=Gs.length,u=1/(Gs.reduce((g,v)=>g+v,0)/o/1e3),f=Gs.filter(g=>g>Lu).reduce((g,v)=>g+(v-Lu)/Lu,0);return{loadTime:n,fullLoadTime:e,fps:u,percentDroppedFrames:f/(o+f)*100}}};l.AJAXError=sr,l.ARRAY_TYPE=_n,l.Actor=class{constructor(n,e,o){this.target=n,this.parent=e,this.mapId=o,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},K(["receive","process"],this),this.invoker=new mf(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=Ze()?n:window}send(n,e,o,u,f=!1){const g=Math.round(1e18*Math.random()).toString(36).substring(0,10);o&&(this.callbacks[g]=o);const v=$e(this.globalScope)?void 0:[];return this.target.postMessage({id:g,type:n,hasCallback:!!o,targetMapId:u,mustQueue:f,sourceMapId:this.mapId,data:Xi(e,v)},v),{cancel:()=>{o&&delete this.callbacks[g],this.target.postMessage({id:g,type:"<cancel>",targetMapId:u,sourceMapId:this.mapId})}}}receive(n){const e=n.data,o=e.id;if(o&&(!e.targetMapId||this.mapId===e.targetMapId))if(e.type==="<cancel>"){delete this.tasks[o];const u=this.cancelCallbacks[o];delete this.cancelCallbacks[o],u&&u()}else Ze()||e.mustQueue?(this.tasks[o]=e,this.taskQueue.push(o),this.invoker.trigger()):this.processTask(o,e)}process(){if(!this.taskQueue.length)return;const n=this.taskQueue.shift(),e=this.tasks[n];delete this.tasks[n],this.taskQueue.length&&this.invoker.trigger(),e&&this.processTask(n,e)}processTask(n,e){if(e.type==="<response>"){const o=this.callbacks[n];delete this.callbacks[n],o&&(e.error?o(Ki(e.error)):o(null,Ki(e.data)))}else{let o=!1;const u=$e(this.globalScope)?void 0:[],f=e.hasCallback?(t,i)=>{o=!0,delete this.cancelCallbacks[n],this.target.postMessage({id:n,type:"<response>",sourceMapId:this.mapId,error:t?Xi(t):null,data:Xi(i,u)},u)}:t=>{o=!0};let g=null;const v=Ki(e.data);if(this.parent[e.type])g=this.parent[e.type](e.sourceMapId,v,f);else if(this.parent.getWorkerSource){const t=e.type.split(".");g=this.parent.getWorkerSource(e.sourceMapId,t[0],v.source)[t[1]](v,f)}else f(new Error(`Could not find function ${e.type}`));!o&&g&&g.cancel&&(this.cancelCallbacks[n]=g.cancel)}}remove(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)}},l.AlphaImage=Vr,l.CanonicalTileID=Pu,l.CollisionBoxArray=Oe,l.CollisionCircleLayoutArray=class extends M{},l.Color=X,l.DEMData=Mh,l.DataConstantProperty=Ot,l.DictionaryCoder=Dh,l.EXTENT=cn,l.ErrorEvent=Qe,l.EvaluationParameters=Mr,l.Event=We,l.Evented=kt,l.FeatureIndex=Ru,l.FillBucket=sh,l.FillExtrusionBucket=gc,l.GeoJSONFeature=Du,l.ImageAtlas=Eh,l.ImagePosition=Sh,l.LineBucket=Bl,l.LineStripIndexArray=class extends Pe{},l.LngLat=Hr,l.LngLatBounds=qa,l.MercatorCoordinate=Wa,l.ONE_EM=sn,l.OverscaledTileID=li,l.PerformanceUtils=Dc,l.PosArray=Jt,l.Properties=nn,l.QuadTriangleArray=class extends q{},l.RGBAImage=Pr,l.RasterBoundsArray=class extends fi{},l.RequestPerformance=class{constructor(n){this._marks={start:[n.url,"start"].join("#"),end:[n.url,"end"].join("#"),measure:n.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let n=performance.getEntriesByName(this._marks.measure);return n.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),n=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),n}},l.ResourceType=or,l.SegmentVector=mr,l.SymbolBucket=Za,l.Transitionable=Sl,l.TriangleIndexArray=jr,l.Uniform1f=Ds,l.Uniform1i=class extends Ln{constructor(n,e){super(n,e),this.current=0}set(n){this.current!==n&&(this.current=n,this.gl.uniform1i(this.location,n))}},l.Uniform2f=class extends Ln{constructor(n,e){super(n,e),this.current=[0,0]}set(n){n[0]===this.current[0]&&n[1]===this.current[1]||(this.current=n,this.gl.uniform2f(this.location,n[0],n[1]))}},l.Uniform3f=class extends Ln{constructor(n,e){super(n,e),this.current=[0,0,0]}set(n){n[0]===this.current[0]&&n[1]===this.current[1]&&n[2]===this.current[2]||(this.current=n,this.gl.uniform3f(this.location,n[0],n[1],n[2]))}},l.Uniform4f=Sa,l.UniformColor=Xn,l.UniformMatrix4f=class extends Ln{constructor(n,e){super(n,e),this.current=ec}set(n){if(n[12]!==this.current[12]||n[0]!==this.current[0])return this.current=n,void this.gl.uniformMatrix4fv(this.location,!1,n);for(let e=1;e<16;e++)if(n[e]!==this.current[e]){this.current=n,this.gl.uniformMatrix4fv(this.location,!1,n);break}}},l.UnwrappedTileID=Md,l.ValidationError=Je,l.ZoomHistory=ks,l.add=function(n,e,o){return n[0]=e[0]+o[0],n[1]=e[1]+o[1],n[2]=e[2]+o[2],n},l.addDynamicAttributes=Au,l.asyncAll=function(n,e,o){if(!n.length)return o(null,[]);let u=n.length;const f=new Array(n.length);let g=null;n.forEach((v,t)=>{e(v,(i,a)=>{i&&(g=i),f[t]=a,--u==0&&o(g,f)})})},l.bezier=G,l.bindAll=K,l.cacheEntryPossiblyAdded=function(n){ct++,ct>Se&&(n.getActor().send("enforceCacheSizeLimit",fe),ct=0)},l.clamp=B,l.clearTileCache=function(n){const e=caches.delete(Fe);n&&e.catch(n).then(()=>n())},l.clipLine=ku,l.clone=function(n){var e=new _n(16);return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],e},l.clone$1=ce,l.clone$2=function(n){var e=new _n(3);return e[0]=n[0],e[1]=n[1],e[2]=n[2],e},l.collisionCircleLayout=yh,l.config=st,l.copy=function(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n},l.create=function(){var n=new _n(16);return _n!=Float32Array&&(n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0),n[0]=1,n[5]=1,n[10]=1,n[15]=1,n},l.create$1=eo,l.createExpression=aa,l.createFilter=fl,l.createLayout=un,l.createStyleLayer=function(n){return n.type==="custom"?new zd(n):new pf[n.type](n)},l.cross=function(n,e,o){var u=e[0],f=e[1],g=e[2],v=o[0],t=o[1],i=o[2];return n[0]=f*i-g*t,n[1]=g*v-u*i,n[2]=u*t-f*v,n},l.dot=function(n,e){return n[0]*e[0]+n[1]*e[1]+n[2]*e[2]},l.dot$1=function(n,e){return n[0]*e[0]+n[1]*e[1]+n[2]*e[2]+n[3]*e[3]},l.ease=$,l.emitValidationErrors=vl,l.enforceCacheSizeLimit=function(n){gt(),ae&&ae.then(e=>{e.keys().then(o=>{for(let u=0;u<o.length-n;u++)e.delete(o[u])})})},l.equals=function(n,e){var o=n[0],u=n[1],f=n[2],g=n[3],v=n[4],t=n[5],i=n[6],a=n[7],h=n[8],y=n[9],w=n[10],E=n[11],z=n[12],N=n[13],W=n[14],se=n[15],pe=e[0],ie=e[1],Te=e[2],Le=e[3],Re=e[4],xt=e[5],we=e[6],ue=e[7],ge=e[8],Be=e[9],tt=e[10],nt=e[11],Ge=e[12],mt=e[13],Ct=e[14],Mt=e[15];return Math.abs(o-pe)<=Gn*Math.max(1,Math.abs(o),Math.abs(pe))&&Math.abs(u-ie)<=Gn*Math.max(1,Math.abs(u),Math.abs(ie))&&Math.abs(f-Te)<=Gn*Math.max(1,Math.abs(f),Math.abs(Te))&&Math.abs(g-Le)<=Gn*Math.max(1,Math.abs(g),Math.abs(Le))&&Math.abs(v-Re)<=Gn*Math.max(1,Math.abs(v),Math.abs(Re))&&Math.abs(t-xt)<=Gn*Math.max(1,Math.abs(t),Math.abs(xt))&&Math.abs(i-we)<=Gn*Math.max(1,Math.abs(i),Math.abs(we))&&Math.abs(a-ue)<=Gn*Math.max(1,Math.abs(a),Math.abs(ue))&&Math.abs(h-ge)<=Gn*Math.max(1,Math.abs(h),Math.abs(ge))&&Math.abs(y-Be)<=Gn*Math.max(1,Math.abs(y),Math.abs(Be))&&Math.abs(w-tt)<=Gn*Math.max(1,Math.abs(w),Math.abs(tt))&&Math.abs(E-nt)<=Gn*Math.max(1,Math.abs(E),Math.abs(nt))&&Math.abs(z-Ge)<=Gn*Math.max(1,Math.abs(z),Math.abs(Ge))&&Math.abs(N-mt)<=Gn*Math.max(1,Math.abs(N),Math.abs(mt))&&Math.abs(W-Ct)<=Gn*Math.max(1,Math.abs(W),Math.abs(Ct))&&Math.abs(se-Mt)<=Gn*Math.max(1,Math.abs(se),Math.abs(Mt))},l.evaluateSizeForFeature=function(n,{uSize:e,uSizeT:o},{lowerSize:u,upperSize:f}){return n.kind==="source"?u/Oi:n.kind==="composite"?Ur(u/Oi,f/Oi,o):e},l.evaluateSizeForZoom=function(n,e){let o=0,u=0;if(n.kind==="constant")u=n.layoutSize;else if(n.kind!=="source"){const{interpolationType:f,minZoom:g,maxZoom:v}=n,t=f?B(yn.interpolationFactor(f,e,g,v),0,1):0;n.kind==="camera"?u=Ur(n.minSize,n.maxSize,t):o=t}return{uSizeT:o,uSize:u}},l.evaluateVariableOffset=Tc,l.evented=Cs,l.exported=qe,l.exported$1=dt,l.extend=Q,l.filterObject=ne,l.fromRotation=function(n,e){var o=Math.sin(e),u=Math.cos(e);return n[0]=u,n[1]=o,n[2]=0,n[3]=-o,n[4]=u,n[5]=0,n[6]=0,n[7]=0,n[8]=1,n},l.fromScaling=function(n,e){return n[0]=e[0],n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=e[1],n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=e[2],n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n},l.getAnchorAlignment=Ns,l.getAnchorJustification=Ch,l.getArrayBuffer=He,l.getImage=ft,l.getJSON=function(n,e){return it(Q(n,{type:"json"}),e)},l.getOverlapMode=Ic,l.getRTLTextPluginStatus=bl,l.getReferrer=pr,l.getVideo=function(n,e){const o=window.document.createElement("video");o.muted=!0,o.onloadstart=function(){e(null,o)};for(let u=0;u<n.length;u++){const f=window.document.createElement("source");de(n[u])||(o.crossOrigin="Anonymous"),f.src=n[u],o.appendChild(f)}return{cancel:()=>{}}},l.identity=Ia,l.invert=function(n,e){var o=e[0],u=e[1],f=e[2],g=e[3],v=e[4],t=e[5],i=e[6],a=e[7],h=e[8],y=e[9],w=e[10],E=e[11],z=e[12],N=e[13],W=e[14],se=e[15],pe=o*t-u*v,ie=o*i-f*v,Te=o*a-g*v,Le=u*i-f*t,Re=u*a-g*t,xt=f*a-g*i,we=h*N-y*z,ue=h*W-w*z,ge=h*se-E*z,Be=y*W-w*N,tt=y*se-E*N,nt=w*se-E*W,Ge=pe*nt-ie*tt+Te*Be+Le*ge-Re*ue+xt*we;return Ge?(n[0]=(t*nt-i*tt+a*Be)*(Ge=1/Ge),n[1]=(f*tt-u*nt-g*Be)*Ge,n[2]=(N*xt-W*Re+se*Le)*Ge,n[3]=(w*Re-y*xt-E*Le)*Ge,n[4]=(i*ge-v*nt-a*ue)*Ge,n[5]=(o*nt-f*ge+g*ue)*Ge,n[6]=(W*Te-z*xt-se*ie)*Ge,n[7]=(h*xt-w*Te+E*ie)*Ge,n[8]=(v*tt-t*ge+a*we)*Ge,n[9]=(u*ge-o*tt-g*we)*Ge,n[10]=(z*Re-N*Te+se*pe)*Ge,n[11]=(y*Te-h*Re-E*pe)*Ge,n[12]=(t*ue-v*Be-i*we)*Ge,n[13]=(o*Be-u*ue+f*we)*Ge,n[14]=(N*ie-z*Le-W*pe)*Ge,n[15]=(h*Le-y*ie+w*pe)*Ge,n):null},l.isImageBitmap=j,l.isSafari=$e,l.isWorker=Ze,l.keysDifference=function(n,e){const o=[];for(const u in n)u in e||o.push(u);return o},l.lazyLoadRTLTextPlugin=function(){_r.isLoading()||_r.isLoaded()||bl()!=="deferred"||_a()},l.makeRequest=it,l.mapObject=Y,l.mercatorXfromLng=Pd,l.mercatorYfromLat=ss,l.mercatorZfromAltitude=zu,l.mul=Qc,l.mul$1=function(n,e,o){return n[0]=e[0]*o[0],n[1]=e[1]*o[1],n[2]=e[2]*o[2],n[3]=e[3]*o[3],n},l.multiply=Al,l.nextPowerOfTwo=function(n){return n<=1?1:Math.pow(2,Math.ceil(Math.log(n)/Math.LN2))},l.normalize=function(n,e){var o=e[0],u=e[1],f=e[2],g=o*o+u*u+f*f;return g>0&&(g=1/Math.sqrt(g)),n[0]=e[0]*g,n[1]=e[1]*g,n[2]=e[2]*g,n},l.number=Ur,l.ortho=function(n,e,o,u,f,g,v){var t=1/(e-o),i=1/(u-f),a=1/(g-v);return n[0]=-2*t,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=-2*i,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=2*a,n[11]=0,n[12]=(e+o)*t,n[13]=(f+u)*i,n[14]=(v+g)*a,n[15]=1,n},l.parseCacheControl=je,l.parseGlyphPbf=function(n){return new Fn(n).readFields(Td,[])},l.pbf=Fn,l.performSymbolLayout=function(n){n.bucket.createArrays(),n.bucket.tilePixelRatio=cn/(512*n.bucket.overscaling),n.bucket.compareText={},n.bucket.iconsNeedLinear=!1;const e=n.bucket.layers[0].layout,o=n.bucket.layers[0]._unevaluatedLayout._values,u={layoutIconSize:o["icon-size"].possiblyEvaluate(new Mr(n.bucket.zoom+1),n.canonical),layoutTextSize:o["text-size"].possiblyEvaluate(new Mr(n.bucket.zoom+1),n.canonical),textMaxSize:o["text-size"].possiblyEvaluate(new Mr(18))};if(n.bucket.textSizeData.kind==="composite"){const{minZoom:i,maxZoom:a}=n.bucket.textSizeData;u.compositeTextSizes=[o["text-size"].possiblyEvaluate(new Mr(i),n.canonical),o["text-size"].possiblyEvaluate(new Mr(a),n.canonical)]}if(n.bucket.iconSizeData.kind==="composite"){const{minZoom:i,maxZoom:a}=n.bucket.iconSizeData;u.compositeIconSizes=[o["icon-size"].possiblyEvaluate(new Mr(i),n.canonical),o["icon-size"].possiblyEvaluate(new Mr(a),n.canonical)]}const f=e.get("text-line-height")*sn,g=e.get("text-rotation-alignment")!=="viewport"&&e.get("symbol-placement")!=="point",v=e.get("text-keep-upright"),t=e.get("text-size");for(const i of n.bucket.features){const a=e.get("text-font").evaluate(i,{},n.canonical).join(","),h=t.evaluate(i,{},n.canonical),y=u.layoutTextSize.evaluate(i,{},n.canonical),w=u.layoutIconSize.evaluate(i,{},n.canonical),E={horizontal:{},vertical:void 0},z=i.text;let N,W=[0,0];if(z){const ie=z.toString(),Te=e.get("text-letter-spacing").evaluate(i,{},n.canonical)*sn,Le=xl(ie)?Te:0,Re=e.get("text-anchor").evaluate(i,{},n.canonical),xt=e.get("text-variable-anchor");if(!xt){const tt=e.get("text-radial-offset").evaluate(i,{},n.canonical);W=tt?Tc(Re,[tt*sn,Cu]):e.get("text-offset").evaluate(i,{},n.canonical).map(nt=>nt*sn)}let we=g?"center":e.get("text-justify").evaluate(i,{},n.canonical);const ue=e.get("symbol-placement"),ge=ue==="point"?e.get("text-max-width").evaluate(i,{},n.canonical)*sn:0,Be=()=>{n.bucket.allowVerticalPlacement&&yo(ie)&&(E.vertical=wc(z,n.glyphMap,n.glyphPositions,n.imagePositions,a,ge,f,Re,"left",Le,W,l.WritingMode.vertical,!0,ue,y,h))};if(!g&&xt){const tt=we==="auto"?xt.map(Ge=>Ch(Ge)):[we];let nt=!1;for(let Ge=0;Ge<tt.length;Ge++){const mt=tt[Ge];if(!E.horizontal[mt])if(nt)E.horizontal[mt]=E.horizontal[0];else{const Ct=wc(z,n.glyphMap,n.glyphPositions,n.imagePositions,a,ge,f,"center",mt,Le,W,l.WritingMode.horizontal,!1,ue,y,h);Ct&&(E.horizontal[mt]=Ct,nt=Ct.positionedLines.length===1)}}Be()}else{we==="auto"&&(we=Ch(Re));const tt=wc(z,n.glyphMap,n.glyphPositions,n.imagePositions,a,ge,f,Re,we,Le,W,l.WritingMode.horizontal,!1,ue,y,h);tt&&(E.horizontal[we]=tt),Be(),yo(ie)&&g&&v&&(E.vertical=wc(z,n.glyphMap,n.glyphPositions,n.imagePositions,a,ge,f,Re,we,Le,W,l.WritingMode.vertical,!1,ue,y,h))}}let se=!1;if(i.icon&&i.icon.name){const ie=n.imageMap[i.icon.name];ie&&(N=Tu(n.imagePositions[i.icon.name],e.get("icon-offset").evaluate(i,{},n.canonical),e.get("icon-anchor").evaluate(i,{},n.canonical)),se=!!ie.sdf,n.bucket.sdfIcons===void 0?n.bucket.sdfIcons=se:n.bucket.sdfIcons!==se&&_e("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(ie.pixelRatio!==n.bucket.pixelRatio||e.get("icon-rotate").constantOr(1)!==0)&&(n.bucket.iconsNeedLinear=!0))}const pe=$s(E.horizontal)||E.vertical;n.bucket.iconsInText=!!pe&&pe.iconsInText,(pe||N)&&Vs(n.bucket,i,E,N,n.imageMap,u,y,w,W,se,n.canonical)}n.showCollisionBoxes&&n.bucket.generateCollisionDebugBuffers()},l.perspective=function(n,e,o,u,f){var g,v=1/Math.tan(e/2);return n[0]=v/o,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=v,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=-1,n[12]=0,n[13]=0,n[15]=0,f!=null&&f!==1/0?(n[10]=(f+u)*(g=1/(u-f)),n[14]=2*f*u*g):(n[10]=-1,n[14]=-2*u),n},l.pick=function(n,e){const o={};for(let u=0;u<e.length;u++){const f=e[u];f in n&&(o[f]=n[f])}return o},l.plugin=_r,l.pointGeometry=ht,l.polygonIntersectsPolygon=pu,l.potpack=io,l.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],l.register=Pt,l.registerForPluginStateChange=function(n){return n({pluginStatus:Mn,pluginURL:vo}),Cs.on("pluginStateChange",n),n},l.renderColorRamp=Tn,l.rotateX=function(n,e,o){var u=Math.sin(o),f=Math.cos(o),g=e[4],v=e[5],t=e[6],i=e[7],a=e[8],h=e[9],y=e[10],w=e[11];return e!==n&&(n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[4]=g*f+a*u,n[5]=v*f+h*u,n[6]=t*f+y*u,n[7]=i*f+w*u,n[8]=a*f-g*u,n[9]=h*f-v*u,n[10]=y*f-t*u,n[11]=w*f-i*u,n},l.rotateZ=function(n,e,o){var u=Math.sin(o),f=Math.cos(o),g=e[0],v=e[1],t=e[2],i=e[3],a=e[4],h=e[5],y=e[6],w=e[7];return e!==n&&(n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[0]=g*f+a*u,n[1]=v*f+h*u,n[2]=t*f+y*u,n[3]=i*f+w*u,n[4]=a*f-g*u,n[5]=h*f-v*u,n[6]=y*f-t*u,n[7]=w*f-i*u,n},l.scale=function(n,e,o){var u=o[0],f=o[1],g=o[2];return n[0]=e[0]*u,n[1]=e[1]*u,n[2]=e[2]*u,n[3]=e[3]*u,n[4]=e[4]*f,n[5]=e[5]*f,n[6]=e[6]*f,n[7]=e[7]*f,n[8]=e[8]*g,n[9]=e[9]*g,n[10]=e[10]*g,n[11]=e[11]*g,n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n},l.scale$1=function(n,e,o){return n[0]=e[0]*o,n[1]=e[1]*o,n[2]=e[2]*o,n},l.setCacheLimits=function(n,e){fe=n,Se=e},l.setRTLTextPlugin=function(n,e,o=!1){if(Mn===ga||Mn===wl||Mn===Li)throw new Error("setRTLTextPlugin cannot be called multiple times.");vo=qe.resolveURL(n),Mn=ga,ya=e,Wo(),o||_a()},l.spec=Me,l.sphericalToCartesian=function([n,e,o]){return e+=90,e*=Math.PI/180,o*=Math.PI/180,{x:n*Math.cos(e)*Math.sin(o),y:n*Math.sin(e)*Math.sin(o),z:n*Math.cos(o)}},l.sqrLen=function(n){var e=n[0],o=n[1];return e*e+o*o},l.sub=function(n,e,o){return n[0]=e[0]-o[0],n[1]=e[1]-o[1],n[2]=e[2]-o[2],n},l.toEvaluationFeature=Ls,l.transformMat3=function(n,e,o){var u=e[0],f=e[1],g=e[2];return n[0]=u*o[0]+f*o[3]+g*o[6],n[1]=u*o[1]+f*o[4]+g*o[7],n[2]=u*o[2]+f*o[5]+g*o[8],n},l.transformMat4=zl,l.transformMat4$1=function(n,e,o){var u=e[0],f=e[1];return n[0]=o[0]*u+o[4]*f+o[12],n[1]=o[1]*u+o[5]*f+o[13],n},l.translate=function(n,e,o){var u,f,g,v,t,i,a,h,y,w,E,z,N=o[0],W=o[1],se=o[2];return e===n?(n[12]=e[0]*N+e[4]*W+e[8]*se+e[12],n[13]=e[1]*N+e[5]*W+e[9]*se+e[13],n[14]=e[2]*N+e[6]*W+e[10]*se+e[14],n[15]=e[3]*N+e[7]*W+e[11]*se+e[15]):(f=e[1],g=e[2],v=e[3],t=e[4],i=e[5],a=e[6],h=e[7],y=e[8],w=e[9],E=e[10],z=e[11],n[0]=u=e[0],n[1]=f,n[2]=g,n[3]=v,n[4]=t,n[5]=i,n[6]=a,n[7]=h,n[8]=y,n[9]=w,n[10]=E,n[11]=z,n[12]=u*N+t*W+y*se+e[12],n[13]=f*N+i*W+w*se+e[13],n[14]=g*N+a*W+E*se+e[14],n[15]=v*N+h*W+z*se+e[15]),n},l.triggerPluginCompletionEvent=Ju,l.unicodeBlockLookup=St,l.uniqueId=function(){return V++},l.validateCustomStyleLayer=function(n){const e=[],o=n.id;return o===void 0&&e.push({message:`layers.${o}: missing required property "id"`}),n.render===void 0&&e.push({message:`layers.${o}: missing required method "render"`}),n.renderingMode&&n.renderingMode!=="2d"&&n.renderingMode!=="3d"&&e.push({message:`layers.${o}: property "renderingMode" must be either "2d" or "3d"`}),e},l.validateLight=Wu,l.validateStyle=mo,l.vectorTile=Fs,l.warnOnce=_e,l.wrap=Z}),T(["./shared"],function(l){function R(J){const D=typeof J;if(D==="number"||D==="boolean"||D==="string"||J==null)return JSON.stringify(J);if(Array.isArray(J)){let re="[";for(const ve of J)re+=`${R(ve)},`;return`${re}]`}const U=Object.keys(J).sort();let X="{";for(let re=0;re<U.length;re++)X+=`${JSON.stringify(U[re])}:${R(J[U[re]])},`;return`${X}}`}function L(J){let D="";for(const U of l.refProperties)D+=`/${R(J[U])}`;return D}class G{constructor(D){this.keyCache={},D&&this.replace(D)}replace(D){this._layerConfigs={},this._layers={},this.update(D,[])}update(D,U){for(const re of D){this._layerConfigs[re.id]=re;const ve=this._layers[re.id]=l.createStyleLayer(re);ve._featureFilter=l.createFilter(ve.filter),this.keyCache[re.id]&&delete this.keyCache[re.id]}for(const re of U)delete this.keyCache[re],delete this._layerConfigs[re],delete this._layers[re];this.familiesBySource={};const X=function(re,ve){const Ce={};for(let xe=0;xe<re.length;xe++){const ze=ve&&ve[re[xe].id]||L(re[xe]);ve&&(ve[re[xe].id]=ze);let Ye=Ce[ze];Ye||(Ye=Ce[ze]=[]),Ye.push(re[xe])}const ke=[];for(const xe in Ce)ke.push(Ce[xe]);return ke}(Object.values(this._layerConfigs),this.keyCache);for(const re of X){const ve=re.map(ut=>this._layers[ut.id]),Ce=ve[0];if(Ce.visibility==="none")continue;const ke=Ce.source||"";let xe=this.familiesBySource[ke];xe||(xe=this.familiesBySource[ke]={});const ze=Ce.sourceLayer||"_geojsonTileLayer";let Ye=xe[ze];Ye||(Ye=xe[ze]=[]),Ye.push(ve)}}}class ${constructor(D){const U={},X=[];for(const ke in D){const xe=D[ke],ze=U[ke]={};for(const Ye in xe){const ut=xe[+Ye];if(!ut||ut.bitmap.width===0||ut.bitmap.height===0)continue;const at={x:0,y:0,w:ut.bitmap.width+2,h:ut.bitmap.height+2};X.push(at),ze[Ye]={rect:at,metrics:ut.metrics}}}const{w:re,h:ve}=l.potpack(X),Ce=new l.AlphaImage({width:re||1,height:ve||1});for(const ke in D){const xe=D[ke];for(const ze in xe){const Ye=xe[+ze];if(!Ye||Ye.bitmap.width===0||Ye.bitmap.height===0)continue;const ut=U[ke][ze].rect;l.AlphaImage.copy(Ye.bitmap,Ce,{x:0,y:0},{x:ut.x+1,y:ut.y+1},Ye.bitmap)}}this.image=Ce,this.positions=U}}l.register("GlyphAtlas",$);class B{constructor(D){this.tileID=new l.OverscaledTileID(D.tileID.overscaledZ,D.tileID.wrap,D.tileID.canonical.z,D.tileID.canonical.x,D.tileID.canonical.y),this.uid=D.uid,this.zoom=D.zoom,this.pixelRatio=D.pixelRatio,this.tileSize=D.tileSize,this.source=D.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=D.showCollisionBoxes,this.collectResourceTiming=!!D.collectResourceTiming,this.returnDependencies=!!D.returnDependencies,this.promoteId=D.promoteId}parse(D,U,X,re,ve){this.status="parsing",this.data=D,this.collisionBoxArray=new l.CollisionBoxArray;const Ce=new l.DictionaryCoder(Object.keys(D.layers).sort()),ke=new l.FeatureIndex(this.tileID,this.promoteId);ke.bucketLayerIDs=[];const xe={},ze={featureIndex:ke,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:X},Ye=U.familiesBySource[this.source];for(const rr in Ye){const Xt=D.layers[rr];if(!Xt)continue;Xt.version===1&&l.warnOnce(`Vector tile source "${this.source}" layer "${rr}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Kt=Ce.encode(rr),Yr=[];for(let Nr=0;Nr<Xt.length;Nr++){const zr=Xt.feature(Nr),bn=ke.getId(zr,rr);Yr.push({feature:zr,id:bn,index:Nr,sourceLayerIndex:Kt})}for(const Nr of Ye[rr]){const zr=Nr[0];zr.source!==this.source&&l.warnOnce(`layer.source = ${zr.source} does not equal this.source = ${this.source}`),zr.minzoom&&this.zoom<Math.floor(zr.minzoom)||zr.maxzoom&&this.zoom>=zr.maxzoom||zr.visibility!=="none"&&(Z(Nr,this.zoom,X),(xe[zr.id]=zr.createBucket({index:ke.bucketLayerIDs.length,layers:Nr,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Kt,sourceID:this.source})).populate(Yr,ze,this.tileID.canonical),ke.bucketLayerIDs.push(Nr.map(bn=>bn.id)))}}let ut,at,Dt,zt;const Ft=l.mapObject(ze.glyphDependencies,rr=>Object.keys(rr).map(Number));Object.keys(Ft).length?re.send("getGlyphs",{uid:this.uid,stacks:Ft},(rr,Xt)=>{ut||(ut=rr,at=Xt,tr.call(this))}):at={};const Et=Object.keys(ze.iconDependencies);Et.length?re.send("getImages",{icons:Et,source:this.source,tileID:this.tileID,type:"icons"},(rr,Xt)=>{ut||(ut=rr,Dt=Xt,tr.call(this))}):Dt={};const er=Object.keys(ze.patternDependencies);function tr(){if(ut)return ve(ut);if(at&&Dt&&zt){const rr=new $(at),Xt=new l.ImageAtlas(Dt,zt);for(const Kt in xe){const Yr=xe[Kt];Yr instanceof l.SymbolBucket?(Z(Yr.layers,this.zoom,X),l.performSymbolLayout({bucket:Yr,glyphMap:at,glyphPositions:rr.positions,imageMap:Dt,imagePositions:Xt.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):Yr.hasPattern&&(Yr instanceof l.LineBucket||Yr instanceof l.FillBucket||Yr instanceof l.FillExtrusionBucket)&&(Z(Yr.layers,this.zoom,X),Yr.addFeatures(ze,this.tileID.canonical,Xt.patternPositions))}this.status="done",ve(null,{buckets:Object.values(xe).filter(Kt=>!Kt.isEmpty()),featureIndex:ke,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:rr.image,imageAtlas:Xt,glyphMap:this.returnDependencies?at:null,iconMap:this.returnDependencies?Dt:null,glyphPositions:this.returnDependencies?rr.positions:null})}}er.length?re.send("getImages",{icons:er,source:this.source,tileID:this.tileID,type:"patterns"},(rr,Xt)=>{ut||(ut=rr,zt=Xt,tr.call(this))}):zt={},tr.call(this)}}function Z(J,D,U){const X=new l.EvaluationParameters(D);for(const re of J)re.recalculate(X,U)}function Q(J,D){const U=l.getArrayBuffer(J.request,(X,re,ve,Ce)=>{X?D(X):re&&D(null,{vectorTile:new l.vectorTile.VectorTile(new l.pbf(re)),rawData:re,cacheControl:ve,expires:Ce})});return()=>{U.cancel(),D()}}class V{constructor(D,U,X,re){this.actor=D,this.layerIndex=U,this.availableImages=X,this.loadVectorData=re||Q,this.loading={},this.loaded={}}loadTile(D,U){const X=D.uid;this.loading||(this.loading={});const re=!!(D&&D.request&&D.request.collectResourceTiming)&&new l.RequestPerformance(D.request),ve=this.loading[X]=new B(D);ve.abort=this.loadVectorData(D,(Ce,ke)=>{if(delete this.loading[X],Ce||!ke)return ve.status="done",this.loaded[X]=ve,U(Ce);const xe=ke.rawData,ze={};ke.expires&&(ze.expires=ke.expires),ke.cacheControl&&(ze.cacheControl=ke.cacheControl);const Ye={};if(re){const ut=re.finish();ut&&(Ye.resourceTiming=JSON.parse(JSON.stringify(ut)))}ve.vectorTile=ke.vectorTile,ve.parse(ke.vectorTile,this.layerIndex,this.availableImages,this.actor,(ut,at)=>{if(ut||!at)return U(ut);U(null,l.extend({rawTileData:xe.slice(0)},at,ze,Ye))}),this.loaded=this.loaded||{},this.loaded[X]=ve})}reloadTile(D,U){const X=this.loaded,re=D.uid,ve=this;if(X&&X[re]){const Ce=X[re];Ce.showCollisionBoxes=D.showCollisionBoxes;const ke=(xe,ze)=>{const Ye=Ce.reloadCallback;Ye&&(delete Ce.reloadCallback,Ce.parse(Ce.vectorTile,ve.layerIndex,this.availableImages,ve.actor,Ye)),U(xe,ze)};Ce.status==="parsing"?Ce.reloadCallback=ke:Ce.status==="done"&&(Ce.vectorTile?Ce.parse(Ce.vectorTile,this.layerIndex,this.availableImages,this.actor,ke):ke())}}abortTile(D,U){const X=this.loading,re=D.uid;X&&X[re]&&X[re].abort&&(X[re].abort(),delete X[re]),U()}removeTile(D,U){const X=this.loaded,re=D.uid;X&&X[re]&&delete X[re],U()}}class K{constructor(){this.loaded={}}loadTile(D,U){const{uid:X,encoding:re,rawImageData:ve}=D,Ce=l.isImageBitmap(ve)?this.getImageData(ve):ve,ke=new l.DEMData(X,Ce,re);this.loaded=this.loaded||{},this.loaded[X]=ke,U(null,ke)}getImageData(D){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(D.width,D.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=D.width,this.offscreenCanvas.height=D.height,this.offscreenCanvasContext.drawImage(D,0,0,D.width,D.height);const U=this.offscreenCanvasContext.getImageData(-1,-1,D.width+2,D.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new l.RGBAImage({width:U.width,height:U.height},U.data)}removeTile(D){const U=this.loaded,X=D.uid;U&&U[X]&&delete U[X]}}var Y=function J(D,U){var X,re=D&&D.type;if(re==="FeatureCollection")for(X=0;X<D.features.length;X++)J(D.features[X],U);else if(re==="GeometryCollection")for(X=0;X<D.geometries.length;X++)J(D.geometries[X],U);else if(re==="Feature")J(D.geometry,U);else if(re==="Polygon")ne(D.coordinates,U);else if(re==="MultiPolygon")for(X=0;X<D.coordinates.length;X++)ne(D.coordinates[X],U);return D};function ne(J,D){if(J.length!==0){ce(J[0],D);for(var U=1;U<J.length;U++)ce(J[U],!D)}}function ce(J,D){for(var U=0,X=0,re=0,ve=J.length,Ce=ve-1;re<ve;Ce=re++){var ke=(J[re][0]-J[Ce][0])*(J[Ce][1]+J[re][1]),xe=U+ke;X+=Math.abs(U)>=Math.abs(ke)?U-xe+ke:ke-xe+U,U=xe}U+X>=0!=!!D&&J.reverse()}const be=l.vectorTile.VectorTileFeature.prototype.toGeoJSON;class _e{constructor(D){this._feature=D,this.extent=l.EXTENT,this.type=D.type,this.properties=D.tags,"id"in D&&!isNaN(D.id)&&(this.id=parseInt(D.id,10))}loadGeometry(){if(this._feature.type===1){const D=[];for(const U of this._feature.geometry)D.push([new l.pointGeometry(U[0],U[1])]);return D}{const D=[];for(const U of this._feature.geometry){const X=[];for(const re of U)X.push(new l.pointGeometry(re[0],re[1]));D.push(X)}return D}}toGeoJSON(D,U,X){return be.call(this,D,U,X)}}class Ue{constructor(D){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=l.EXTENT,this.length=D.length,this._features=D}feature(D){return new _e(this._features[D])}}var De={exports:{}},Ze=l.pointGeometry,je=l.vectorTile.VectorTileFeature,lt=vt;function vt(J,D){this.options=D||{},this.features=J,this.length=J.length}function me(J,D){this.id=typeof J.id=="number"?J.id:void 0,this.type=J.type,this.rawGeometry=J.type===1?[J.geometry]:J.geometry,this.properties=J.tags,this.extent=D||4096}vt.prototype.feature=function(J){return new me(this.features[J],this.options.extent)},me.prototype.loadGeometry=function(){var J=this.rawGeometry;this.geometry=[];for(var D=0;D<J.length;D++){for(var U=J[D],X=[],re=0;re<U.length;re++)X.push(new Ze(U[re][0],U[re][1]));this.geometry.push(X)}return this.geometry},me.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var J=this.geometry,D=1/0,U=-1/0,X=1/0,re=-1/0,ve=0;ve<J.length;ve++)for(var Ce=J[ve],ke=0;ke<Ce.length;ke++){var xe=Ce[ke];D=Math.min(D,xe.x),U=Math.max(U,xe.x),X=Math.min(X,xe.y),re=Math.max(re,xe.y)}return[D,X,U,re]},me.prototype.toGeoJSON=je.prototype.toGeoJSON;var $e=l.pbf,j=lt;function qe(J){var D=new $e;return function(U,X){for(var re in U.layers)X.writeMessage(3,ht,U.layers[re])}(J,D),D.finish()}function ht(J,D){var U;D.writeVarintField(15,J.version||1),D.writeStringField(1,J.name||""),D.writeVarintField(5,J.extent||4096);var X={keys:[],values:[],keycache:{},valuecache:{}};for(U=0;U<J.length;U++)X.feature=J.feature(U),D.writeMessage(2,Ke,X);var re=X.keys;for(U=0;U<re.length;U++)D.writeStringField(3,re[U]);var ve=X.values;for(U=0;U<ve.length;U++)D.writeMessage(4,Se,ve[U])}function Ke(J,D){var U=J.feature;U.id!==void 0&&D.writeVarintField(1,U.id),D.writeMessage(2,st,J),D.writeVarintField(3,U.type),D.writeMessage(4,fe,U)}function st(J,D){var U=J.feature,X=J.keys,re=J.values,ve=J.keycache,Ce=J.valuecache;for(var ke in U.properties){var xe=U.properties[ke],ze=ve[ke];if(xe!==null){ze===void 0&&(X.push(ke),ve[ke]=ze=X.length-1),D.writeVarint(ze);var Ye=typeof xe;Ye!=="string"&&Ye!=="boolean"&&Ye!=="number"&&(xe=JSON.stringify(xe));var ut=Ye+":"+xe,at=Ce[ut];at===void 0&&(re.push(xe),Ce[ut]=at=re.length-1),D.writeVarint(at)}}}function Fe(J,D){return(D<<3)+(7&J)}function ae(J){return J<<1^J>>31}function fe(J,D){for(var U=J.loadGeometry(),X=J.type,re=0,ve=0,Ce=U.length,ke=0;ke<Ce;ke++){var xe=U[ke],ze=1;X===1&&(ze=xe.length),D.writeVarint(Fe(1,ze));for(var Ye=X===3?xe.length-1:xe.length,ut=0;ut<Ye;ut++){ut===1&&X!==1&&D.writeVarint(Fe(2,Ye-1));var at=xe[ut].x-re,Dt=xe[ut].y-ve;D.writeVarint(ae(at)),D.writeVarint(ae(Dt)),re+=at,ve+=Dt}X===3&&D.writeVarint(Fe(7,1))}}function Se(J,D){var U=typeof J;U==="string"?D.writeStringField(1,J):U==="boolean"?D.writeBooleanField(7,J):U==="number"&&(J%1!=0?D.writeDoubleField(3,J):J<0?D.writeSVarintField(6,J):D.writeVarintField(5,J))}function gt(J,D,U,X,re,ve){if(re-X<=U)return;const Ce=X+re>>1;ct(J,D,Ce,X,re,ve%2),gt(J,D,U,X,Ce-1,ve+1),gt(J,D,U,Ce+1,re,ve+1)}function ct(J,D,U,X,re,ve){for(;re>X;){if(re-X>600){const ze=re-X+1,Ye=U-X+1,ut=Math.log(ze),at=.5*Math.exp(2*ut/3),Dt=.5*Math.sqrt(ut*at*(ze-at)/ze)*(Ye-ze/2<0?-1:1);ct(J,D,U,Math.max(X,Math.floor(U-Ye*at/ze+Dt)),Math.min(re,Math.floor(U+(ze-Ye)*at/ze+Dt)),ve)}const Ce=D[2*U+ve];let ke=X,xe=re;for(dt(J,D,X,U),D[2*re+ve]>Ce&&dt(J,D,X,re);ke<xe;){for(dt(J,D,ke,xe),ke++,xe--;D[2*ke+ve]<Ce;)ke++;for(;D[2*xe+ve]>Ce;)xe--}D[2*X+ve]===Ce?dt(J,D,X,xe):(xe++,dt(J,D,xe,re)),xe<=U&&(X=xe+1),U<=xe&&(re=xe-1)}}function dt(J,D,U,X){bt(J,U,X),bt(D,2*U,2*X),bt(D,2*U+1,2*X+1)}function bt(J,D,U){const X=J[D];J[D]=J[U],J[U]=X}function Vt(J,D,U,X){const re=J-U,ve=D-X;return re*re+ve*ve}De.exports=qe,De.exports.fromVectorTileJs=qe,De.exports.fromGeojsonVt=function(J,D){D=D||{};var U={};for(var X in J)U[X]=new j(J[X].features,D),U[X].name=X,U[X].version=D.version,U[X].extent=D.extent;return qe({layers:U})},De.exports.GeoJSONWrapper=j;const At=J=>J[0],Rt=J=>J[1];class $t{constructor(D,U=At,X=Rt,re=64,ve=Float64Array){this.nodeSize=re,this.points=D;const Ce=D.length<65536?Uint16Array:Uint32Array,ke=this.ids=new Ce(D.length),xe=this.coords=new ve(2*D.length);for(let ze=0;ze<D.length;ze++)ke[ze]=ze,xe[2*ze]=U(D[ze]),xe[2*ze+1]=X(D[ze]);gt(ke,xe,re,0,ke.length-1,0)}range(D,U,X,re){return function(ve,Ce,ke,xe,ze,Ye,ut){const at=[0,ve.length-1,0],Dt=[];let zt,Ft;for(;at.length;){const Et=at.pop(),er=at.pop(),tr=at.pop();if(er-tr<=ut){for(let Kt=tr;Kt<=er;Kt++)zt=Ce[2*Kt],Ft=Ce[2*Kt+1],zt>=ke&&zt<=ze&&Ft>=xe&&Ft<=Ye&&Dt.push(ve[Kt]);continue}const rr=Math.floor((tr+er)/2);zt=Ce[2*rr],Ft=Ce[2*rr+1],zt>=ke&&zt<=ze&&Ft>=xe&&Ft<=Ye&&Dt.push(ve[rr]);const Xt=(Et+1)%2;(Et===0?ke<=zt:xe<=Ft)&&(at.push(tr),at.push(rr-1),at.push(Xt)),(Et===0?ze>=zt:Ye>=Ft)&&(at.push(rr+1),at.push(er),at.push(Xt))}return Dt}(this.ids,this.coords,D,U,X,re,this.nodeSize)}within(D,U,X){return function(re,ve,Ce,ke,xe,ze){const Ye=[0,re.length-1,0],ut=[],at=xe*xe;for(;Ye.length;){const Dt=Ye.pop(),zt=Ye.pop(),Ft=Ye.pop();if(zt-Ft<=ze){for(let Xt=Ft;Xt<=zt;Xt++)Vt(ve[2*Xt],ve[2*Xt+1],Ce,ke)<=at&&ut.push(re[Xt]);continue}const Et=Math.floor((Ft+zt)/2),er=ve[2*Et],tr=ve[2*Et+1];Vt(er,tr,Ce,ke)<=at&&ut.push(re[Et]);const rr=(Dt+1)%2;(Dt===0?Ce-xe<=er:ke-xe<=tr)&&(Ye.push(Ft),Ye.push(Et-1),Ye.push(rr)),(Dt===0?Ce+xe>=er:ke+xe>=tr)&&(Ye.push(Et+1),Ye.push(zt),Ye.push(rr))}return ut}(this.ids,this.coords,D,U,X,this.nodeSize)}}const or={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:J=>J},sr=Math.fround||(pr=new Float32Array(1),J=>(pr[0]=+J,pr[0]));var pr;class O{constructor(D){this.options=Ne(Object.create(or),D),this.trees=new Array(this.options.maxZoom+1)}load(D){const{log:U,minZoom:X,maxZoom:re,nodeSize:ve}=this.options;U&&console.time("total time");const Ce=`prepare ${D.length} points`;U&&console.time(Ce),this.points=D;let ke=[];for(let xe=0;xe<D.length;xe++)D[xe].geometry&&ke.push(He(D[xe],xe));this.trees[re+1]=new $t(ke,_t,We,ve,Float32Array),U&&console.timeEnd(Ce);for(let xe=re;xe>=X;xe--){const ze=+Date.now();ke=this._cluster(ke,xe),this.trees[xe]=new $t(ke,_t,We,ve,Float32Array),U&&console.log("z%d: %d clusters in %dms",xe,ke.length,+Date.now()-ze)}return U&&console.timeEnd("total time"),this}getClusters(D,U){let X=((D[0]+180)%360+360)%360-180;const re=Math.max(-90,Math.min(90,D[1]));let ve=D[2]===180?180:((D[2]+180)%360+360)%360-180;const Ce=Math.max(-90,Math.min(90,D[3]));if(D[2]-D[0]>=360)X=-180,ve=180;else if(X>ve){const Ye=this.getClusters([X,re,180,Ce],U),ut=this.getClusters([-180,re,ve,Ce],U);return Ye.concat(ut)}const ke=this.trees[this._limitZoom(U)],xe=ke.range(Ee(X),ot(Ce),Ee(ve),ot(re)),ze=[];for(const Ye of xe){const ut=ke.points[Ye];ze.push(ut.numPoints?de(ut):this.points[ut.index])}return ze}getChildren(D){const U=this._getOriginId(D),X=this._getOriginZoom(D),re="No cluster with the specified id.",ve=this.trees[X];if(!ve)throw new Error(re);const Ce=ve.points[U];if(!Ce)throw new Error(re);const ke=this.options.radius/(this.options.extent*Math.pow(2,X-1)),xe=ve.within(Ce.x,Ce.y,ke),ze=[];for(const Ye of xe){const ut=ve.points[Ye];ut.parentId===D&&ze.push(ut.numPoints?de(ut):this.points[ut.index])}if(ze.length===0)throw new Error(re);return ze}getLeaves(D,U,X){const re=[];return this._appendLeaves(re,D,U=U||10,X=X||0,0),re}getTile(D,U,X){const re=this.trees[this._limitZoom(D)],ve=Math.pow(2,D),{extent:Ce,radius:ke}=this.options,xe=ke/Ce,ze=(X-xe)/ve,Ye=(X+1+xe)/ve,ut={features:[]};return this._addTileFeatures(re.range((U-xe)/ve,ze,(U+1+xe)/ve,Ye),re.points,U,X,ve,ut),U===0&&this._addTileFeatures(re.range(1-xe/ve,ze,1,Ye),re.points,ve,X,ve,ut),U===ve-1&&this._addTileFeatures(re.range(0,ze,xe/ve,Ye),re.points,-1,X,ve,ut),ut.features.length?ut:null}getClusterExpansionZoom(D){let U=this._getOriginZoom(D)-1;for(;U<=this.options.maxZoom;){const X=this.getChildren(D);if(U++,X.length!==1)break;D=X[0].properties.cluster_id}return U}_appendLeaves(D,U,X,re,ve){const Ce=this.getChildren(U);for(const ke of Ce){const xe=ke.properties;if(xe&&xe.cluster?ve+xe.point_count<=re?ve+=xe.point_count:ve=this._appendLeaves(D,xe.cluster_id,X,re,ve):ve<re?ve++:D.push(ke),D.length===X)break}return ve}_addTileFeatures(D,U,X,re,ve,Ce){for(const ke of D){const xe=U[ke],ze=xe.numPoints;let Ye,ut,at;if(ze)Ye=oe(xe),ut=xe.x,at=xe.y;else{const Ft=this.points[xe.index];Ye=Ft.properties,ut=Ee(Ft.geometry.coordinates[0]),at=ot(Ft.geometry.coordinates[1])}const Dt={type:1,geometry:[[Math.round(this.options.extent*(ut*ve-X)),Math.round(this.options.extent*(at*ve-re))]],tags:Ye};let zt;ze?zt=xe.id:this.options.generateId?zt=xe.index:this.points[xe.index].id&&(zt=this.points[xe.index].id),zt!==void 0&&(Dt.id=zt),Ce.features.push(Dt)}}_limitZoom(D){return Math.max(this.options.minZoom,Math.min(Math.floor(+D),this.options.maxZoom+1))}_cluster(D,U){const X=[],{radius:re,extent:ve,reduce:Ce,minPoints:ke}=this.options,xe=re/(ve*Math.pow(2,U));for(let ze=0;ze<D.length;ze++){const Ye=D[ze];if(Ye.zoom<=U)continue;Ye.zoom=U;const ut=this.trees[U+1],at=ut.within(Ye.x,Ye.y,xe),Dt=Ye.numPoints||1;let zt=Dt;for(const Ft of at){const Et=ut.points[Ft];Et.zoom>U&&(zt+=Et.numPoints||1)}if(zt>Dt&&zt>=ke){let Ft=Ye.x*Dt,Et=Ye.y*Dt,er=Ce&&Dt>1?this._map(Ye,!0):null;const tr=(ze<<5)+(U+1)+this.points.length;for(const rr of at){const Xt=ut.points[rr];if(Xt.zoom<=U)continue;Xt.zoom=U;const Kt=Xt.numPoints||1;Ft+=Xt.x*Kt,Et+=Xt.y*Kt,Xt.parentId=tr,Ce&&(er||(er=this._map(Ye,!0)),Ce(er,this._map(Xt)))}Ye.parentId=tr,X.push(it(Ft/zt,Et/zt,tr,zt,er))}else if(X.push(Ye),zt>1)for(const Ft of at){const Et=ut.points[Ft];Et.zoom<=U||(Et.zoom=U,X.push(Et))}}return X}_getOriginId(D){return D-this.points.length>>5}_getOriginZoom(D){return(D-this.points.length)%32}_map(D,U){if(D.numPoints)return U?Ne({},D.properties):D.properties;const X=this.points[D.index].properties,re=this.options.map(X);return U&&re===X?Ne({},re):re}}function it(J,D,U,X,re){return{x:sr(J),y:sr(D),zoom:1/0,id:U,parentId:-1,numPoints:X,properties:re}}function He(J,D){const[U,X]=J.geometry.coordinates;return{x:sr(Ee(U)),y:sr(ot(X)),zoom:1/0,index:D,parentId:-1}}function de(J){return{type:"Feature",id:J.id,properties:oe(J),geometry:{type:"Point",coordinates:[(D=J.x,360*(D-.5)),ft(J.y)]}};var D}function oe(J){const D=J.numPoints,U=D>=1e4?`${Math.round(D/1e3)}k`:D>=1e3?Math.round(D/100)/10+"k":D;return Ne(Ne({},J.properties),{cluster:!0,cluster_id:J.id,point_count:D,point_count_abbreviated:U})}function Ee(J){return J/360+.5}function ot(J){const D=Math.sin(J*Math.PI/180),U=.5-.25*Math.log((1+D)/(1-D))/Math.PI;return U<0?0:U>1?1:U}function ft(J){const D=(180-360*J)*Math.PI/180;return 360*Math.atan(Math.exp(D))/Math.PI-90}function Ne(J,D){for(const U in D)J[U]=D[U];return J}function _t(J){return J.x}function We(J){return J.y}function Qe(J,D,U,X){for(var re,ve=X,Ce=U-D>>1,ke=U-D,xe=J[D],ze=J[D+1],Ye=J[U],ut=J[U+1],at=D+3;at<U;at+=3){var Dt=kt(J[at],J[at+1],xe,ze,Ye,ut);if(Dt>ve)re=at,ve=Dt;else if(Dt===ve){var zt=Math.abs(at-Ce);zt<ke&&(re=at,ke=zt)}}ve>X&&(re-D>3&&Qe(J,D,re,X),J[re+2]=ve,U-re>3&&Qe(J,re,U,X))}function kt(J,D,U,X,re,ve){var Ce=re-U,ke=ve-X;if(Ce!==0||ke!==0){var xe=((J-U)*Ce+(D-X)*ke)/(Ce*Ce+ke*ke);xe>1?(U=re,X=ve):xe>0&&(U+=Ce*xe,X+=ke*xe)}return(Ce=J-U)*Ce+(ke=D-X)*ke}function Me(J,D,U,X){var re={id:J===void 0?null:J,type:D,geometry:U,tags:X,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(ve){var Ce=ve.geometry,ke=ve.type;if(ke==="Point"||ke==="MultiPoint"||ke==="LineString")Je(ve,Ce);else if(ke==="Polygon"||ke==="MultiLineString")for(var xe=0;xe<Ce.length;xe++)Je(ve,Ce[xe]);else if(ke==="MultiPolygon")for(xe=0;xe<Ce.length;xe++)for(var ze=0;ze<Ce[xe].length;ze++)Je(ve,Ce[xe][ze])}(re),re}function Je(J,D){for(var U=0;U<D.length;U+=3)J.minX=Math.min(J.minX,D[U]),J.minY=Math.min(J.minY,D[U+1]),J.maxX=Math.max(J.maxX,D[U]),J.maxY=Math.max(J.maxY,D[U+1])}function xr(J,D,U,X){if(D.geometry){var re=D.geometry.coordinates,ve=D.geometry.type,Ce=Math.pow(U.tolerance/((1<<U.maxZoom)*U.extent),2),ke=[],xe=D.id;if(U.promoteId?xe=D.properties[U.promoteId]:U.generateId&&(xe=X||0),ve==="Point")kr(re,ke);else if(ve==="MultiPoint")for(var ze=0;ze<re.length;ze++)kr(re[ze],ke);else if(ve==="LineString")Wt(re,ke,Ce,!1);else if(ve==="MultiLineString"){if(U.lineMetrics){for(ze=0;ze<re.length;ze++)Wt(re[ze],ke=[],Ce,!1),J.push(Me(xe,"LineString",ke,D.properties));return}vr(re,ke,Ce,!1)}else if(ve==="Polygon")vr(re,ke,Ce,!0);else{if(ve!=="MultiPolygon"){if(ve==="GeometryCollection"){for(ze=0;ze<D.geometry.geometries.length;ze++)xr(J,{id:xe,geometry:D.geometry.geometries[ze],properties:D.properties},U,X);return}throw new Error("Input data is not a valid GeoJSON object.")}for(ze=0;ze<re.length;ze++){var Ye=[];vr(re[ze],Ye,Ce,!0),ke.push(Ye)}}J.push(Me(xe,ve,ke,D.properties))}}function kr(J,D){D.push(Qt(J[0])),D.push(dn(J[1])),D.push(0)}function Wt(J,D,U,X){for(var re,ve,Ce=0,ke=0;ke<J.length;ke++){var xe=Qt(J[ke][0]),ze=dn(J[ke][1]);D.push(xe),D.push(ze),D.push(0),ke>0&&(Ce+=X?(re*ze-xe*ve)/2:Math.sqrt(Math.pow(xe-re,2)+Math.pow(ze-ve,2))),re=xe,ve=ze}var Ye=D.length-3;D[2]=1,Qe(D,0,Ye,U),D[Ye+2]=1,D.size=Math.abs(Ce),D.start=0,D.end=D.size}function vr(J,D,U,X){for(var re=0;re<J.length;re++){var ve=[];Wt(J[re],ve,U,X),D.push(ve)}}function Qt(J){return J/360+.5}function dn(J){var D=Math.sin(J*Math.PI/180),U=.5-.25*Math.log((1+D)/(1-D))/Math.PI;return U<0?0:U>1?1:U}function Rr(J,D,U,X,re,ve,Ce,ke){if(X/=D,ve>=(U/=D)&&Ce<X)return J;if(Ce<U||ve>=X)return null;for(var xe=[],ze=0;ze<J.length;ze++){var Ye=J[ze],ut=Ye.geometry,at=Ye.type,Dt=re===0?Ye.minX:Ye.minY,zt=re===0?Ye.maxX:Ye.maxY;if(Dt>=U&&zt<X)xe.push(Ye);else if(!(zt<U||Dt>=X)){var Ft=[];if(at==="Point"||at==="MultiPoint")yt(ut,Ft,U,X,re);else if(at==="LineString")qt(ut,Ft,U,X,re,!1,ke.lineMetrics);else if(at==="MultiLineString")qr(ut,Ft,U,X,re,!1);else if(at==="Polygon")qr(ut,Ft,U,X,re,!0);else if(at==="MultiPolygon")for(var Et=0;Et<ut.length;Et++){var er=[];qr(ut[Et],er,U,X,re,!0),er.length&&Ft.push(er)}if(Ft.length){if(ke.lineMetrics&&at==="LineString"){for(Et=0;Et<Ft.length;Et++)xe.push(Me(Ye.id,at,Ft[Et],Ye.tags));continue}at!=="LineString"&&at!=="MultiLineString"||(Ft.length===1?(at="LineString",Ft=Ft[0]):at="MultiLineString"),at!=="Point"&&at!=="MultiPoint"||(at=Ft.length===3?"Point":"MultiPoint"),xe.push(Me(Ye.id,at,Ft,Ye.tags))}}}return xe.length?xe:null}function yt(J,D,U,X,re){for(var ve=0;ve<J.length;ve+=3){var Ce=J[ve+re];Ce>=U&&Ce<=X&&(D.push(J[ve]),D.push(J[ve+1]),D.push(J[ve+2]))}}function qt(J,D,U,X,re,ve,Ce){for(var ke,xe,ze=Zt(J),Ye=re===0?Lt:gr,ut=J.start,at=0;at<J.length-3;at+=3){var Dt=J[at],zt=J[at+1],Ft=J[at+2],Et=J[at+3],er=J[at+4],tr=re===0?Dt:zt,rr=re===0?Et:er,Xt=!1;Ce&&(ke=Math.sqrt(Math.pow(Dt-Et,2)+Math.pow(zt-er,2))),tr<U?rr>U&&(xe=Ye(ze,Dt,zt,Et,er,U),Ce&&(ze.start=ut+ke*xe)):tr>X?rr<X&&(xe=Ye(ze,Dt,zt,Et,er,X),Ce&&(ze.start=ut+ke*xe)):fn(ze,Dt,zt,Ft),rr<U&&tr>=U&&(xe=Ye(ze,Dt,zt,Et,er,U),Xt=!0),rr>X&&tr<=X&&(xe=Ye(ze,Dt,zt,Et,er,X),Xt=!0),!ve&&Xt&&(Ce&&(ze.end=ut+ke*xe),D.push(ze),ze=Zt(J)),Ce&&(ut+=ke)}var Kt=J.length-3;Dt=J[Kt],zt=J[Kt+1],Ft=J[Kt+2],(tr=re===0?Dt:zt)>=U&&tr<=X&&fn(ze,Dt,zt,Ft),Kt=ze.length-3,ve&&Kt>=3&&(ze[Kt]!==ze[0]||ze[Kt+1]!==ze[1])&&fn(ze,ze[0],ze[1],ze[2]),ze.length&&D.push(ze)}function Zt(J){var D=[];return D.size=J.size,D.start=J.start,D.end=J.end,D}function qr(J,D,U,X,re,ve){for(var Ce=0;Ce<J.length;Ce++)qt(J[Ce],D,U,X,re,ve,!1)}function fn(J,D,U,X){J.push(D),J.push(U),J.push(X)}function Lt(J,D,U,X,re,ve){var Ce=(ve-D)/(X-D);return J.push(ve),J.push(U+(re-U)*Ce),J.push(1),Ce}function gr(J,D,U,X,re,ve){var Ce=(ve-U)/(re-U);return J.push(D+(X-D)*Ce),J.push(ve),J.push(1),Ce}function Ar(J,D){for(var U=[],X=0;X<J.length;X++){var re,ve=J[X],Ce=ve.type;if(Ce==="Point"||Ce==="MultiPoint"||Ce==="LineString")re=Lr(ve.geometry,D);else if(Ce==="MultiLineString"||Ce==="Polygon"){re=[];for(var ke=0;ke<ve.geometry.length;ke++)re.push(Lr(ve.geometry[ke],D))}else if(Ce==="MultiPolygon")for(re=[],ke=0;ke<ve.geometry.length;ke++){for(var xe=[],ze=0;ze<ve.geometry[ke].length;ze++)xe.push(Lr(ve.geometry[ke][ze],D));re.push(xe)}U.push(Me(ve.id,Ce,re,ve.tags))}return U}function Lr(J,D){var U=[];U.size=J.size,J.start!==void 0&&(U.start=J.start,U.end=J.end);for(var X=0;X<J.length;X+=3)U.push(J[X]+D,J[X+1],J[X+2]);return U}function Kr(J,D){if(J.transformed)return J;var U,X,re,ve=1<<J.z,Ce=J.x,ke=J.y;for(U=0;U<J.features.length;U++){var xe=J.features[U],ze=xe.geometry,Ye=xe.type;if(xe.geometry=[],Ye===1)for(X=0;X<ze.length;X+=2)xe.geometry.push(lr(ze[X],ze[X+1],D,ve,Ce,ke));else for(X=0;X<ze.length;X++){var ut=[];for(re=0;re<ze[X].length;re+=2)ut.push(lr(ze[X][re],ze[X][re+1],D,ve,Ce,ke));xe.geometry.push(ut)}}return J.transformed=!0,J}function lr(J,D,U,X,re,ve){return[Math.round(U*(J*X-re)),Math.round(U*(D*X-ve))]}function ur(J,D,U,X,re){for(var ve=D===re.maxZoom?0:re.tolerance/((1<<D)*re.extent),Ce={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:U,y:X,z:D,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},ke=0;ke<J.length;ke++){Ce.numFeatures++,An(Ce,J[ke],ve,re);var xe=J[ke].minX,ze=J[ke].minY,Ye=J[ke].maxX,ut=J[ke].maxY;xe<Ce.minX&&(Ce.minX=xe),ze<Ce.minY&&(Ce.minY=ze),Ye>Ce.maxX&&(Ce.maxX=Ye),ut>Ce.maxY&&(Ce.maxY=ut)}return Ce}function An(J,D,U,X){var re=D.geometry,ve=D.type,Ce=[];if(ve==="Point"||ve==="MultiPoint")for(var ke=0;ke<re.length;ke+=3)Ce.push(re[ke]),Ce.push(re[ke+1]),J.numPoints++,J.numSimplified++;else if(ve==="LineString")Wr(Ce,re,J,U,!1,!1);else if(ve==="MultiLineString"||ve==="Polygon")for(ke=0;ke<re.length;ke++)Wr(Ce,re[ke],J,U,ve==="Polygon",ke===0);else if(ve==="MultiPolygon")for(var xe=0;xe<re.length;xe++){var ze=re[xe];for(ke=0;ke<ze.length;ke++)Wr(Ce,ze[ke],J,U,!0,ke===0)}if(Ce.length){var Ye=D.tags||null;if(ve==="LineString"&&X.lineMetrics){for(var ut in Ye={},D.tags)Ye[ut]=D.tags[ut];Ye.mapbox_clip_start=re.start/re.size,Ye.mapbox_clip_end=re.end/re.size}var at={geometry:Ce,type:ve==="Polygon"||ve==="MultiPolygon"?3:ve==="LineString"||ve==="MultiLineString"?2:1,tags:Ye};D.id!==null&&(at.id=D.id),J.features.push(at)}}function Wr(J,D,U,X,re,ve){var Ce=X*X;if(X>0&&D.size<(re?Ce:X))U.numPoints+=D.length/3;else{for(var ke=[],xe=0;xe<D.length;xe+=3)(X===0||D[xe+2]>Ce)&&(U.numSimplified++,ke.push(D[xe]),ke.push(D[xe+1])),U.numPoints++;re&&function(ze,Ye){for(var ut=0,at=0,Dt=ze.length,zt=Dt-2;at<Dt;zt=at,at+=2)ut+=(ze[at]-ze[zt])*(ze[at+1]+ze[zt+1]);if(ut>0===Ye)for(at=0,Dt=ze.length;at<Dt/2;at+=2){var Ft=ze[at],Et=ze[at+1];ze[at]=ze[Dt-2-at],ze[at+1]=ze[Dt-1-at],ze[Dt-2-at]=Ft,ze[Dt-1-at]=Et}}(ke,ve),J.push(ke)}}function gn(J,D){var U=(D=this.options=function(re,ve){for(var Ce in ve)re[Ce]=ve[Ce];return re}(Object.create(this.options),D)).debug;if(U&&console.time("preprocess data"),D.maxZoom<0||D.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(D.promoteId&&D.generateId)throw new Error("promoteId and generateId cannot be used together.");var X=function(re,ve){var Ce=[];if(re.type==="FeatureCollection")for(var ke=0;ke<re.features.length;ke++)xr(Ce,re.features[ke],ve,ke);else xr(Ce,re.type==="Feature"?re:{geometry:re},ve);return Ce}(J,D);this.tiles={},this.tileCoords=[],U&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",D.indexMaxZoom,D.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),X=function(re,ve){var Ce=ve.buffer/ve.extent,ke=re,xe=Rr(re,1,-1-Ce,Ce,0,-1,2,ve),ze=Rr(re,1,1-Ce,2+Ce,0,-1,2,ve);return(xe||ze)&&(ke=Rr(re,1,-Ce,1+Ce,0,-1,2,ve)||[],xe&&(ke=Ar(xe,1).concat(ke)),ze&&(ke=ke.concat(Ar(ze,-1)))),ke}(X,D),X.length&&this.splitTile(X,0,0,0),U&&(X.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function wn(J,D,U){return 32*((1<<J)*U+D)+J}function Hn(J,D){const U=J.tileID.canonical;if(!this._geoJSONIndex)return D(null,null);const X=this._geoJSONIndex.getTile(U.z,U.x,U.y);if(!X)return D(null,null);const re=new Ue(X.features);let ve=De.exports(re);ve.byteOffset===0&&ve.byteLength===ve.buffer.byteLength||(ve=new Uint8Array(ve)),D(null,{vectorTile:re,rawData:ve.buffer})}gn.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},gn.prototype.splitTile=function(J,D,U,X,re,ve,Ce){for(var ke=[J,D,U,X],xe=this.options,ze=xe.debug;ke.length;){X=ke.pop(),U=ke.pop(),D=ke.pop(),J=ke.pop();var Ye=1<<D,ut=wn(D,U,X),at=this.tiles[ut];if(!at&&(ze>1&&console.time("creation"),at=this.tiles[ut]=ur(J,D,U,X,xe),this.tileCoords.push({z:D,x:U,y:X}),ze)){ze>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",D,U,X,at.numFeatures,at.numPoints,at.numSimplified),console.timeEnd("creation"));var Dt="z"+D;this.stats[Dt]=(this.stats[Dt]||0)+1,this.total++}if(at.source=J,re){if(D===xe.maxZoom||D===re)continue;var zt=1<<re-D;if(U!==Math.floor(ve/zt)||X!==Math.floor(Ce/zt))continue}else if(D===xe.indexMaxZoom||at.numPoints<=xe.indexMaxPoints)continue;if(at.source=null,J.length!==0){ze>1&&console.time("clipping");var Ft,Et,er,tr,rr,Xt,Kt=.5*xe.buffer/xe.extent,Yr=.5-Kt,Nr=.5+Kt,zr=1+Kt;Ft=Et=er=tr=null,rr=Rr(J,Ye,U-Kt,U+Nr,0,at.minX,at.maxX,xe),Xt=Rr(J,Ye,U+Yr,U+zr,0,at.minX,at.maxX,xe),J=null,rr&&(Ft=Rr(rr,Ye,X-Kt,X+Nr,1,at.minY,at.maxY,xe),Et=Rr(rr,Ye,X+Yr,X+zr,1,at.minY,at.maxY,xe),rr=null),Xt&&(er=Rr(Xt,Ye,X-Kt,X+Nr,1,at.minY,at.maxY,xe),tr=Rr(Xt,Ye,X+Yr,X+zr,1,at.minY,at.maxY,xe),Xt=null),ze>1&&console.timeEnd("clipping"),ke.push(Ft||[],D+1,2*U,2*X),ke.push(Et||[],D+1,2*U,2*X+1),ke.push(er||[],D+1,2*U+1,2*X),ke.push(tr||[],D+1,2*U+1,2*X+1)}}},gn.prototype.getTile=function(J,D,U){var X=this.options,re=X.extent,ve=X.debug;if(J<0||J>24)return null;var Ce=1<<J,ke=wn(J,D=(D%Ce+Ce)%Ce,U);if(this.tiles[ke])return Kr(this.tiles[ke],re);ve>1&&console.log("drilling down to z%d-%d-%d",J,D,U);for(var xe,ze=J,Ye=D,ut=U;!xe&&ze>0;)ze--,Ye=Math.floor(Ye/2),ut=Math.floor(ut/2),xe=this.tiles[wn(ze,Ye,ut)];return xe&&xe.source?(ve>1&&console.log("found parent tile z%d-%d-%d",ze,Ye,ut),ve>1&&console.time("drilling down"),this.splitTile(xe.source,ze,Ye,ut,J,D,U),ve>1&&console.timeEnd("drilling down"),this.tiles[ke]?Kr(this.tiles[ke],re):null):null};class Di extends V{constructor(D,U,X,re){super(D,U,X,Hn),re&&(this.loadGeoJSON=re)}loadData(D,U){var X;(X=this._pendingRequest)===null||X===void 0||X.cancel(),this._pendingCallback&&this._pendingCallback(null,{abandoned:!0});const re=!!(D&&D.request&&D.request.collectResourceTiming)&&new l.RequestPerformance(D.request);this._pendingCallback=U,this._pendingRequest=this.loadGeoJSON(D,(ve,Ce)=>{if(delete this._pendingCallback,delete this._pendingRequest,ve||!Ce)return U(ve);if(typeof Ce!="object")return U(new Error(`Input data given to '${D.source}' is not a valid GeoJSON object.`));{Y(Ce,!0);try{if(D.filter){const xe=l.createExpression(D.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(xe.result==="error")throw new Error(xe.value.map(Ye=>`${Ye.key}: ${Ye.message}`).join(", "));Ce={type:"FeatureCollection",features:Ce.features.filter(Ye=>xe.value.evaluate({zoom:0},Ye))}}this._geoJSONIndex=D.cluster?new O(function({superclusterOptions:xe,clusterProperties:ze}){if(!ze||!xe)return xe;const Ye={},ut={},at={accumulated:null,zoom:0},Dt={properties:null},zt=Object.keys(ze);for(const Ft of zt){const[Et,er]=ze[Ft],tr=l.createExpression(er),rr=l.createExpression(typeof Et=="string"?[Et,["accumulated"],["get",Ft]]:Et);Ye[Ft]=tr.value,ut[Ft]=rr.value}return xe.map=Ft=>{Dt.properties=Ft;const Et={};for(const er of zt)Et[er]=Ye[er].evaluate(at,Dt);return Et},xe.reduce=(Ft,Et)=>{Dt.properties=Et;for(const er of zt)at.accumulated=Ft[er],Ft[er]=ut[er].evaluate(at,Dt)},xe}(D)).load(Ce.features):function(xe,ze){return new gn(xe,ze)}(Ce,D.geojsonVtOptions)}catch(xe){return U(xe)}this.loaded={};const ke={};if(re){const xe=re.finish();xe&&(ke.resourceTiming={},ke.resourceTiming[D.source]=JSON.parse(JSON.stringify(xe)))}U(null,ke)}})}reloadTile(D,U){const X=this.loaded;return X&&X[D.uid]?super.reloadTile(D,U):this.loadTile(D,U)}loadGeoJSON(D,U){if(D.request)return l.getJSON(D.request,U);if(typeof D.data=="string")try{U(null,JSON.parse(D.data))}catch{U(new Error(`Input data given to '${D.source}' is not a valid GeoJSON object.`))}else U(new Error(`Input data given to '${D.source}' is not a valid GeoJSON object.`));return{cancel:()=>{}}}removeSource(D,U){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),U()}getClusterExpansionZoom(D,U){try{U(null,this._geoJSONIndex.getClusterExpansionZoom(D.clusterId))}catch(X){U(X)}}getClusterChildren(D,U){try{U(null,this._geoJSONIndex.getChildren(D.clusterId))}catch(X){U(X)}}getClusterLeaves(D,U){try{U(null,this._geoJSONIndex.getLeaves(D.clusterId,D.limit,D.offset))}catch(X){U(X)}}}class zn{constructor(D){this.self=D,this.actor=new l.Actor(D,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:V,geojson:Di},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(U,X)=>{if(this.workerSourceTypes[U])throw new Error(`Worker source with name "${U}" already registered.`);this.workerSourceTypes[U]=X},this.self.registerRTLTextPlugin=U=>{if(l.plugin.isParsed())throw new Error("RTL text plugin already registered.");l.plugin.applyArabicShaping=U.applyArabicShaping,l.plugin.processBidirectionalText=U.processBidirectionalText,l.plugin.processStyledBidirectionalText=U.processStyledBidirectionalText}}setReferrer(D,U){this.referrer=U}setImages(D,U,X){this.availableImages[D]=U;for(const re in this.workerSources[D]){const ve=this.workerSources[D][re];for(const Ce in ve)ve[Ce].availableImages=U}X()}setLayers(D,U,X){this.getLayerIndex(D).replace(U),X()}updateLayers(D,U,X){this.getLayerIndex(D).update(U.layers,U.removedIds),X()}loadTile(D,U,X){this.getWorkerSource(D,U.type,U.source).loadTile(U,X)}loadDEMTile(D,U,X){this.getDEMWorkerSource(D,U.source).loadTile(U,X)}reloadTile(D,U,X){this.getWorkerSource(D,U.type,U.source).reloadTile(U,X)}abortTile(D,U,X){this.getWorkerSource(D,U.type,U.source).abortTile(U,X)}removeTile(D,U,X){this.getWorkerSource(D,U.type,U.source).removeTile(U,X)}removeDEMTile(D,U){this.getDEMWorkerSource(D,U.source).removeTile(U)}removeSource(D,U,X){if(!this.workerSources[D]||!this.workerSources[D][U.type]||!this.workerSources[D][U.type][U.source])return;const re=this.workerSources[D][U.type][U.source];delete this.workerSources[D][U.type][U.source],re.removeSource!==void 0?re.removeSource(U,X):X()}loadWorkerSource(D,U,X){try{this.self.importScripts(U.url),X()}catch(re){X(re.toString())}}syncRTLPluginState(D,U,X){try{l.plugin.setState(U);const re=l.plugin.getPluginURL();if(l.plugin.isLoaded()&&!l.plugin.isParsed()&&re!=null){this.self.importScripts(re);const ve=l.plugin.isParsed();X(ve?void 0:new Error(`RTL Text Plugin failed to import scripts from ${re}`),ve)}}catch(re){X(re.toString())}}getAvailableImages(D){let U=this.availableImages[D];return U||(U=[]),U}getLayerIndex(D){let U=this.layerIndexes[D];return U||(U=this.layerIndexes[D]=new G),U}getWorkerSource(D,U,X){if(this.workerSources[D]||(this.workerSources[D]={}),this.workerSources[D][U]||(this.workerSources[D][U]={}),!this.workerSources[D][U][X]){const re={send:(ve,Ce,ke)=>{this.actor.send(ve,Ce,ke,D)}};this.workerSources[D][U][X]=new this.workerSourceTypes[U](re,this.getLayerIndex(D),this.getAvailableImages(D))}return this.workerSources[D][U][X]}getDEMWorkerSource(D,U){return this.demWorkerSources[D]||(this.demWorkerSources[D]={}),this.demWorkerSources[D][U]||(this.demWorkerSources[D][U]=new K),this.demWorkerSources[D][U]}enforceCacheSizeLimit(D,U){l.enforceCacheSizeLimit(U)}}return l.isWorker()&&(self.worker=new zn(self)),zn}),T(["./shared"],function(l){var R=L;function L(d){return!function(r){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var c,p,_=new Blob([""],{type:"text/javascript"}),S=URL.createObjectURL(_);try{p=new Worker(S),c=!0}catch{c=!1}return p&&p.terminate(),URL.revokeObjectURL(S),c}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var c=document.createElement("canvas");c.width=c.height=1;var p=c.getContext("2d");if(!p)return!1;var _=p.getImageData(0,0,1,1);return _&&_.width===c.width}()?(G[s=r&&r.failIfMajorPerformanceCaveat]===void 0&&(G[s]=function(c){var p,_=function(S){var k=document.createElement("canvas"),A=Object.create(L.webGLContextAttributes);return A.failIfMajorPerformanceCaveat=S,k.getContext("webgl",A)||k.getContext("experimental-webgl",A)}(c);if(!_)return!1;try{p=_.createShader(_.VERTEX_SHADER)}catch{return!1}return!(!p||_.isContextLost())&&(_.shaderSource(p,"void main() {}"),_.compileShader(p),_.getShaderParameter(p,_.COMPILE_STATUS)===!0)}(s)),G[s]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var s}(d)}var G={};function $(d,r){if(Array.isArray(d)){if(!Array.isArray(r)||d.length!==r.length)return!1;for(let s=0;s<d.length;s++)if(!$(d[s],r[s]))return!1;return!0}if(typeof d=="object"&&d!==null&&r!==null){if(typeof r!="object"||Object.keys(d).length!==Object.keys(r).length)return!1;for(const s in d)if(!$(d[s],r[s]))return!1;return!0}return d===r}L.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};class B{static testProp(r){if(!B.docStyle)return r[0];for(let s=0;s<r.length;s++)if(r[s]in B.docStyle)return r[s];return r[0]}static create(r,s,c){const p=window.document.createElement(r);return s!==void 0&&(p.className=s),c&&c.appendChild(p),p}static createNS(r,s){return window.document.createElementNS(r,s)}static disableDrag(){B.docStyle&&B.selectProp&&(B.userSelect=B.docStyle[B.selectProp],B.docStyle[B.selectProp]="none")}static enableDrag(){B.docStyle&&B.selectProp&&(B.docStyle[B.selectProp]=B.userSelect)}static setTransform(r,s){r.style[B.transformProp]=s}static addEventListener(r,s,c,p={}){r.addEventListener(s,c,"passive"in p?p:p.capture)}static removeEventListener(r,s,c,p={}){r.removeEventListener(s,c,"passive"in p?p:p.capture)}static suppressClickInternal(r){r.preventDefault(),r.stopPropagation(),window.removeEventListener("click",B.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",B.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",B.suppressClickInternal,!0)},0)}static mousePos(r,s){const c=r.getBoundingClientRect();return new l.pointGeometry(s.clientX-c.left-r.clientLeft,s.clientY-c.top-r.clientTop)}static touchPos(r,s){const c=r.getBoundingClientRect(),p=[];for(let _=0;_<s.length;_++)p.push(new l.pointGeometry(s[_].clientX-c.left-r.clientLeft,s[_].clientY-c.top-r.clientTop));return p}static mouseButton(r){return r.button}static remove(r){r.parentNode&&r.parentNode.removeChild(r)}}B.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,B.selectProp=B.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),B.transformProp=B.testProp(["transform","WebkitTransform"]);class Z{constructor(r){this._transformRequestFn=r}transformRequest(r,s){return this._transformRequestFn&&this._transformRequestFn(r,s)||{url:r}}normalizeSpriteURL(r,s,c){const p=function(_){const S=_.match(Q);if(!S)throw new Error(`Unable to parse URL "${_}"`);return{protocol:S[1],authority:S[2],path:S[3]||"/",params:S[4]?S[4].split("&"):[]}}(r);return p.path+=`${s}${c}`,function(_){const S=_.params.length?`?${_.params.join("&")}`:"";return`${_.protocol}://${_.authority}${_.path}${S}`}(p)}setTransformRequest(r){this._transformRequestFn=r}}const Q=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;class V{constructor(r,s,c,p){this.context=r,this.format=c,this.texture=r.gl.createTexture(),this.update(s,p)}update(r,s,c){const{width:p,height:_}=r,S=!(this.size&&this.size[0]===p&&this.size[1]===_||c),{context:k}=this,{gl:A}=k;if(this.useMipmap=!!(s&&s.useMipmap),A.bindTexture(A.TEXTURE_2D,this.texture),k.pixelStoreUnpackFlipY.set(!1),k.pixelStoreUnpack.set(1),k.pixelStoreUnpackPremultiplyAlpha.set(this.format===A.RGBA&&(!s||s.premultiply!==!1)),S)this.size=[p,_],r instanceof HTMLImageElement||r instanceof HTMLCanvasElement||r instanceof HTMLVideoElement||r instanceof ImageData||l.isImageBitmap(r)?A.texImage2D(A.TEXTURE_2D,0,this.format,this.format,A.UNSIGNED_BYTE,r):A.texImage2D(A.TEXTURE_2D,0,this.format,p,_,0,this.format,A.UNSIGNED_BYTE,r.data);else{const{x:M,y:F}=c||{x:0,y:0};r instanceof HTMLImageElement||r instanceof HTMLCanvasElement||r instanceof HTMLVideoElement||r instanceof ImageData||l.isImageBitmap(r)?A.texSubImage2D(A.TEXTURE_2D,0,M,F,A.RGBA,A.UNSIGNED_BYTE,r):A.texSubImage2D(A.TEXTURE_2D,0,M,F,p,_,A.RGBA,A.UNSIGNED_BYTE,r.data)}this.useMipmap&&this.isSizePowerOfTwo()&&A.generateMipmap(A.TEXTURE_2D)}bind(r,s,c){const{context:p}=this,{gl:_}=p;_.bindTexture(_.TEXTURE_2D,this.texture),c!==_.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(c=_.LINEAR),r!==this.filter&&(_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MAG_FILTER,r),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MIN_FILTER,c||r),this.filter=r),s!==this.wrap&&(_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_S,s),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_T,s),this.wrap=s)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:r}=this.context;r.deleteTexture(this.texture),this.texture=null}}function K(d){const{userImage:r}=d;return!!(r&&r.render&&r.render())&&(d.data.replace(new Uint8Array(r.data.buffer)),!0)}class Y extends l.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new l.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(r){if(this.loaded!==r&&(this.loaded=r,r)){for(const{ids:s,callback:c}of this.requestors)this._notify(s,c);this.requestors=[]}}getImage(r){return this.images[r]}addImage(r,s){if(this.images[r])throw new Error(`Image id ${r} already exist, use updateImage instead`);this._validate(r,s)&&(this.images[r]=s)}_validate(r,s){let c=!0;return this._validateStretch(s.stretchX,s.data&&s.data.width)||(this.fire(new l.ErrorEvent(new Error(`Image "${r}" has invalid "stretchX" value`))),c=!1),this._validateStretch(s.stretchY,s.data&&s.data.height)||(this.fire(new l.ErrorEvent(new Error(`Image "${r}" has invalid "stretchY" value`))),c=!1),this._validateContent(s.content,s)||(this.fire(new l.ErrorEvent(new Error(`Image "${r}" has invalid "content" value`))),c=!1),c}_validateStretch(r,s){if(!r)return!0;let c=0;for(const p of r){if(p[0]<c||p[1]<p[0]||s<p[1])return!1;c=p[1]}return!0}_validateContent(r,s){return!(r&&(r.length!==4||r[0]<0||s.data.width<r[0]||r[1]<0||s.data.height<r[1]||r[2]<0||s.data.width<r[2]||r[3]<0||s.data.height<r[3]||r[2]<r[0]||r[3]<r[1]))}updateImage(r,s){const c=this.images[r];if(c.data.width!==s.data.width||c.data.height!==s.data.height)throw new Error(`size mismatch between old image (${c.data.width}x${c.data.height}) and new image (${s.data.width}x${s.data.height}).`);s.version=c.version+1,this.images[r]=s,this.updatedImages[r]=!0}removeImage(r){const s=this.images[r];delete this.images[r],delete this.patterns[r],s.userImage&&s.userImage.onRemove&&s.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(r,s){let c=!0;if(!this.isLoaded())for(const p of r)this.images[p]||(c=!1);this.isLoaded()||c?this._notify(r,s):this.requestors.push({ids:r,callback:s})}_notify(r,s){const c={};for(const p of r){this.images[p]||this.fire(new l.Event("styleimagemissing",{id:p}));const _=this.images[p];_?c[p]={data:_.data.clone(),pixelRatio:_.pixelRatio,sdf:_.sdf,version:_.version,stretchX:_.stretchX,stretchY:_.stretchY,content:_.content,hasRenderCallback:!!(_.userImage&&_.userImage.render)}:l.warnOnce(`Image "${p}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}s(null,c)}getPixelSize(){const{width:r,height:s}=this.atlasImage;return{width:r,height:s}}getPattern(r){const s=this.patterns[r],c=this.getImage(r);if(!c)return null;if(s&&s.position.version===c.version)return s.position;if(s)s.position.version=c.version;else{const p={w:c.data.width+2,h:c.data.height+2,x:0,y:0},_=new l.ImagePosition(p,c);this.patterns[r]={bin:p,position:_}}return this._updatePatternAtlas(),this.patterns[r].position}bind(r){const s=r.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new V(r,this.atlasImage,s.RGBA),this.atlasTexture.bind(s.LINEAR,s.CLAMP_TO_EDGE)}_updatePatternAtlas(){const r=[];for(const _ in this.patterns)r.push(this.patterns[_].bin);const{w:s,h:c}=l.potpack(r),p=this.atlasImage;p.resize({width:s||1,height:c||1});for(const _ in this.patterns){const{bin:S}=this.patterns[_],k=S.x+1,A=S.y+1,M=this.images[_].data,F=M.width,q=M.height;l.RGBAImage.copy(M,p,{x:0,y:0},{x:k,y:A},{width:F,height:q}),l.RGBAImage.copy(M,p,{x:0,y:q-1},{x:k,y:A-1},{width:F,height:1}),l.RGBAImage.copy(M,p,{x:0,y:0},{x:k,y:A+q},{width:F,height:1}),l.RGBAImage.copy(M,p,{x:F-1,y:0},{x:k-1,y:A},{width:1,height:q}),l.RGBAImage.copy(M,p,{x:0,y:0},{x:k+F,y:A},{width:1,height:q})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(r){for(const s of r){if(this.callbackDispatchedThisFrame[s])continue;this.callbackDispatchedThisFrame[s]=!0;const c=this.images[s];c||l.warnOnce(`Image with ID: "${s}" was not found`),K(c)&&this.updateImage(s,c)}}}const ne=1e20;function ce(d,r,s,c,p,_,S,k,A){for(let M=r;M<r+c;M++)be(d,s*_+M,_,p,S,k,A);for(let M=s;M<s+p;M++)be(d,M*_+r,1,c,S,k,A)}function be(d,r,s,c,p,_,S){_[0]=0,S[0]=-ne,S[1]=ne,p[0]=d[r];for(let k=1,A=0,M=0;k<c;k++){p[k]=d[r+k*s];const F=k*k;do{const q=_[A];M=(p[k]-p[q]+F-q*q)/(k-q)/2}while(M<=S[A]&&--A>-1);A++,_[A]=k,S[A]=M,S[A+1]=ne}for(let k=0,A=0;k<c;k++){for(;S[A+1]<k;)A++;const M=_[A],F=k-M;d[r+k*s]=p[M]+F*F}}class _e{constructor(r,s){this.requestManager=r,this.localIdeographFontFamily=s,this.entries={}}setURL(r){this.url=r}getGlyphs(r,s){const c=[];for(const p in r)for(const _ of r[p])c.push({stack:p,id:_});l.asyncAll(c,({stack:p,id:_},S)=>{let k=this.entries[p];k||(k=this.entries[p]={glyphs:{},requests:{},ranges:{}});let A=k.glyphs[_];if(A!==void 0)return void S(null,{stack:p,id:_,glyph:A});if(A=this._tinySDF(k,p,_),A)return k.glyphs[_]=A,void S(null,{stack:p,id:_,glyph:A});const M=Math.floor(_/256);if(256*M>65535)return void S(new Error("glyphs > 65535 not supported"));if(k.ranges[M])return void S(null,{stack:p,id:_,glyph:A});let F=k.requests[M];F||(F=k.requests[M]=[],_e.loadGlyphRange(p,M,this.url,this.requestManager,(q,H)=>{if(H){for(const le in H)this._doesCharSupportLocalGlyph(+le)||(k.glyphs[+le]=H[+le]);k.ranges[M]=!0}for(const le of F)le(q,H);delete k.requests[M]})),F.push((q,H)=>{q?S(q):H&&S(null,{stack:p,id:_,glyph:H[_]||null})})},(p,_)=>{if(p)s(p);else if(_){const S={};for(const{stack:k,id:A,glyph:M}of _)(S[k]||(S[k]={}))[A]=M&&{id:M.id,bitmap:M.bitmap.clone(),metrics:M.metrics};s(null,S)}})}_doesCharSupportLocalGlyph(r){return!!this.localIdeographFontFamily&&(l.unicodeBlockLookup["CJK Unified Ideographs"](r)||l.unicodeBlockLookup["Hangul Syllables"](r)||l.unicodeBlockLookup.Hiragana(r)||l.unicodeBlockLookup.Katakana(r))}_tinySDF(r,s,c){const p=this.localIdeographFontFamily;if(!p||!this._doesCharSupportLocalGlyph(c))return;let _=r.tinySDF;if(!_){let k="400";/bold/i.test(s)?k="900":/medium/i.test(s)?k="500":/light/i.test(s)&&(k="200"),_=r.tinySDF=new _e.TinySDF({fontSize:24,buffer:3,radius:8,cutoff:.25,fontFamily:p,fontWeight:k})}const S=_.draw(String.fromCharCode(c));return{id:c,bitmap:new l.AlphaImage({width:S.width||30,height:S.height||30},S.data),metrics:{width:S.glyphWidth||24,height:S.glyphHeight||24,left:S.glyphLeft||0,top:S.glyphTop-27||-8,advance:S.glyphAdvance||24}}}}_e.loadGlyphRange=function(d,r,s,c,p){const _=256*r,S=_+255,k=c.transformRequest(s.replace("{fontstack}",d).replace("{range}",`${_}-${S}`),l.ResourceType.Glyphs);l.getArrayBuffer(k,(A,M)=>{if(A)p(A);else if(M){const F={};for(const q of l.parseGlyphPbf(M))F[q.id]=q;p(null,F)}})},_e.TinySDF=class{constructor({fontSize:d=24,buffer:r=3,radius:s=8,cutoff:c=.25,fontFamily:p="sans-serif",fontWeight:_="normal",fontStyle:S="normal"}={}){this.buffer=r,this.cutoff=c,this.radius=s;const k=this.size=d+4*r,A=this._createCanvas(k),M=this.ctx=A.getContext("2d",{willReadFrequently:!0});M.font=`${S} ${_} ${d}px ${p}`,M.textBaseline="alphabetic",M.textAlign="left",M.fillStyle="black",this.gridOuter=new Float64Array(k*k),this.gridInner=new Float64Array(k*k),this.f=new Float64Array(k),this.z=new Float64Array(k+1),this.v=new Uint16Array(k)}_createCanvas(d){const r=document.createElement("canvas");return r.width=r.height=d,r}draw(d){const{width:r,actualBoundingBoxAscent:s,actualBoundingBoxDescent:c,actualBoundingBoxLeft:p,actualBoundingBoxRight:_}=this.ctx.measureText(d),S=Math.ceil(s),k=Math.min(this.size-this.buffer,Math.ceil(_-p)),A=Math.min(this.size-this.buffer,S+Math.ceil(c)),M=k+2*this.buffer,F=A+2*this.buffer,q=Math.max(M*F,0),H=new Uint8ClampedArray(q),le={data:H,width:M,height:F,glyphWidth:k,glyphHeight:A,glyphTop:S,glyphLeft:0,glyphAdvance:r};if(k===0||A===0)return le;const{ctx:te,buffer:ee,gridInner:ye,gridOuter:Ae}=this;te.clearRect(ee,ee,k,A),te.fillText(d,ee,ee+S);const Pe=te.getImageData(ee,ee,k,A);Ae.fill(ne,0,q),ye.fill(0,0,q);for(let he=0;he<A;he++)for(let Ve=0;Ve<k;Ve++){const Oe=Pe.data[4*(he*k+Ve)+3]/255;if(Oe===0)continue;const Xe=(he+ee)*M+Ve+ee;if(Oe===1)Ae[Xe]=0,ye[Xe]=ne;else{const rt=.5-Oe;Ae[Xe]=rt>0?rt*rt:0,ye[Xe]=rt<0?rt*rt:0}}ce(Ae,0,0,M,F,M,this.f,this.v,this.z),ce(ye,ee,ee,k,A,M,this.f,this.v,this.z);for(let he=0;he<q;he++){const Ve=Math.sqrt(Ae[he])-Math.sqrt(ye[he]);H[he]=Math.round(255-255*(Ve/this.radius+this.cutoff))}return le}};const Ue=new l.Properties({anchor:new l.DataConstantProperty(l.spec.light.anchor),position:new class{constructor(){this.specification=l.spec.light.position}possiblyEvaluate(d,r){return l.sphericalToCartesian(d.expression.evaluate(r))}interpolate(d,r,s){return{x:l.number(d.x,r.x,s),y:l.number(d.y,r.y,s),z:l.number(d.z,r.z,s)}}},color:new l.DataConstantProperty(l.spec.light.color),intensity:new l.DataConstantProperty(l.spec.light.intensity)}),De="-transition";class Ze extends l.Evented{constructor(r){super(),this._transitionable=new l.Transitionable(Ue),this.setLight(r),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(r,s={}){if(!this._validate(l.validateLight,r,s))for(const c in r){const p=r[c];c.endsWith(De)?this._transitionable.setTransition(c.slice(0,-De.length),p):this._transitionable.setValue(c,p)}}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}_validate(r,s,c){return(!c||c.validate!==!1)&&l.emitValidationErrors(this,r.call(l.validateStyle,l.extend({value:s,style:{glyphs:!0,sprite:!0},styleSpec:l.spec})))}}class je{constructor(r,s){this.width=r,this.height=s,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(r,s){const c=r.join(",")+String(s);return this.dashEntry[c]||(this.dashEntry[c]=this.addDash(r,s)),this.dashEntry[c]}getDashRanges(r,s,c){const p=[];let _=r.length%2==1?-r[r.length-1]*c:0,S=r[0]*c,k=!0;p.push({left:_,right:S,isDash:k,zeroLength:r[0]===0});let A=r[0];for(let M=1;M<r.length;M++){k=!k;const F=r[M];_=A*c,A+=F,S=A*c,p.push({left:_,right:S,isDash:k,zeroLength:F===0})}return p}addRoundDash(r,s,c){const p=s/2;for(let _=-c;_<=c;_++){const S=this.width*(this.nextRow+c+_);let k=0,A=r[k];for(let M=0;M<this.width;M++){M/A.right>1&&(A=r[++k]);const F=Math.abs(M-A.left),q=Math.abs(M-A.right),H=Math.min(F,q);let le;const te=_/c*(p+1);if(A.isDash){const ee=p-Math.abs(te);le=Math.sqrt(H*H+ee*ee)}else le=p-Math.sqrt(H*H+te*te);this.data[S+M]=Math.max(0,Math.min(255,le+128))}}}addRegularDash(r){for(let k=r.length-1;k>=0;--k){const A=r[k],M=r[k+1];A.zeroLength?r.splice(k,1):M&&M.isDash===A.isDash&&(M.left=A.left,r.splice(k,1))}const s=r[0],c=r[r.length-1];s.isDash===c.isDash&&(s.left=c.left-this.width,c.right=s.right+this.width);const p=this.width*this.nextRow;let _=0,S=r[_];for(let k=0;k<this.width;k++){k/S.right>1&&(S=r[++_]);const A=Math.abs(k-S.left),M=Math.abs(k-S.right),F=Math.min(A,M);this.data[p+k]=Math.max(0,Math.min(255,(S.isDash?F:-F)+128))}}addDash(r,s){const c=s?7:0,p=2*c+1;if(this.nextRow+p>this.height)return l.warnOnce("LineAtlas out of space"),null;let _=0;for(let k=0;k<r.length;k++)_+=r[k];if(_!==0){const k=this.width/_,A=this.getDashRanges(r,this.width,k);s?this.addRoundDash(A,k,c):this.addRegularDash(A)}const S={y:(this.nextRow+c+.5)/this.height,height:2*c/this.height,width:_};return this.nextRow+=p,this.dirty=!0,S}bind(r){const s=r.gl;this.texture?(s.bindTexture(s.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,s.texSubImage2D(s.TEXTURE_2D,0,0,0,this.width,this.height,s.ALPHA,s.UNSIGNED_BYTE,this.data))):(this.texture=s.createTexture(),s.bindTexture(s.TEXTURE_2D,this.texture),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,s.REPEAT),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,s.REPEAT),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,s.LINEAR),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,s.LINEAR),s.texImage2D(s.TEXTURE_2D,0,s.ALPHA,this.width,this.height,0,s.ALPHA,s.UNSIGNED_BYTE,this.data))}}class lt{constructor(r,s){this.workerPool=r,this.actors=[],this.currentActor=0,this.id=l.uniqueId();const c=this.workerPool.acquire(this.id);for(let p=0;p<c.length;p++){const _=new lt.Actor(c[p],s,this.id);_.name=`Worker ${p}`,this.actors.push(_)}if(!this.actors.length)throw new Error("No actors found")}broadcast(r,s,c){l.asyncAll(this.actors,(p,_)=>{p.send(r,s,_)},c=c||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(r=>{r.remove()}),this.actors=[],this.workerPool.release(this.id)}}function vt(d,r,s){const c=function(p,_){if(p)return s(p);if(_){const S=l.pick(l.extend(_,d),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);_.vector_layers&&(S.vectorLayers=_.vector_layers,S.vectorLayerIds=S.vectorLayers.map(k=>k.id)),s(null,S)}};return d.url?l.getJSON(r.transformRequest(d.url,l.ResourceType.Source),c):l.exported.frame(()=>c(null,d))}lt.Actor=l.Actor;class me{constructor(r,s,c){this.bounds=l.LngLatBounds.convert(this.validateBounds(r)),this.minzoom=s||0,this.maxzoom=c||24}validateBounds(r){return Array.isArray(r)&&r.length===4?[Math.max(-180,r[0]),Math.max(-90,r[1]),Math.min(180,r[2]),Math.min(90,r[3])]:[-180,-90,180,90]}contains(r){const s=Math.pow(2,r.z),c=Math.floor(l.mercatorXfromLng(this.bounds.getWest())*s),p=Math.floor(l.mercatorYfromLat(this.bounds.getNorth())*s),_=Math.ceil(l.mercatorXfromLng(this.bounds.getEast())*s),S=Math.ceil(l.mercatorYfromLat(this.bounds.getSouth())*s);return r.x>=c&&r.x<_&&r.y>=p&&r.y<S}}class $e extends l.Evented{constructor(r,s,c,p){if(super(),this.id=r,this.dispatcher=c,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,l.extend(this,l.pick(s,["url","scheme","tileSize","promoteId"])),this._options=l.extend({type:"vector"},s),this._collectResourceTiming=s.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(p)}load(){this._loaded=!1,this.fire(new l.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=vt(this._options,this.map._requestManager,(r,s)=>{this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),r?this.fire(new l.ErrorEvent(r)):s&&(l.extend(this,s),s.bounds&&(this.tileBounds=new me(s.bounds,this.minzoom,this.maxzoom)),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}hasTile(r){return!this.tileBounds||this.tileBounds.contains(r.canonical)}onAdd(r){this.map=r,this.load()}setSourceProperty(r){this._tileJSONRequest&&this._tileJSONRequest.cancel(),r(),this.load()}setTiles(r){return this.setSourceProperty(()=>{this._options.tiles=r}),this}setUrl(r){return this.setSourceProperty(()=>{this.url=r,this._options.url=r}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return l.extend({},this._options)}loadTile(r,s){const c=r.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),p={request:this.map._requestManager.transformRequest(c,l.ResourceType.Tile),uid:r.uid,tileID:r.tileID,zoom:r.tileID.overscaledZ,tileSize:this.tileSize*r.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function _(S,k){return delete r.request,r.aborted?s(null):S&&S.status!==404?s(S):(k&&k.resourceTiming&&(r.resourceTiming=k.resourceTiming),this.map._refreshExpiredTiles&&k&&r.setExpiryData(k),r.loadVectorData(k,this.map.painter),l.cacheEntryPossiblyAdded(this.dispatcher),s(null),void(r.reloadCallback&&(this.loadTile(r,r.reloadCallback),r.reloadCallback=null)))}p.request.collectResourceTiming=this._collectResourceTiming,r.actor&&r.state!=="expired"?r.state==="loading"?r.reloadCallback=s:r.request=r.actor.send("reloadTile",p,_.bind(this)):(r.actor=this.dispatcher.getActor(),r.request=r.actor.send("loadTile",p,_.bind(this)))}abortTile(r){r.request&&(r.request.cancel(),delete r.request),r.actor&&r.actor.send("abortTile",{uid:r.uid,type:this.type,source:this.id},void 0)}unloadTile(r){r.unloadVectorData(),r.actor&&r.actor.send("removeTile",{uid:r.uid,type:this.type,source:this.id},void 0)}hasTransition(){return!1}}class j extends l.Evented{constructor(r,s,c,p){super(),this.id=r,this.dispatcher=c,this.setEventedParent(p),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=l.extend({type:"raster"},s),l.extend(this,l.pick(s,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new l.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=vt(this._options,this.map._requestManager,(r,s)=>{this._tileJSONRequest=null,this._loaded=!0,r?this.fire(new l.ErrorEvent(r)):s&&(l.extend(this,s),s.bounds&&(this.tileBounds=new me(s.bounds,this.minzoom,this.maxzoom)),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(r){this.map=r,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return l.extend({},this._options)}hasTile(r){return!this.tileBounds||this.tileBounds.contains(r.canonical)}loadTile(r,s){const c=r.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);r.request=l.getImage(this.map._requestManager.transformRequest(c,l.ResourceType.Tile),(p,_,S)=>{if(delete r.request,r.aborted)r.state="unloaded",s(null);else if(p)r.state="errored",s(p);else if(_){this.map._refreshExpiredTiles&&r.setExpiryData(S);const k=this.map.painter.context,A=k.gl;r.texture=this.map.painter.getTileTexture(_.width),r.texture?r.texture.update(_,{useMipmap:!0}):(r.texture=new V(k,_,A.RGBA,{useMipmap:!0}),r.texture.bind(A.LINEAR,A.CLAMP_TO_EDGE,A.LINEAR_MIPMAP_NEAREST),k.extTextureFilterAnisotropic&&A.texParameterf(A.TEXTURE_2D,k.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,k.extTextureFilterAnisotropicMax)),r.state="loaded",l.cacheEntryPossiblyAdded(this.dispatcher),s(null)}})}abortTile(r,s){r.request&&(r.request.cancel(),delete r.request),s()}unloadTile(r,s){r.texture&&this.map.painter.saveTileTexture(r.texture),s()}hasTransition(){return!1}}let qe;class ht extends j{constructor(r,s,c,p){super(r,s,c,p),this.type="raster-dem",this.maxzoom=22,this._options=l.extend({type:"raster-dem"},s),this.encoding=s.encoding||"mapbox"}serialize(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}}loadTile(r,s){const c=r.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);function p(_,S){_&&(r.state="errored",s(_)),S&&(r.dem=S,r.needsHillshadePrepare=!0,r.needsTerrainPrepare=!0,r.state="loaded",s(null))}r.request=l.getImage(this.map._requestManager.transformRequest(c,l.ResourceType.Tile),(function(_,S){if(delete r.request,r.aborted)r.state="unloaded",s(null);else if(_)r.state="errored",s(_);else if(S){this.map._refreshExpiredTiles&&r.setExpiryData(S),delete S.cacheControl,delete S.expires;const k=l.isImageBitmap(S)&&(qe==null&&(qe=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),qe)?S:l.exported.getImageData(S,1),A={uid:r.uid,coord:r.tileID,source:this.id,rawImageData:k,encoding:this.encoding};r.actor&&r.state!=="expired"||(r.actor=this.dispatcher.getActor(),r.actor.send("loadDEMTile",A,p.bind(this)))}}).bind(this)),r.neighboringTiles=this._getNeighboringTiles(r.tileID)}_getNeighboringTiles(r){const s=r.canonical,c=Math.pow(2,s.z),p=(s.x-1+c)%c,_=s.x===0?r.wrap-1:r.wrap,S=(s.x+1+c)%c,k=s.x+1===c?r.wrap+1:r.wrap,A={};return A[new l.OverscaledTileID(r.overscaledZ,_,s.z,p,s.y).key]={backfilled:!1},A[new l.OverscaledTileID(r.overscaledZ,k,s.z,S,s.y).key]={backfilled:!1},s.y>0&&(A[new l.OverscaledTileID(r.overscaledZ,_,s.z,p,s.y-1).key]={backfilled:!1},A[new l.OverscaledTileID(r.overscaledZ,r.wrap,s.z,s.x,s.y-1).key]={backfilled:!1},A[new l.OverscaledTileID(r.overscaledZ,k,s.z,S,s.y-1).key]={backfilled:!1}),s.y+1<c&&(A[new l.OverscaledTileID(r.overscaledZ,_,s.z,p,s.y+1).key]={backfilled:!1},A[new l.OverscaledTileID(r.overscaledZ,r.wrap,s.z,s.x,s.y+1).key]={backfilled:!1},A[new l.OverscaledTileID(r.overscaledZ,k,s.z,S,s.y+1).key]={backfilled:!1}),A}unloadTile(r){r.demTexture&&this.map.painter.saveTileTexture(r.demTexture),r.fbo&&(r.fbo.destroy(),delete r.fbo),r.dem&&delete r.dem,delete r.neighboringTiles,r.state="unloaded",r.actor&&r.actor.send("removeDEMTile",{uid:r.uid,source:this.id})}}class Ke extends l.Evented{constructor(r,s,c,p){super(),this.id=r,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=c.getActor(),this.setEventedParent(p),this._data=s.data,this._options=l.extend({},s),this._collectResourceTiming=s.collectResourceTiming,s.maxzoom!==void 0&&(this.maxzoom=s.maxzoom),s.type&&(this.type=s.type),s.attribution&&(this.attribution=s.attribution),this.promoteId=s.promoteId;const _=l.EXTENT/this.tileSize;this.workerOptions=l.extend({source:this.id,cluster:s.cluster||!1,geojsonVtOptions:{buffer:(s.buffer!==void 0?s.buffer:128)*_,tolerance:(s.tolerance!==void 0?s.tolerance:.375)*_,extent:l.EXTENT,maxZoom:this.maxzoom,lineMetrics:s.lineMetrics||!1,generateId:s.generateId||!1},superclusterOptions:{maxZoom:s.clusterMaxZoom!==void 0?s.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,s.clusterMinPoints||2),extent:l.EXTENT,radius:(s.clusterRadius||50)*_,log:!1,generateId:s.generateId||!1},clusterProperties:s.clusterProperties,filter:s.filter},s.workerOptions)}load(){this._updateWorkerData("metadata")}onAdd(r){this.map=r,this.load()}setData(r){return this._data=r,this._updateWorkerData("content"),this}getClusterExpansionZoom(r,s){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:r,source:this.id},s),this}getClusterChildren(r,s){return this.actor.send("geojson.getClusterChildren",{clusterId:r,source:this.id},s),this}getClusterLeaves(r,s,c,p){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:r,limit:s,offset:c},p),this}_updateWorkerData(r){const s=l.extend({},this.workerOptions),c=this._data;typeof c=="string"?(s.request=this.map._requestManager.transformRequest(l.exported.resolveURL(c),l.ResourceType.Source),s.request.collectResourceTiming=this._collectResourceTiming):s.data=JSON.stringify(c),this._pendingLoads++,this.fire(new l.Event("dataloading",{dataType:"source"})),this.actor.send(`${this.type}.loadData`,s,(p,_)=>{if(this._pendingLoads--,this._removed||_&&_.abandoned)return void this.fire(new l.Event("dataabort",{dataType:"source",sourceDataType:r}));let S=null;if(_&&_.resourceTiming&&_.resourceTiming[this.id]&&(S=_.resourceTiming[this.id].slice(0)),p)return void this.fire(new l.ErrorEvent(p));const k={dataType:"source",sourceDataType:r};this._collectResourceTiming&&S&&S.length>0&&l.extend(k,{resourceTiming:S}),this.fire(new l.Event("data",k))})}loaded(){return this._pendingLoads===0}loadTile(r,s){const c=r.actor?"reloadTile":"loadTile";r.actor=this.actor;const p={type:this.type,uid:r.uid,tileID:r.tileID,zoom:r.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};r.request=this.actor.send(c,p,(_,S)=>(delete r.request,r.unloadVectorData(),r.aborted?s(null):_?s(_):(r.loadVectorData(S,this.map.painter,c==="reloadTile"),s(null))))}abortTile(r){r.request&&(r.request.cancel(),delete r.request),r.aborted=!0}unloadTile(r){r.unloadVectorData(),this.actor.send("removeTile",{uid:r.uid,type:this.type,source:this.id})}onRemove(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})}serialize(){return l.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var st=l.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Fe extends l.Evented{constructor(r,s,c,p){super(),this.id=r,this.dispatcher=c,this.coordinates=s.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(p),this.options=s}load(r,s){this._loaded=!1,this.fire(new l.Event("dataloading",{dataType:"source"})),this.url=this.options.url,l.getImage(this.map._requestManager.transformRequest(this.url,l.ResourceType.Image),(c,p)=>{this._loaded=!0,c?this.fire(new l.ErrorEvent(c)):p&&(this.image=p,r&&(this.coordinates=r),s&&s(),this._finishLoading())})}loaded(){return this._loaded}updateImage(r){return this.image&&r.url?(this.options.url=r.url,this.load(r.coordinates,()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(r){this.map=r,this.load()}setCoordinates(r){this.coordinates=r;const s=r.map(l.MercatorCoordinate.fromLngLat);this.tileID=function(p){let _=1/0,S=1/0,k=-1/0,A=-1/0;for(const H of p)_=Math.min(_,H.x),S=Math.min(S,H.y),k=Math.max(k,H.x),A=Math.max(A,H.y);const M=Math.max(k-_,A-S),F=Math.max(0,Math.floor(-Math.log(M)/Math.LN2)),q=Math.pow(2,F);return new l.CanonicalTileID(F,Math.floor((_+k)/2*q),Math.floor((S+A)/2*q))}(s),this.minzoom=this.maxzoom=this.tileID.z;const c=s.map(p=>this.tileID.getTilePoint(p)._round());return this._boundsArray=new l.RasterBoundsArray,this._boundsArray.emplaceBack(c[0].x,c[0].y,0,0),this._boundsArray.emplaceBack(c[1].x,c[1].y,l.EXTENT,0),this._boundsArray.emplaceBack(c[3].x,c[3].y,0,l.EXTENT),this._boundsArray.emplaceBack(c[2].x,c[2].y,l.EXTENT,l.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const r=this.map.painter.context,s=r.gl;this.boundsBuffer||(this.boundsBuffer=r.createVertexBuffer(this._boundsArray,st.members)),this.boundsSegments||(this.boundsSegments=l.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new V(r,this.image,s.RGBA),this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE));for(const c in this.tiles){const p=this.tiles[c];p.state!=="loaded"&&(p.state="loaded",p.texture=this.texture)}}loadTile(r,s){this.tileID&&this.tileID.equals(r.tileID.canonical)?(this.tiles[String(r.tileID.wrap)]=r,r.buckets={},s(null)):(r.state="errored",s(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class ae extends Fe{constructor(r,s,c,p){super(r,s,c,p),this.roundZoom=!0,this.type="video",this.options=s}load(){this._loaded=!1;const r=this.options;this.urls=[];for(const s of r.urls)this.urls.push(this.map._requestManager.transformRequest(s,l.ResourceType.Source).url);l.getVideo(this.urls,(s,c)=>{this._loaded=!0,s?this.fire(new l.ErrorEvent(s)):c&&(this.video=c,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(r){if(this.video){const s=this.video.seekable;r<s.start(0)||r>s.end(0)?this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${s.start(0)} and ${s.end(0)}-second mark.`))):this.video.currentTime=r}}getVideo(){return this.video}onAdd(r){this.map||(this.map=r,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const r=this.map.painter.context,s=r.gl;this.boundsBuffer||(this.boundsBuffer=r.createVertexBuffer(this._boundsArray,st.members)),this.boundsSegments||(this.boundsSegments=l.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE),s.texSubImage2D(s.TEXTURE_2D,0,0,0,s.RGBA,s.UNSIGNED_BYTE,this.video)):(this.texture=new V(r,this.video,s.RGBA),this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE));for(const c in this.tiles){const p=this.tiles[c];p.state!=="loaded"&&(p.state="loaded",p.texture=this.texture)}}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class fe extends Fe{constructor(r,s,c,p){super(r,s,c,p),s.coordinates?Array.isArray(s.coordinates)&&s.coordinates.length===4&&!s.coordinates.some(_=>!Array.isArray(_)||_.length!==2||_.some(S=>typeof S!="number"))||this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${r}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${r}`,null,'missing required property "coordinates"'))),s.animate&&typeof s.animate!="boolean"&&this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${r}`,null,'optional "animate" property must be a boolean value'))),s.canvas?typeof s.canvas=="string"||s.canvas instanceof HTMLCanvasElement||this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${r}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${r}`,null,'missing required property "canvas"'))),this.options=s,this.animate=s.animate===void 0||s.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new l.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(r){this.map=r,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let r=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,r=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,r=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const s=this.map.painter.context,c=s.gl;this.boundsBuffer||(this.boundsBuffer=s.createVertexBuffer(this._boundsArray,st.members)),this.boundsSegments||(this.boundsSegments=l.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(r||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new V(s,this.canvas,c.RGBA,{premultiply:!0});for(const p in this.tiles){const _=this.tiles[p];_.state!=="loaded"&&(_.state="loaded",_.texture=this.texture)}}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const r of[this.canvas.width,this.canvas.height])if(isNaN(r)||r<=0)return!0;return!1}}const Se={vector:$e,raster:j,"raster-dem":ht,geojson:Ke,video:ae,image:Fe,canvas:fe};function gt(d,r){const s=l.create();return l.translate(s,s,[1,1,0]),l.scale(s,s,[.5*d.width,.5*d.height,1]),l.multiply(s,s,d.calculatePosMatrix(r.toUnwrapped()))}function ct(d,r,s,c,p,_){const S=function(q,H,le){if(q)for(const te of q){const ee=H[te];if(ee&&ee.source===le&&ee.type==="fill-extrusion")return!0}else for(const te in H){const ee=H[te];if(ee.source===le&&ee.type==="fill-extrusion")return!0}return!1}(p&&p.layers,r,d.id),k=_.maxPitchScaleFactor(),A=d.tilesIn(c,k,S);A.sort(dt);const M=[];for(const q of A)M.push({wrappedTileID:q.tileID.wrapped().key,queryResults:q.tile.queryRenderedFeatures(r,s,d._state,q.queryGeometry,q.cameraQueryGeometry,q.scale,p,_,k,gt(d.transform,q.tileID))});const F=function(q){const H={},le={};for(const te of q){const ee=te.queryResults,ye=te.wrappedTileID,Ae=le[ye]=le[ye]||{};for(const Pe in ee){const he=ee[Pe],Ve=Ae[Pe]=Ae[Pe]||{},Oe=H[Pe]=H[Pe]||[];for(const Xe of he)Ve[Xe.featureIndex]||(Ve[Xe.featureIndex]=!0,Oe.push(Xe))}}return H}(M);for(const q in F)F[q].forEach(H=>{const le=H.feature,te=d.getFeatureState(le.layer["source-layer"],le.id);le.source=le.layer.source,le.layer["source-layer"]&&(le.sourceLayer=le.layer["source-layer"]),le.state=te});return F}function dt(d,r){const s=d.tileID,c=r.tileID;return s.overscaledZ-c.overscaledZ||s.canonical.y-c.canonical.y||s.wrap-c.wrap||s.canonical.x-c.canonical.x}class bt{constructor(r,s){this.tileID=r,this.uid=l.uniqueId(),this.uses=0,this.tileSize=s,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.textures=[],this.textureCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(r){const s=r+this.timeAdded;s<l.exported.now()||this.fadeEndTime&&s<this.fadeEndTime||(this.fadeEndTime=s)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(r){this.demTexture&&r.saveTileTexture(this.demTexture),this.textures.forEach(s=>r.saveTileTexture(s)),this.demTexture=null,this.textures=[],this.textureCoords={}}loadVectorData(r,s,c){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",r){r.featureIndex&&(this.latestFeatureIndex=r.featureIndex,r.rawTileData?(this.latestRawTileData=r.rawTileData,this.latestFeatureIndex.rawTileData=r.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=r.collisionBoxArray,this.buckets=function(p,_){const S={};if(!_)return S;for(const k of p){const A=k.layerIds.map(M=>_.getLayer(M)).filter(Boolean);if(A.length!==0){k.layers=A,k.stateDependentLayerIds&&(k.stateDependentLayers=k.stateDependentLayerIds.map(M=>A.filter(F=>F.id===M)[0]));for(const M of A)S[M.id]=k}}return S}(r.buckets,s.style),this.hasSymbolBuckets=!1;for(const p in this.buckets){const _=this.buckets[p];if(_ instanceof l.SymbolBucket){if(this.hasSymbolBuckets=!0,!c)break;_.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const p in this.buckets){const _=this.buckets[p];if(_ instanceof l.SymbolBucket&&_.hasRTLText){this.hasRTLText=!0,l.lazyLoadRTLTextPlugin();break}}this.queryPadding=0;for(const p in this.buckets){const _=this.buckets[p];this.queryPadding=Math.max(this.queryPadding,s.style.getLayer(p).queryRadius(_))}r.imageAtlas&&(this.imageAtlas=r.imageAtlas),r.glyphAtlasImage&&(this.glyphAtlasImage=r.glyphAtlasImage)}else this.collisionBoxArray=new l.CollisionBoxArray}unloadVectorData(){for(const r in this.buckets)this.buckets[r].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(r){return this.buckets[r.id]}upload(r){for(const c in this.buckets){const p=this.buckets[c];p.uploadPending()&&p.upload(r)}const s=r.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new V(r,this.imageAtlas.image,s.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new V(r,this.glyphAtlasImage,s.ALPHA),this.glyphAtlasImage=null)}prepare(r){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(r,this.imageAtlasTexture)}queryRenderedFeatures(r,s,c,p,_,S,k,A,M,F){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:p,cameraQueryGeometry:_,scale:S,tileSize:this.tileSize,pixelPosMatrix:F,transform:A,params:k,queryPadding:this.queryPadding*M},r,s,c):{}}querySourceFeatures(r,s){const c=this.latestFeatureIndex;if(!c||!c.rawTileData)return;const p=c.loadVTLayers(),_=s?s.sourceLayer:"",S=p._geojsonTileLayer||p[_];if(!S)return;const k=l.createFilter(s&&s.filter),{z:A,x:M,y:F}=this.tileID.canonical,q={z:A,x:M,y:F};for(let H=0;H<S.length;H++){const le=S.feature(H);if(k.needGeometry){const ye=l.toEvaluationFeature(le,!0);if(!k.filter(new l.EvaluationParameters(this.tileID.overscaledZ),ye,this.tileID.canonical))continue}else if(!k.filter(new l.EvaluationParameters(this.tileID.overscaledZ),le))continue;const te=c.getId(le,_),ee=new l.GeoJSONFeature(le,A,M,F,te);ee.tile=q,r.push(ee)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(r){const s=this.expirationTime;if(r.cacheControl){const c=l.parseCacheControl(r.cacheControl);c["max-age"]&&(this.expirationTime=Date.now()+1e3*c["max-age"])}else r.expires&&(this.expirationTime=new Date(r.expires).getTime());if(this.expirationTime){const c=Date.now();let p=!1;if(this.expirationTime>c)p=!1;else if(s)if(this.expirationTime<s)p=!0;else{const _=this.expirationTime-s;_?this.expirationTime=c+Math.max(_,3e4):p=!0}else p=!0;p?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(r,s){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(r).length===0)return;const c=this.latestFeatureIndex.loadVTLayers();for(const p in this.buckets){if(!s.style.hasLayer(p))continue;const _=this.buckets[p],S=_.layers[0].sourceLayer||"_geojsonTileLayer",k=c[S],A=r[S];if(!k||!A||Object.keys(A).length===0)continue;_.update(A,k,this.imageAtlas&&this.imageAtlas.patternPositions||{});const M=s&&s.style&&s.style.getLayer(p);M&&(this.queryPadding=Math.max(this.queryPadding,M.queryRadius(_)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<l.exported.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(r){this.symbolFadeHoldUntil=l.exported.now()+r}setDependencies(r,s){const c={};for(const p of s)c[p]=!0;this.dependencies[r]=c}hasDependency(r,s){for(const c of r){const p=this.dependencies[c];if(p){for(const _ of s)if(p[_])return!0}}return!1}}class Vt{constructor(r,s){this.max=r,this.onRemove=s,this.reset()}reset(){for(const r in this.data)for(const s of this.data[r])s.timeout&&clearTimeout(s.timeout),this.onRemove(s.value);return this.data={},this.order=[],this}add(r,s,c){const p=r.wrapped().key;this.data[p]===void 0&&(this.data[p]=[]);const _={value:s,timeout:void 0};if(c!==void 0&&(_.timeout=setTimeout(()=>{this.remove(r,_)},c)),this.data[p].push(_),this.order.push(p),this.order.length>this.max){const S=this._getAndRemoveByKey(this.order[0]);S&&this.onRemove(S)}return this}has(r){return r.wrapped().key in this.data}getAndRemove(r){return this.has(r)?this._getAndRemoveByKey(r.wrapped().key):null}_getAndRemoveByKey(r){const s=this.data[r].shift();return s.timeout&&clearTimeout(s.timeout),this.data[r].length===0&&delete this.data[r],this.order.splice(this.order.indexOf(r),1),s.value}getByKey(r){const s=this.data[r];return s?s[0].value:null}get(r){return this.has(r)?this.data[r.wrapped().key][0].value:null}remove(r,s){if(!this.has(r))return this;const c=r.wrapped().key,p=s===void 0?0:this.data[c].indexOf(s),_=this.data[c][p];return this.data[c].splice(p,1),_.timeout&&clearTimeout(_.timeout),this.data[c].length===0&&delete this.data[c],this.onRemove(_.value),this.order.splice(this.order.indexOf(c),1),this}setMaxSize(r){for(this.max=r;this.order.length>this.max;){const s=this._getAndRemoveByKey(this.order[0]);s&&this.onRemove(s)}return this}filter(r){const s=[];for(const c in this.data)for(const p of this.data[c])r(p.value)||s.push(p);for(const c of s)this.remove(c.value.tileID,c)}}class At{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(r,s,c){const p=String(s);if(this.stateChanges[r]=this.stateChanges[r]||{},this.stateChanges[r][p]=this.stateChanges[r][p]||{},l.extend(this.stateChanges[r][p],c),this.deletedStates[r]===null){this.deletedStates[r]={};for(const _ in this.state[r])_!==p&&(this.deletedStates[r][_]=null)}else if(this.deletedStates[r]&&this.deletedStates[r][p]===null){this.deletedStates[r][p]={};for(const _ in this.state[r][p])c[_]||(this.deletedStates[r][p][_]=null)}else for(const _ in c)this.deletedStates[r]&&this.deletedStates[r][p]&&this.deletedStates[r][p][_]===null&&delete this.deletedStates[r][p][_]}removeFeatureState(r,s,c){if(this.deletedStates[r]===null)return;const p=String(s);if(this.deletedStates[r]=this.deletedStates[r]||{},c&&s!==void 0)this.deletedStates[r][p]!==null&&(this.deletedStates[r][p]=this.deletedStates[r][p]||{},this.deletedStates[r][p][c]=null);else if(s!==void 0)if(this.stateChanges[r]&&this.stateChanges[r][p])for(c in this.deletedStates[r][p]={},this.stateChanges[r][p])this.deletedStates[r][p][c]=null;else this.deletedStates[r][p]=null;else this.deletedStates[r]=null}getState(r,s){const c=String(s),p=l.extend({},(this.state[r]||{})[c],(this.stateChanges[r]||{})[c]);if(this.deletedStates[r]===null)return{};if(this.deletedStates[r]){const _=this.deletedStates[r][s];if(_===null)return{};for(const S in _)delete p[S]}return p}initializeTileState(r,s){r.setFeatureState(this.state,s)}coalesceChanges(r,s){const c={};for(const p in this.stateChanges){this.state[p]=this.state[p]||{};const _={};for(const S in this.stateChanges[p])this.state[p][S]||(this.state[p][S]={}),l.extend(this.state[p][S],this.stateChanges[p][S]),_[S]=this.state[p][S];c[p]=_}for(const p in this.deletedStates){this.state[p]=this.state[p]||{};const _={};if(this.deletedStates[p]===null)for(const S in this.state[p])_[S]={},this.state[p][S]={};else for(const S in this.deletedStates[p]){if(this.deletedStates[p][S]===null)this.state[p][S]={};else for(const k of Object.keys(this.deletedStates[p][S]))delete this.state[p][S][k];_[S]=this.state[p][S]}c[p]=c[p]||{},l.extend(c[p],_)}if(this.stateChanges={},this.deletedStates={},Object.keys(c).length!==0)for(const p in r)r[p].setFeatureState(c,s)}}class Rt extends l.Evented{constructor(r,s,c){super(),this.id=r,this.dispatcher=c,this.on("data",p=>{p.dataType==="source"&&p.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&p.dataType==="source"&&p.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain))}),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=function(p,_,S,k){const A=new Se[_.type](p,_,S,k);if(A.id!==p)throw new Error(`Expected Source id to be ${p} instead of ${A.id}`);return l.bindAll(["load","abort","unload","serialize","prepare"],A),A}(r,s,c,this),this._tiles={},this._cache=new Vt(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new At}onAdd(r){this.map=r,this._maxTileCacheSize=r?r._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(r)}onRemove(r){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(r)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const r in this._tiles){const s=this._tiles[r];if(s.state!=="loaded"&&s.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const r=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,r&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(r,s){return this._source.loadTile(r,s)}_unloadTile(r){if(this._source.unloadTile)return this._source.unloadTile(r,()=>{})}_abortTile(r){this._source.abortTile&&this._source.abortTile(r,()=>{}),this._source.fire(new l.Event("dataabort",{tile:r,coord:r.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(r){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const s in this._tiles){const c=this._tiles[s];c.upload(r),c.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(r=>r.tileID).sort($t).map(r=>r.key)}getRenderableIds(r){const s=[];for(const c in this._tiles)this._isIdRenderable(c,r)&&s.push(this._tiles[c]);return r?s.sort((c,p)=>{const _=c.tileID,S=p.tileID,k=new l.pointGeometry(_.canonical.x,_.canonical.y)._rotate(this.transform.angle),A=new l.pointGeometry(S.canonical.x,S.canonical.y)._rotate(this.transform.angle);return _.overscaledZ-S.overscaledZ||A.y-k.y||A.x-k.x}).map(c=>c.tileID.key):s.map(c=>c.tileID).sort($t).map(c=>c.key)}hasRenderableParent(r){const s=this.findLoadedParent(r,0);return!!s&&this._isIdRenderable(s.tileID.key)}_isIdRenderable(r,s){return this._tiles[r]&&this._tiles[r].hasData()&&!this._coveredTiles[r]&&(s||!this._tiles[r].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const r in this._tiles)this._tiles[r].state!=="errored"&&this._reloadTile(r,"reloading")}}_reloadTile(r,s){const c=this._tiles[r];c&&(c.state!=="loading"&&(c.state=s),this._loadTile(c,this._tileLoaded.bind(this,c,r,s)))}_tileLoaded(r,s,c,p){if(p)return r.state="errored",void(p.status!==404?this._source.fire(new l.ErrorEvent(p,{tile:r})):this.update(this.transform,this.terrain));r.timeAdded=l.exported.now(),c==="expired"&&(r.refreshedUponExpiration=!0),this._setTileReloadTimer(s,r),this.getSource().type==="raster-dem"&&r.dem&&this._backfillDEM(r),this._state.initializeTileState(r,this.map?this.map.painter:null),r.aborted||this._source.fire(new l.Event("data",{dataType:"source",tile:r,coord:r.tileID}))}_backfillDEM(r){const s=this.getRenderableIds();for(let p=0;p<s.length;p++){const _=s[p];if(r.neighboringTiles&&r.neighboringTiles[_]){const S=this.getTileByID(_);c(r,S),c(S,r)}}function c(p,_){p.needsHillshadePrepare=!0,p.needsTerrainPrepare=!0;let S=_.tileID.canonical.x-p.tileID.canonical.x;const k=_.tileID.canonical.y-p.tileID.canonical.y,A=Math.pow(2,p.tileID.canonical.z),M=_.tileID.key;S===0&&k===0||Math.abs(k)>1||(Math.abs(S)>1&&(Math.abs(S+A)===1?S+=A:Math.abs(S-A)===1&&(S-=A)),_.dem&&p.dem&&(p.dem.backfillBorder(_.dem,S,k),p.neighboringTiles&&p.neighboringTiles[M]&&(p.neighboringTiles[M].backfilled=!0)))}}getTile(r){return this.getTileByID(r.key)}getTileByID(r){return this._tiles[r]}_retainLoadedChildren(r,s,c,p){for(const _ in this._tiles){let S=this._tiles[_];if(p[_]||!S.hasData()||S.tileID.overscaledZ<=s||S.tileID.overscaledZ>c)continue;let k=S.tileID;for(;S&&S.tileID.overscaledZ>s+1;){const M=S.tileID.scaledTo(S.tileID.overscaledZ-1);S=this._tiles[M.key],S&&S.hasData()&&(k=M)}let A=k;for(;A.overscaledZ>s;)if(A=A.scaledTo(A.overscaledZ-1),r[A.key]){p[k.key]=k;break}}}findLoadedParent(r,s){if(r.key in this._loadedParentTiles){const c=this._loadedParentTiles[r.key];return c&&c.tileID.overscaledZ>=s?c:null}for(let c=r.overscaledZ-1;c>=s;c--){const p=r.scaledTo(c),_=this._getLoadedTile(p);if(_)return _}}_getLoadedTile(r){const s=this._tiles[r.key];return s&&s.hasData()?s:this._cache.getByKey(r.wrapped().key)}updateCacheSize(r){const s=Math.ceil(r.width/this._source.tileSize)+1,c=Math.ceil(r.height/this._source.tileSize)+1,p=Math.floor(s*c*5),_=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,p):p;this._cache.setMaxSize(_)}handleWrapJump(r){const s=Math.round((r-(this._prevLng===void 0?r:this._prevLng))/360);if(this._prevLng=r,s){const c={};for(const p in this._tiles){const _=this._tiles[p];_.tileID=_.tileID.unwrapTo(_.tileID.wrap+s),c[_.tileID.key]=_}this._tiles=c;for(const p in this._timers)clearTimeout(this._timers[p]),delete this._timers[p];for(const p in this._tiles)this._setTileReloadTimer(p,this._tiles[p])}}update(r,s){if(this.transform=r,this.terrain=s,!this._sourceLoaded||this._paused)return;let c;this.updateCacheSize(r),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?c=r.getVisibleUnwrappedCoordinates(this._source.tileID).map(M=>new l.OverscaledTileID(M.canonical.z,M.wrap,M.canonical.z,M.canonical.x,M.canonical.y)):(c=r.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:s}),this._source.hasTile&&(c=c.filter(M=>this._source.hasTile(M)))):c=[];const p=r.coveringZoomLevel(this._source),_=Math.max(p-Rt.maxOverzooming,this._source.minzoom),S=Math.max(p+Rt.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const M={};for(const F of c)if(F.canonical.z>this._source.minzoom){const q=F.scaledTo(F.canonical.z-1);M[q.key]=q;const H=F.scaledTo(Math.max(this._source.minzoom,Math.min(F.canonical.z,5)));M[H.key]=H}c=c.concat(Object.values(M))}const k=this._updateRetainedTiles(c,p);if(or(this._source.type)){const M={},F={},q=Object.keys(k);for(const H of q){const le=k[H],te=this._tiles[H];if(!te||te.fadeEndTime&&te.fadeEndTime<=l.exported.now())continue;const ee=this.findLoadedParent(le,_);ee&&(this._addTile(ee.tileID),M[ee.tileID.key]=ee.tileID),F[H]=le}this._retainLoadedChildren(F,p,S,k);for(const H in M)k[H]||(this._coveredTiles[H]=!0,k[H]=M[H]);if(s){const H={},le={};for(const te of c)this._tiles[te.key].hasData()?H[te.key]=te:le[te.key]=te;for(const te in le){const ee=le[te].children(this._source.maxzoom);this._tiles[ee[0].key]&&this._tiles[ee[1].key]&&this._tiles[ee[2].key]&&this._tiles[ee[3].key]&&(H[ee[0].key]=k[ee[0].key]=ee[0],H[ee[1].key]=k[ee[1].key]=ee[1],H[ee[2].key]=k[ee[2].key]=ee[2],H[ee[3].key]=k[ee[3].key]=ee[3],delete le[te])}for(const te in le){const ee=this.findLoadedParent(le[te],this._source.minzoom);if(ee){H[ee.tileID.key]=k[ee.tileID.key]=ee.tileID;for(const ye in H)H[ye].isChildOf(ee.tileID)&&delete H[ye]}}for(const te in this._tiles)H[te]||(this._coveredTiles[te]=!0)}}for(const M in k)this._tiles[M].clearFadeHold();const A=l.keysDifference(this._tiles,k);for(const M of A){const F=this._tiles[M];F.hasSymbolBuckets&&!F.holdingForFade()?F.setHoldDuration(this.map._fadeDuration):F.hasSymbolBuckets&&!F.symbolFadeFinished()||this._removeTile(M)}this._updateLoadedParentTileCache()}releaseSymbolFadeTiles(){for(const r in this._tiles)this._tiles[r].holdingForFade()&&this._removeTile(r)}_updateRetainedTiles(r,s){const c={},p={},_=Math.max(s-Rt.maxOverzooming,this._source.minzoom),S=Math.max(s+Rt.maxUnderzooming,this._source.minzoom),k={};for(const A of r){const M=this._addTile(A);c[A.key]=A,M.hasData()||s<this._source.maxzoom&&(k[A.key]=A)}this._retainLoadedChildren(k,s,S,c);for(const A of r){let M=this._tiles[A.key];if(M.hasData())continue;if(s+1>this._source.maxzoom){const q=A.children(this._source.maxzoom)[0],H=this.getTile(q);if(H&&H.hasData()){c[q.key]=q;continue}}else{const q=A.children(this._source.maxzoom);if(c[q[0].key]&&c[q[1].key]&&c[q[2].key]&&c[q[3].key])continue}let F=M.wasRequested();for(let q=A.overscaledZ-1;q>=_;--q){const H=A.scaledTo(q);if(p[H.key]||(p[H.key]=!0,M=this.getTile(H),!M&&F&&(M=this._addTile(H)),M&&(c[H.key]=H,F=M.wasRequested(),M.hasData())))break}}return c}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const r in this._tiles){const s=[];let c,p=this._tiles[r].tileID;for(;p.overscaledZ>0;){if(p.key in this._loadedParentTiles){c=this._loadedParentTiles[p.key];break}s.push(p.key);const _=p.scaledTo(p.overscaledZ-1);if(c=this._getLoadedTile(_),c)break;p=_}for(const _ of s)this._loadedParentTiles[_]=c}}_addTile(r){let s=this._tiles[r.key];if(s)return s;s=this._cache.getAndRemove(r),s&&(this._setTileReloadTimer(r.key,s),s.tileID=r,this._state.initializeTileState(s,this.map?this.map.painter:null),this._cacheTimers[r.key]&&(clearTimeout(this._cacheTimers[r.key]),delete this._cacheTimers[r.key],this._setTileReloadTimer(r.key,s)));const c=s;return s||(s=new bt(r,this._source.tileSize*r.overscaleFactor()),this._loadTile(s,this._tileLoaded.bind(this,s,r.key,s.state))),s.uses++,this._tiles[r.key]=s,c||this._source.fire(new l.Event("dataloading",{tile:s,coord:s.tileID,dataType:"source"})),s}_setTileReloadTimer(r,s){r in this._timers&&(clearTimeout(this._timers[r]),delete this._timers[r]);const c=s.getExpiryTimeout();c&&(this._timers[r]=setTimeout(()=>{this._reloadTile(r,"expired"),delete this._timers[r]},c))}_removeTile(r){const s=this._tiles[r];s&&(s.uses--,delete this._tiles[r],this._timers[r]&&(clearTimeout(this._timers[r]),delete this._timers[r]),s.uses>0||(s.hasData()&&s.state!=="reloading"?this._cache.add(s.tileID,s,s.getExpiryTimeout()):(s.aborted=!0,this._abortTile(s),this._unloadTile(s))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const r in this._tiles)this._removeTile(r);this._cache.reset()}tilesIn(r,s,c){const p=[],_=this.transform;if(!_)return p;const S=c?_.getCameraQueryGeometry(r):r,k=r.map(te=>_.pointCoordinate(te,this.terrain)),A=S.map(te=>_.pointCoordinate(te,this.terrain)),M=this.getIds();let F=1/0,q=1/0,H=-1/0,le=-1/0;for(const te of A)F=Math.min(F,te.x),q=Math.min(q,te.y),H=Math.max(H,te.x),le=Math.max(le,te.y);for(let te=0;te<M.length;te++){const ee=this._tiles[M[te]];if(ee.holdingForFade())continue;const ye=ee.tileID,Ae=Math.pow(2,_.zoom-ee.tileID.overscaledZ),Pe=s*ee.queryPadding*l.EXTENT/ee.tileSize/Ae,he=[ye.getTilePoint(new l.MercatorCoordinate(F,q)),ye.getTilePoint(new l.MercatorCoordinate(H,le))];if(he[0].x-Pe<l.EXTENT&&he[0].y-Pe<l.EXTENT&&he[1].x+Pe>=0&&he[1].y+Pe>=0){const Ve=k.map(Xe=>ye.getTilePoint(Xe)),Oe=A.map(Xe=>ye.getTilePoint(Xe));p.push({tile:ee,tileID:ye,queryGeometry:Ve,cameraQueryGeometry:Oe,scale:Ae})}}return p}getVisibleCoordinates(r){const s=this.getRenderableIds(r).map(c=>this._tiles[c].tileID);for(const c of s)c.posMatrix=this.transform.calculatePosMatrix(c.toUnwrapped());return s}hasTransition(){if(this._source.hasTransition())return!0;if(or(this._source.type))for(const r in this._tiles){const s=this._tiles[r];if(s.fadeEndTime!==void 0&&s.fadeEndTime>=l.exported.now())return!0}return!1}setFeatureState(r,s,c){this._state.updateState(r=r||"_geojsonTileLayer",s,c)}removeFeatureState(r,s,c){this._state.removeFeatureState(r=r||"_geojsonTileLayer",s,c)}getFeatureState(r,s){return this._state.getState(r=r||"_geojsonTileLayer",s)}setDependencies(r,s,c){const p=this._tiles[r];p&&p.setDependencies(s,c)}reloadTilesForDependencies(r,s){for(const c in this._tiles)this._tiles[c].hasDependency(r,s)&&this._reloadTile(c,"reloading");this._cache.filter(c=>!c.hasDependency(r,s))}}function $t(d,r){const s=Math.abs(2*d.wrap)-+(d.wrap<0),c=Math.abs(2*r.wrap)-+(r.wrap<0);return d.overscaledZ-r.overscaledZ||c-s||r.canonical.y-d.canonical.y||r.canonical.x-d.canonical.x}function or(d){return d==="raster"||d==="image"||d==="video"}Rt.maxOverzooming=10,Rt.maxUnderzooming=3;const sr="mapboxgl_preloaded_worker_pool";class pr{constructor(){this.active={}}acquire(r){if(!this.workers)for(this.workers=[];this.workers.length<pr.workerCount;)this.workers.push(new Worker(fi.workerUrl));return this.active[r]=!0,this.workers.slice()}release(r){delete this.active[r],this.numActive()===0&&(this.workers.forEach(s=>{s.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[sr]}numActive(){return Object.keys(this.active).length}}const O=Math.floor(l.exported.hardwareConcurrency/2);let it;function He(){return it||(it=new pr),it}function de(d,r){const s={};for(const c in d)c!=="ref"&&(s[c]=d[c]);return l.refProperties.forEach(c=>{c in r&&(s[c]=r[c])}),s}function oe(d){d=d.slice();const r=Object.create(null);for(let s=0;s<d.length;s++)r[d[s].id]=d[s];for(let s=0;s<d.length;s++)"ref"in d[s]&&(d[s]=de(d[s],r[d[s].ref]));return d}pr.workerCount=Math.max(Math.min(O,6),1);const Ee={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function ot(d,r,s){s.push({command:Ee.addSource,args:[d,r[d]]})}function ft(d,r,s){r.push({command:Ee.removeSource,args:[d]}),s[d]=!0}function Ne(d,r,s,c){ft(d,s,c),ot(d,r,s)}function _t(d,r,s){let c;for(c in d[s])if(Object.prototype.hasOwnProperty.call(d[s],c)&&c!=="data"&&!$(d[s][c],r[s][c]))return!1;for(c in r[s])if(Object.prototype.hasOwnProperty.call(r[s],c)&&c!=="data"&&!$(d[s][c],r[s][c]))return!1;return!0}function We(d,r,s,c,p,_){let S;for(S in r=r||{},d=d||{})Object.prototype.hasOwnProperty.call(d,S)&&($(d[S],r[S])||s.push({command:_,args:[c,S,r[S],p]}));for(S in r)Object.prototype.hasOwnProperty.call(r,S)&&!Object.prototype.hasOwnProperty.call(d,S)&&($(d[S],r[S])||s.push({command:_,args:[c,S,r[S],p]}))}function Qe(d){return d.id}function kt(d,r){return d[r.id]=r,d}class Me{constructor(r,s){this.reset(r,s)}reset(r,s){this.points=r||[],this._distances=[0];for(let c=1;c<this.points.length;c++)this._distances[c]=this._distances[c-1]+this.points[c].dist(this.points[c-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(s||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(r){if(this.points.length===1)return this.points[0];r=l.clamp(r,0,1);let s=1,c=this._distances[s];const p=r*this.paddedLength+this.padding;for(;c<p&&s<this._distances.length;)c=this._distances[++s];const _=s-1,S=this._distances[_],k=c-S,A=k>0?(p-S)/k:0;return this.points[_].mult(1-A).add(this.points[s].mult(A))}}function Je(d,r){let s=!0;return d==="always"||d!=="never"&&r!=="never"||(s=!1),s}class xr{constructor(r,s,c){const p=this.boxCells=[],_=this.circleCells=[];this.xCellCount=Math.ceil(r/c),this.yCellCount=Math.ceil(s/c);for(let S=0;S<this.xCellCount*this.yCellCount;S++)p.push([]),_.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=r,this.height=s,this.xScale=this.xCellCount/r,this.yScale=this.yCellCount/s,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(r,s,c,p,_){this._forEachCell(s,c,p,_,this._insertBoxCell,this.boxUid++),this.boxKeys.push(r),this.bboxes.push(s),this.bboxes.push(c),this.bboxes.push(p),this.bboxes.push(_)}insertCircle(r,s,c,p){this._forEachCell(s-p,c-p,s+p,c+p,this._insertCircleCell,this.circleUid++),this.circleKeys.push(r),this.circles.push(s),this.circles.push(c),this.circles.push(p)}_insertBoxCell(r,s,c,p,_,S){this.boxCells[_].push(S)}_insertCircleCell(r,s,c,p,_,S){this.circleCells[_].push(S)}_query(r,s,c,p,_,S,k){if(c<0||r>this.width||p<0||s>this.height)return[];const A=[];if(r<=0&&s<=0&&this.width<=c&&this.height<=p){if(_)return[{key:null,x1:r,y1:s,x2:c,y2:p}];for(let M=0;M<this.boxKeys.length;M++)A.push({key:this.boxKeys[M],x1:this.bboxes[4*M],y1:this.bboxes[4*M+1],x2:this.bboxes[4*M+2],y2:this.bboxes[4*M+3]});for(let M=0;M<this.circleKeys.length;M++){const F=this.circles[3*M],q=this.circles[3*M+1],H=this.circles[3*M+2];A.push({key:this.circleKeys[M],x1:F-H,y1:q-H,x2:F+H,y2:q+H})}}else this._forEachCell(r,s,c,p,this._queryCell,A,{hitTest:_,overlapMode:S,seenUids:{box:{},circle:{}}},k);return A}query(r,s,c,p){return this._query(r,s,c,p,!1,null)}hitTest(r,s,c,p,_,S){return this._query(r,s,c,p,!0,_,S).length>0}hitTestCircle(r,s,c,p,_){const S=r-c,k=r+c,A=s-c,M=s+c;if(k<0||S>this.width||M<0||A>this.height)return!1;const F=[];return this._forEachCell(S,A,k,M,this._queryCellCircle,F,{hitTest:!0,overlapMode:p,circle:{x:r,y:s,radius:c},seenUids:{box:{},circle:{}}},_),F.length>0}_queryCell(r,s,c,p,_,S,k,A){const{seenUids:M,hitTest:F,overlapMode:q}=k,H=this.boxCells[_];if(H!==null){const te=this.bboxes;for(const ee of H)if(!M.box[ee]){M.box[ee]=!0;const ye=4*ee,Ae=this.boxKeys[ee];if(r<=te[ye+2]&&s<=te[ye+3]&&c>=te[ye+0]&&p>=te[ye+1]&&(!A||A(Ae))&&(!F||!Je(q,Ae.overlapMode))&&(S.push({key:Ae,x1:te[ye],y1:te[ye+1],x2:te[ye+2],y2:te[ye+3]}),F))return!0}}const le=this.circleCells[_];if(le!==null){const te=this.circles;for(const ee of le)if(!M.circle[ee]){M.circle[ee]=!0;const ye=3*ee,Ae=this.circleKeys[ee];if(this._circleAndRectCollide(te[ye],te[ye+1],te[ye+2],r,s,c,p)&&(!A||A(Ae))&&(!F||!Je(q,Ae.overlapMode))){const Pe=te[ye],he=te[ye+1],Ve=te[ye+2];if(S.push({key:Ae,x1:Pe-Ve,y1:he-Ve,x2:Pe+Ve,y2:he+Ve}),F)return!0}}}return!1}_queryCellCircle(r,s,c,p,_,S,k,A){const{circle:M,seenUids:F,overlapMode:q}=k,H=this.boxCells[_];if(H!==null){const te=this.bboxes;for(const ee of H)if(!F.box[ee]){F.box[ee]=!0;const ye=4*ee,Ae=this.boxKeys[ee];if(this._circleAndRectCollide(M.x,M.y,M.radius,te[ye+0],te[ye+1],te[ye+2],te[ye+3])&&(!A||A(Ae))&&!Je(q,Ae.overlapMode))return S.push(!0),!0}}const le=this.circleCells[_];if(le!==null){const te=this.circles;for(const ee of le)if(!F.circle[ee]){F.circle[ee]=!0;const ye=3*ee,Ae=this.circleKeys[ee];if(this._circlesCollide(te[ye],te[ye+1],te[ye+2],M.x,M.y,M.radius)&&(!A||A(Ae))&&!Je(q,Ae.overlapMode))return S.push(!0),!0}}}_forEachCell(r,s,c,p,_,S,k,A){const M=this._convertToXCellCoord(r),F=this._convertToYCellCoord(s),q=this._convertToXCellCoord(c),H=this._convertToYCellCoord(p);for(let le=M;le<=q;le++)for(let te=F;te<=H;te++)if(_.call(this,r,s,c,p,this.xCellCount*te+le,S,k,A))return}_convertToXCellCoord(r){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(r*this.xScale)))}_convertToYCellCoord(r){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(r*this.yScale)))}_circlesCollide(r,s,c,p,_,S){const k=p-r,A=_-s,M=c+S;return M*M>k*k+A*A}_circleAndRectCollide(r,s,c,p,_,S,k){const A=(S-p)/2,M=Math.abs(r-(p+A));if(M>A+c)return!1;const F=(k-_)/2,q=Math.abs(s-(_+F));if(q>F+c)return!1;if(M<=A||q<=F)return!0;const H=M-A,le=q-F;return H*H+le*le<=c*c}}function kr(d,r,s,c,p){const _=l.create();return r?(l.scale(_,_,[1/p,1/p,1]),s||l.rotateZ(_,_,c.angle)):l.multiply(_,c.labelPlaneMatrix,d),_}function Wt(d,r,s,c,p){if(r){const _=l.clone(d);return l.scale(_,_,[p,p,1]),s||l.rotateZ(_,_,-c.angle),_}return c.glCoordMatrix}function vr(d,r,s){let c;s?(c=[d.x,d.y,s(d.x,d.y),1],l.transformMat4(c,c,r)):(c=[d.x,d.y,0,1],Ar(c,c,r));const p=c[3];return{point:new l.pointGeometry(c[0]/p,c[1]/p),signedDistanceFromCamera:p}}function Qt(d,r){return .5+d/r*.5}function dn(d,r){const s=d[0]/d[3],c=d[1]/d[3];return s>=-r[0]&&s<=r[0]&&c>=-r[1]&&c<=r[1]}function Rr(d,r,s,c,p,_,S,k,A,M){const F=c?d.textSizeData:d.iconSizeData,q=l.evaluateSizeForZoom(F,s.transform.zoom),H=[256/s.width*2+1,256/s.height*2+1],le=c?d.text.dynamicLayoutVertexArray:d.icon.dynamicLayoutVertexArray;le.clear();const te=d.lineVertexArray,ee=c?d.text.placedSymbolArray:d.icon.placedSymbolArray,ye=s.transform.width/s.transform.height;let Ae=!1;for(let Pe=0;Pe<ee.length;Pe++){const he=ee.get(Pe);if(he.hidden||he.writingMode===l.WritingMode.vertical&&!Ae){gr(he.numGlyphs,le);continue}let Ve;if(Ae=!1,M?(Ve=[he.anchorX,he.anchorY,M(he.anchorX,he.anchorY),1],l.transformMat4(Ve,Ve,r)):(Ve=[he.anchorX,he.anchorY,0,1],Ar(Ve,Ve,r)),!dn(Ve,H)){gr(he.numGlyphs,le);continue}const Oe=Qt(s.transform.cameraToCenterDistance,Ve[3]),Xe=l.evaluateSizeForFeature(F,q,he),rt=S?Xe/Oe:Xe*Oe,pt=new l.pointGeometry(he.anchorX,he.anchorY),et=vr(pt,p,M).point,It={},wt=Zt(he,rt,!1,k,r,p,_,d.glyphOffsetArray,te,le,et,pt,It,ye,A,M);Ae=wt.useVertical,(wt.notEnoughRoom||Ae||wt.needsFlipping&&Zt(he,rt,!0,k,r,p,_,d.glyphOffsetArray,te,le,et,pt,It,ye,A,M).notEnoughRoom)&&gr(he.numGlyphs,le)}c?d.text.dynamicLayoutVertexBuffer.updateData(le):d.icon.dynamicLayoutVertexBuffer.updateData(le)}function yt(d,r,s,c,p,_,S,k,A,M,F,q,H){const le=k.glyphStartIndex+k.numGlyphs,te=k.lineStartIndex,ee=k.lineStartIndex+k.lineLength,ye=r.getoffsetX(k.glyphStartIndex),Ae=r.getoffsetX(le-1),Pe=fn(d*ye,s,c,p,_,S,k.segment,te,ee,A,M,F,q,H);if(!Pe)return null;const he=fn(d*Ae,s,c,p,_,S,k.segment,te,ee,A,M,F,q,H);return he?{first:Pe,last:he}:null}function qt(d,r,s,c){return d===l.WritingMode.horizontal&&Math.abs(s.y-r.y)>Math.abs(s.x-r.x)*c?{useVertical:!0}:(d===l.WritingMode.vertical?r.y<s.y:r.x>s.x)?{needsFlipping:!0}:null}function Zt(d,r,s,c,p,_,S,k,A,M,F,q,H,le,te,ee){const ye=r/24,Ae=d.lineOffsetX*ye,Pe=d.lineOffsetY*ye;let he;if(d.numGlyphs>1){const Ve=d.glyphStartIndex+d.numGlyphs,Oe=d.lineStartIndex,Xe=d.lineStartIndex+d.lineLength,rt=yt(ye,k,Ae,Pe,s,F,q,d,A,_,H,te,ee);if(!rt)return{notEnoughRoom:!0};const pt=vr(rt.first.point,S,ee).point,et=vr(rt.last.point,S,ee).point;if(c&&!s){const It=qt(d.writingMode,pt,et,le);if(It)return It}he=[rt.first];for(let It=d.glyphStartIndex+1;It<Ve-1;It++)he.push(fn(ye*k.getoffsetX(It),Ae,Pe,s,F,q,d.segment,Oe,Xe,A,_,H,te,ee));he.push(rt.last)}else{if(c&&!s){const Oe=vr(q,p,ee).point,Xe=d.lineStartIndex+d.segment+1,rt=new l.pointGeometry(A.getx(Xe),A.gety(Xe)),pt=vr(rt,p,ee),et=pt.signedDistanceFromCamera>0?pt.point:qr(q,rt,Oe,1,p,ee),It=qt(d.writingMode,Oe,et,le);if(It)return It}const Ve=fn(ye*k.getoffsetX(d.glyphStartIndex),Ae,Pe,s,F,q,d.segment,d.lineStartIndex,d.lineStartIndex+d.lineLength,A,_,H,te,ee);if(!Ve)return{notEnoughRoom:!0};he=[Ve]}for(const Ve of he)l.addDynamicAttributes(M,Ve.point,Ve.angle);return{}}function qr(d,r,s,c,p,_){const S=vr(d.add(d.sub(r)._unit()),p,_).point,k=s.sub(S);return s.add(k._mult(c/k.mag()))}function fn(d,r,s,c,p,_,S,k,A,M,F,q,H,le){const te=c?d-r:d+r;let ee=te>0?1:-1,ye=0;c&&(ee*=-1,ye=Math.PI),ee<0&&(ye+=Math.PI);let Ae=ee>0?k+S:k+S+1,Pe=p,he=p,Ve=0,Oe=0;const Xe=Math.abs(te),rt=[];for(;Ve+Oe<=Xe;){if(Ae+=ee,Ae<k||Ae>=A)return null;if(he=Pe,rt.push(Pe),Pe=q[Ae],Pe===void 0){const Tt=new l.pointGeometry(M.getx(Ae),M.gety(Ae)),Ht=vr(Tt,F,le);if(Ht.signedDistanceFromCamera>0)Pe=q[Ae]=Ht.point;else{const Jt=Ae-ee;Pe=qr(Ve===0?_:new l.pointGeometry(M.getx(Jt),M.gety(Jt)),Tt,he,Xe-Ve+1,F,le)}}Ve+=Oe,Oe=he.dist(Pe)}const pt=(Xe-Ve)/Oe,et=Pe.sub(he),It=et.mult(pt)._add(he);It._add(et._unit()._perp()._mult(s*ee));const wt=ye+Math.atan2(Pe.y-he.y,Pe.x-he.x);return rt.push(It),{point:It,angle:H?wt:0,path:rt}}const Lt=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function gr(d,r){for(let s=0;s<d;s++){const c=r.length;r.resize(c+4),r.float32.set(Lt,3*c)}}function Ar(d,r,s){const c=r[0],p=r[1];return d[0]=s[0]*c+s[4]*p+s[12],d[1]=s[1]*c+s[5]*p+s[13],d[3]=s[3]*c+s[7]*p+s[15],d}const Lr=100;class Kr{constructor(r,s=new xr(r.width+200,r.height+200,25),c=new xr(r.width+200,r.height+200,25)){this.transform=r,this.grid=s,this.ignoredGrid=c,this.pitchfactor=Math.cos(r._pitch)*r.cameraToCenterDistance,this.screenRightBoundary=r.width+Lr,this.screenBottomBoundary=r.height+Lr,this.gridRightBoundary=r.width+200,this.gridBottomBoundary=r.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(r,s,c,p,_,S){const k=this.projectAndGetPerspectiveRatio(p,r.anchorPointX,r.anchorPointY,S),A=c*k.perspectiveRatio,M=r.x1*A+k.point.x,F=r.y1*A+k.point.y,q=r.x2*A+k.point.x,H=r.y2*A+k.point.y;return!this.isInsideGrid(M,F,q,H)||s!=="always"&&this.grid.hitTest(M,F,q,H,s,_)||k.perspectiveRatio<this.perspectiveRatioCutoff?{box:[],offscreen:!1}:{box:[M,F,q,H],offscreen:this.isOffscreen(M,F,q,H)}}placeCollisionCircles(r,s,c,p,_,S,k,A,M,F,q,H,le,te){const ee=[],ye=new l.pointGeometry(s.anchorX,s.anchorY),Ae=vr(ye,S,te),Pe=Qt(this.transform.cameraToCenterDistance,Ae.signedDistanceFromCamera),he=(F?_/Pe:_*Pe)/l.ONE_EM,Ve=vr(ye,k,te).point,Oe=yt(he,p,s.lineOffsetX*he,s.lineOffsetY*he,!1,Ve,ye,s,c,k,{},!1,te);let Xe=!1,rt=!1,pt=!0;if(Oe){const et=.5*H*Pe+le,It=new l.pointGeometry(-100,-100),wt=new l.pointGeometry(this.screenRightBoundary,this.screenBottomBoundary),Tt=new Me,Ht=Oe.first,Jt=Oe.last;let jt=[];for(let ir=Ht.path.length-1;ir>=1;ir--)jt.push(Ht.path[ir]);for(let ir=1;ir<Jt.path.length;ir++)jt.push(Jt.path[ir]);const Ir=2.5*et;if(A){const ir=jt.map(ar=>vr(ar,A,te));jt=ir.some(ar=>ar.signedDistanceFromCamera<=0)?[]:ir.map(ar=>ar.point)}let cr=[];if(jt.length>0){const ir=jt[0].clone(),ar=jt[0].clone();for(let hr=1;hr<jt.length;hr++)ir.x=Math.min(ir.x,jt[hr].x),ir.y=Math.min(ir.y,jt[hr].y),ar.x=Math.max(ar.x,jt[hr].x),ar.y=Math.max(ar.y,jt[hr].y);cr=ir.x>=It.x&&ar.x<=wt.x&&ir.y>=It.y&&ar.y<=wt.y?[jt]:ar.x<It.x||ir.x>wt.x||ar.y<It.y||ir.y>wt.y?[]:l.clipLine([jt],It.x,It.y,wt.x,wt.y)}for(const ir of cr){Tt.reset(ir,.25*et);let ar=0;ar=Tt.length<=.5*et?1:Math.ceil(Tt.paddedLength/Ir)+1;for(let hr=0;hr<ar;hr++){const Rn=hr/Math.max(ar-1,1),on=Tt.lerp(Rn),Qr=on.x+Lr,Sn=on.y+Lr;ee.push(Qr,Sn,et,0);const $n=Qr-et,jr=Sn-et,En=Qr+et,So=Sn+et;if(pt=pt&&this.isOffscreen($n,jr,En,So),rt=rt||this.isInsideGrid($n,jr,En,So),r!=="always"&&this.grid.hitTestCircle(Qr,Sn,et,r,q)&&(Xe=!0,!M))return{circles:[],offscreen:!1,collisionDetected:Xe}}}}return{circles:!M&&Xe||!rt||Pe<this.perspectiveRatioCutoff?[]:ee,offscreen:pt,collisionDetected:Xe}}queryRenderedSymbols(r){if(r.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const s=[];let c=1/0,p=1/0,_=-1/0,S=-1/0;for(const F of r){const q=new l.pointGeometry(F.x+Lr,F.y+Lr);c=Math.min(c,q.x),p=Math.min(p,q.y),_=Math.max(_,q.x),S=Math.max(S,q.y),s.push(q)}const k=this.grid.query(c,p,_,S).concat(this.ignoredGrid.query(c,p,_,S)),A={},M={};for(const F of k){const q=F.key;if(A[q.bucketInstanceId]===void 0&&(A[q.bucketInstanceId]={}),A[q.bucketInstanceId][q.featureIndex])continue;const H=[new l.pointGeometry(F.x1,F.y1),new l.pointGeometry(F.x2,F.y1),new l.pointGeometry(F.x2,F.y2),new l.pointGeometry(F.x1,F.y2)];l.polygonIntersectsPolygon(s,H)&&(A[q.bucketInstanceId][q.featureIndex]=!0,M[q.bucketInstanceId]===void 0&&(M[q.bucketInstanceId]=[]),M[q.bucketInstanceId].push(q.featureIndex))}return M}insertCollisionBox(r,s,c,p,_,S){(c?this.ignoredGrid:this.grid).insert({bucketInstanceId:p,featureIndex:_,collisionGroupID:S,overlapMode:s},r[0],r[1],r[2],r[3])}insertCollisionCircles(r,s,c,p,_,S){const k=c?this.ignoredGrid:this.grid,A={bucketInstanceId:p,featureIndex:_,collisionGroupID:S,overlapMode:s};for(let M=0;M<r.length;M+=4)k.insertCircle(A,r[M],r[M+1],r[M+2])}projectAndGetPerspectiveRatio(r,s,c,p){let _;return p?(_=[s,c,p(s,c),1],l.transformMat4(_,_,r)):(_=[s,c,0,1],Ar(_,_,r)),{point:new l.pointGeometry((_[0]/_[3]+1)/2*this.transform.width+Lr,(-_[1]/_[3]+1)/2*this.transform.height+Lr),perspectiveRatio:.5+this.transform.cameraToCenterDistance/_[3]*.5}}isOffscreen(r,s,c,p){return c<Lr||r>=this.screenRightBoundary||p<Lr||s>this.screenBottomBoundary}isInsideGrid(r,s,c,p){return c>=0&&r<this.gridRightBoundary&&p>=0&&s<this.gridBottomBoundary}getViewportMatrix(){const r=l.identity([]);return l.translate(r,r,[-100,-100,0]),r}}function lr(d,r,s){return r*(l.EXTENT/(d.tileSize*Math.pow(2,s-d.tileID.overscaledZ)))}class ur{constructor(r,s,c,p){this.opacity=r?Math.max(0,Math.min(1,r.opacity+(r.placed?s:-s))):p&&c?1:0,this.placed=c}isHidden(){return this.opacity===0&&!this.placed}}class An{constructor(r,s,c,p,_){this.text=new ur(r?r.text:null,s,c,_),this.icon=new ur(r?r.icon:null,s,p,_)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Wr{constructor(r,s,c){this.text=r,this.icon=s,this.skipFade=c}}class gn{constructor(){this.invProjMatrix=l.create(),this.viewportMatrix=l.create(),this.circles=[]}}class wn{constructor(r,s,c,p,_){this.bucketInstanceId=r,this.featureIndex=s,this.sourceLayerIndex=c,this.bucketIndex=p,this.tileID=_}}class Hn{constructor(r){this.crossSourceCollisions=r,this.maxGroupID=0,this.collisionGroups={}}get(r){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[r]){const s=++this.maxGroupID;this.collisionGroups[r]={ID:s,predicate:c=>c.collisionGroupID===s}}return this.collisionGroups[r]}}function Di(d,r,s,c,p){const{horizontalAlign:_,verticalAlign:S}=l.getAnchorAlignment(d),k=-(_-.5)*r,A=-(S-.5)*s,M=l.evaluateVariableOffset(d,c);return new l.pointGeometry(k+M[0]*p,A+M[1]*p)}function zn(d,r,s,c,p,_){const{x1:S,x2:k,y1:A,y2:M,anchorPointX:F,anchorPointY:q}=d,H=new l.pointGeometry(r,s);return c&&H._rotate(p?_:-_),{x1:S+H.x,y1:A+H.y,x2:k+H.x,y2:M+H.y,anchorPointX:F,anchorPointY:q}}class J{constructor(r,s,c,p,_){this.transform=r.clone(),this.terrain=s,this.collisionIndex=new Kr(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=c,this.retainedQueryData={},this.collisionGroups=new Hn(p),this.collisionCircleArrays={},this.prevPlacement=_,_&&(_.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(r,s,c,p){const _=c.getBucket(s),S=c.latestFeatureIndex;if(!_||!S||s.id!==_.layerIds[0])return;const k=c.collisionBoxArray,A=_.layers[0].layout,M=Math.pow(2,this.transform.zoom-c.tileID.overscaledZ),F=c.tileSize/l.EXTENT,q=this.transform.calculatePosMatrix(c.tileID.toUnwrapped()),H=A.get("text-pitch-alignment")==="map",le=A.get("text-rotation-alignment")==="map",te=lr(c,1,this.transform.zoom),ee=kr(q,H,le,this.transform,te);let ye=null;if(H){const Pe=Wt(q,H,le,this.transform,te);ye=l.multiply([],this.transform.labelPlaneMatrix,Pe)}this.retainedQueryData[_.bucketInstanceId]=new wn(_.bucketInstanceId,S,_.sourceLayerIndex,_.index,c.tileID);const Ae={bucket:_,layout:A,posMatrix:q,textLabelPlaneMatrix:ee,labelToScreenMatrix:ye,scale:M,textPixelRatio:F,holdingForFade:c.holdingForFade(),collisionBoxArray:k,partiallyEvaluatedTextSize:l.evaluateSizeForZoom(_.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(_.sourceID)};if(p)for(const Pe of _.sortKeyRanges){const{sortKey:he,symbolInstanceStart:Ve,symbolInstanceEnd:Oe}=Pe;r.push({sortKey:he,symbolInstanceStart:Ve,symbolInstanceEnd:Oe,parameters:Ae})}else r.push({symbolInstanceStart:0,symbolInstanceEnd:_.symbolInstances.length,parameters:Ae})}attemptAnchorPlacement(r,s,c,p,_,S,k,A,M,F,q,H,le,te,ee,ye){const Ae=[H.textOffset0,H.textOffset1],Pe=Di(r,c,p,Ae,_),he=this.collisionIndex.placeCollisionBox(zn(s,Pe.x,Pe.y,S,k,this.transform.angle),q,A,M,F.predicate,ye);if((!ee||this.collisionIndex.placeCollisionBox(zn(ee,Pe.x,Pe.y,S,k,this.transform.angle),q,A,M,F.predicate,ye).box.length!==0)&&he.box.length>0){let Ve;if(this.prevPlacement&&this.prevPlacement.variableOffsets[H.crossTileID]&&this.prevPlacement.placements[H.crossTileID]&&this.prevPlacement.placements[H.crossTileID].text&&(Ve=this.prevPlacement.variableOffsets[H.crossTileID].anchor),H.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[H.crossTileID]={textOffset:Ae,width:c,height:p,anchor:r,textBoxScale:_,prevAnchor:Ve},this.markUsedJustification(le,r,H,te),le.allowVerticalPlacement&&(this.markUsedOrientation(le,te,H),this.placedOrientations[H.crossTileID]=te),{shift:Pe,placedGlyphBoxes:he}}}placeLayerBucketPart(r,s,c){const{bucket:p,layout:_,posMatrix:S,textLabelPlaneMatrix:k,labelToScreenMatrix:A,textPixelRatio:M,holdingForFade:F,collisionBoxArray:q,partiallyEvaluatedTextSize:H,collisionGroup:le}=r.parameters,te=_.get("text-optional"),ee=_.get("icon-optional"),ye=l.getOverlapMode(_,"text-overlap","text-allow-overlap"),Ae=ye==="always",Pe=l.getOverlapMode(_,"icon-overlap","icon-allow-overlap"),he=Pe==="always",Ve=_.get("text-rotation-alignment")==="map",Oe=_.get("text-pitch-alignment")==="map",Xe=_.get("icon-text-fit")!=="none",rt=_.get("symbol-z-order")==="viewport-y",pt=Ae&&(he||!p.hasIconData()||ee),et=he&&(Ae||!p.hasTextData()||te);!p.collisionArrays&&q&&p.deserializeCollisionBoxes(q);const It=(wt,Tt)=>{if(s[wt.crossTileID])return;if(F)return void(this.placements[wt.crossTileID]=new Wr(!1,!1,!1));let Ht=!1,Jt=!1,jt=!0,Ir=null,cr={box:null,offscreen:null},ir={box:null},ar=null,hr=null,Rn=null,on=0,Qr=0,Sn=0;Tt.textFeatureIndex?on=Tt.textFeatureIndex:wt.useRuntimeCollisionCircles&&(on=wt.featureIndex),Tt.verticalTextFeatureIndex&&(Qr=Tt.verticalTextFeatureIndex);const $n=this.retainedQueryData[p.bucketInstanceId].tileID,jr=this.terrain?(mr,dr)=>this.terrain.getElevation($n,mr,dr):null;for(const mr of["textBox","verticalTextBox","iconBox","verticalIconBox"]){const dr=Tt[mr];dr&&(dr.elevation=jr?jr(dr.anchorPointX,dr.anchorPointY):0)}const En=Tt.textBox;if(En){const mr=Yt=>{let nr=l.WritingMode.horizontal;if(p.allowVerticalPlacement&&!Yt&&this.prevPlacement){const Zr=this.prevPlacement.placedOrientations[wt.crossTileID];Zr&&(this.placedOrientations[wt.crossTileID]=Zr,nr=Zr,this.markUsedOrientation(p,nr,wt))}return nr},dr=(Yt,nr)=>{if(p.allowVerticalPlacement&&wt.numVerticalGlyphVertices>0&&Tt.verticalTextBox){for(const Zr of p.writingModes)if(Zr===l.WritingMode.vertical?(cr=nr(),ir=cr):cr=Yt(),cr&&cr.box&&cr.box.length)break}else cr=Yt()};if(_.get("text-variable-anchor")){let Yt=_.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[wt.crossTileID]){const Fr=this.prevPlacement.variableOffsets[wt.crossTileID];Yt.indexOf(Fr.anchor)>0&&(Yt=Yt.filter(ii=>ii!==Fr.anchor),Yt.unshift(Fr.anchor))}const nr=(Fr,ii,Eo)=>{const To=Fr.x2-Fr.x1,wa=Fr.y2-Fr.y1,Ms=wt.textBoxScale,ba=Xe&&Pe==="never"?ii:null;let Ln={box:[],offscreen:!1};const Ds=ye!=="never"?2*Yt.length:Yt.length;for(let Sa=0;Sa<Ds;++Sa){const Xn=this.attemptAnchorPlacement(Yt[Sa%Yt.length],Fr,To,wa,Ms,Ve,Oe,M,S,le,Sa>=Yt.length?ye:"never",wt,p,Eo,ba,jr);if(Xn&&(Ln=Xn.placedGlyphBoxes,Ln&&Ln.box&&Ln.box.length)){Ht=!0,Ir=Xn.shift;break}}return Ln};dr(()=>nr(En,Tt.iconBox,l.WritingMode.horizontal),()=>{const Fr=Tt.verticalTextBox;return p.allowVerticalPlacement&&!(cr&&cr.box&&cr.box.length)&&wt.numVerticalGlyphVertices>0&&Fr?nr(Fr,Tt.verticalIconBox,l.WritingMode.vertical):{box:null,offscreen:null}}),cr&&(Ht=cr.box,jt=cr.offscreen);const Zr=mr(cr&&cr.box);if(!Ht&&this.prevPlacement){const Fr=this.prevPlacement.variableOffsets[wt.crossTileID];Fr&&(this.variableOffsets[wt.crossTileID]=Fr,this.markUsedJustification(p,Fr.anchor,wt,Zr))}}else{const Yt=(nr,Zr)=>{const Fr=this.collisionIndex.placeCollisionBox(nr,ye,M,S,le.predicate,jr);return Fr&&Fr.box&&Fr.box.length&&(this.markUsedOrientation(p,Zr,wt),this.placedOrientations[wt.crossTileID]=Zr),Fr};dr(()=>Yt(En,l.WritingMode.horizontal),()=>{const nr=Tt.verticalTextBox;return p.allowVerticalPlacement&&wt.numVerticalGlyphVertices>0&&nr?Yt(nr,l.WritingMode.vertical):{box:null,offscreen:null}}),mr(cr&&cr.box&&cr.box.length)}}if(ar=cr,Ht=ar&&ar.box&&ar.box.length>0,jt=ar&&ar.offscreen,wt.useRuntimeCollisionCircles){const mr=p.text.placedSymbolArray.get(wt.centerJustifiedTextSymbolIndex),dr=l.evaluateSizeForFeature(p.textSizeData,H,mr),Yt=_.get("text-padding");hr=this.collisionIndex.placeCollisionCircles(ye,mr,p.lineVertexArray,p.glyphOffsetArray,dr,S,k,A,c,Oe,le.predicate,wt.collisionCircleDiameter,Yt,jr),hr.circles.length&&hr.collisionDetected&&!c&&l.warnOnce("Collisions detected, but collision boxes are not shown"),Ht=Ae||hr.circles.length>0&&!hr.collisionDetected,jt=jt&&hr.offscreen}if(Tt.iconFeatureIndex&&(Sn=Tt.iconFeatureIndex),Tt.iconBox){const mr=dr=>{const Yt=Xe&&Ir?zn(dr,Ir.x,Ir.y,Ve,Oe,this.transform.angle):dr;return this.collisionIndex.placeCollisionBox(Yt,Pe,M,S,le.predicate,jr)};ir&&ir.box&&ir.box.length&&Tt.verticalIconBox?(Rn=mr(Tt.verticalIconBox),Jt=Rn.box.length>0):(Rn=mr(Tt.iconBox),Jt=Rn.box.length>0),jt=jt&&Rn.offscreen}const So=te||wt.numHorizontalGlyphVertices===0&&wt.numVerticalGlyphVertices===0,Ps=ee||wt.numIconVertices===0;if(So||Ps?Ps?So||(Jt=Jt&&Ht):Ht=Jt&&Ht:Jt=Ht=Jt&&Ht,Ht&&ar&&ar.box&&this.collisionIndex.insertCollisionBox(ar.box,ye,_.get("text-ignore-placement"),p.bucketInstanceId,ir&&ir.box&&Qr?Qr:on,le.ID),Jt&&Rn&&this.collisionIndex.insertCollisionBox(Rn.box,Pe,_.get("icon-ignore-placement"),p.bucketInstanceId,Sn,le.ID),hr&&(Ht&&this.collisionIndex.insertCollisionCircles(hr.circles,ye,_.get("text-ignore-placement"),p.bucketInstanceId,on,le.ID),c)){const mr=p.bucketInstanceId;let dr=this.collisionCircleArrays[mr];dr===void 0&&(dr=this.collisionCircleArrays[mr]=new gn);for(let Yt=0;Yt<hr.circles.length;Yt+=4)dr.circles.push(hr.circles[Yt+0]),dr.circles.push(hr.circles[Yt+1]),dr.circles.push(hr.circles[Yt+2]),dr.circles.push(hr.collisionDetected?1:0)}if(wt.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(p.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[wt.crossTileID]=new Wr(Ht||pt,Jt||et,jt||p.justReloaded),s[wt.crossTileID]=!0};if(rt){if(r.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const wt=p.getSortedSymbolIndexes(this.transform.angle);for(let Tt=wt.length-1;Tt>=0;--Tt){const Ht=wt[Tt];It(p.symbolInstances.get(Ht),p.collisionArrays[Ht])}}else for(let wt=r.symbolInstanceStart;wt<r.symbolInstanceEnd;wt++)It(p.symbolInstances.get(wt),p.collisionArrays[wt]);if(c&&p.bucketInstanceId in this.collisionCircleArrays){const wt=this.collisionCircleArrays[p.bucketInstanceId];l.invert(wt.invProjMatrix,S),wt.viewportMatrix=this.collisionIndex.getViewportMatrix()}p.justReloaded=!1}markUsedJustification(r,s,c,p){let _;_=p===l.WritingMode.vertical?c.verticalPlacedTextSymbolIndex:{left:c.leftJustifiedTextSymbolIndex,center:c.centerJustifiedTextSymbolIndex,right:c.rightJustifiedTextSymbolIndex}[l.getAnchorJustification(s)];const S=[c.leftJustifiedTextSymbolIndex,c.centerJustifiedTextSymbolIndex,c.rightJustifiedTextSymbolIndex,c.verticalPlacedTextSymbolIndex];for(const k of S)k>=0&&(r.text.placedSymbolArray.get(k).crossTileID=_>=0&&k!==_?0:c.crossTileID)}markUsedOrientation(r,s,c){const p=s===l.WritingMode.horizontal||s===l.WritingMode.horizontalOnly?s:0,_=s===l.WritingMode.vertical?s:0,S=[c.leftJustifiedTextSymbolIndex,c.centerJustifiedTextSymbolIndex,c.rightJustifiedTextSymbolIndex];for(const k of S)r.text.placedSymbolArray.get(k).placedOrientation=p;c.verticalPlacedTextSymbolIndex&&(r.text.placedSymbolArray.get(c.verticalPlacedTextSymbolIndex).placedOrientation=_)}commit(r){this.commitTime=r,this.zoomAtLastRecencyCheck=this.transform.zoom;const s=this.prevPlacement;let c=!1;this.prevZoomAdjustment=s?s.zoomAdjustment(this.transform.zoom):0;const p=s?s.symbolFadeChange(r):1,_=s?s.opacities:{},S=s?s.variableOffsets:{},k=s?s.placedOrientations:{};for(const A in this.placements){const M=this.placements[A],F=_[A];F?(this.opacities[A]=new An(F,p,M.text,M.icon),c=c||M.text!==F.text.placed||M.icon!==F.icon.placed):(this.opacities[A]=new An(null,p,M.text,M.icon,M.skipFade),c=c||M.text||M.icon)}for(const A in _){const M=_[A];if(!this.opacities[A]){const F=new An(M,p,!1,!1);F.isHidden()||(this.opacities[A]=F,c=c||M.text.placed||M.icon.placed)}}for(const A in S)this.variableOffsets[A]||!this.opacities[A]||this.opacities[A].isHidden()||(this.variableOffsets[A]=S[A]);for(const A in k)this.placedOrientations[A]||!this.opacities[A]||this.opacities[A].isHidden()||(this.placedOrientations[A]=k[A]);if(s&&s.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");c?this.lastPlacementChangeTime=r:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=s?s.lastPlacementChangeTime:r)}updateLayerOpacities(r,s){const c={};for(const p of s){const _=p.getBucket(r);_&&p.latestFeatureIndex&&r.id===_.layerIds[0]&&this.updateBucketOpacities(_,c,p.collisionBoxArray)}}updateBucketOpacities(r,s,c){r.hasTextData()&&r.text.opacityVertexArray.clear(),r.hasIconData()&&r.icon.opacityVertexArray.clear(),r.hasIconCollisionBoxData()&&r.iconCollisionBox.collisionVertexArray.clear(),r.hasTextCollisionBoxData()&&r.textCollisionBox.collisionVertexArray.clear();const p=r.layers[0].layout,_=new An(null,0,!1,!1,!0),S=p.get("text-allow-overlap"),k=p.get("icon-allow-overlap"),A=p.get("text-variable-anchor"),M=p.get("text-rotation-alignment")==="map",F=p.get("text-pitch-alignment")==="map",q=p.get("icon-text-fit")!=="none",H=new An(null,0,S&&(k||!r.hasIconData()||p.get("icon-optional")),k&&(S||!r.hasTextData()||p.get("text-optional")),!0);!r.collisionArrays&&c&&(r.hasIconCollisionBoxData()||r.hasTextCollisionBoxData())&&r.deserializeCollisionBoxes(c);const le=(te,ee,ye)=>{for(let Ae=0;Ae<ee/4;Ae++)te.opacityVertexArray.emplaceBack(ye)};for(let te=0;te<r.symbolInstances.length;te++){const ee=r.symbolInstances.get(te),{numHorizontalGlyphVertices:ye,numVerticalGlyphVertices:Ae,crossTileID:Pe}=ee;let he=this.opacities[Pe];s[Pe]?he=_:he||(he=H,this.opacities[Pe]=he),s[Pe]=!0;const Ve=ee.numIconVertices>0,Oe=this.placedOrientations[ee.crossTileID],Xe=Oe===l.WritingMode.vertical,rt=Oe===l.WritingMode.horizontal||Oe===l.WritingMode.horizontalOnly;if(ye>0||Ae>0){const pt=ze(he.text);le(r.text,ye,Xe?Ye:pt),le(r.text,Ae,rt?Ye:pt);const et=he.text.isHidden();[ee.rightJustifiedTextSymbolIndex,ee.centerJustifiedTextSymbolIndex,ee.leftJustifiedTextSymbolIndex].forEach(Tt=>{Tt>=0&&(r.text.placedSymbolArray.get(Tt).hidden=et||Xe?1:0)}),ee.verticalPlacedTextSymbolIndex>=0&&(r.text.placedSymbolArray.get(ee.verticalPlacedTextSymbolIndex).hidden=et||rt?1:0);const It=this.variableOffsets[ee.crossTileID];It&&this.markUsedJustification(r,It.anchor,ee,Oe);const wt=this.placedOrientations[ee.crossTileID];wt&&(this.markUsedJustification(r,"left",ee,wt),this.markUsedOrientation(r,wt,ee))}if(Ve){const pt=ze(he.icon),et=!(q&&ee.verticalPlacedIconSymbolIndex&&Xe);ee.placedIconSymbolIndex>=0&&(le(r.icon,ee.numIconVertices,et?pt:Ye),r.icon.placedSymbolArray.get(ee.placedIconSymbolIndex).hidden=he.icon.isHidden()),ee.verticalPlacedIconSymbolIndex>=0&&(le(r.icon,ee.numVerticalIconVertices,et?Ye:pt),r.icon.placedSymbolArray.get(ee.verticalPlacedIconSymbolIndex).hidden=he.icon.isHidden())}if(r.hasIconCollisionBoxData()||r.hasTextCollisionBoxData()){const pt=r.collisionArrays[te];if(pt){let et=new l.pointGeometry(0,0);if(pt.textBox||pt.verticalTextBox){let wt=!0;if(A){const Tt=this.variableOffsets[Pe];Tt?(et=Di(Tt.anchor,Tt.width,Tt.height,Tt.textOffset,Tt.textBoxScale),M&&et._rotate(F?this.transform.angle:-this.transform.angle)):wt=!1}pt.textBox&&D(r.textCollisionBox.collisionVertexArray,he.text.placed,!wt||Xe,et.x,et.y),pt.verticalTextBox&&D(r.textCollisionBox.collisionVertexArray,he.text.placed,!wt||rt,et.x,et.y)}const It=!!(!rt&&pt.verticalIconBox);pt.iconBox&&D(r.iconCollisionBox.collisionVertexArray,he.icon.placed,It,q?et.x:0,q?et.y:0),pt.verticalIconBox&&D(r.iconCollisionBox.collisionVertexArray,he.icon.placed,!It,q?et.x:0,q?et.y:0)}}}if(r.sortFeatures(this.transform.angle),this.retainedQueryData[r.bucketInstanceId]&&(this.retainedQueryData[r.bucketInstanceId].featureSortOrder=r.featureSortOrder),r.hasTextData()&&r.text.opacityVertexBuffer&&r.text.opacityVertexBuffer.updateData(r.text.opacityVertexArray),r.hasIconData()&&r.icon.opacityVertexBuffer&&r.icon.opacityVertexBuffer.updateData(r.icon.opacityVertexArray),r.hasIconCollisionBoxData()&&r.iconCollisionBox.collisionVertexBuffer&&r.iconCollisionBox.collisionVertexBuffer.updateData(r.iconCollisionBox.collisionVertexArray),r.hasTextCollisionBoxData()&&r.textCollisionBox.collisionVertexBuffer&&r.textCollisionBox.collisionVertexBuffer.updateData(r.textCollisionBox.collisionVertexArray),r.text.opacityVertexArray.length!==r.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${r.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${r.text.layoutVertexArray.length}) / 4`);if(r.icon.opacityVertexArray.length!==r.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${r.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${r.icon.layoutVertexArray.length}) / 4`);if(r.bucketInstanceId in this.collisionCircleArrays){const te=this.collisionCircleArrays[r.bucketInstanceId];r.placementInvProjMatrix=te.invProjMatrix,r.placementViewportMatrix=te.viewportMatrix,r.collisionCircleArray=te.circles,delete this.collisionCircleArrays[r.bucketInstanceId]}}symbolFadeChange(r){return this.fadeDuration===0?1:(r-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(r){return Math.max(0,(this.transform.zoom-r)/1.5)}hasTransitions(r){return this.stale||r-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(r,s){const c=this.zoomAtLastRecencyCheck===s?1-this.zoomAdjustment(s):1;return this.zoomAtLastRecencyCheck=s,this.commitTime+this.fadeDuration*c>r}setStale(){this.stale=!0}}function D(d,r,s,c,p){d.emplaceBack(r?1:0,s?1:0,c||0,p||0),d.emplaceBack(r?1:0,s?1:0,c||0,p||0),d.emplaceBack(r?1:0,s?1:0,c||0,p||0),d.emplaceBack(r?1:0,s?1:0,c||0,p||0)}const U=Math.pow(2,25),X=Math.pow(2,24),re=Math.pow(2,17),ve=Math.pow(2,16),Ce=Math.pow(2,9),ke=Math.pow(2,8),xe=Math.pow(2,1);function ze(d){if(d.opacity===0&&!d.placed)return 0;if(d.opacity===1&&d.placed)return 4294967295;const r=d.placed?1:0,s=Math.floor(127*d.opacity);return s*U+r*X+s*re+r*ve+s*Ce+r*ke+s*xe+r}const Ye=0;class ut{constructor(r){this._sortAcrossTiles=r.layout.get("symbol-z-order")!=="viewport-y"&&!r.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(r,s,c,p,_){const S=this._bucketParts;for(;this._currentTileIndex<r.length;)if(s.getBucketParts(S,p,r[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,_())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,S.sort((k,A)=>k.sortKey-A.sortKey));this._currentPartIndex<S.length;)if(s.placeLayerBucketPart(S[this._currentPartIndex],this._seenCrossTileIDs,c),this._currentPartIndex++,_())return!0;return!1}}class at{constructor(r,s,c,p,_,S,k,A){this.placement=new J(r,s,S,k,A),this._currentPlacementIndex=c.length-1,this._forceFullPlacement=p,this._showCollisionBoxes=_,this._done=!1}isDone(){return this._done}continuePlacement(r,s,c){const p=l.exported.now(),_=()=>{const S=l.exported.now()-p;return!this._forceFullPlacement&&S>2};for(;this._currentPlacementIndex>=0;){const S=s[r[this._currentPlacementIndex]],k=this.placement.collisionIndex.transform.zoom;if(S.type==="symbol"&&(!S.minzoom||S.minzoom<=k)&&(!S.maxzoom||S.maxzoom>k)){if(this._inProgressLayer||(this._inProgressLayer=new ut(S)),this._inProgressLayer.continuePlacement(c[S.source],this.placement,this._showCollisionBoxes,S,_))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(r){return this.placement.commit(r),this.placement}}const Dt=512/l.EXTENT/2;class zt{constructor(r,s,c){this.tileID=r,this.indexedSymbolInstances={},this.bucketInstanceId=c;for(let p=0;p<s.length;p++){const _=s.get(p),S=_.key;this.indexedSymbolInstances[S]||(this.indexedSymbolInstances[S]=[]),this.indexedSymbolInstances[S].push({crossTileID:_.crossTileID,coord:this.getScaledCoordinates(_,r)})}}getScaledCoordinates(r,s){const c=Dt/Math.pow(2,s.canonical.z-this.tileID.canonical.z);return{x:Math.floor((s.canonical.x*l.EXTENT+r.anchorX)*c),y:Math.floor((s.canonical.y*l.EXTENT+r.anchorY)*c)}}findMatches(r,s,c){const p=this.tileID.canonical.z<s.canonical.z?1:Math.pow(2,this.tileID.canonical.z-s.canonical.z);for(let _=0;_<r.length;_++){const S=r.get(_);if(S.crossTileID)continue;const k=this.indexedSymbolInstances[S.key];if(!k)continue;const A=this.getScaledCoordinates(S,s);for(const M of k)if(Math.abs(M.coord.x-A.x)<=p&&Math.abs(M.coord.y-A.y)<=p&&!c[M.crossTileID]){c[M.crossTileID]=!0,S.crossTileID=M.crossTileID;break}}}}class Ft{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Et{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(r){const s=Math.round((r-this.lng)/360);if(s!==0)for(const c in this.indexes){const p=this.indexes[c],_={};for(const S in p){const k=p[S];k.tileID=k.tileID.unwrapTo(k.tileID.wrap+s),_[k.tileID.key]=k}this.indexes[c]=_}this.lng=r}addBucket(r,s,c){if(this.indexes[r.overscaledZ]&&this.indexes[r.overscaledZ][r.key]){if(this.indexes[r.overscaledZ][r.key].bucketInstanceId===s.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(r.overscaledZ,this.indexes[r.overscaledZ][r.key])}for(let _=0;_<s.symbolInstances.length;_++)s.symbolInstances.get(_).crossTileID=0;this.usedCrossTileIDs[r.overscaledZ]||(this.usedCrossTileIDs[r.overscaledZ]={});const p=this.usedCrossTileIDs[r.overscaledZ];for(const _ in this.indexes){const S=this.indexes[_];if(Number(_)>r.overscaledZ)for(const k in S){const A=S[k];A.tileID.isChildOf(r)&&A.findMatches(s.symbolInstances,r,p)}else{const k=S[r.scaledTo(Number(_)).key];k&&k.findMatches(s.symbolInstances,r,p)}}for(let _=0;_<s.symbolInstances.length;_++){const S=s.symbolInstances.get(_);S.crossTileID||(S.crossTileID=c.generate(),p[S.crossTileID]=!0)}return this.indexes[r.overscaledZ]===void 0&&(this.indexes[r.overscaledZ]={}),this.indexes[r.overscaledZ][r.key]=new zt(r,s.symbolInstances,s.bucketInstanceId),!0}removeBucketCrossTileIDs(r,s){for(const c in s.indexedSymbolInstances)for(const p of s.indexedSymbolInstances[c])delete this.usedCrossTileIDs[r][p.crossTileID]}removeStaleBuckets(r){let s=!1;for(const c in this.indexes){const p=this.indexes[c];for(const _ in p)r[p[_].bucketInstanceId]||(this.removeBucketCrossTileIDs(c,p[_]),delete p[_],s=!0)}return s}}class er{constructor(){this.layerIndexes={},this.crossTileIDs=new Ft,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(r,s,c){let p=this.layerIndexes[r.id];p===void 0&&(p=this.layerIndexes[r.id]=new Et);let _=!1;const S={};p.handleWrapJump(c);for(const k of s){const A=k.getBucket(r);A&&r.id===A.layerIds[0]&&(A.bucketInstanceId||(A.bucketInstanceId=++this.maxBucketInstanceId),p.addBucket(k.tileID,A,this.crossTileIDs)&&(_=!0),S[A.bucketInstanceId]=!0)}return p.removeStaleBuckets(S)&&(_=!0),_}pruneUnusedLayers(r){const s={};r.forEach(c=>{s[c]=!0});for(const c in this.layerIndexes)s[c]||delete this.layerIndexes[c]}}var tr=l.createLayout([{name:"a_pos",type:"Int16",components:2}]);class rr extends l.Evented{constructor(r){super(),this.sourceCache=r,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.renderHistory=[],this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,this.renderHistorySize=r._cache.max,r.usedForTerrain=!0,r.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null;for(const r in this._tiles){const s=this._tiles[r];s.textures.forEach(c=>c.destroy()),s.textures=[]}}update(r,s){this.sourceCache.update(r,s),this._renderableTilesKeys=[];for(const c of r.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:s}))this._renderableTilesKeys.push(c.key),this._tiles[c.key]||(c.posMatrix=new Float64Array(16),l.ortho(c.posMatrix,0,l.EXTENT,0,l.EXTENT,0,1),this._tiles[c.key]=new bt(c,this.tileSize))}removeOutdated(r){const s={};this.renderHistory=this.renderHistory.filter((c,p)=>this.renderHistory.indexOf(c)===p).slice(0,this.renderHistorySize);for(const c of this._renderableTilesKeys)s[c]=!0;for(const c of this.renderHistory)s[c]=!0;for(const c in this._tiles)s[c]||(this._tiles[c].clearTextures(r),delete this._tiles[c])}getRenderableTiles(){return this._renderableTilesKeys.map(r=>this.getTileByID(r))}getTileByID(r){return this._tiles[r]}getTerrainCoords(r){const s={};for(const c of this._renderableTilesKeys){const p=this._tiles[c].tileID;if(p.canonical.equals(r.canonical)){const _=r.clone();_.posMatrix=new Float64Array(16),l.ortho(_.posMatrix,0,l.EXTENT,0,l.EXTENT,0,1),s[c]=_}else if(p.canonical.isChildOf(r.canonical)){const _=r.clone();_.posMatrix=new Float64Array(16);const S=p.canonical.z-r.canonical.z,k=p.canonical.x-(p.canonical.x>>S<<S),A=p.canonical.y-(p.canonical.y>>S<<S),M=l.EXTENT>>S;l.ortho(_.posMatrix,0,M,0,M,0,1),l.translate(_.posMatrix,_.posMatrix,[-k*M,-A*M,0]),s[c]=_}else if(r.canonical.isChildOf(p.canonical)){const _=r.clone();_.posMatrix=new Float64Array(16);const S=r.canonical.z-p.canonical.z,k=r.canonical.x-(r.canonical.x>>S<<S),A=r.canonical.y-(r.canonical.y>>S<<S),M=l.EXTENT>>S;l.ortho(_.posMatrix,0,l.EXTENT,0,l.EXTENT,0,1),l.translate(_.posMatrix,_.posMatrix,[k*M,A*M,0]),l.scale(_.posMatrix,_.posMatrix,[1/2**S,1/2**S,0]),s[c]=_}}return s}getSourceTile(r,s){const c=this.sourceCache._source;let p=r.overscaledZ-this.deltaZoom;if(p>c.maxzoom&&(p=c.maxzoom),p<c.minzoom)return null;this._sourceTileCache[r.key]||(this._sourceTileCache[r.key]=r.scaledTo(p).key);let _=this.sourceCache.getTileByID(this._sourceTileCache[r.key]);if((!_||!_.dem)&&s)for(;p>=c.minzoom&&(!_||!_.dem);)_=this.sourceCache.getTileByID(r.scaledTo(p--).key);return _}tilesAfterTime(r=Date.now()){return Object.values(this._tiles).filter(s=>s.timeLoaded>=r)}}class Xt{constructor(r,s,c){this.style=r,this.sourceCache=new rr(s),this.options=c,this.exaggeration=typeof c.exaggeration=="number"?c.exaggeration:1,this.elevationOffset=typeof c.elevationOffset=="number"?c.elevationOffset:450,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024,this.clearRerenderCache()}getDEMElevation(r,s,c,p=l.EXTENT){if(!(s>=0&&s<p&&c>=0&&c<p))return this.elevationOffset;let _=0;const S=this.getTerrainData(r);if(S.tile&&S.tile.dem){const k=l.transformMat4$1([],[s/p*l.EXTENT,c/p*l.EXTENT],S.u_terrain_matrix),A=[k[0]*S.tile.dem.dim,k[1]*S.tile.dem.dim],M=[Math.floor(A[0]),Math.floor(A[1])],F=S.tile.dem.get(M[0],M[1]),q=S.tile.dem.get(M[0],M[1]+1),H=S.tile.dem.get(M[0]+1,M[1]),le=S.tile.dem.get(M[0]+1,M[1]+1);_=l.number(l.number(F,q,A[0]-M[0]),l.number(H,le,A[0]-M[0]),A[1]-M[1])}return _}rememberForRerender(r,s){for(const c in this.sourceCache._tiles){const p=this.sourceCache._tiles[c];(p.tileID.equals(s)||p.tileID.isChildOf(s))&&(r===this.sourceCache.sourceCache.id&&(p.timeLoaded=Date.now()),this._rerender[r]=this._rerender[r]||{},this._rerender[r][p.tileID.key]=!0)}}needsRerender(r,s){return this._rerender[r]&&this._rerender[r][s.key]}clearRerenderCache(){this._rerender={}}getElevation(r,s,c,p=l.EXTENT){return(this.getDEMElevation(r,s,c,p)+this.elevationOffset)*this.exaggeration}getTerrainData(r){if(!this._emptyDemTexture){const p=this.style.map.painter.context,_=new l.RGBAImage({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new V(p,_,p.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new V(p,new l.RGBAImage({width:1,height:1}),p.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(p.gl.NEAREST,p.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=l.identity([])}const s=this.sourceCache.getSourceTile(r,!0);if(s&&s.dem&&(!s.demTexture||s.needsTerrainPrepare)){const p=this.style.map.painter.context;s.demTexture=this.style.map.painter.getTileTexture(s.dem.stride),s.demTexture?s.demTexture.update(s.dem.getPixels(),{premultiply:!1}):s.demTexture=new V(p,s.dem.getPixels(),p.gl.RGBA,{premultiply:!1}),s.demTexture.bind(p.gl.NEAREST,p.gl.CLAMP_TO_EDGE),s.needsTerrainPrepare=!1}const c=s&&s+s.tileID.key+r.key;if(c&&!this._demMatrixCache[c]){const p=this.sourceCache.sourceCache._source.maxzoom;let _=r.canonical.z-s.tileID.canonical.z;r.overscaledZ>r.canonical.z&&(r.canonical.z>=p?_=r.canonical.z-p:l.warnOnce("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const S=r.canonical.x-(r.canonical.x>>_<<_),k=r.canonical.y-(r.canonical.y>>_<<_),A=l.fromScaling(new Float64Array(16),[1/(l.EXTENT<<_),1/(l.EXTENT<<_),0]);l.translate(A,A,[S*l.EXTENT,k*l.EXTENT,0]),this._demMatrixCache[r.key]={matrix:A,coord:r}}return{u_depth:2,u_terrain:3,u_terrain_dim:s&&s.dem&&s.dem.dim||1,u_terrain_matrix:c?this._demMatrixCache[r.key].matrix:this._emptyDemMatrix,u_terrain_unpack:s&&s.dem&&s.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_offset:this.elevationOffset,u_terrain_exaggeration:this.exaggeration,texture:(s&&s.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:s}}getRTTFramebuffer(){const r=this.style.map.painter;if(!this._rttFramebuffer){const s=this.sourceCache.tileSize*this.qualityFactor;this._rttFramebuffer=r.context.createFramebuffer(s,s,!0),this._rttFramebuffer.depthAttachment.set(r.context.createRenderbuffer(r.context.gl.DEPTH_COMPONENT16,s,s))}return this._rttFramebuffer}getFramebuffer(r){const s=this.style.map.painter,c=s.width/devicePixelRatio,p=s.height/devicePixelRatio;return!this._fbo||this._fbo.width===c&&this._fbo.height===p||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new V(s.context,{width:c,height:p,data:null},s.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(s.context.gl.NEAREST,s.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new V(s.context,{width:c,height:p,data:null},s.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(s.context.gl.NEAREST,s.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=s.context.createFramebuffer(c,p,!0),this._fbo.depthAttachment.set(s.context.createRenderbuffer(s.context.gl.DEPTH_COMPONENT16,c,p))),this._fbo.colorAttachment.set(r==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const r=this.style.map.painter.context;if(this._coordsTexture)return this._coordsTexture;const s=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let _=0,S=0;_<this._coordsTextureSize;_++)for(let k=0;k<this._coordsTextureSize;k++,S+=4)s[S+0]=255&k,s[S+1]=255&_,s[S+2]=k>>8<<4|_>>8,s[S+3]=0;const c=new l.RGBAImage({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(s.buffer)),p=new V(r,c,r.gl.RGBA,{premultiply:!1});return p.bind(r.gl.NEAREST,r.gl.CLAMP_TO_EDGE),this._coordsTexture=p,p}pointCoordinate(r){const s=new Uint8Array(4),c=this.style.map.painter,p=c.context,_=p.gl;p.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),_.readPixels(r.x,c.height/devicePixelRatio-r.y-1,1,1,_.RGBA,_.UNSIGNED_BYTE,s),p.bindFramebuffer.set(null);const S=s[0]+(s[2]>>4<<8),k=s[1]+((15&s[2])<<8),A=this.coordsIndex[255-s[3]],M=A&&this.sourceCache.getTileByID(A);if(!M)return null;const F=this._coordsTextureSize,q=(1<<M.tileID.canonical.z)*F;return new l.MercatorCoordinate((M.tileID.canonical.x*F+S)/q,(M.tileID.canonical.y*F+k)/q,this.getElevation(M.tileID,S,k,F))}getTerrainMesh(){if(this._mesh)return this._mesh;const r=this.style.map.painter.context,s=new l.PosArray,c=new l.TriangleIndexArray,p=this.meshSize,_=l.EXTENT/p,S=p*p;for(let k=0;k<=p;k++)for(let A=0;A<=p;A++)s.emplaceBack(A*_,k*_);for(let k=0;k<S;k+=p+1)for(let A=0;A<p;A++)c.emplaceBack(A+k,p+A+k+1,p+A+k+2),c.emplaceBack(A+k,p+A+k+2,A+k+1);return this._mesh={indexBuffer:r.createIndexBuffer(c),vertexBuffer:r.createVertexBuffer(s,tr.members),segments:l.SegmentVector.simpleSegment(0,0,s.length,c.length)},this._mesh}getMinMaxElevation(r){const s=this.getTerrainData(r).tile,c={minElevation:null,maxElevation:null};return s&&s.dem&&(c.minElevation=(s.dem.min+this.elevationOffset)*this.exaggeration,c.maxElevation=(s.dem.max+this.elevationOffset)*this.exaggeration),c}}const Kt=(d,r)=>l.emitValidationErrors(d,r&&r.filter(s=>s.identifier!=="source.canvas")),Yr=l.pick(Ee,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),Nr=l.pick(Ee,["setCenter","setZoom","setBearing","setPitch"]),zr=function(){const d={},r=l.spec.$version;for(const s in l.spec.$root){const c=l.spec.$root[s];if(c.required){let p=null;p=s==="version"?r:c.type==="array"?[]:{},p!=null&&(d[s]=p)}}return d}();class bn extends l.Evented{constructor(r,s={}){super(),this.map=r,this.dispatcher=new lt(He(),this),this.imageManager=new Y,this.imageManager.setEventedParent(this),this.glyphManager=new _e(r._requestManager,s.localIdeographFontFamily),this.lineAtlas=new je(256,512),this.crossTileSymbolIndex=new er,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new l.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",l.getReferrer());const c=this;this._rtlTextPluginCallback=bn.registerForPluginStateChange(p=>{c.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:p.pluginStatus,pluginURL:p.pluginURL},(_,S)=>{if(l.triggerPluginCompletionEvent(_),S&&S.every(k=>k))for(const k in c.sourceCaches)c.sourceCaches[k].reload()})}),this.on("data",p=>{if(p.dataType!=="source"||p.sourceDataType!=="metadata")return;const _=this.sourceCaches[p.sourceId];if(!_)return;const S=_.getSource();if(S&&S.vectorLayerIds)for(const k in this._layers){const A=this._layers[k];A.source===S.id&&this._validateLayer(A)}})}loadURL(r,s={}){this.fire(new l.Event("dataloading",{dataType:"style"}));const c=typeof s.validate!="boolean"||s.validate,p=this.map._requestManager.transformRequest(r,l.ResourceType.Style);this._request=l.getJSON(p,(_,S)=>{this._request=null,_?this.fire(new l.ErrorEvent(_)):S&&this._load(S,c)})}loadJSON(r,s={}){this.fire(new l.Event("dataloading",{dataType:"style"})),this._request=l.exported.frame(()=>{this._request=null,this._load(r,s.validate!==!1)})}loadEmpty(){this.fire(new l.Event("dataloading",{dataType:"style"})),this._load(zr,!1)}_load(r,s){if(s&&Kt(this,l.validateStyle(r)))return;this._loaded=!0,this.stylesheet=r;for(const p in r.sources)this.addSource(p,r.sources[p],{validate:!1});r.sprite?this._loadSprite(r.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(r.glyphs);const c=oe(this.stylesheet.layers);this._order=c.map(p=>p.id),this._layers={},this._serializedLayers={};for(let p of c)p=l.createStyleLayer(p),p.setEventedParent(this,{layer:{id:p.id}}),this._layers[p.id]=p,this._serializedLayers[p.id]=p.serialize();this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new Ze(this.stylesheet.light),this.setTerrain(this.stylesheet.terrain),this.fire(new l.Event("data",{dataType:"style"})),this.fire(new l.Event("style.load"))}_loadSprite(r){this._spriteRequest=function(s,c,p,_){let S,k,A;const M=p>1?"@2x":"";let F=l.getJSON(c.transformRequest(c.normalizeSpriteURL(s,M,".json"),l.ResourceType.SpriteJSON),(le,te)=>{F=null,A||(A=le,S=te,H())}),q=l.getImage(c.transformRequest(c.normalizeSpriteURL(s,M,".png"),l.ResourceType.SpriteImage),(le,te)=>{q=null,A||(A=le,k=te,H())});function H(){if(A)_(A);else if(S&&k){const le=l.exported.getImageData(k),te={};for(const ee in S){const{width:ye,height:Ae,x:Pe,y:he,sdf:Ve,pixelRatio:Oe,stretchX:Xe,stretchY:rt,content:pt}=S[ee],et=new l.RGBAImage({width:ye,height:Ae});l.RGBAImage.copy(le,et,{x:Pe,y:he},{x:0,y:0},{width:ye,height:Ae}),te[ee]={data:et,pixelRatio:Oe,sdf:Ve,stretchX:Xe,stretchY:rt,content:pt}}_(null,te)}}return{cancel(){F&&(F.cancel(),F=null),q&&(q.cancel(),q=null)}}}(r,this.map._requestManager,this.map.getPixelRatio(),(s,c)=>{if(this._spriteRequest=null,s)this.fire(new l.ErrorEvent(s));else if(c)for(const p in c)this.imageManager.addImage(p,c[p]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new l.Event("data",{dataType:"style"}))})}_validateLayer(r){const s=this.sourceCaches[r.source];if(!s)return;const c=r.sourceLayer;if(!c)return;const p=s.getSource();(p.type==="geojson"||p.vectorLayerIds&&p.vectorLayerIds.indexOf(c)===-1)&&this.fire(new l.ErrorEvent(new Error(`Source layer "${c}" does not exist on source "${p.id}" as specified by style layer "${r.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const r in this.sourceCaches)if(!this.sourceCaches[r].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(r){const s=[];for(const c of r){const p=this._layers[c];p.type!=="custom"&&s.push(p.serialize())}return s}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(const r in this.sourceCaches)if(this.sourceCaches[r].hasTransition())return!0;for(const r in this._layers)if(this._layers[r].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(r){if(!this._loaded)return;const s=this._changed;if(this._changed){const p=Object.keys(this._updatedLayers),_=Object.keys(this._removedLayers);(p.length||_.length)&&this._updateWorkerLayers(p,_);for(const S in this._updatedSources){const k=this._updatedSources[S];if(k==="reload")this._reloadSource(S);else{if(k!=="clear")throw new Error(`Invalid action ${k}`);this._clearSource(S)}}this._updateTilesForChangedImages();for(const S in this._updatedPaintProps)this._layers[S].updateTransitions(r);this.light.updateTransitions(r),this._resetUpdates()}const c={};for(const p in this.sourceCaches){const _=this.sourceCaches[p];c[p]=_.used,_.used=!1}for(const p of this._order){const _=this._layers[p];_.recalculate(r,this._availableImages),!_.isHidden(r.zoom)&&_.source&&(this.sourceCaches[_.source].used=!0)}for(const p in c){const _=this.sourceCaches[p];c[p]!==_.used&&_.fire(new l.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:p}))}this.light.recalculate(r),this.z=r.zoom,s&&this.fire(new l.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const r=Object.keys(this._changedImages);if(r.length){for(const s in this.sourceCaches)this.sourceCaches[s].reloadTilesForDependencies(["icons","patterns"],r);this._changedImages={}}}_updateWorkerLayers(r,s){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(r),removedIds:s})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setTerrain(r){if(this._checkLoaded(),this._terrainDataCallback&&this.off("data",this._terrainDataCallback),this._terrainfreezeElevationCallback&&this.map.off("freezeElevation",this._terrainfreezeElevationCallback),r){const s=this.sourceCaches[r.source];if(!s)throw new Error(`cannot load terrain, because there exists no source with ID: ${r.source}`);this.terrain=new Xt(this,s,r),this.map.transform.updateElevation(this.terrain),this._terrainfreezeElevationCallback=c=>{c.freeze?this.map.transform.freezeElevation=!0:(this.map.transform.freezeElevation=!1,this.map.transform.recalculateZoom(this.terrain))},this._terrainDataCallback=c=>{c.tile&&(c.sourceId===r.source?(this.map.transform.updateElevation(this.terrain),this.terrain.rememberForRerender(c.sourceId,c.tile.tileID)):c.source.type==="geojson"&&this.terrain.rememberForRerender(c.sourceId,c.tile.tileID))},this.on("data",this._terrainDataCallback),this.map.on("freezeElevation",this._terrainfreezeElevationCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.map.transform.updateElevation(this.terrain);this.map.fire(new l.Event("terrain",{terrain:r}))}setState(r){if(this._checkLoaded(),Kt(this,l.validateStyle(r)))return!1;(r=l.clone$1(r)).layers=oe(r.layers);const s=function(p,_){if(!p)return[{command:Ee.setStyle,args:[_]}];let S=[];try{if(!$(p.version,_.version))return[{command:Ee.setStyle,args:[_]}];$(p.center,_.center)||S.push({command:Ee.setCenter,args:[_.center]}),$(p.zoom,_.zoom)||S.push({command:Ee.setZoom,args:[_.zoom]}),$(p.bearing,_.bearing)||S.push({command:Ee.setBearing,args:[_.bearing]}),$(p.pitch,_.pitch)||S.push({command:Ee.setPitch,args:[_.pitch]}),$(p.sprite,_.sprite)||S.push({command:Ee.setSprite,args:[_.sprite]}),$(p.glyphs,_.glyphs)||S.push({command:Ee.setGlyphs,args:[_.glyphs]}),$(p.transition,_.transition)||S.push({command:Ee.setTransition,args:[_.transition]}),$(p.light,_.light)||S.push({command:Ee.setLight,args:[_.light]});const k={},A=[];(function(F,q,H,le){let te;for(te in q=q||{},F=F||{})Object.prototype.hasOwnProperty.call(F,te)&&(Object.prototype.hasOwnProperty.call(q,te)||ft(te,H,le));for(te in q)Object.prototype.hasOwnProperty.call(q,te)&&(Object.prototype.hasOwnProperty.call(F,te)?$(F[te],q[te])||(F[te].type==="geojson"&&q[te].type==="geojson"&&_t(F,q,te)?H.push({command:Ee.setGeoJSONSourceData,args:[te,q[te].data]}):Ne(te,q,H,le)):ot(te,q,H))})(p.sources,_.sources,A,k);const M=[];p.layers&&p.layers.forEach(F=>{k[F.source]?S.push({command:Ee.removeLayer,args:[F.id]}):M.push(F)}),S=S.concat(A),function(F,q,H){q=q||[];const le=(F=F||[]).map(Qe),te=q.map(Qe),ee=F.reduce(kt,{}),ye=q.reduce(kt,{}),Ae=le.slice(),Pe=Object.create(null);let he,Ve,Oe,Xe,rt,pt,et;for(he=0,Ve=0;he<le.length;he++)Oe=le[he],Object.prototype.hasOwnProperty.call(ye,Oe)?Ve++:(H.push({command:Ee.removeLayer,args:[Oe]}),Ae.splice(Ae.indexOf(Oe,Ve),1));for(he=0,Ve=0;he<te.length;he++)Oe=te[te.length-1-he],Ae[Ae.length-1-he]!==Oe&&(Object.prototype.hasOwnProperty.call(ee,Oe)?(H.push({command:Ee.removeLayer,args:[Oe]}),Ae.splice(Ae.lastIndexOf(Oe,Ae.length-Ve),1)):Ve++,pt=Ae[Ae.length-he],H.push({command:Ee.addLayer,args:[ye[Oe],pt]}),Ae.splice(Ae.length-he,0,Oe),Pe[Oe]=!0);for(he=0;he<te.length;he++)if(Oe=te[he],Xe=ee[Oe],rt=ye[Oe],!Pe[Oe]&&!$(Xe,rt))if($(Xe.source,rt.source)&&$(Xe["source-layer"],rt["source-layer"])&&$(Xe.type,rt.type)){for(et in We(Xe.layout,rt.layout,H,Oe,null,Ee.setLayoutProperty),We(Xe.paint,rt.paint,H,Oe,null,Ee.setPaintProperty),$(Xe.filter,rt.filter)||H.push({command:Ee.setFilter,args:[Oe,rt.filter]}),$(Xe.minzoom,rt.minzoom)&&$(Xe.maxzoom,rt.maxzoom)||H.push({command:Ee.setLayerZoomRange,args:[Oe,rt.minzoom,rt.maxzoom]}),Xe)Object.prototype.hasOwnProperty.call(Xe,et)&&et!=="layout"&&et!=="paint"&&et!=="filter"&&et!=="metadata"&&et!=="minzoom"&&et!=="maxzoom"&&(et.indexOf("paint.")===0?We(Xe[et],rt[et],H,Oe,et.slice(6),Ee.setPaintProperty):$(Xe[et],rt[et])||H.push({command:Ee.setLayerProperty,args:[Oe,et,rt[et]]}));for(et in rt)Object.prototype.hasOwnProperty.call(rt,et)&&!Object.prototype.hasOwnProperty.call(Xe,et)&&et!=="layout"&&et!=="paint"&&et!=="filter"&&et!=="metadata"&&et!=="minzoom"&&et!=="maxzoom"&&(et.indexOf("paint.")===0?We(Xe[et],rt[et],H,Oe,et.slice(6),Ee.setPaintProperty):$(Xe[et],rt[et])||H.push({command:Ee.setLayerProperty,args:[Oe,et,rt[et]]}))}else H.push({command:Ee.removeLayer,args:[Oe]}),pt=Ae[Ae.lastIndexOf(Oe)+1],H.push({command:Ee.addLayer,args:[rt,pt]})}(M,_.layers,S)}catch(k){console.warn("Unable to compute style diff:",k),S=[{command:Ee.setStyle,args:[_]}]}return S}(this.serialize(),r).filter(p=>!(p.command in Nr));if(s.length===0)return!1;const c=s.filter(p=>!(p.command in Yr));if(c.length>0)throw new Error(`Unimplemented: ${c.map(p=>p.command).join(", ")}.`);return s.forEach(p=>{p.command!=="setTransition"&&this[p.command].apply(this,p.args)}),this.stylesheet=r,!0}addImage(r,s){if(this.getImage(r))return this.fire(new l.ErrorEvent(new Error(`An image named "${r}" already exists.`)));this.imageManager.addImage(r,s),this._afterImageUpdated(r)}updateImage(r,s){this.imageManager.updateImage(r,s)}getImage(r){return this.imageManager.getImage(r)}removeImage(r){if(!this.getImage(r))return this.fire(new l.ErrorEvent(new Error(`An image named "${r}" does not exist.`)));this.imageManager.removeImage(r),this._afterImageUpdated(r)}_afterImageUpdated(r){this._availableImages=this.imageManager.listImages(),this._changedImages[r]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new l.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(r,s,c={}){if(this._checkLoaded(),this.sourceCaches[r]!==void 0)throw new Error(`Source "${r}" already exists.`);if(!s.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(s).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(s.type)>=0&&this._validate(l.validateStyle.source,`sources.${r}`,s,null,c))return;this.map&&this.map._collectResourceTiming&&(s.collectResourceTiming=!0);const p=this.sourceCaches[r]=new Rt(r,s,this.dispatcher);p.style=this,p.setEventedParent(this,()=>({isSourceLoaded:this.loaded(),source:p.serialize(),sourceId:r})),p.onAdd(this.map),this._changed=!0}removeSource(r){if(this._checkLoaded(),this.sourceCaches[r]===void 0)throw new Error("There is no source with this ID");for(const c in this._layers)if(this._layers[c].source===r)return this.fire(new l.ErrorEvent(new Error(`Source "${r}" cannot be removed while layer "${c}" is using it.`)));const s=this.sourceCaches[r];delete this.sourceCaches[r],delete this._updatedSources[r],s.fire(new l.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:r})),s.setEventedParent(null),s.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(r,s){if(this._checkLoaded(),this.sourceCaches[r]===void 0)throw new Error(`There is no source with this ID=${r}`);const c=this.sourceCaches[r].getSource();if(c.type!=="geojson")throw new Error(`geojsonSource.type is ${c.type}, which is !== 'geojson`);c.setData(s),this._changed=!0}getSource(r){return this.sourceCaches[r]&&this.sourceCaches[r].getSource()}addLayer(r,s,c={}){this._checkLoaded();const p=r.id;if(this.getLayer(p))return void this.fire(new l.ErrorEvent(new Error(`Layer "${p}" already exists on this map.`)));let _;if(r.type==="custom"){if(Kt(this,l.validateCustomStyleLayer(r)))return;_=l.createStyleLayer(r)}else{if(typeof r.source=="object"&&(this.addSource(p,r.source),r=l.clone$1(r),r=l.extend(r,{source:p})),this._validate(l.validateStyle.layer,`layers.${p}`,r,{arrayIndex:-1},c))return;_=l.createStyleLayer(r),this._validateLayer(_),_.setEventedParent(this,{layer:{id:p}}),this._serializedLayers[_.id]=_.serialize()}const S=s?this._order.indexOf(s):this._order.length;if(s&&S===-1)this.fire(new l.ErrorEvent(new Error(`Cannot add layer "${p}" before non-existing layer "${s}".`)));else{if(this._order.splice(S,0,p),this._layerOrderChanged=!0,this._layers[p]=_,this._removedLayers[p]&&_.source&&_.type!=="custom"){const k=this._removedLayers[p];delete this._removedLayers[p],k.type!==_.type?this._updatedSources[_.source]="clear":(this._updatedSources[_.source]="reload",this.sourceCaches[_.source].pause())}this._updateLayer(_),_.onAdd&&_.onAdd(this.map)}}moveLayer(r,s){if(this._checkLoaded(),this._changed=!0,!this._layers[r])return void this.fire(new l.ErrorEvent(new Error(`The layer '${r}' does not exist in the map's style and cannot be moved.`)));if(r===s)return;const c=this._order.indexOf(r);this._order.splice(c,1);const p=s?this._order.indexOf(s):this._order.length;s&&p===-1?this.fire(new l.ErrorEvent(new Error(`Cannot move layer "${r}" before non-existing layer "${s}".`))):(this._order.splice(p,0,r),this._layerOrderChanged=!0)}removeLayer(r){this._checkLoaded();const s=this._layers[r];if(!s)return void this.fire(new l.ErrorEvent(new Error(`Cannot remove non-existing layer "${r}".`)));s.setEventedParent(null);const c=this._order.indexOf(r);this._order.splice(c,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[r]=s,delete this._layers[r],delete this._serializedLayers[r],delete this._updatedLayers[r],delete this._updatedPaintProps[r],s.onRemove&&s.onRemove(this.map)}getLayer(r){return this._layers[r]}hasLayer(r){return r in this._layers}setLayerZoomRange(r,s,c){this._checkLoaded();const p=this.getLayer(r);p?p.minzoom===s&&p.maxzoom===c||(s!=null&&(p.minzoom=s),c!=null&&(p.maxzoom=c),this._updateLayer(p)):this.fire(new l.ErrorEvent(new Error(`Cannot set the zoom range of non-existing layer "${r}".`)))}setFilter(r,s,c={}){this._checkLoaded();const p=this.getLayer(r);if(p){if(!$(p.filter,s))return s==null?(p.filter=void 0,void this._updateLayer(p)):void(this._validate(l.validateStyle.filter,`layers.${p.id}.filter`,s,null,c)||(p.filter=l.clone$1(s),this._updateLayer(p)))}else this.fire(new l.ErrorEvent(new Error(`Cannot filter non-existing layer "${r}".`)))}getFilter(r){return l.clone$1(this.getLayer(r).filter)}setLayoutProperty(r,s,c,p={}){this._checkLoaded();const _=this.getLayer(r);_?$(_.getLayoutProperty(s),c)||(_.setLayoutProperty(s,c,p),this._updateLayer(_)):this.fire(new l.ErrorEvent(new Error(`Cannot style non-existing layer "${r}".`)))}getLayoutProperty(r,s){const c=this.getLayer(r);if(c)return c.getLayoutProperty(s);this.fire(new l.ErrorEvent(new Error(`Cannot get style of non-existing layer "${r}".`)))}setPaintProperty(r,s,c,p={}){this._checkLoaded();const _=this.getLayer(r);_?$(_.getPaintProperty(s),c)||(_.setPaintProperty(s,c,p)&&this._updateLayer(_),this._changed=!0,this._updatedPaintProps[r]=!0):this.fire(new l.ErrorEvent(new Error(`Cannot style non-existing layer "${r}".`)))}getPaintProperty(r,s){return this.getLayer(r).getPaintProperty(s)}setFeatureState(r,s){this._checkLoaded();const c=r.source,p=r.sourceLayer,_=this.sourceCaches[c];if(_===void 0)return void this.fire(new l.ErrorEvent(new Error(`The source '${c}' does not exist in the map's style.`)));const S=_.getSource().type;S==="geojson"&&p?this.fire(new l.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):S!=="vector"||p?(r.id===void 0&&this.fire(new l.ErrorEvent(new Error("The feature id parameter must be provided."))),_.setFeatureState(p,r.id,s)):this.fire(new l.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(r,s){this._checkLoaded();const c=r.source,p=this.sourceCaches[c];if(p===void 0)return void this.fire(new l.ErrorEvent(new Error(`The source '${c}' does not exist in the map's style.`)));const _=p.getSource().type,S=_==="vector"?r.sourceLayer:void 0;_!=="vector"||S?s&&typeof r.id!="string"&&typeof r.id!="number"?this.fire(new l.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):p.removeFeatureState(S,r.id,s):this.fire(new l.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(r){this._checkLoaded();const s=r.source,c=r.sourceLayer,p=this.sourceCaches[s];if(p!==void 0)return p.getSource().type!=="vector"||c?(r.id===void 0&&this.fire(new l.ErrorEvent(new Error("The feature id parameter must be provided."))),p.getFeatureState(c,r.id)):void this.fire(new l.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new l.ErrorEvent(new Error(`The source '${s}' does not exist in the map's style.`)))}getTransition(){return l.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){return l.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:l.mapObject(this.sourceCaches,r=>r.serialize()),layers:this._serializeLayers(this._order)},r=>r!==void 0)}_updateLayer(r){this._updatedLayers[r.id]=!0,r.source&&!this._updatedSources[r.source]&&this.sourceCaches[r.source].getSource().type!=="raster"&&(this._updatedSources[r.source]="reload",this.sourceCaches[r.source].pause()),this._changed=!0}_flattenAndSortRenderedFeatures(r){const s=S=>this._layers[S].type==="fill-extrusion",c={},p=[];for(let S=this._order.length-1;S>=0;S--){const k=this._order[S];if(s(k)){c[k]=S;for(const A of r){const M=A[k];if(M)for(const F of M)p.push(F)}}}p.sort((S,k)=>k.intersectionZ-S.intersectionZ);const _=[];for(let S=this._order.length-1;S>=0;S--){const k=this._order[S];if(s(k))for(let A=p.length-1;A>=0;A--){const M=p[A].feature;if(c[M.layer.id]<S)break;_.push(M),p.pop()}else for(const A of r){const M=A[k];if(M)for(const F of M)_.push(F.feature)}}return _}queryRenderedFeatures(r,s,c){s&&s.filter&&this._validate(l.validateStyle.filter,"queryRenderedFeatures.filter",s.filter,null,s);const p={};if(s&&s.layers){if(!Array.isArray(s.layers))return this.fire(new l.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const S of s.layers){const k=this._layers[S];if(!k)return this.fire(new l.ErrorEvent(new Error(`The layer '${S}' does not exist in the map's style and cannot be queried for features.`))),[];p[k.source]=!0}}const _=[];s.availableImages=this._availableImages;for(const S in this.sourceCaches)s.layers&&!p[S]||_.push(ct(this.sourceCaches[S],this._layers,this._serializedLayers,r,s,c));return this.placement&&_.push(function(S,k,A,M,F,q,H){const le={},te=q.queryRenderedSymbols(M),ee=[];for(const ye of Object.keys(te).map(Number))ee.push(H[ye]);ee.sort(dt);for(const ye of ee){const Ae=ye.featureIndex.lookupSymbolFeatures(te[ye.bucketInstanceId],k,ye.bucketIndex,ye.sourceLayerIndex,F.filter,F.layers,F.availableImages,S);for(const Pe in Ae){const he=le[Pe]=le[Pe]||[],Ve=Ae[Pe];Ve.sort((Oe,Xe)=>{const rt=ye.featureSortOrder;if(rt){const pt=rt.indexOf(Oe.featureIndex);return rt.indexOf(Xe.featureIndex)-pt}return Xe.featureIndex-Oe.featureIndex});for(const Oe of Ve)he.push(Oe)}}for(const ye in le)le[ye].forEach(Ae=>{const Pe=Ae.feature,he=A[S[ye].source].getFeatureState(Pe.layer["source-layer"],Pe.id);Pe.source=Pe.layer.source,Pe.layer["source-layer"]&&(Pe.sourceLayer=Pe.layer["source-layer"]),Pe.state=he});return le}(this._layers,this._serializedLayers,this.sourceCaches,r,s,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(_)}querySourceFeatures(r,s){s&&s.filter&&this._validate(l.validateStyle.filter,"querySourceFeatures.filter",s.filter,null,s);const c=this.sourceCaches[r];return c?function(p,_){const S=p.getRenderableIds().map(M=>p.getTileByID(M)),k=[],A={};for(let M=0;M<S.length;M++){const F=S[M],q=F.tileID.canonical.key;A[q]||(A[q]=!0,F.querySourceFeatures(k,_))}return k}(c,s):[]}addSourceType(r,s,c){return bn.getSourceType(r)?c(new Error(`A source type called "${r}" already exists.`)):(bn.setSourceType(r,s),s.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:r,url:s.workerSourceURL},c):c(null,null))}getLight(){return this.light.getLight()}setLight(r,s={}){this._checkLoaded();const c=this.light.getLight();let p=!1;for(const S in r)if(!$(r[S],c[S])){p=!0;break}if(!p)return;const _={now:l.exported.now(),transition:l.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(r,s),this.light.updateTransitions(_)}_validate(r,s,c,p,_={}){return(!_||_.validate!==!1)&&Kt(this,r.call(l.validateStyle,l.extend({key:s,style:this.serialize(),value:c,styleSpec:l.spec},p)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),l.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const r in this._layers)this._layers[r].setEventedParent(null);for(const r in this.sourceCaches){const s=this.sourceCaches[r];s.setEventedParent(null),s.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(r){this.sourceCaches[r].clearTiles()}_reloadSource(r){this.sourceCaches[r].resume(),this.sourceCaches[r].reload()}_updateSources(r){for(const s in this.sourceCaches)this.sourceCaches[s].update(r,this.terrain)}_generateCollisionBoxes(){for(const r in this.sourceCaches)this._reloadSource(r)}_updatePlacement(r,s,c,p,_=!1){let S=!1,k=!1;const A={};for(const M of this._order){const F=this._layers[M];if(F.type!=="symbol")continue;if(!A[F.source]){const H=this.sourceCaches[F.source];A[F.source]=H.getRenderableIds(!0).map(le=>H.getTileByID(le)).sort((le,te)=>te.tileID.overscaledZ-le.tileID.overscaledZ||(le.tileID.isLessThan(te.tileID)?-1:1))}const q=this.crossTileSymbolIndex.addLayer(F,A[F.source],r.center.lng);S=S||q}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((_=_||this._layerOrderChanged||c===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(l.exported.now(),r.zoom))&&(this.pauseablePlacement=new at(r,this.terrain,this._order,_,s,c,p,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,A),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(l.exported.now()),k=!0),S&&this.pauseablePlacement.placement.setStale()),k||S)for(const M of this._order){const F=this._layers[M];F.type==="symbol"&&this.placement.updateLayerOpacities(F,A[F.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(l.exported.now())}_releaseSymbolFadeTiles(){for(const r in this.sourceCaches)this.sourceCaches[r].releaseSymbolFadeTiles()}getImages(r,s,c){this.imageManager.getImages(s.icons,c),this._updateTilesForChangedImages();const p=this.sourceCaches[s.source];p&&p.setDependencies(s.tileID.key,s.type,s.icons)}getGlyphs(r,s,c){this.glyphManager.getGlyphs(s.stacks,c)}getResource(r,s,c){return l.makeRequest(s,c)}}bn.getSourceType=function(d){return Se[d]},bn.setSourceType=function(d,r){Se[d]=r},bn.registerForPluginStateChange=l.registerForPluginStateChange;var ti="attribute vec2 a_pos;uniform mat4 u_matrix;varying vec2 v_texture_pos;varying float v_depth;void main() {v_texture_pos=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);v_depth=gl_Position.z/gl_Position.w;}";const Xs={prelude:Cr(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_offset;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return (elevation+u_terrain_offset)*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:Cr(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:Cr(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:Cr(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:Cr("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Cr(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),heatmapTexture:Cr(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:Cr("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Cr("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:Cr("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:Cr(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:Cr(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:Cr(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:Cr(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:Cr(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float baseDelta=10.0;float ele=get_elevation(a_centroid);
#else
float baseDelta=0.0;float ele=0.0;
#endif
base=max(0.0,ele+base-baseDelta);height=max(0.0,ele+height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:Cr(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float baseDelta=10.0;float ele=get_elevation(a_centroid);
#else
float baseDelta=0.0;float ele=0.0;
#endif
base=max(0.0,ele+base-baseDelta);height=max(0.0,ele+height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:Cr(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Cr(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:Cr(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:Cr(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:Cr(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:Cr(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:Cr(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:Cr(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),z,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:Cr(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:Cr(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:Cr("uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}",ti),terrainDepth:Cr("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}",ti),terrainCoords:Cr("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}",ti)};function Cr(d,r){const s=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,c=r.match(/attribute ([\w]+) ([\w]+)/g),p=d.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),_=r.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),S=_?_.concat(p):p,k={};return{fragmentSource:d=d.replace(s,(A,M,F,q,H)=>(k[H]=!0,M==="define"?`
#ifndef HAS_UNIFORM_u_${H}
varying ${F} ${q} ${H};
#else
uniform ${F} ${q} u_${H};
#endif
`:`
#ifdef HAS_UNIFORM_u_${H}
    ${F} ${q} ${H} = u_${H};
#endif
`)),vertexSource:r=r.replace(s,(A,M,F,q,H)=>{const le=q==="float"?"vec2":"vec4",te=H.match(/color/)?"color":le;return k[H]?M==="define"?`
#ifndef HAS_UNIFORM_u_${H}
uniform lowp float u_${H}_t;
attribute ${F} ${le} a_${H};
varying ${F} ${q} ${H};
#else
uniform ${F} ${q} u_${H};
#endif
`:te==="vec4"?`
#ifndef HAS_UNIFORM_u_${H}
    ${H} = a_${H};
#else
    ${F} ${q} ${H} = u_${H};
#endif
`:`
#ifndef HAS_UNIFORM_u_${H}
    ${H} = unpack_mix_${te}(a_${H}, u_${H}_t);
#else
    ${F} ${q} ${H} = u_${H};
#endif
`:M==="define"?`
#ifndef HAS_UNIFORM_u_${H}
uniform lowp float u_${H}_t;
attribute ${F} ${le} a_${H};
#else
uniform ${F} ${q} u_${H};
#endif
`:te==="vec4"?`
#ifndef HAS_UNIFORM_u_${H}
    ${F} ${q} ${H} = a_${H};
#else
    ${F} ${q} ${H} = u_${H};
#endif
`:`
#ifndef HAS_UNIFORM_u_${H}
    ${F} ${q} ${H} = unpack_mix_${te}(a_${H}, u_${H}_t);
#else
    ${F} ${q} ${H} = u_${H};
#endif
`}),staticAttributes:c,staticUniforms:S}}class qc{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(r,s,c,p,_,S,k,A,M){this.context=r;let F=this.boundPaintVertexBuffers.length!==p.length;for(let q=0;!F&&q<p.length;q++)this.boundPaintVertexBuffers[q]!==p[q]&&(F=!0);r.extVertexArrayObject&&this.vao&&this.boundProgram===s&&this.boundLayoutVertexBuffer===c&&!F&&this.boundIndexBuffer===_&&this.boundVertexOffset===S&&this.boundDynamicVertexBuffer===k&&this.boundDynamicVertexBuffer2===A&&this.boundDynamicVertexBuffer3===M?(r.bindVertexArrayOES.set(this.vao),k&&k.bind(),_&&_.dynamicDraw&&_.bind(),A&&A.bind(),M&&M.bind()):this.freshBind(s,c,p,_,S,k,A,M)}freshBind(r,s,c,p,_,S,k,A){let M;const F=r.numAttributes,q=this.context,H=q.gl;if(q.extVertexArrayObject)this.vao&&this.destroy(),this.vao=q.extVertexArrayObject.createVertexArrayOES(),q.bindVertexArrayOES.set(this.vao),M=0,this.boundProgram=r,this.boundLayoutVertexBuffer=s,this.boundPaintVertexBuffers=c,this.boundIndexBuffer=p,this.boundVertexOffset=_,this.boundDynamicVertexBuffer=S,this.boundDynamicVertexBuffer2=k,this.boundDynamicVertexBuffer3=A;else{M=q.currentNumAttributes||0;for(let le=F;le<M;le++)H.disableVertexAttribArray(le)}s.enableAttributes(H,r);for(const le of c)le.enableAttributes(H,r);S&&S.enableAttributes(H,r),k&&k.enableAttributes(H,r),A&&A.enableAttributes(H,r),s.bind(),s.setVertexAttribPointers(H,r,_);for(const le of c)le.bind(),le.setVertexAttribPointers(H,r,_);S&&(S.bind(),S.setVertexAttribPointers(H,r,_)),p&&p.bind(),k&&(k.bind(),k.setVertexAttribPointers(H,r,_)),A&&(A.bind(),A.setVertexAttribPointers(H,r,_)),q.currentNumAttributes=F}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function Lo(d){const r=[];for(let s=0;s<d.length;s++){if(d[s]===null)continue;const c=d[s].split(" ");r.push(c.pop())}return r}class el{constructor(r,s,c,p,_,S,k){const A=r.gl;this.program=A.createProgram();const M=Lo(c.staticAttributes),F=p?p.getBinderAttributes():[],q=M.concat(F),H=Xs.prelude.staticUniforms?Lo(Xs.prelude.staticUniforms):[],le=c.staticUniforms?Lo(c.staticUniforms):[],te=p?p.getBinderUniforms():[],ee=H.concat(le).concat(te),ye=[];for(const rt of ee)ye.indexOf(rt)<0&&ye.push(rt);const Ae=p?p.defines():[];S&&Ae.push("#define OVERDRAW_INSPECTOR;"),k&&Ae.push("#define TERRAIN3D;");const Pe=Ae.concat(Xs.prelude.fragmentSource,c.fragmentSource).join(`
`),he=Ae.concat(Xs.prelude.vertexSource,c.vertexSource).join(`
`),Ve=A.createShader(A.FRAGMENT_SHADER);if(A.isContextLost())return void(this.failedToCreate=!0);A.shaderSource(Ve,Pe),A.compileShader(Ve),A.attachShader(this.program,Ve);const Oe=A.createShader(A.VERTEX_SHADER);if(A.isContextLost())return void(this.failedToCreate=!0);A.shaderSource(Oe,he),A.compileShader(Oe),A.attachShader(this.program,Oe),this.attributes={};const Xe={};this.numAttributes=q.length;for(let rt=0;rt<this.numAttributes;rt++)q[rt]&&(A.bindAttribLocation(this.program,rt,q[rt]),this.attributes[q[rt]]=rt);A.linkProgram(this.program),A.deleteShader(Oe),A.deleteShader(Ve);for(let rt=0;rt<ye.length;rt++){const pt=ye[rt];if(pt&&!Xe[pt]){const et=A.getUniformLocation(this.program,pt);et&&(Xe[pt]=et)}}this.fixedUniforms=_(r,Xe),this.terrainUniforms=((rt,pt)=>({u_depth:new l.Uniform1i(rt,pt.u_depth),u_terrain:new l.Uniform1i(rt,pt.u_terrain),u_terrain_dim:new l.Uniform1f(rt,pt.u_terrain_dim),u_terrain_matrix:new l.UniformMatrix4f(rt,pt.u_terrain_matrix),u_terrain_unpack:new l.Uniform4f(rt,pt.u_terrain_unpack),u_terrain_offset:new l.Uniform1f(rt,pt.u_terrain_offset),u_terrain_exaggeration:new l.Uniform1f(rt,pt.u_terrain_exaggeration)}))(r,Xe),this.binderUniforms=p?p.getUniforms(r,Xe):[]}draw(r,s,c,p,_,S,k,A,M,F,q,H,le,te,ee,ye,Ae,Pe){const he=r.gl;if(this.failedToCreate)return;if(r.program.set(this.program),r.setDepthMode(c),r.setStencilMode(p),r.setColorMode(_),r.setCullFace(S),A){r.activeTexture.set(he.TEXTURE2),he.bindTexture(he.TEXTURE_2D,A.depthTexture),r.activeTexture.set(he.TEXTURE3),he.bindTexture(he.TEXTURE_2D,A.texture);for(const Oe in this.terrainUniforms)this.terrainUniforms[Oe].set(A[Oe])}for(const Oe in this.fixedUniforms)this.fixedUniforms[Oe].set(k[Oe]);ee&&ee.setUniforms(r,this.binderUniforms,le,{zoom:te});let Ve=0;switch(s){case he.LINES:Ve=2;break;case he.TRIANGLES:Ve=3;break;case he.LINE_STRIP:Ve=1}for(const Oe of H.get()){const Xe=Oe.vaos||(Oe.vaos={});(Xe[M]||(Xe[M]=new qc)).bind(r,this,F,ee?ee.getPaintVertexBuffers():[],q,Oe.vertexOffset,ye,Ae,Pe),he.drawElements(s,Oe.primitiveLength*Ve,he.UNSIGNED_SHORT,Oe.primitiveOffset*Ve*2)}}}function Bo(d,r,s){const c=1/lr(s,1,r.transform.tileZoom),p=Math.pow(2,s.tileID.overscaledZ),_=s.tileSize*Math.pow(2,r.transform.tileZoom)/p,S=_*(s.tileID.canonical.x+s.tileID.wrap*p),k=_*s.tileID.canonical.y;return{u_image:0,u_texsize:s.imageAtlasTexture.size,u_scale:[c,d.fromScale,d.toScale],u_fade:d.t,u_pixel_coord_upper:[S>>16,k>>16],u_pixel_coord_lower:[65535&S,65535&k]}}const Ks=(d,r,s,c)=>{const p=r.style.light,_=p.properties.get("position"),S=[_.x,_.y,_.z],k=l.create$1();p.properties.get("anchor")==="viewport"&&l.fromRotation(k,-r.transform.angle),l.transformMat3(S,S,k);const A=p.properties.get("color");return{u_matrix:d,u_lightpos:S,u_lightintensity:p.properties.get("intensity"),u_lightcolor:[A.r,A.g,A.b],u_vertical_gradient:+s,u_opacity:c}},ql=(d,r,s,c,p,_,S)=>l.extend(Ks(d,r,s,c),Bo(_,r,S),{u_height_factor:-Math.pow(2,p.overscaledZ)/S.tileSize/8}),Wl=d=>({u_matrix:d}),Ys=(d,r,s,c)=>l.extend(Wl(d),Bo(s,r,c)),Hl=(d,r)=>({u_matrix:d,u_world:r}),tl=(d,r,s,c,p)=>l.extend(Ys(d,r,s,c),{u_world:p}),_i=(d,r,s,c)=>{const p=d.transform;let _,S;if(c.paint.get("circle-pitch-alignment")==="map"){const k=lr(s,1,p.zoom);_=!0,S=[k,k]}else _=!1,S=p.pixelsToGLUnits;return{u_camera_to_center_distance:p.cameraToCenterDistance,u_scale_with_map:+(c.paint.get("circle-pitch-scale")==="map"),u_matrix:d.translatePosMatrix(r.posMatrix,s,c.paint.get("circle-translate"),c.paint.get("circle-translate-anchor")),u_pitch_with_map:+_,u_device_pixel_ratio:d.pixelRatio,u_extrude_scale:S}},rl=(d,r,s)=>{const c=lr(s,1,r.zoom),p=Math.pow(2,r.zoom-s.tileID.overscaledZ),_=s.tileID.overscaleFactor();return{u_matrix:d,u_camera_to_center_distance:r.cameraToCenterDistance,u_pixels_to_tile_units:c,u_extrude_scale:[r.pixelsToGLUnits[0]/(c*p),r.pixelsToGLUnits[1]/(c*p)],u_overscale_factor:_}},lo=(d,r,s=1)=>({u_matrix:d,u_color:r,u_overlay:0,u_overlay_scale:s}),wr=d=>({u_matrix:d}),Js=(d,r,s,c)=>({u_matrix:d,u_extrude_scale:lr(r,1,s),u_intensity:c});function Qs(d,r){const s=Math.pow(2,r.canonical.z),c=r.canonical.y;return[new l.MercatorCoordinate(0,c/s).toLngLat().lat,new l.MercatorCoordinate(0,(c+1)/s).toLngLat().lat]}const Fo=(d,r,s,c)=>{const p=d.transform;return{u_matrix:fs(d,r,s,c),u_ratio:1/lr(r,1,p.zoom),u_device_pixel_ratio:d.pixelRatio,u_units_to_pixels:[1/p.pixelsToGLUnits[0],1/p.pixelsToGLUnits[1]]}},ea=(d,r,s,c,p)=>l.extend(Fo(d,r,s,p),{u_image:0,u_image_height:c}),ds=(d,r,s,c,p)=>{const _=d.transform,S=Oo(r,_);return{u_matrix:fs(d,r,s,p),u_texsize:r.imageAtlasTexture.size,u_ratio:1/lr(r,1,_.zoom),u_device_pixel_ratio:d.pixelRatio,u_image:0,u_scale:[S,c.fromScale,c.toScale],u_fade:c.t,u_units_to_pixels:[1/_.pixelsToGLUnits[0],1/_.pixelsToGLUnits[1]]}},Ur=(d,r,s,c,p,_)=>{const S=d.lineAtlas,k=Oo(r,d.transform),A=s.layout.get("line-cap")==="round",M=S.getDash(c.from,A),F=S.getDash(c.to,A),q=M.width*p.fromScale,H=F.width*p.toScale;return l.extend(Fo(d,r,s,_),{u_patternscale_a:[k/q,-M.height/2],u_patternscale_b:[k/H,-F.height/2],u_sdfgamma:S.width/(256*Math.min(q,H)*d.pixelRatio)/2,u_image:0,u_tex_y_a:M.y,u_tex_y_b:F.y,u_mix:p.t})};function Oo(d,r){return 1/lr(d,1,r.tileZoom)}function fs(d,r,s,c){return d.translatePosMatrix(c?c.posMatrix:r.tileID.posMatrix,r,s.paint.get("line-translate"),s.paint.get("line-translate-anchor"))}const $i=(d,r,s,c,p)=>{return{u_matrix:d,u_tl_parent:r,u_scale_parent:s,u_buffer_scale:1,u_fade_t:c.mix,u_opacity:c.opacity*p.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:p.paint.get("raster-brightness-min"),u_brightness_high:p.paint.get("raster-brightness-max"),u_saturation_factor:(S=p.paint.get("raster-saturation"),S>0?1-1/(1.001-S):-S),u_contrast_factor:(_=p.paint.get("raster-contrast"),_>0?1/(1-_):1+_),u_spin_weights:Gi(p.paint.get("raster-hue-rotate"))};var _,S};function Gi(d){d*=Math.PI/180;const r=Math.sin(d),s=Math.cos(d);return[(2*s+1)/3,(-Math.sqrt(3)*r-s+1)/3,(Math.sqrt(3)*r-s+1)/3]}const vi=(d,r,s,c,p,_,S,k,A,M)=>{const F=p.transform;return{u_is_size_zoom_constant:+(d==="constant"||d==="source"),u_is_size_feature_constant:+(d==="constant"||d==="camera"),u_size_t:r?r.uSizeT:0,u_size:r?r.uSize:0,u_camera_to_center_distance:F.cameraToCenterDistance,u_pitch:F.pitch/360*2*Math.PI,u_rotate_symbol:+s,u_aspect_ratio:F.width/F.height,u_fade_change:p.options.fadeDuration?p.symbolFadeChange:1,u_matrix:_,u_label_plane_matrix:S,u_coord_matrix:k,u_is_text:+A,u_pitch_with_map:+c,u_texsize:M,u_texture:0}},No=(d,r,s,c,p,_,S,k,A,M,F)=>{const q=p.transform;return l.extend(vi(d,r,s,c,p,_,S,k,A,M),{u_gamma_scale:c?Math.cos(q._pitch)*q.cameraToCenterDistance:1,u_device_pixel_ratio:p.pixelRatio,u_is_halo:1})},ta=(d,r,s,c,p,_,S,k,A,M)=>l.extend(No(d,r,s,c,p,_,S,k,!0,A),{u_texsize_icon:M,u_texture_icon:1}),uo=(d,r,s)=>({u_matrix:d,u_opacity:r,u_color:s}),Xl=(d,r,s,c,p,_)=>l.extend(function(S,k,A,M){const F=A.imageManager.getPattern(S.from.toString()),q=A.imageManager.getPattern(S.to.toString()),{width:H,height:le}=A.imageManager.getPixelSize(),te=Math.pow(2,M.tileID.overscaledZ),ee=M.tileSize*Math.pow(2,A.transform.tileZoom)/te,ye=ee*(M.tileID.canonical.x+M.tileID.wrap*te),Ae=ee*M.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:F.tl,u_pattern_br_a:F.br,u_pattern_tl_b:q.tl,u_pattern_br_b:q.br,u_texsize:[H,le],u_mix:k.t,u_pattern_size_a:F.displaySize,u_pattern_size_b:q.displaySize,u_scale_a:k.fromScale,u_scale_b:k.toScale,u_tile_units_to_pixels:1/lr(M,1,A.transform.tileZoom),u_pixel_coord_upper:[ye>>16,Ae>>16],u_pixel_coord_lower:[65535&ye,65535&Ae]}}(c,_,s,p),{u_matrix:d,u_opacity:r}),nl={fillExtrusion:(d,r)=>({u_matrix:new l.UniformMatrix4f(d,r.u_matrix),u_lightpos:new l.Uniform3f(d,r.u_lightpos),u_lightintensity:new l.Uniform1f(d,r.u_lightintensity),u_lightcolor:new l.Uniform3f(d,r.u_lightcolor),u_vertical_gradient:new l.Uniform1f(d,r.u_vertical_gradient),u_opacity:new l.Uniform1f(d,r.u_opacity)}),fillExtrusionPattern:(d,r)=>({u_matrix:new l.UniformMatrix4f(d,r.u_matrix),u_lightpos:new l.Uniform3f(d,r.u_lightpos),u_lightintensity:new l.Uniform1f(d,r.u_lightintensity),u_lightcolor:new l.Uniform3f(d,r.u_lightcolor),u_vertical_gradient:new l.Uniform1f(d,r.u_vertical_gradient),u_height_factor:new l.Uniform1f(d,r.u_height_factor),u_image:new l.Uniform1i(d,r.u_image),u_texsize:new l.Uniform2f(d,r.u_texsize),u_pixel_coord_upper:new l.Uniform2f(d,r.u_pixel_coord_upper),u_pixel_coord_lower:new l.Uniform2f(d,r.u_pixel_coord_lower),u_scale:new l.Uniform3f(d,r.u_scale),u_fade:new l.Uniform1f(d,r.u_fade),u_opacity:new l.Uniform1f(d,r.u_opacity)}),fill:(d,r)=>({u_matrix:new l.UniformMatrix4f(d,r.u_matrix)}),fillPattern:(d,r)=>({u_matrix:new l.UniformMatrix4f(d,r.u_matrix),u_image:new l.Uniform1i(d,r.u_image),u_texsize:new l.Uniform2f(d,r.u_texsize),u_pixel_coord_upper:new l.Uniform2f(d,r.u_pixel_coord_upper),u_pixel_coord_lower:new l.Uniform2f(d,r.u_pixel_coord_lower),u_scale:new l.Uniform3f(d,r.u_scale),u_fade:new l.Uniform1f(d,r.u_fade)}),fillOutline:(d,r)=>({u_matrix:new l.UniformMatrix4f(d,r.u_matrix),u_world:new l.Uniform2f(d,r.u_world)}),fillOutlinePattern:(d,r)=>({u_matrix:new l.UniformMatrix4f(d,r.u_matrix),u_world:new l.Uniform2f(d,r.u_world),u_image:new l.Uniform1i(d,r.u_image),u_texsize:new l.Uniform2f(d,r.u_texsize),u_pixel_coord_upper:new l.Uniform2f(d,r.u_pixel_coord_upper),u_pixel_coord_lower:new l.Uniform2f(d,r.u_pixel_coord_lower),u_scale:new l.Uniform3f(d,r.u_scale),u_fade:new l.Uniform1f(d,r.u_fade)}),circle:(d,r)=>({u_camera_to_center_distance:new l.Uniform1f(d,r.u_camera_to_center_distance),u_scale_with_map:new l.Uniform1i(d,r.u_scale_with_map),u_pitch_with_map:new l.Uniform1i(d,r.u_pitch_with_map),u_extrude_scale:new l.Uniform2f(d,r.u_extrude_scale),u_device_pixel_ratio:new l.Uniform1f(d,r.u_device_pixel_ratio),u_matrix:new l.UniformMatrix4f(d,r.u_matrix)}),collisionBox:(d,r)=>({u_matrix:new l.UniformMatrix4f(d,r.u_matrix),u_camera_to_center_distance:new l.Uniform1f(d,r.u_camera_to_center_distance),u_pixels_to_tile_units:new l.Uniform1f(d,r.u_pixels_to_tile_units),u_extrude_scale:new l.Uniform2f(d,r.u_extrude_scale),u_overscale_factor:new l.Uniform1f(d,r.u_overscale_factor)}),collisionCircle:(d,r)=>({u_matrix:new l.UniformMatrix4f(d,r.u_matrix),u_inv_matrix:new l.UniformMatrix4f(d,r.u_inv_matrix),u_camera_to_center_distance:new l.Uniform1f(d,r.u_camera_to_center_distance),u_viewport_size:new l.Uniform2f(d,r.u_viewport_size)}),debug:(d,r)=>({u_color:new l.UniformColor(d,r.u_color),u_matrix:new l.UniformMatrix4f(d,r.u_matrix),u_overlay:new l.Uniform1i(d,r.u_overlay),u_overlay_scale:new l.Uniform1f(d,r.u_overlay_scale)}),clippingMask:(d,r)=>({u_matrix:new l.UniformMatrix4f(d,r.u_matrix)}),heatmap:(d,r)=>({u_extrude_scale:new l.Uniform1f(d,r.u_extrude_scale),u_intensity:new l.Uniform1f(d,r.u_intensity),u_matrix:new l.UniformMatrix4f(d,r.u_matrix)}),heatmapTexture:(d,r)=>({u_matrix:new l.UniformMatrix4f(d,r.u_matrix),u_world:new l.Uniform2f(d,r.u_world),u_image:new l.Uniform1i(d,r.u_image),u_color_ramp:new l.Uniform1i(d,r.u_color_ramp),u_opacity:new l.Uniform1f(d,r.u_opacity)}),hillshade:(d,r)=>({u_matrix:new l.UniformMatrix4f(d,r.u_matrix),u_image:new l.Uniform1i(d,r.u_image),u_latrange:new l.Uniform2f(d,r.u_latrange),u_light:new l.Uniform2f(d,r.u_light),u_shadow:new l.UniformColor(d,r.u_shadow),u_highlight:new l.UniformColor(d,r.u_highlight),u_accent:new l.UniformColor(d,r.u_accent)}),hillshadePrepare:(d,r)=>({u_matrix:new l.UniformMatrix4f(d,r.u_matrix),u_image:new l.Uniform1i(d,r.u_image),u_dimension:new l.Uniform2f(d,r.u_dimension),u_zoom:new l.Uniform1f(d,r.u_zoom),u_unpack:new l.Uniform4f(d,r.u_unpack)}),line:(d,r)=>({u_matrix:new l.UniformMatrix4f(d,r.u_matrix),u_ratio:new l.Uniform1f(d,r.u_ratio),u_device_pixel_ratio:new l.Uniform1f(d,r.u_device_pixel_ratio),u_units_to_pixels:new l.Uniform2f(d,r.u_units_to_pixels)}),lineGradient:(d,r)=>({u_matrix:new l.UniformMatrix4f(d,r.u_matrix),u_ratio:new l.Uniform1f(d,r.u_ratio),u_device_pixel_ratio:new l.Uniform1f(d,r.u_device_pixel_ratio),u_units_to_pixels:new l.Uniform2f(d,r.u_units_to_pixels),u_image:new l.Uniform1i(d,r.u_image),u_image_height:new l.Uniform1f(d,r.u_image_height)}),linePattern:(d,r)=>({u_matrix:new l.UniformMatrix4f(d,r.u_matrix),u_texsize:new l.Uniform2f(d,r.u_texsize),u_ratio:new l.Uniform1f(d,r.u_ratio),u_device_pixel_ratio:new l.Uniform1f(d,r.u_device_pixel_ratio),u_image:new l.Uniform1i(d,r.u_image),u_units_to_pixels:new l.Uniform2f(d,r.u_units_to_pixels),u_scale:new l.Uniform3f(d,r.u_scale),u_fade:new l.Uniform1f(d,r.u_fade)}),lineSDF:(d,r)=>({u_matrix:new l.UniformMatrix4f(d,r.u_matrix),u_ratio:new l.Uniform1f(d,r.u_ratio),u_device_pixel_ratio:new l.Uniform1f(d,r.u_device_pixel_ratio),u_units_to_pixels:new l.Uniform2f(d,r.u_units_to_pixels),u_patternscale_a:new l.Uniform2f(d,r.u_patternscale_a),u_patternscale_b:new l.Uniform2f(d,r.u_patternscale_b),u_sdfgamma:new l.Uniform1f(d,r.u_sdfgamma),u_image:new l.Uniform1i(d,r.u_image),u_tex_y_a:new l.Uniform1f(d,r.u_tex_y_a),u_tex_y_b:new l.Uniform1f(d,r.u_tex_y_b),u_mix:new l.Uniform1f(d,r.u_mix)}),raster:(d,r)=>({u_matrix:new l.UniformMatrix4f(d,r.u_matrix),u_tl_parent:new l.Uniform2f(d,r.u_tl_parent),u_scale_parent:new l.Uniform1f(d,r.u_scale_parent),u_buffer_scale:new l.Uniform1f(d,r.u_buffer_scale),u_fade_t:new l.Uniform1f(d,r.u_fade_t),u_opacity:new l.Uniform1f(d,r.u_opacity),u_image0:new l.Uniform1i(d,r.u_image0),u_image1:new l.Uniform1i(d,r.u_image1),u_brightness_low:new l.Uniform1f(d,r.u_brightness_low),u_brightness_high:new l.Uniform1f(d,r.u_brightness_high),u_saturation_factor:new l.Uniform1f(d,r.u_saturation_factor),u_contrast_factor:new l.Uniform1f(d,r.u_contrast_factor),u_spin_weights:new l.Uniform3f(d,r.u_spin_weights)}),symbolIcon:(d,r)=>({u_is_size_zoom_constant:new l.Uniform1i(d,r.u_is_size_zoom_constant),u_is_size_feature_constant:new l.Uniform1i(d,r.u_is_size_feature_constant),u_size_t:new l.Uniform1f(d,r.u_size_t),u_size:new l.Uniform1f(d,r.u_size),u_camera_to_center_distance:new l.Uniform1f(d,r.u_camera_to_center_distance),u_pitch:new l.Uniform1f(d,r.u_pitch),u_rotate_symbol:new l.Uniform1i(d,r.u_rotate_symbol),u_aspect_ratio:new l.Uniform1f(d,r.u_aspect_ratio),u_fade_change:new l.Uniform1f(d,r.u_fade_change),u_matrix:new l.UniformMatrix4f(d,r.u_matrix),u_label_plane_matrix:new l.UniformMatrix4f(d,r.u_label_plane_matrix),u_coord_matrix:new l.UniformMatrix4f(d,r.u_coord_matrix),u_is_text:new l.Uniform1i(d,r.u_is_text),u_pitch_with_map:new l.Uniform1i(d,r.u_pitch_with_map),u_texsize:new l.Uniform2f(d,r.u_texsize),u_texture:new l.Uniform1i(d,r.u_texture)}),symbolSDF:(d,r)=>({u_is_size_zoom_constant:new l.Uniform1i(d,r.u_is_size_zoom_constant),u_is_size_feature_constant:new l.Uniform1i(d,r.u_is_size_feature_constant),u_size_t:new l.Uniform1f(d,r.u_size_t),u_size:new l.Uniform1f(d,r.u_size),u_camera_to_center_distance:new l.Uniform1f(d,r.u_camera_to_center_distance),u_pitch:new l.Uniform1f(d,r.u_pitch),u_rotate_symbol:new l.Uniform1i(d,r.u_rotate_symbol),u_aspect_ratio:new l.Uniform1f(d,r.u_aspect_ratio),u_fade_change:new l.Uniform1f(d,r.u_fade_change),u_matrix:new l.UniformMatrix4f(d,r.u_matrix),u_label_plane_matrix:new l.UniformMatrix4f(d,r.u_label_plane_matrix),u_coord_matrix:new l.UniformMatrix4f(d,r.u_coord_matrix),u_is_text:new l.Uniform1i(d,r.u_is_text),u_pitch_with_map:new l.Uniform1i(d,r.u_pitch_with_map),u_texsize:new l.Uniform2f(d,r.u_texsize),u_texture:new l.Uniform1i(d,r.u_texture),u_gamma_scale:new l.Uniform1f(d,r.u_gamma_scale),u_device_pixel_ratio:new l.Uniform1f(d,r.u_device_pixel_ratio),u_is_halo:new l.Uniform1i(d,r.u_is_halo)}),symbolTextAndIcon:(d,r)=>({u_is_size_zoom_constant:new l.Uniform1i(d,r.u_is_size_zoom_constant),u_is_size_feature_constant:new l.Uniform1i(d,r.u_is_size_feature_constant),u_size_t:new l.Uniform1f(d,r.u_size_t),u_size:new l.Uniform1f(d,r.u_size),u_camera_to_center_distance:new l.Uniform1f(d,r.u_camera_to_center_distance),u_pitch:new l.Uniform1f(d,r.u_pitch),u_rotate_symbol:new l.Uniform1i(d,r.u_rotate_symbol),u_aspect_ratio:new l.Uniform1f(d,r.u_aspect_ratio),u_fade_change:new l.Uniform1f(d,r.u_fade_change),u_matrix:new l.UniformMatrix4f(d,r.u_matrix),u_label_plane_matrix:new l.UniformMatrix4f(d,r.u_label_plane_matrix),u_coord_matrix:new l.UniformMatrix4f(d,r.u_coord_matrix),u_is_text:new l.Uniform1i(d,r.u_is_text),u_pitch_with_map:new l.Uniform1i(d,r.u_pitch_with_map),u_texsize:new l.Uniform2f(d,r.u_texsize),u_texsize_icon:new l.Uniform2f(d,r.u_texsize_icon),u_texture:new l.Uniform1i(d,r.u_texture),u_texture_icon:new l.Uniform1i(d,r.u_texture_icon),u_gamma_scale:new l.Uniform1f(d,r.u_gamma_scale),u_device_pixel_ratio:new l.Uniform1f(d,r.u_device_pixel_ratio),u_is_halo:new l.Uniform1i(d,r.u_is_halo)}),background:(d,r)=>({u_matrix:new l.UniformMatrix4f(d,r.u_matrix),u_opacity:new l.Uniform1f(d,r.u_opacity),u_color:new l.UniformColor(d,r.u_color)}),backgroundPattern:(d,r)=>({u_matrix:new l.UniformMatrix4f(d,r.u_matrix),u_opacity:new l.Uniform1f(d,r.u_opacity),u_image:new l.Uniform1i(d,r.u_image),u_pattern_tl_a:new l.Uniform2f(d,r.u_pattern_tl_a),u_pattern_br_a:new l.Uniform2f(d,r.u_pattern_br_a),u_pattern_tl_b:new l.Uniform2f(d,r.u_pattern_tl_b),u_pattern_br_b:new l.Uniform2f(d,r.u_pattern_br_b),u_texsize:new l.Uniform2f(d,r.u_texsize),u_mix:new l.Uniform1f(d,r.u_mix),u_pattern_size_a:new l.Uniform2f(d,r.u_pattern_size_a),u_pattern_size_b:new l.Uniform2f(d,r.u_pattern_size_b),u_scale_a:new l.Uniform1f(d,r.u_scale_a),u_scale_b:new l.Uniform1f(d,r.u_scale_b),u_pixel_coord_upper:new l.Uniform2f(d,r.u_pixel_coord_upper),u_pixel_coord_lower:new l.Uniform2f(d,r.u_pixel_coord_lower),u_tile_units_to_pixels:new l.Uniform1f(d,r.u_tile_units_to_pixels)}),terrain:(d,r)=>({u_matrix:new l.UniformMatrix4f(d,r.u_matrix),u_texture:new l.Uniform1i(d,r.u_texture)}),terrainDepth:(d,r)=>({u_matrix:new l.UniformMatrix4f(d,r.u_matrix)}),terrainCoords:(d,r)=>({u_matrix:new l.UniformMatrix4f(d,r.u_matrix),u_texture:new l.Uniform1i(d,r.u_texture),u_terrain_coords_id:new l.Uniform1f(d,r.u_terrain_coords_id)})};class Uo{constructor(r,s,c){this.context=r;const p=r.gl;this.buffer=p.createBuffer(),this.dynamicDraw=!!c,this.context.unbindVAO(),r.bindElementBuffer.set(this.buffer),p.bufferData(p.ELEMENT_ARRAY_BUFFER,s.arrayBuffer,this.dynamicDraw?p.DYNAMIC_DRAW:p.STATIC_DRAW),this.dynamicDraw||delete s.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(r){const s=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),s.bufferSubData(s.ELEMENT_ARRAY_BUFFER,0,r.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Kl={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Yl{constructor(r,s,c,p){this.length=s.length,this.attributes=c,this.itemSize=s.bytesPerElement,this.dynamicDraw=p,this.context=r;const _=r.gl;this.buffer=_.createBuffer(),r.bindVertexBuffer.set(this.buffer),_.bufferData(_.ARRAY_BUFFER,s.arrayBuffer,this.dynamicDraw?_.DYNAMIC_DRAW:_.STATIC_DRAW),this.dynamicDraw||delete s.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(r){if(r.length!==this.length)throw new Error(`Length of new data is ${r.length}, which doesn't match current length of ${this.length}`);const s=this.context.gl;this.bind(),s.bufferSubData(s.ARRAY_BUFFER,0,r.arrayBuffer)}enableAttributes(r,s){for(let c=0;c<this.attributes.length;c++){const p=s.attributes[this.attributes[c].name];p!==void 0&&r.enableVertexAttribArray(p)}}setVertexAttribPointers(r,s,c){for(let p=0;p<this.attributes.length;p++){const _=this.attributes[p],S=s.attributes[_.name];S!==void 0&&r.vertexAttribPointer(S,_.components,r[Kl[_.type]],!1,this.itemSize,_.offset+this.itemSize*(c||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class yr{constructor(r){this.gl=r.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(r){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Uu extends yr{getDefault(){return l.Color.transparent}set(r){const s=this.current;(r.r!==s.r||r.g!==s.g||r.b!==s.b||r.a!==s.a||this.dirty)&&(this.gl.clearColor(r.r,r.g,r.b,r.a),this.current=r,this.dirty=!1)}}class ra extends yr{getDefault(){return 1}set(r){(r!==this.current||this.dirty)&&(this.gl.clearDepth(r),this.current=r,this.dirty=!1)}}class Zi extends yr{getDefault(){return 0}set(r){(r!==this.current||this.dirty)&&(this.gl.clearStencil(r),this.current=r,this.dirty=!1)}}class ps extends yr{getDefault(){return[!0,!0,!0,!0]}set(r){const s=this.current;(r[0]!==s[0]||r[1]!==s[1]||r[2]!==s[2]||r[3]!==s[3]||this.dirty)&&(this.gl.colorMask(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)}}class yn extends yr{getDefault(){return!0}set(r){(r!==this.current||this.dirty)&&(this.gl.depthMask(r),this.current=r,this.dirty=!1)}}class ms extends yr{getDefault(){return 255}set(r){(r!==this.current||this.dirty)&&(this.gl.stencilMask(r),this.current=r,this.dirty=!1)}}class il extends yr{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(r){const s=this.current;(r.func!==s.func||r.ref!==s.ref||r.mask!==s.mask||this.dirty)&&(this.gl.stencilFunc(r.func,r.ref,r.mask),this.current=r,this.dirty=!1)}}class ol extends yr{getDefault(){const r=this.gl;return[r.KEEP,r.KEEP,r.KEEP]}set(r){const s=this.current;(r[0]!==s[0]||r[1]!==s[1]||r[2]!==s[2]||this.dirty)&&(this.gl.stencilOp(r[0],r[1],r[2]),this.current=r,this.dirty=!1)}}class na extends yr{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const s=this.gl;r?s.enable(s.STENCIL_TEST):s.disable(s.STENCIL_TEST),this.current=r,this.dirty=!1}}class gs extends yr{getDefault(){return[0,1]}set(r){const s=this.current;(r[0]!==s[0]||r[1]!==s[1]||this.dirty)&&(this.gl.depthRange(r[0],r[1]),this.current=r,this.dirty=!1)}}class ys extends yr{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const s=this.gl;r?s.enable(s.DEPTH_TEST):s.disable(s.DEPTH_TEST),this.current=r,this.dirty=!1}}class sl extends yr{getDefault(){return this.gl.LESS}set(r){(r!==this.current||this.dirty)&&(this.gl.depthFunc(r),this.current=r,this.dirty=!1)}}class Ri extends yr{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const s=this.gl;r?s.enable(s.BLEND):s.disable(s.BLEND),this.current=r,this.dirty=!1}}class _s extends yr{getDefault(){const r=this.gl;return[r.ONE,r.ZERO]}set(r){const s=this.current;(r[0]!==s[0]||r[1]!==s[1]||this.dirty)&&(this.gl.blendFunc(r[0],r[1]),this.current=r,this.dirty=!1)}}class ia extends yr{getDefault(){return l.Color.transparent}set(r){const s=this.current;(r.r!==s.r||r.g!==s.g||r.b!==s.b||r.a!==s.a||this.dirty)&&(this.gl.blendColor(r.r,r.g,r.b,r.a),this.current=r,this.dirty=!1)}}class Jl extends yr{getDefault(){return this.gl.FUNC_ADD}set(r){(r!==this.current||this.dirty)&&(this.gl.blendEquation(r),this.current=r,this.dirty=!1)}}class qi extends yr{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const s=this.gl;r?s.enable(s.CULL_FACE):s.disable(s.CULL_FACE),this.current=r,this.dirty=!1}}class al extends yr{getDefault(){return this.gl.BACK}set(r){(r!==this.current||this.dirty)&&(this.gl.cullFace(r),this.current=r,this.dirty=!1)}}class ju extends yr{getDefault(){return this.gl.CCW}set(r){(r!==this.current||this.dirty)&&(this.gl.frontFace(r),this.current=r,this.dirty=!1)}}class ri extends yr{getDefault(){return null}set(r){(r!==this.current||this.dirty)&&(this.gl.useProgram(r),this.current=r,this.dirty=!1)}}class vs extends yr{getDefault(){return this.gl.TEXTURE0}set(r){(r!==this.current||this.dirty)&&(this.gl.activeTexture(r),this.current=r,this.dirty=!1)}}class Ql extends yr{getDefault(){const r=this.gl;return[0,0,r.drawingBufferWidth,r.drawingBufferHeight]}set(r){const s=this.current;(r[0]!==s[0]||r[1]!==s[1]||r[2]!==s[2]||r[3]!==s[3]||this.dirty)&&(this.gl.viewport(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)}}class oa extends yr{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const s=this.gl;s.bindFramebuffer(s.FRAMEBUFFER,r),this.current=r,this.dirty=!1}}class eu extends yr{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const s=this.gl;s.bindRenderbuffer(s.RENDERBUFFER,r),this.current=r,this.dirty=!1}}class xs extends yr{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const s=this.gl;s.bindTexture(s.TEXTURE_2D,r),this.current=r,this.dirty=!1}}class sa extends yr{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const s=this.gl;s.bindBuffer(s.ARRAY_BUFFER,r),this.current=r,this.dirty=!1}}class jo extends yr{getDefault(){return null}set(r){const s=this.gl;s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,r),this.current=r,this.dirty=!1}}class Wi extends yr{constructor(r){super(r),this.vao=r.extVertexArrayObject}getDefault(){return null}set(r){this.vao&&(r!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(r),this.current=r,this.dirty=!1)}}class tu extends yr{getDefault(){return 4}set(r){if(r===this.current&&!this.dirty)return;const s=this.gl;s.pixelStorei(s.UNPACK_ALIGNMENT,r),this.current=r,this.dirty=!1}}class Vu extends yr{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const s=this.gl;s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r),this.current=r,this.dirty=!1}}class ru extends yr{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const s=this.gl;s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,r),this.current=r,this.dirty=!1}}class co extends yr{constructor(r,s){super(r),this.context=r,this.parent=s}getDefault(){return null}}class ll extends co{setDirty(){this.dirty=!0}set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const s=this.gl;s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,r,0),this.current=r,this.dirty=!1}}class ws extends co{set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const s=this.gl;s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_ATTACHMENT,s.RENDERBUFFER,r),this.current=r,this.dirty=!1}}class bs{constructor(r,s,c,p){this.context=r,this.width=s,this.height=c;const _=r.gl,S=this.framebuffer=_.createFramebuffer();if(this.colorAttachment=new ll(r,S),p&&(this.depthAttachment=new ws(r,S)),_.checkFramebufferStatus(_.FRAMEBUFFER)!==_.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const r=this.context.gl,s=this.colorAttachment.get();if(s&&r.deleteTexture(s),this.depthAttachment){const c=this.depthAttachment.get();c&&r.deleteRenderbuffer(c)}r.deleteFramebuffer(this.framebuffer)}}class Jr{constructor(r,s,c){this.blendFunction=r,this.blendColor=s,this.mask=c}}Jr.Replace=[1,0],Jr.disabled=new Jr(Jr.Replace,l.Color.transparent,[!1,!1,!1,!1]),Jr.unblended=new Jr(Jr.Replace,l.Color.transparent,[!0,!0,!0,!0]),Jr.alphaBlended=new Jr([1,771],l.Color.transparent,[!0,!0,!0,!0]);class nu{constructor(r){this.gl=r,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new Uu(this),this.clearDepth=new ra(this),this.clearStencil=new Zi(this),this.colorMask=new ps(this),this.depthMask=new yn(this),this.stencilMask=new ms(this),this.stencilFunc=new il(this),this.stencilOp=new ol(this),this.stencilTest=new na(this),this.depthRange=new gs(this),this.depthTest=new ys(this),this.depthFunc=new sl(this),this.blend=new Ri(this),this.blendFunc=new _s(this),this.blendColor=new ia(this),this.blendEquation=new Jl(this),this.cullFace=new qi(this),this.cullFaceSide=new al(this),this.frontFace=new ju(this),this.program=new ri(this),this.activeTexture=new vs(this),this.viewport=new Ql(this),this.bindFramebuffer=new oa(this),this.bindRenderbuffer=new eu(this),this.bindTexture=new xs(this),this.bindVertexBuffer=new sa(this),this.bindElementBuffer=new jo(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new Wi(this),this.pixelStoreUnpack=new tu(this),this.pixelStoreUnpackPremultiplyAlpha=new Vu(this),this.pixelStoreUnpackFlipY=new ru(this),this.extTextureFilterAnisotropic=r.getExtension("EXT_texture_filter_anisotropic")||r.getExtension("MOZ_EXT_texture_filter_anisotropic")||r.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=r.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=r.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(r.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=r.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=r.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=r.getParameter(r.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(r,s){return new Uo(this,r,s)}createVertexBuffer(r,s,c){return new Yl(this,r,s,c)}createRenderbuffer(r,s,c){const p=this.gl,_=p.createRenderbuffer();return this.bindRenderbuffer.set(_),p.renderbufferStorage(p.RENDERBUFFER,r,s,c),this.bindRenderbuffer.set(null),_}createFramebuffer(r,s,c){return new bs(this,r,s,c)}clear({color:r,depth:s}){const c=this.gl;let p=0;r&&(p|=c.COLOR_BUFFER_BIT,this.clearColor.set(r),this.colorMask.set([!0,!0,!0,!0])),s!==void 0&&(p|=c.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(s),this.depthMask.set(!0)),c.clear(p)}setCullFace(r){r.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(r.mode),this.frontFace.set(r.frontFace))}setDepthMode(r){r.func!==this.gl.ALWAYS||r.mask?(this.depthTest.set(!0),this.depthFunc.set(r.func),this.depthMask.set(r.mask),this.depthRange.set(r.range)):this.depthTest.set(!1)}setStencilMode(r){r.test.func!==this.gl.ALWAYS||r.mask?(this.stencilTest.set(!0),this.stencilMask.set(r.mask),this.stencilOp.set([r.fail,r.depthFail,r.pass]),this.stencilFunc.set({func:r.test.func,ref:r.ref,mask:r.test.mask})):this.stencilTest.set(!1)}setColorMode(r){$(r.blendFunction,Jr.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(r.blendFunction),this.blendColor.set(r.blendColor)),this.colorMask.set(r.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class Bt{constructor(r,s,c){this.func=r,this.mask=s,this.range=c}}Bt.ReadOnly=!1,Bt.ReadWrite=!0,Bt.disabled=new Bt(519,Bt.ReadOnly,[0,1]);const Vo=7680;class Gr{constructor(r,s,c,p,_,S){this.test=r,this.ref=s,this.mask=c,this.fail=p,this.depthFail=_,this.pass=S}}Gr.disabled=new Gr({func:519,mask:0},0,0,Vo,Vo,Vo);class Br{constructor(r,s,c){this.enable=r,this.mode=s,this.frontFace=c}}let ho;function $u(d,r,s,c,p,_,S){const k=d.context,A=k.gl,M=d.useProgram("collisionBox"),F=[];let q=0,H=0;for(let he=0;he<c.length;he++){const Ve=c[he],Oe=r.getTile(Ve),Xe=Oe.getBucket(s);if(!Xe)continue;let rt=Ve.posMatrix;p[0]===0&&p[1]===0||(rt=d.translatePosMatrix(Ve.posMatrix,Oe,p,_));const pt=S?Xe.textCollisionBox:Xe.iconCollisionBox,et=Xe.collisionCircleArray;if(et.length>0){const It=l.create(),wt=rt;l.mul(It,Xe.placementInvProjMatrix,d.transform.glCoordMatrix),l.mul(It,It,Xe.placementViewportMatrix),F.push({circleArray:et,circleOffset:H,transform:wt,invTransform:It,coord:Ve}),q+=et.length/4,H=q}pt&&M.draw(k,A.LINES,Bt.disabled,Gr.disabled,d.colorModeForRenderPass(),Br.disabled,rl(rt,d.transform,Oe),d.style.terrain&&d.style.terrain.getTerrainData(Ve),s.id,pt.layoutVertexBuffer,pt.indexBuffer,pt.segments,null,d.transform.zoom,null,null,pt.collisionVertexBuffer)}if(!S||!F.length)return;const le=d.useProgram("collisionCircle"),te=new l.CollisionCircleLayoutArray;te.resize(4*q),te._trim();let ee=0;for(const he of F)for(let Ve=0;Ve<he.circleArray.length/4;Ve++){const Oe=4*Ve,Xe=he.circleArray[Oe+0],rt=he.circleArray[Oe+1],pt=he.circleArray[Oe+2],et=he.circleArray[Oe+3];te.emplace(ee++,Xe,rt,pt,et,0),te.emplace(ee++,Xe,rt,pt,et,1),te.emplace(ee++,Xe,rt,pt,et,2),te.emplace(ee++,Xe,rt,pt,et,3)}(!ho||ho.length<2*q)&&(ho=function(he){const Ve=2*he,Oe=new l.QuadTriangleArray;Oe.resize(Ve),Oe._trim();for(let Xe=0;Xe<Ve;Xe++){const rt=6*Xe;Oe.uint16[rt+0]=4*Xe+0,Oe.uint16[rt+1]=4*Xe+1,Oe.uint16[rt+2]=4*Xe+2,Oe.uint16[rt+3]=4*Xe+2,Oe.uint16[rt+4]=4*Xe+3,Oe.uint16[rt+5]=4*Xe+0}return Oe}(q));const ye=k.createIndexBuffer(ho,!0),Ae=k.createVertexBuffer(te,l.collisionCircleLayout.members,!0);for(const he of F){const Ve={u_matrix:he.transform,u_inv_matrix:he.invTransform,u_camera_to_center_distance:(Pe=d.transform).cameraToCenterDistance,u_viewport_size:[Pe.width,Pe.height]};le.draw(k,A.TRIANGLES,Bt.disabled,Gr.disabled,d.colorModeForRenderPass(),Br.disabled,Ve,d.style.terrain&&d.style.terrain.getTerrainData(he.coord),s.id,Ae,ye,l.SegmentVector.simpleSegment(0,2*he.circleOffset,he.circleArray.length,he.circleArray.length/2),null,d.transform.zoom,null,null,null)}var Pe;Ae.destroy(),ye.destroy()}Br.disabled=new Br(!1,1029,2305),Br.backCCW=new Br(!0,1029,2305);const iu=l.identity(new Float32Array(16));function Gu(d,r,s,c,p,_){const{horizontalAlign:S,verticalAlign:k}=l.getAnchorAlignment(d),A=-(S-.5)*r,M=-(k-.5)*s,F=l.evaluateVariableOffset(d,c);return new l.pointGeometry((A/p+F[0])*_,(M/p+F[1])*_)}function Wc(d,r,s,c,p,_,S,k,A,M,F){const q=d.text.placedSymbolArray,H=d.text.dynamicLayoutVertexArray,le=d.icon.dynamicLayoutVertexArray,te={};H.clear();for(let ee=0;ee<q.length;ee++){const ye=q.get(ee),Ae=d.allowVerticalPlacement&&!ye.placedOrientation,Pe=ye.hidden||!ye.crossTileID||Ae?null:c[ye.crossTileID];if(Pe){const he=new l.pointGeometry(ye.anchorX,ye.anchorY),Ve=vr(he,s?S:_,F),Oe=Qt(p.cameraToCenterDistance,Ve.signedDistanceFromCamera);let Xe=l.evaluateSizeForFeature(d.textSizeData,A,ye)*Oe/l.ONE_EM;s&&(Xe*=d.tilePixelRatio/k);const{width:rt,height:pt,anchor:et,textOffset:It,textBoxScale:wt}=Pe,Tt=Gu(et,rt,pt,It,wt,Xe),Ht=s?vr(he.add(Tt),_,F).point:Ve.point.add(r?Tt.rotate(-p.angle):Tt),Jt=d.allowVerticalPlacement&&ye.placedOrientation===l.WritingMode.vertical?Math.PI/2:0;for(let jt=0;jt<ye.numGlyphs;jt++)l.addDynamicAttributes(H,Ht,Jt);M&&ye.associatedIconIndex>=0&&(te[ye.associatedIconIndex]={shiftedAnchor:Ht,angle:Jt})}else gr(ye.numGlyphs,H)}if(M){le.clear();const ee=d.icon.placedSymbolArray;for(let ye=0;ye<ee.length;ye++){const Ae=ee.get(ye);if(Ae.hidden)gr(Ae.numGlyphs,le);else{const Pe=te[ye];if(Pe)for(let he=0;he<Ae.numGlyphs;he++)l.addDynamicAttributes(le,Pe.shiftedAnchor,Pe.angle);else gr(Ae.numGlyphs,le)}}d.icon.dynamicLayoutVertexBuffer.updateData(le)}d.text.dynamicLayoutVertexBuffer.updateData(H)}function ou(d,r,s){return s.iconsInText&&r?"symbolTextAndIcon":d?"symbolSDF":"symbolIcon"}function Ss(d,r,s,c,p,_,S,k,A,M,F,q){const H=d.context,le=H.gl,te=d.transform,ee=k==="map",ye=A==="map",Ae=k!=="viewport"&&s.layout.get("symbol-placement")!=="point",Pe=ee&&!ye&&!Ae,he=!s.layout.get("symbol-sort-key").isConstant();let Ve=!1;const Oe=d.depthModeForSublayer(0,Bt.ReadOnly),Xe=s.layout.get("text-variable-anchor"),rt=[];for(const pt of c){const et=r.getTile(pt),It=et.getBucket(s);if(!It)continue;const wt=p?It.text:It.icon;if(!wt||!wt.segments.get().length)continue;const Tt=wt.programConfigurations.get(s.id),Ht=p||It.sdfIcons,Jt=p?It.textSizeData:It.iconSizeData,jt=ye||te.pitch!==0,Ir=d.useProgram(ou(Ht,p,It),Tt),cr=l.evaluateSizeForZoom(Jt,te.zoom),ir=d.style.terrain&&d.style.terrain.getTerrainData(pt);let ar,hr,Rn,on,Qr=[0,0],Sn=null;if(p){if(hr=et.glyphAtlasTexture,Rn=le.LINEAR,ar=et.glyphAtlasTexture.size,It.iconsInText){Qr=et.imageAtlasTexture.size,Sn=et.imageAtlasTexture;const ii=Jt.kind==="composite"||Jt.kind==="camera";on=jt||d.options.rotating||d.options.zooming||ii?le.LINEAR:le.NEAREST}}else{const ii=s.layout.get("icon-size").constantOr(0)!==1||It.iconsNeedLinear;hr=et.imageAtlasTexture,Rn=Ht||d.options.rotating||d.options.zooming||ii||jt?le.LINEAR:le.NEAREST,ar=et.imageAtlasTexture.size}const $n=lr(et,1,d.transform.zoom),jr=kr(pt.posMatrix,ye,ee,d.transform,$n),En=Wt(pt.posMatrix,ye,ee,d.transform,$n),So=Xe&&It.hasTextData(),Ps=s.layout.get("icon-text-fit")!=="none"&&So&&It.hasIconData();if(Ae){const ii=d.style.terrain?(To,wa)=>d.style.terrain.getElevation(pt,To,wa):null,Eo=s.layout.get("text-rotation-alignment")==="map";Rr(It,pt.posMatrix,d,p,jr,En,ye,M,Eo,ii)}const mr=d.translatePosMatrix(pt.posMatrix,et,_,S),dr=Ae||p&&Xe||Ps?iu:jr,Yt=d.translatePosMatrix(En,et,_,S,!0),nr=Ht&&s.paint.get(p?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Zr;Zr=Ht?It.iconsInText?ta(Jt.kind,cr,Pe,ye,d,mr,dr,Yt,ar,Qr):No(Jt.kind,cr,Pe,ye,d,mr,dr,Yt,p,ar):vi(Jt.kind,cr,Pe,ye,d,mr,dr,Yt,p,ar);const Fr={program:Ir,buffers:wt,uniformValues:Zr,atlasTexture:hr,atlasTextureIcon:Sn,atlasInterpolation:Rn,atlasInterpolationIcon:on,isSDF:Ht,hasHalo:nr};if(he&&It.canOverlap){Ve=!0;const ii=wt.segments.get();for(const Eo of ii)rt.push({segments:new l.SegmentVector([Eo]),sortKey:Eo.sortKey,state:Fr,terrainData:ir})}else rt.push({segments:wt.segments,sortKey:0,state:Fr,terrainData:ir})}Ve&&rt.sort((pt,et)=>pt.sortKey-et.sortKey);for(const pt of rt){const et=pt.state;if(H.activeTexture.set(le.TEXTURE0),et.atlasTexture.bind(et.atlasInterpolation,le.CLAMP_TO_EDGE),et.atlasTextureIcon&&(H.activeTexture.set(le.TEXTURE1),et.atlasTextureIcon&&et.atlasTextureIcon.bind(et.atlasInterpolationIcon,le.CLAMP_TO_EDGE)),et.isSDF){const It=et.uniformValues;et.hasHalo&&(It.u_is_halo=1,aa(et.buffers,pt.segments,s,d,et.program,Oe,F,q,It,pt.terrainData)),It.u_is_halo=0}aa(et.buffers,pt.segments,s,d,et.program,Oe,F,q,et.uniformValues,pt.terrainData)}}function aa(d,r,s,c,p,_,S,k,A,M){const F=c.context;p.draw(F,F.gl.TRIANGLES,_,S,k,Br.disabled,A,M,s.id,d.layoutVertexBuffer,d.indexBuffer,r,s.paint,c.transform.zoom,d.programConfigurations.get(s.id),d.dynamicLayoutVertexBuffer,d.opacityVertexBuffer)}function ul(d,r,s,c,p,_,S){const k=d.context.gl,A=s.paint.get("fill-pattern"),M=A&&A.constantOr(1),F=s.getCrossfadeParameters();let q,H,le,te,ee;S?(H=M&&!s.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",q=k.LINES):(H=M?"fillPattern":"fill",q=k.TRIANGLES);for(const ye of c){const Ae=r.getTile(ye);if(M&&!Ae.patternsLoaded())continue;const Pe=Ae.getBucket(s);if(!Pe)continue;const he=Pe.programConfigurations.get(s.id),Ve=d.useProgram(H,he),Oe=d.style.terrain&&d.style.terrain.getTerrainData(ye);M&&(d.context.activeTexture.set(k.TEXTURE0),Ae.imageAtlasTexture.bind(k.LINEAR,k.CLAMP_TO_EDGE),he.updatePaintBuffers(F));const Xe=A.constantOr(null);if(Xe&&Ae.imageAtlas){const et=Ae.imageAtlas,It=et.patternPositions[Xe.to.toString()],wt=et.patternPositions[Xe.from.toString()];It&&wt&&he.setConstantPatternPositions(It,wt)}const rt=Oe?ye:null,pt=d.translatePosMatrix(rt?rt.posMatrix:ye.posMatrix,Ae,s.paint.get("fill-translate"),s.paint.get("fill-translate-anchor"));if(S){te=Pe.indexBuffer2,ee=Pe.segments2;const et=[k.drawingBufferWidth,k.drawingBufferHeight];le=H==="fillOutlinePattern"&&M?tl(pt,d,F,Ae,et):Hl(pt,et)}else te=Pe.indexBuffer,ee=Pe.segments,le=M?Ys(pt,d,F,Ae):Wl(pt);Ve.draw(d.context,q,p,d.stencilModeForClipping(ye),_,Br.disabled,le,Oe,s.id,Pe.layoutVertexBuffer,te,ee,s.paint,d.transform.zoom,he)}}function la(d,r,s,c,p,_,S){const k=d.context,A=k.gl,M=s.paint.get("fill-extrusion-pattern"),F=M.constantOr(1),q=s.getCrossfadeParameters(),H=s.paint.get("fill-extrusion-opacity");for(const le of c){const te=r.getTile(le),ee=te.getBucket(s);if(!ee)continue;const ye=d.style.terrain&&d.style.terrain.getTerrainData(le),Ae=ee.programConfigurations.get(s.id),Pe=d.useProgram(F?"fillExtrusionPattern":"fillExtrusion",Ae);F&&(d.context.activeTexture.set(A.TEXTURE0),te.imageAtlasTexture.bind(A.LINEAR,A.CLAMP_TO_EDGE),Ae.updatePaintBuffers(q));const he=M.constantOr(null);if(he&&te.imageAtlas){const rt=te.imageAtlas,pt=rt.patternPositions[he.to.toString()],et=rt.patternPositions[he.from.toString()];pt&&et&&Ae.setConstantPatternPositions(pt,et)}const Ve=d.translatePosMatrix(le.posMatrix,te,s.paint.get("fill-extrusion-translate"),s.paint.get("fill-extrusion-translate-anchor")),Oe=s.paint.get("fill-extrusion-vertical-gradient"),Xe=F?ql(Ve,d,Oe,H,le,q,te):Ks(Ve,d,Oe,H);Pe.draw(k,k.gl.TRIANGLES,p,_,S,Br.backCCW,Xe,ye,s.id,ee.layoutVertexBuffer,ee.indexBuffer,ee.segments,s.paint,d.transform.zoom,Ae,d.style.terrain&&ee.centroidVertexBuffer)}}function Zu(d,r,s,c,p,_,S){const k=d.context,A=k.gl,M=s.fbo;if(!M)return;const F=d.useProgram("hillshade"),q=d.style.terrain&&d.style.terrain.getTerrainData(r);k.activeTexture.set(A.TEXTURE0),A.bindTexture(A.TEXTURE_2D,M.colorAttachment.get()),F.draw(k,A.TRIANGLES,p,_,S,Br.disabled,((H,le,te,ee)=>{const ye=te.paint.get("hillshade-shadow-color"),Ae=te.paint.get("hillshade-highlight-color"),Pe=te.paint.get("hillshade-accent-color");let he=te.paint.get("hillshade-illumination-direction")*(Math.PI/180);te.paint.get("hillshade-illumination-anchor")==="viewport"&&(he-=H.transform.angle);const Ve=!H.options.moving;return{u_matrix:ee?ee.posMatrix:H.transform.calculatePosMatrix(le.tileID.toUnwrapped(),Ve),u_image:0,u_latrange:Qs(0,le.tileID),u_light:[te.paint.get("hillshade-exaggeration"),he],u_shadow:ye,u_highlight:Ae,u_accent:Pe}})(d,s,c,q?r:null),q,c.id,d.rasterBoundsBuffer,d.quadTriangleIndexBuffer,d.rasterBoundsSegments)}function cl(d,r,s,c,p,_){const S=d.context,k=S.gl,A=r.dem;if(A&&A.data){const M=A.dim,F=A.stride,q=A.getPixels();if(S.activeTexture.set(k.TEXTURE1),S.pixelStoreUnpackPremultiplyAlpha.set(!1),r.demTexture=r.demTexture||d.getTileTexture(F),r.demTexture){const le=r.demTexture;le.update(q,{premultiply:!1}),le.bind(k.NEAREST,k.CLAMP_TO_EDGE)}else r.demTexture=new V(S,q,k.RGBA,{premultiply:!1}),r.demTexture.bind(k.NEAREST,k.CLAMP_TO_EDGE);S.activeTexture.set(k.TEXTURE0);let H=r.fbo;if(!H){const le=new V(S,{width:M,height:M,data:null},k.RGBA);le.bind(k.LINEAR,k.CLAMP_TO_EDGE),H=r.fbo=S.createFramebuffer(M,M,!0),H.colorAttachment.set(le.texture)}S.bindFramebuffer.set(H.framebuffer),S.viewport.set([0,0,M,M]),d.useProgram("hillshadePrepare").draw(S,k.TRIANGLES,c,p,_,Br.disabled,((le,te)=>{const ee=te.stride,ye=l.create();return l.ortho(ye,0,l.EXTENT,-l.EXTENT,0,0,1),l.translate(ye,ye,[0,-l.EXTENT,0]),{u_matrix:ye,u_image:1,u_dimension:[ee,ee],u_zoom:le.overscaledZ,u_unpack:te.getUnpackVector()}})(r.tileID,A),null,s.id,d.rasterBoundsBuffer,d.quadTriangleIndexBuffer,d.rasterBoundsSegments),r.needsHillshadePrepare=!1}}function hl(d,r,s,c,p,_){const S=c.paint.get("raster-fade-duration");if(!_&&S>0){const k=l.exported.now(),A=(k-d.timeAdded)/S,M=r?(k-r.timeAdded)/S:-1,F=s.getSource(),q=p.coveringZoomLevel({tileSize:F.tileSize,roundZoom:F.roundZoom}),H=!r||Math.abs(r.tileID.overscaledZ-q)>Math.abs(d.tileID.overscaledZ-q),le=H&&d.refreshedUponExpiration?1:l.clamp(H?A:1-M,0,1);return d.refreshedUponExpiration&&A>=1&&(d.refreshedUponExpiration=!1),r?{opacity:1,mix:1-le}:{opacity:le,mix:0}}return{opacity:1,mix:0}}const xi=new l.Color(1,0,0,1),dl=new l.Color(0,1,0,1),$o=new l.Color(0,0,1,1),qu=new l.Color(1,0,1,1),Go=new l.Color(0,1,1,1);function Es(d,r,s,c){ca(d,0,r+s/2,d.transform.width,s,c)}function ua(d,r,s,c){ca(d,r-s/2,0,s,d.transform.height,c)}function ca(d,r,s,c,p,_){const S=d.context,k=S.gl;k.enable(k.SCISSOR_TEST),k.scissor(r*d.pixelRatio,s*d.pixelRatio,c*d.pixelRatio,p*d.pixelRatio),S.clear({color:_}),k.disable(k.SCISSOR_TEST)}function fl(d,r,s){const c=d.context,p=c.gl,_=s.posMatrix,S=d.useProgram("debug"),k=Bt.disabled,A=Gr.disabled,M=d.colorModeForRenderPass(),F="$debug",q=d.style.terrain&&d.style.terrain.getTerrainData(s);c.activeTexture.set(p.TEXTURE0),d.emptyTexture.bind(p.LINEAR,p.CLAMP_TO_EDGE);const H=r.getTileByID(s.key).latestRawTileData,le=Math.floor((H&&H.byteLength||0)/1024),te=r.getTile(s).tileSize,ee=512/Math.min(te,512)*(s.overscaledZ/d.transform.zoom)*.5;let ye=s.canonical.toString();s.overscaledZ!==s.canonical.z&&(ye+=` => ${s.overscaledZ}`),function(Ae,Pe){Ae.initDebugOverlayCanvas();const he=Ae.debugOverlayCanvas,Ve=Ae.context.gl,Oe=Ae.debugOverlayCanvas.getContext("2d");Oe.clearRect(0,0,he.width,he.height),Oe.shadowColor="white",Oe.shadowBlur=2,Oe.lineWidth=1.5,Oe.strokeStyle="white",Oe.textBaseline="top",Oe.font="bold 36px Open Sans, sans-serif",Oe.fillText(Pe,5,5),Oe.strokeText(Pe,5,5),Ae.debugOverlayTexture.update(he),Ae.debugOverlayTexture.bind(Ve.LINEAR,Ve.CLAMP_TO_EDGE)}(d,`${ye} ${le}kB`),S.draw(c,p.TRIANGLES,k,A,Jr.alphaBlended,Br.disabled,lo(_,l.Color.transparent,ee),null,F,d.debugBuffer,d.quadTriangleIndexBuffer,d.debugSegments),S.draw(c,p.LINE_STRIP,k,A,M,Br.disabled,lo(_,l.Color.red),q,F,d.debugBuffer,d.tileBorderIndexBuffer,d.debugSegments)}function Zo(d,r,s){const c=d.context,p=c.gl,_=d.colorModeForRenderPass(),S=new Bt(p.LEQUAL,Bt.ReadWrite,d.depthRangeFor3D),k=d.useProgram("terrain"),A=r.getTerrainMesh(),M=r.getTerrainData(s.tileID);c.bindFramebuffer.set(null),c.viewport.set([0,0,d.width,d.height]),c.activeTexture.set(p.TEXTURE0),p.bindTexture(p.TEXTURE_2D,r.getRTTFramebuffer().colorAttachment.get());const F=d.transform.calculatePosMatrix(s.tileID.toUnwrapped());k.draw(c,p.TRIANGLES,S,Gr.disabled,_,Br.backCCW,{u_matrix:F,u_texture:0},M,"terrain",A.vertexBuffer,A.indexBuffer,A.segments)}function su(d,r,s,c){const p=d.context,_=s.tileSize*r.qualityFactor;s.textures[c]||(s.textures[c]=d.getTileTexture(_)||new V(p,{width:_,height:_,data:null},p.gl.RGBA),s.textures[c].bind(p.gl.LINEAR,p.gl.CLAMP_TO_EDGE),c===0&&r.sourceCache.renderHistory.unshift(s.tileID.key));const S=r.getRTTFramebuffer();S.colorAttachment.set(s.textures[c].texture),p.bindFramebuffer.set(S.framebuffer),p.viewport.set([0,0,_,_])}class pl{constructor(r){this._coordsDescendingInv={},this._coordsDescendingInvStr={},this.painter=r,this._renderToTexture={background:!0,fill:!0,line:!0,raster:!0},this._coordsDescendingInv={},this._coordsDescendingInvStr={},this._stacks=[],this._prevType=null,this._rerender={},this._renderableTiles=r.style.terrain.sourceCache.getRenderableTiles(),this._init()}_init(){const r=this.painter.style,s=r.terrain;for(const c in r.sourceCaches){this._coordsDescendingInv[c]={};const p=r.sourceCaches[c].getVisibleCoordinates();for(const _ of p){const S=s.sourceCache.getTerrainCoords(_);for(const k in S)this._coordsDescendingInv[c][k]||(this._coordsDescendingInv[c][k]=[]),this._coordsDescendingInv[c][k].push(S[k])}}for(const c of r._order){const p=r._layers[c],_=p.source;if(this._renderToTexture[p.type]&&!this._coordsDescendingInvStr[_]){this._coordsDescendingInvStr[_]={};for(const S in this._coordsDescendingInv[_])this._coordsDescendingInvStr[_][S]=this._coordsDescendingInv[_][S].map(k=>k.key).sort().join()}}return this._renderableTiles.forEach(c=>{for(const p in this._coordsDescendingInvStr){const _=this._coordsDescendingInvStr[p][c.tileID.key];_&&_!==c.textureCoords[p]&&c.clearTextures(this.painter),s.needsRerender(p,c.tileID)&&c.clearTextures(this.painter)}this._rerender[c.tileID.key]=!c.textures.length}),s.clearRerenderCache(),s.sourceCache.removeOutdated(this.painter),this}renderLayer(r){const s=r.type,c=this.painter,p=c.style._order,_=c.currentLayer,S=_+1===p.length;if(this._renderToTexture[s]&&(this._prevType&&this._renderToTexture[this._prevType]||this._stacks.push([]),this._prevType=s,this._stacks[this._stacks.length-1].push(p[_]),!S))return!0;if(this._renderToTexture[this._prevType]||s==="hillshade"||this._renderToTexture[s]&&S){this._prevType=s;const k=this._stacks.length-1,A=this._stacks[k]||[];for(const M of this._renderableTiles){if(su(c,c.style.terrain,M,k),this._rerender[M.tileID.key]){c.context.clear({color:l.Color.transparent});for(let F=0;F<A.length;F++){const q=c.style._layers[A[F]],H=q.source?this._coordsDescendingInv[q.source][M.tileID.key]:[M.tileID];c._renderTileClippingMasks(q,H),c.renderLayer(c,c.style.sourceCaches[q.source],q,H),q.source&&(M.textureCoords[q.source]=this._coordsDescendingInvStr[q.source][M.tileID.key])}}Zo(c,c.style.terrain,M)}if(s==="hillshade"){this._stacks.push([p[_]]);for(const M of this._renderableTiles){const F=this._coordsDescendingInv[r.source][M.tileID.key];su(c,c.style.terrain,M,this._stacks.length-1),c.context.clear({color:l.Color.transparent}),c._renderTileClippingMasks(r,F),c.renderLayer(c,c.style.sourceCaches[r.source],r,F),Zo(c,c.style.terrain,M)}return!0}return this._renderToTexture[s]}return!1}}const ml={symbol:function(d,r,s,c,p){if(d.renderPass!=="translucent")return;const _=Gr.disabled,S=d.colorModeForRenderPass();s.layout.get("text-variable-anchor")&&function(k,A,M,F,q,H,le){const te=A.transform,ee=q==="map",ye=H==="map";for(const Ae of k){const Pe=F.getTile(Ae),he=Pe.getBucket(M);if(!he||!he.text||!he.text.segments.get().length)continue;const Ve=l.evaluateSizeForZoom(he.textSizeData,te.zoom),Oe=lr(Pe,1,A.transform.zoom),Xe=kr(Ae.posMatrix,ye,ee,A.transform,Oe),rt=M.layout.get("icon-text-fit")!=="none"&&he.hasIconData();if(Ve){const pt=Math.pow(2,te.zoom-Pe.tileID.overscaledZ);Wc(he,ee,ye,le,te,Xe,Ae.posMatrix,pt,Ve,rt,A.style.terrain?(et,It)=>A.style.terrain.getElevation(Ae,et,It):null)}}}(c,d,s,r,s.layout.get("text-rotation-alignment"),s.layout.get("text-pitch-alignment"),p),s.paint.get("icon-opacity").constantOr(1)!==0&&Ss(d,r,s,c,!1,s.paint.get("icon-translate"),s.paint.get("icon-translate-anchor"),s.layout.get("icon-rotation-alignment"),s.layout.get("icon-pitch-alignment"),s.layout.get("icon-keep-upright"),_,S),s.paint.get("text-opacity").constantOr(1)!==0&&Ss(d,r,s,c,!0,s.paint.get("text-translate"),s.paint.get("text-translate-anchor"),s.layout.get("text-rotation-alignment"),s.layout.get("text-pitch-alignment"),s.layout.get("text-keep-upright"),_,S),r.map.showCollisionBoxes&&($u(d,r,s,c,s.paint.get("text-translate"),s.paint.get("text-translate-anchor"),!0),$u(d,r,s,c,s.paint.get("icon-translate"),s.paint.get("icon-translate-anchor"),!1))},circle:function(d,r,s,c){if(d.renderPass!=="translucent")return;const p=s.paint.get("circle-opacity"),_=s.paint.get("circle-stroke-width"),S=s.paint.get("circle-stroke-opacity"),k=!s.layout.get("circle-sort-key").isConstant();if(p.constantOr(1)===0&&(_.constantOr(1)===0||S.constantOr(1)===0))return;const A=d.context,M=A.gl,F=d.depthModeForSublayer(0,Bt.ReadOnly),q=Gr.disabled,H=d.colorModeForRenderPass(),le=[];for(let te=0;te<c.length;te++){const ee=c[te],ye=r.getTile(ee),Ae=ye.getBucket(s);if(!Ae)continue;const Pe=Ae.programConfigurations.get(s.id),he=d.useProgram("circle",Pe),Ve=Ae.layoutVertexBuffer,Oe=Ae.indexBuffer,Xe=d.style.terrain&&d.style.terrain.getTerrainData(ee),rt={programConfiguration:Pe,program:he,layoutVertexBuffer:Ve,indexBuffer:Oe,uniformValues:_i(d,ee,ye,s),terrainData:Xe};if(k){const pt=Ae.segments.get();for(const et of pt)le.push({segments:new l.SegmentVector([et]),sortKey:et.sortKey,state:rt})}else le.push({segments:Ae.segments,sortKey:0,state:rt})}k&&le.sort((te,ee)=>te.sortKey-ee.sortKey);for(const te of le){const{programConfiguration:ee,program:ye,layoutVertexBuffer:Ae,indexBuffer:Pe,uniformValues:he,terrainData:Ve}=te.state;ye.draw(A,M.TRIANGLES,F,q,H,Br.disabled,he,Ve,s.id,Ae,Pe,te.segments,s.paint,d.transform.zoom,ee)}},heatmap:function(d,r,s,c){if(s.paint.get("heatmap-opacity")!==0)if(d.renderPass==="offscreen"){const p=d.context,_=p.gl,S=Gr.disabled,k=new Jr([_.ONE,_.ONE],l.Color.transparent,[!0,!0,!0,!0]);(function(A,M,F){const q=A.gl;A.activeTexture.set(q.TEXTURE1),A.viewport.set([0,0,M.width/4,M.height/4]);let H=F.heatmapFbo;if(H)q.bindTexture(q.TEXTURE_2D,H.colorAttachment.get()),A.bindFramebuffer.set(H.framebuffer);else{const le=q.createTexture();q.bindTexture(q.TEXTURE_2D,le),q.texParameteri(q.TEXTURE_2D,q.TEXTURE_WRAP_S,q.CLAMP_TO_EDGE),q.texParameteri(q.TEXTURE_2D,q.TEXTURE_WRAP_T,q.CLAMP_TO_EDGE),q.texParameteri(q.TEXTURE_2D,q.TEXTURE_MIN_FILTER,q.LINEAR),q.texParameteri(q.TEXTURE_2D,q.TEXTURE_MAG_FILTER,q.LINEAR),H=F.heatmapFbo=A.createFramebuffer(M.width/4,M.height/4,!1),function(te,ee,ye,Ae){const Pe=te.gl;Pe.texImage2D(Pe.TEXTURE_2D,0,Pe.RGBA,ee.width/4,ee.height/4,0,Pe.RGBA,te.extRenderToTextureHalfFloat?te.extTextureHalfFloat.HALF_FLOAT_OES:Pe.UNSIGNED_BYTE,null),Ae.colorAttachment.set(ye)}(A,M,le,H)}})(p,d,s),p.clear({color:l.Color.transparent});for(let A=0;A<c.length;A++){const M=c[A];if(r.hasRenderableParent(M))continue;const F=r.getTile(M),q=F.getBucket(s);if(!q)continue;const H=q.programConfigurations.get(s.id),le=d.useProgram("heatmap",H),{zoom:te}=d.transform;le.draw(p,_.TRIANGLES,Bt.disabled,S,k,Br.disabled,Js(M.posMatrix,F,te,s.paint.get("heatmap-intensity")),null,s.id,q.layoutVertexBuffer,q.indexBuffer,q.segments,s.paint,d.transform.zoom,H)}p.viewport.set([0,0,d.width,d.height])}else d.renderPass==="translucent"&&(d.context.setColorMode(d.colorModeForRenderPass()),function(p,_){const S=p.context,k=S.gl,A=_.heatmapFbo;if(!A)return;S.activeTexture.set(k.TEXTURE0),k.bindTexture(k.TEXTURE_2D,A.colorAttachment.get()),S.activeTexture.set(k.TEXTURE1);let M=_.colorRampTexture;M||(M=_.colorRampTexture=new V(S,_.colorRamp,k.RGBA)),M.bind(k.LINEAR,k.CLAMP_TO_EDGE),p.useProgram("heatmapTexture").draw(S,k.TRIANGLES,Bt.disabled,Gr.disabled,p.colorModeForRenderPass(),Br.disabled,((F,q,H,le)=>{const te=l.create();l.ortho(te,0,F.width,F.height,0,0,1);const ee=F.context.gl;return{u_matrix:te,u_world:[ee.drawingBufferWidth,ee.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:q.paint.get("heatmap-opacity")}})(p,_),null,_.id,p.viewportBuffer,p.quadTriangleIndexBuffer,p.viewportSegments,_.paint,p.transform.zoom)}(d,s))},line:function(d,r,s,c){if(d.renderPass!=="translucent")return;const p=s.paint.get("line-opacity"),_=s.paint.get("line-width");if(p.constantOr(1)===0||_.constantOr(1)===0)return;const S=d.depthModeForSublayer(0,Bt.ReadOnly),k=d.colorModeForRenderPass(),A=s.paint.get("line-dasharray"),M=s.paint.get("line-pattern"),F=M.constantOr(1),q=s.paint.get("line-gradient"),H=s.getCrossfadeParameters(),le=F?"linePattern":A?"lineSDF":q?"lineGradient":"line",te=d.context,ee=te.gl;let ye=!0;for(const Ae of c){const Pe=r.getTile(Ae);if(F&&!Pe.patternsLoaded())continue;const he=Pe.getBucket(s);if(!he)continue;const Ve=he.programConfigurations.get(s.id),Oe=d.context.program.get(),Xe=d.useProgram(le,Ve),rt=ye||Xe.program!==Oe,pt=d.style.terrain&&d.style.terrain.getTerrainData(Ae),et=M.constantOr(null);if(et&&Pe.imageAtlas){const Tt=Pe.imageAtlas,Ht=Tt.patternPositions[et.to.toString()],Jt=Tt.patternPositions[et.from.toString()];Ht&&Jt&&Ve.setConstantPatternPositions(Ht,Jt)}const It=pt?Ae:null,wt=F?ds(d,Pe,s,H,It):A?Ur(d,Pe,s,A,H,It):q?ea(d,Pe,s,he.lineClipsArray.length,It):Fo(d,Pe,s,It);if(F)te.activeTexture.set(ee.TEXTURE0),Pe.imageAtlasTexture.bind(ee.LINEAR,ee.CLAMP_TO_EDGE),Ve.updatePaintBuffers(H);else if(A&&(rt||d.lineAtlas.dirty))te.activeTexture.set(ee.TEXTURE0),d.lineAtlas.bind(te);else if(q){const Tt=he.gradients[s.id];let Ht=Tt.texture;if(s.gradientVersion!==Tt.version){let Jt=256;if(s.stepInterpolant){const jt=r.getSource().maxzoom,Ir=Ae.canonical.z===jt?Math.ceil(1<<d.transform.maxZoom-Ae.canonical.z):1;Jt=l.clamp(l.nextPowerOfTwo(he.maxLineLength/l.EXTENT*1024*Ir),256,te.maxTextureSize)}Tt.gradient=l.renderColorRamp({expression:s.gradientExpression(),evaluationKey:"lineProgress",resolution:Jt,image:Tt.gradient||void 0,clips:he.lineClipsArray}),Tt.texture?Tt.texture.update(Tt.gradient):Tt.texture=new V(te,Tt.gradient,ee.RGBA),Tt.version=s.gradientVersion,Ht=Tt.texture}te.activeTexture.set(ee.TEXTURE0),Ht.bind(s.stepInterpolant?ee.NEAREST:ee.LINEAR,ee.CLAMP_TO_EDGE)}Xe.draw(te,ee.TRIANGLES,S,d.stencilModeForClipping(Ae),k,Br.disabled,wt,pt,s.id,he.layoutVertexBuffer,he.indexBuffer,he.segments,s.paint,d.transform.zoom,Ve,he.layoutVertexBuffer2),ye=!1}},fill:function(d,r,s,c){const p=s.paint.get("fill-color"),_=s.paint.get("fill-opacity");if(_.constantOr(1)===0)return;const S=d.colorModeForRenderPass(),k=s.paint.get("fill-pattern"),A=d.opaquePassEnabledForLayer()&&!k.constantOr(1)&&p.constantOr(l.Color.transparent).a===1&&_.constantOr(0)===1?"opaque":"translucent";if(d.renderPass===A){const M=d.depthModeForSublayer(1,d.renderPass==="opaque"?Bt.ReadWrite:Bt.ReadOnly);ul(d,r,s,c,M,S,!1)}if(d.renderPass==="translucent"&&s.paint.get("fill-antialias")){const M=d.depthModeForSublayer(s.getPaintProperty("fill-outline-color")?2:0,Bt.ReadOnly);ul(d,r,s,c,M,S,!0)}},"fill-extrusion":function(d,r,s,c){const p=s.paint.get("fill-extrusion-opacity");if(p!==0&&d.renderPass==="translucent"){const _=new Bt(d.context.gl.LEQUAL,Bt.ReadWrite,d.depthRangeFor3D);if(p!==1||s.paint.get("fill-extrusion-pattern").constantOr(1))la(d,r,s,c,_,Gr.disabled,Jr.disabled),la(d,r,s,c,_,d.stencilModeFor3D(),d.colorModeForRenderPass());else{const S=d.colorModeForRenderPass();la(d,r,s,c,_,Gr.disabled,S)}}},hillshade:function(d,r,s,c){if(d.renderPass!=="offscreen"&&d.renderPass!=="translucent")return;const p=d.context,_=d.depthModeForSublayer(0,Bt.ReadOnly),S=d.colorModeForRenderPass(),[k,A]=d.renderPass==="translucent"?d.stencilConfigForOverlap(c):[{},c];for(const M of A){const F=r.getTile(M);F.needsHillshadePrepare!==void 0&&F.needsHillshadePrepare&&d.renderPass==="offscreen"?cl(d,F,s,_,Gr.disabled,S):d.renderPass==="translucent"&&Zu(d,M,F,s,_,k[M.overscaledZ],S)}p.viewport.set([0,0,d.width,d.height])},raster:function(d,r,s,c){if(d.renderPass!=="translucent"||s.paint.get("raster-opacity")===0||!c.length)return;const p=d.context,_=p.gl,S=r.getSource(),k=d.useProgram("raster"),A=d.colorModeForRenderPass(),[M,F]=S instanceof Fe?[{},c]:d.stencilConfigForOverlap(c),q=F[F.length-1].overscaledZ,H=!d.options.moving;for(const le of F){const te=d.depthModeForSublayer(le.overscaledZ-q,s.paint.get("raster-opacity")===1?Bt.ReadWrite:Bt.ReadOnly,_.LESS),ee=r.getTile(le);ee.registerFadeDuration(s.paint.get("raster-fade-duration"));const ye=r.findLoadedParent(le,0),Ae=hl(ee,ye,r,s,d.transform,d.style.terrain);let Pe,he;const Ve=s.paint.get("raster-resampling")==="nearest"?_.NEAREST:_.LINEAR;p.activeTexture.set(_.TEXTURE0),ee.texture.bind(Ve,_.CLAMP_TO_EDGE,_.LINEAR_MIPMAP_NEAREST),p.activeTexture.set(_.TEXTURE1),ye?(ye.texture.bind(Ve,_.CLAMP_TO_EDGE,_.LINEAR_MIPMAP_NEAREST),Pe=Math.pow(2,ye.tileID.overscaledZ-ee.tileID.overscaledZ),he=[ee.tileID.canonical.x*Pe%1,ee.tileID.canonical.y*Pe%1]):ee.texture.bind(Ve,_.CLAMP_TO_EDGE,_.LINEAR_MIPMAP_NEAREST);const Oe=d.style.terrain&&d.style.terrain.getTerrainData(le),Xe=Oe?le:null,rt=Xe?Xe.posMatrix:d.transform.calculatePosMatrix(le.toUnwrapped(),H),pt=$i(rt,he||[0,0],Pe||1,Ae,s);S instanceof Fe?k.draw(p,_.TRIANGLES,te,Gr.disabled,A,Br.disabled,pt,Oe,s.id,S.boundsBuffer,d.quadTriangleIndexBuffer,S.boundsSegments):k.draw(p,_.TRIANGLES,te,M[le.overscaledZ],A,Br.disabled,pt,Oe,s.id,d.rasterBoundsBuffer,d.quadTriangleIndexBuffer,d.rasterBoundsSegments)}},background:function(d,r,s,c){const p=s.paint.get("background-color"),_=s.paint.get("background-opacity");if(_===0)return;const S=d.context,k=S.gl,A=d.transform,M=A.tileSize,F=s.paint.get("background-pattern");if(d.isPatternMissing(F))return;const q=!F&&p.a===1&&_===1&&d.opaquePassEnabledForLayer()?"opaque":"translucent";if(d.renderPass!==q)return;const H=Gr.disabled,le=d.depthModeForSublayer(0,q==="opaque"?Bt.ReadWrite:Bt.ReadOnly),te=d.colorModeForRenderPass(),ee=d.useProgram(F?"backgroundPattern":"background"),ye=c||A.coveringTiles({tileSize:M,terrain:d.style.terrain});F&&(S.activeTexture.set(k.TEXTURE0),d.imageManager.bind(d.context));const Ae=s.getCrossfadeParameters();for(const Pe of ye){const he=c?Pe.posMatrix:d.transform.calculatePosMatrix(Pe.toUnwrapped()),Ve=F?Xl(he,_,d,F,{tileID:Pe,tileSize:M},Ae):uo(he,_,p),Oe=d.style.terrain&&d.style.terrain.getTerrainData(Pe);ee.draw(S,k.TRIANGLES,le,H,te,Br.disabled,Ve,Oe,s.id,d.tileExtentBuffer,d.quadTriangleIndexBuffer,d.tileExtentSegments)}},debug:function(d,r,s){for(let c=0;c<s.length;c++)fl(d,r,s[c])},custom:function(d,r,s){const c=d.context,p=s.implementation;if(d.renderPass==="offscreen"){const _=p.prerender;_&&(d.setCustomLayerDefaults(),c.setColorMode(d.colorModeForRenderPass()),_.call(p,c.gl,d.transform.customLayerMatrix()),c.setDirty(),d.setBaseState())}else if(d.renderPass==="translucent"){d.setCustomLayerDefaults(),c.setColorMode(d.colorModeForRenderPass()),c.setStencilMode(Gr.disabled);const _=p.renderingMode==="3d"?new Bt(d.context.gl.LEQUAL,Bt.ReadWrite,d.depthRangeFor3D):d.depthModeForSublayer(0,Bt.ReadOnly);c.setDepthMode(_),p.render(c.gl,d.transform.customLayerMatrix()),c.setDirty(),d.setBaseState(),c.bindFramebuffer.set(null)}}};class au{constructor(r,s){this.context=new nu(r),this.transform=s,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:l.create(),renderTime:0},this.setup(),this.numSublayers=Rt.maxUnderzooming+Rt.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new er,this.gpuTimers={}}resize(r,s,c){if(this.width=r*c,this.height=s*c,this.pixelRatio=c,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const p of this.style._order)this.style._layers[p].resize()}setup(){const r=this.context,s=new l.PosArray;s.emplaceBack(0,0),s.emplaceBack(l.EXTENT,0),s.emplaceBack(0,l.EXTENT),s.emplaceBack(l.EXTENT,l.EXTENT),this.tileExtentBuffer=r.createVertexBuffer(s,tr.members),this.tileExtentSegments=l.SegmentVector.simpleSegment(0,0,4,2);const c=new l.PosArray;c.emplaceBack(0,0),c.emplaceBack(l.EXTENT,0),c.emplaceBack(0,l.EXTENT),c.emplaceBack(l.EXTENT,l.EXTENT),this.debugBuffer=r.createVertexBuffer(c,tr.members),this.debugSegments=l.SegmentVector.simpleSegment(0,0,4,5);const p=new l.RasterBoundsArray;p.emplaceBack(0,0,0,0),p.emplaceBack(l.EXTENT,0,l.EXTENT,0),p.emplaceBack(0,l.EXTENT,0,l.EXTENT),p.emplaceBack(l.EXTENT,l.EXTENT,l.EXTENT,l.EXTENT),this.rasterBoundsBuffer=r.createVertexBuffer(p,st.members),this.rasterBoundsSegments=l.SegmentVector.simpleSegment(0,0,4,2);const _=new l.PosArray;_.emplaceBack(0,0),_.emplaceBack(1,0),_.emplaceBack(0,1),_.emplaceBack(1,1),this.viewportBuffer=r.createVertexBuffer(_,tr.members),this.viewportSegments=l.SegmentVector.simpleSegment(0,0,4,2);const S=new l.LineStripIndexArray;S.emplaceBack(0),S.emplaceBack(1),S.emplaceBack(3),S.emplaceBack(2),S.emplaceBack(0),this.tileBorderIndexBuffer=r.createIndexBuffer(S);const k=new l.TriangleIndexArray;k.emplaceBack(0,1,2),k.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=r.createIndexBuffer(k),this.emptyTexture=new V(r,{width:1,height:1,data:new Uint8Array([0,0,0,0])},r.gl.RGBA);const A=this.context.gl;this.stencilClearMode=new Gr({func:A.ALWAYS,mask:0},0,255,A.ZERO,A.ZERO,A.ZERO)}clearStencil(){const r=this.context,s=r.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const c=l.create();l.ortho(c,0,this.width,this.height,0,0,1),l.scale(c,c,[s.drawingBufferWidth,s.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(r,s.TRIANGLES,Bt.disabled,this.stencilClearMode,Jr.disabled,Br.disabled,wr(c),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(r,s){if(this.currentStencilSource===r.source||!r.isTileClipped()||!s||!s.length)return;this.currentStencilSource=r.source;const c=this.context,p=c.gl;this.nextStencilID+s.length>256&&this.clearStencil(),c.setColorMode(Jr.disabled),c.setDepthMode(Bt.disabled);const _=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const S of s){const k=this._tileClippingMaskIDs[S.key]=this.nextStencilID++,A=this.style.terrain&&this.style.terrain.getTerrainData(S);_.draw(c,p.TRIANGLES,Bt.disabled,new Gr({func:p.ALWAYS,mask:0},k,255,p.KEEP,p.KEEP,p.REPLACE),Jr.disabled,Br.disabled,wr(S.posMatrix),A,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const r=this.nextStencilID++,s=this.context.gl;return new Gr({func:s.NOTEQUAL,mask:255},r,255,s.KEEP,s.KEEP,s.REPLACE)}stencilModeForClipping(r){const s=this.context.gl;return new Gr({func:s.EQUAL,mask:255},this._tileClippingMaskIDs[r.key],0,s.KEEP,s.KEEP,s.REPLACE)}stencilConfigForOverlap(r){const s=this.context.gl,c=r.sort((S,k)=>k.overscaledZ-S.overscaledZ),p=c[c.length-1].overscaledZ,_=c[0].overscaledZ-p+1;if(_>1){this.currentStencilSource=void 0,this.nextStencilID+_>256&&this.clearStencil();const S={};for(let k=0;k<_;k++)S[k+p]=new Gr({func:s.GEQUAL,mask:255},k+this.nextStencilID,255,s.KEEP,s.KEEP,s.REPLACE);return this.nextStencilID+=_,[S,c]}return[{[p]:Gr.disabled},c]}colorModeForRenderPass(){const r=this.context.gl;return this._showOverdrawInspector?new Jr([r.CONSTANT_COLOR,r.ONE],new l.Color(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Jr.unblended:Jr.alphaBlended}depthModeForSublayer(r,s,c){if(!this.opaquePassEnabledForLayer())return Bt.disabled;const p=1-((1+this.currentLayer)*this.numSublayers+r)*this.depthEpsilon;return new Bt(c||this.context.gl.LEQUAL,s,[p,p])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(r,s){this.style=r,this.options=s,this.lineAtlas=r.lineAtlas,this.imageManager=r.imageManager,this.glyphManager=r.glyphManager,this.symbolFadeChange=r.placement.symbolFadeChange(l.exported.now()),this.imageManager.beginFrame();const c=this.style._order,p=this.style.sourceCaches,_=this.style.terrain&&new pl(this);for(const M in p){const F=p[M];F.used&&F.prepare(this.context)}const S={},k={},A={};for(const M in p){const F=p[M];S[M]=F.getVisibleCoordinates(),k[M]=S[M].slice().reverse(),A[M]=F.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let M=0;M<c.length;M++)if(this.style._layers[c[M]].is3D()){this.opaquePassCutoff=M;break}if(_){this.opaquePassCutoff=0;const M=this.style.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime);(this.terrainFacilitator.dirty||!l.equals(this.terrainFacilitator.matrix,this.transform.projMatrix)||M.length)&&(l.copy(this.terrainFacilitator.matrix,this.transform.projMatrix),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(F,q){const H=F.context,le=H.gl,te=Jr.unblended,ee=new Bt(le.LEQUAL,Bt.ReadWrite,[0,1]),ye=q.getTerrainMesh(),Ae=q.sourceCache.getRenderableTiles(),Pe=F.useProgram("terrainDepth");H.bindFramebuffer.set(q.getFramebuffer("depth").framebuffer),H.viewport.set([0,0,F.width/devicePixelRatio,F.height/devicePixelRatio]),H.clear({color:l.Color.transparent,depth:1});for(const he of Ae){const Ve=q.getTerrainData(he.tileID),Oe=F.transform.calculatePosMatrix(he.tileID.toUnwrapped());Pe.draw(H,le.TRIANGLES,ee,Gr.disabled,te,Br.backCCW,{u_matrix:Oe},Ve,"terrain",ye.vertexBuffer,ye.indexBuffer,ye.segments)}H.bindFramebuffer.set(null),H.viewport.set([0,0,F.width,F.height])}(this,this.style.terrain),function(F,q){const H=F.context,le=H.gl,te=Jr.unblended,ee=new Bt(le.LEQUAL,Bt.ReadWrite,[0,1]),ye=q.getTerrainMesh(),Ae=q.getCoordsTexture(),Pe=q.sourceCache.getRenderableTiles(),he=F.useProgram("terrainCoords");H.bindFramebuffer.set(q.getFramebuffer("coords").framebuffer),H.viewport.set([0,0,F.width/devicePixelRatio,F.height/devicePixelRatio]),H.clear({color:l.Color.transparent,depth:1}),q.coordsIndex=[];for(const Ve of Pe){const Oe=q.getTerrainData(Ve.tileID);H.activeTexture.set(le.TEXTURE0),le.bindTexture(le.TEXTURE_2D,Ae.texture);const Xe=F.transform.calculatePosMatrix(Ve.tileID.toUnwrapped());he.draw(H,le.TRIANGLES,ee,Gr.disabled,te,Br.backCCW,{u_matrix:Xe,u_terrain_coords_id:(255-q.coordsIndex.length)/255,u_texture:0},Oe,"terrain",ye.vertexBuffer,ye.indexBuffer,ye.segments),q.coordsIndex.push(Ve.tileID.key)}H.bindFramebuffer.set(null),H.viewport.set([0,0,F.width,F.height])}(this,this.style.terrain))}this.renderPass="offscreen";for(const M of c){const F=this.style._layers[M];if(!F.hasOffscreenPass()||F.isHidden(this.transform.zoom))continue;const q=k[F.source];(F.type==="custom"||q.length)&&this.renderLayer(this,p[F.source],F,q)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:s.showOverdrawInspector?l.Color.black:l.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=s.showOverdrawInspector,this.depthRangeFor3D=[0,1-(r._order.length+2)*this.numSublayers*this.depthEpsilon],!_)for(this.renderPass="opaque",this.currentLayer=c.length-1;this.currentLayer>=0;this.currentLayer--){const M=this.style._layers[c[this.currentLayer]],F=p[M.source],q=S[M.source];this._renderTileClippingMasks(M,q),this.renderLayer(this,F,M,q)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<c.length;this.currentLayer++){const M=this.style._layers[c[this.currentLayer]],F=p[M.source];if(_&&_.renderLayer(M))continue;const q=(M.type==="symbol"?A:k)[M.source];this._renderTileClippingMasks(M,S[M.source]),this.renderLayer(this,F,M,q)}if(this.options.showTileBoundaries){let M,F;Object.values(this.style._layers).forEach(q=>{q.source&&!q.isHidden(this.transform.zoom)&&(q.source!==(F&&F.id)&&(F=this.style.sourceCaches[q.source]),(!M||M.getSource().maxzoom<F.getSource().maxzoom)&&(M=F))}),M&&ml.debug(this,M,M.getVisibleCoordinates())}this.options.showPadding&&function(M){const F=M.transform.padding;Es(M,M.transform.height-(F.top||0),3,xi),Es(M,F.bottom||0,3,dl),ua(M,F.left||0,3,$o),ua(M,M.transform.width-(F.right||0),3,qu);const q=M.transform.centerPoint;(function(H,le,te,ee){ca(H,le-1,te-10,2,20,ee),ca(H,le-10,te-1,20,2,ee)})(M,q.x,M.transform.height-q.y,Go)}(this),this.context.setDefault()}renderLayer(r,s,c,p){c.isHidden(this.transform.zoom)||(c.type==="background"||c.type==="custom"||(p||[]).length)&&(this.id=c.id,this.gpuTimingStart(c),ml[c.type](r,s,c,p,this.style.placement.variableOffsets),this.gpuTimingEnd())}gpuTimingStart(r){if(!this.options.gpuTiming)return;const s=this.context.extTimerQuery;let c=this.gpuTimers[r.id];c||(c=this.gpuTimers[r.id]={calls:0,cpuTime:0,query:s.createQueryEXT()}),c.calls++,s.beginQueryEXT(s.TIME_ELAPSED_EXT,c.query)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const r=this.context.extTimerQuery;r.endQueryEXT(r.TIME_ELAPSED_EXT)}collectGpuTimers(){const r=this.gpuTimers;return this.gpuTimers={},r}queryGpuTimers(r){const s={};for(const c in r){const p=r[c],_=this.context.extTimerQuery,S=_.getQueryObjectEXT(p.query,_.QUERY_RESULT_EXT)/1e6;_.deleteQueryEXT(p.query),s[c]=S}return s}translatePosMatrix(r,s,c,p,_){if(!c[0]&&!c[1])return r;const S=_?p==="map"?this.transform.angle:0:p==="viewport"?-this.transform.angle:0;if(S){const M=Math.sin(S),F=Math.cos(S);c=[c[0]*F-c[1]*M,c[0]*M+c[1]*F]}const k=[_?c[0]:lr(s,c[0],this.transform.zoom),_?c[1]:lr(s,c[1],this.transform.zoom),0],A=new Float32Array(16);return l.translate(A,r,k),A}saveTileTexture(r){const s=this._tileTextures[r.size[0]];s?s.push(r):this._tileTextures[r.size[0]]=[r]}getTileTexture(r){const s=this._tileTextures[r];return s&&s.length>0?s.pop():null}isPatternMissing(r){if(!r)return!1;if(!r.from||!r.to)return!0;const s=this.imageManager.getPattern(r.from.toString()),c=this.imageManager.getPattern(r.to.toString());return!s||!c}useProgram(r,s){this.cache=this.cache||{};const c=r+(s?s.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.terrain?"/terrain":"");return this.cache[c]||(this.cache[c]=new el(this.context,r,Xs[r],s,nl[r],this._showOverdrawInspector,this.style.terrain)),this.cache[c]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const r=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(r.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new V(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}}class ha{constructor(r,s){this.points=r,this.planes=s}static fromInvProjectionMatrix(r,s,c){const p=Math.pow(2,c),_=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(k=>{const A=1/(k=l.transformMat4([],k,r))[3]/s*p;return l.mul$1(k,k,[A,A,1/k[3],A])}),S=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(k=>{const A=l.sub([],_[k[0]],_[k[1]]),M=l.sub([],_[k[2]],_[k[1]]),F=l.normalize([],l.cross([],A,M)),q=-l.dot(F,_[k[1]]);return F.concat(q)});return new ha(_,S)}}class wi{constructor(r,s){this.min=r,this.max=s,this.center=l.scale$1([],l.add([],this.min,this.max),.5)}quadrant(r){const s=[r%2==0,r<2],c=l.clone$2(this.min),p=l.clone$2(this.max);for(let _=0;_<s.length;_++)c[_]=s[_]?this.min[_]:this.center[_],p[_]=s[_]?this.center[_]:this.max[_];return p[2]=this.max[2],new wi(c,p)}distanceX(r){return Math.max(Math.min(this.max[0],r[0]),this.min[0])-r[0]}distanceY(r){return Math.max(Math.min(this.max[1],r[1]),this.min[1])-r[1]}intersects(r){const s=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let c=!0;for(let p=0;p<r.planes.length;p++){const _=r.planes[p];let S=0;for(let k=0;k<s.length;k++)l.dot$1(_,s[k])>=0&&S++;if(S===0)return 0;S!==s.length&&(c=!1)}if(c)return 2;for(let p=0;p<3;p++){let _=Number.MAX_VALUE,S=-Number.MAX_VALUE;for(let k=0;k<r.points.length;k++){const A=r.points[k][p]-this.min[p];_=Math.min(_,A),S=Math.max(S,A)}if(S<0||_>this.max[p]-this.min[p])return 0}return 1}}class Hi{constructor(r=0,s=0,c=0,p=0){if(isNaN(r)||r<0||isNaN(s)||s<0||isNaN(c)||c<0||isNaN(p)||p<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=r,this.bottom=s,this.left=c,this.right=p}interpolate(r,s,c){return s.top!=null&&r.top!=null&&(this.top=l.number(r.top,s.top,c)),s.bottom!=null&&r.bottom!=null&&(this.bottom=l.number(r.bottom,s.bottom,c)),s.left!=null&&r.left!=null&&(this.left=l.number(r.left,s.left,c)),s.right!=null&&r.right!=null&&(this.right=l.number(r.right,s.right,c)),this}getCenter(r,s){const c=l.clamp((this.left+r-this.right)/2,0,r),p=l.clamp((this.top+s-this.bottom)/2,0,s);return new l.pointGeometry(c,p)}equals(r){return this.top===r.top&&this.bottom===r.bottom&&this.left===r.left&&this.right===r.right}clone(){return new Hi(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}class gl{constructor(r,s,c,p,_){this.tileSize=512,this.maxValidLatitude=85.051129,this.freezeElevation=!1,this._renderWorldCopies=_===void 0||!!_,this._minZoom=r||0,this._maxZoom=s||22,this._minPitch=c??0,this._maxPitch=p??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new l.LngLat(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Hi,this._posMatrixCache={},this._alignedPosMatrixCache={}}clone(){const r=new gl(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return r.tileSize=this.tileSize,r.latRange=this.latRange,r.width=this.width,r.height=this.height,r._center=this._center,r._elevation=this._elevation,r.zoom=this.zoom,r.angle=this.angle,r._fov=this._fov,r._pitch=this._pitch,r._unmodified=this._unmodified,r._edgeInsets=this._edgeInsets.clone(),r._calcMatrices(),r}get minZoom(){return this._minZoom}set minZoom(r){this._minZoom!==r&&(this._minZoom=r,this.zoom=Math.max(this.zoom,r))}get maxZoom(){return this._maxZoom}set maxZoom(r){this._maxZoom!==r&&(this._maxZoom=r,this.zoom=Math.min(this.zoom,r))}get minPitch(){return this._minPitch}set minPitch(r){this._minPitch!==r&&(this._minPitch=r,this.pitch=Math.max(this.pitch,r))}get maxPitch(){return this._maxPitch}set maxPitch(r){this._maxPitch!==r&&(this._maxPitch=r,this.pitch=Math.min(this.pitch,r))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(r){r===void 0?r=!0:r===null&&(r=!1),this._renderWorldCopies=r}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new l.pointGeometry(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(r){const s=-l.wrap(r,-180,180)*Math.PI/180;var c;this.angle!==s&&(this._unmodified=!1,this.angle=s,this._calcMatrices(),this.rotationMatrix=(c=new l.ARRAY_TYPE(4),l.ARRAY_TYPE!=Float32Array&&(c[1]=0,c[2]=0),c[0]=1,c[3]=1,c),function(p,_,S){var k=_[0],A=_[1],M=_[2],F=_[3],q=Math.sin(S),H=Math.cos(S);p[0]=k*H+M*q,p[1]=A*H+F*q,p[2]=k*-q+M*H,p[3]=A*-q+F*H}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(r){const s=l.clamp(r,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==s&&(this._unmodified=!1,this._pitch=s,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(r){r=Math.max(.01,Math.min(60,r)),this._fov!==r&&(this._unmodified=!1,this._fov=r/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(r){const s=Math.min(Math.max(r,this.minZoom),this.maxZoom);this._zoom!==s&&(this._unmodified=!1,this._zoom=s,this.scale=this.zoomScale(s),this.tileZoom=Math.floor(s),this.zoomFraction=s-this.tileZoom,this._constrain(),this._calcMatrices())}get center(){return this._center}set center(r){r.lat===this._center.lat&&r.lng===this._center.lng||(this._unmodified=!1,this._center=r,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(r){r!==this._elevation&&(this._elevation=r,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(r){this._edgeInsets.equals(r)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,r,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(r){return this._edgeInsets.equals(r)}interpolatePadding(r,s,c){this._unmodified=!1,this._edgeInsets.interpolate(r,s,c),this._constrain(),this._calcMatrices()}coveringZoomLevel(r){const s=(r.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/r.tileSize));return Math.max(0,s)}getVisibleUnwrappedCoordinates(r){const s=[new l.UnwrappedTileID(0,r)];if(this._renderWorldCopies){const c=this.pointCoordinate(new l.pointGeometry(0,0)),p=this.pointCoordinate(new l.pointGeometry(this.width,0)),_=this.pointCoordinate(new l.pointGeometry(this.width,this.height)),S=this.pointCoordinate(new l.pointGeometry(0,this.height)),k=Math.floor(Math.min(c.x,p.x,_.x,S.x)),A=Math.floor(Math.max(c.x,p.x,_.x,S.x)),M=1;for(let F=k-M;F<=A+M;F++)F!==0&&s.push(new l.UnwrappedTileID(F,r))}return s}coveringTiles(r){var s,c;let p=this.coveringZoomLevel(r);const _=p;if(r.minzoom!==void 0&&p<r.minzoom)return[];r.maxzoom!==void 0&&p>r.maxzoom&&(p=r.maxzoom);const S=this.pointCoordinate(this.getCameraPoint()),k=l.MercatorCoordinate.fromLngLat(this.center),A=Math.pow(2,p),M=[A*S.x,A*S.y,0],F=[A*k.x,A*k.y,0],q=ha.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,p);let H=r.minzoom||0;!r.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(H=p);const le=r.terrain?2/Math.min(this.tileSize,r.tileSize)*this.tileSize:3,te=he=>({aabb:new wi([he*A,0,0],[(he+1)*A,A,0]),zoom:0,x:0,y:0,wrap:he,fullyVisible:!1}),ee=[],ye=[],Ae=p,Pe=r.reparseOverscaled?_:p;if(this._renderWorldCopies)for(let he=1;he<=3;he++)ee.push(te(-he)),ee.push(te(he));for(ee.push(te(0));ee.length>0;){const he=ee.pop(),Ve=he.x,Oe=he.y;let Xe=he.fullyVisible;if(!Xe){const Tt=he.aabb.intersects(q);if(Tt===0)continue;Xe=Tt===2}const rt=r.terrain?M:F,pt=he.aabb.distanceX(rt),et=he.aabb.distanceY(rt),It=Math.max(Math.abs(pt),Math.abs(et)),wt=le+(1<<Ae-he.zoom)-2;if(he.zoom===Ae||It>wt&&he.zoom>=H){const Tt=Ae-he.zoom,Ht=M[0]-.5-(Ve<<Tt),Jt=M[1]-.5-(Oe<<Tt);ye.push({tileID:new l.OverscaledTileID(he.zoom===Ae?Pe:he.zoom,he.wrap,he.zoom,Ve,Oe),distanceSq:l.sqrLen([F[0]-.5-Ve,F[1]-.5-Oe]),tileDistanceToCamera:Math.sqrt(Ht*Ht+Jt*Jt)})}else for(let Tt=0;Tt<4;Tt++){const Ht=(Ve<<1)+Tt%2,Jt=(Oe<<1)+(Tt>>1),jt=he.zoom+1;let Ir=he.aabb.quadrant(Tt);if(r.terrain){const cr=new l.OverscaledTileID(jt,he.wrap,jt,Ht,Jt),ir=r.terrain.getMinMaxElevation(cr),ar=(s=ir.minElevation)!==null&&s!==void 0?s:this.elevation,hr=(c=ir.maxElevation)!==null&&c!==void 0?c:this.elevation;Ir=new wi([Ir.min[0],Ir.min[1],ar],[Ir.max[0],Ir.max[1],hr])}ee.push({aabb:Ir,zoom:jt,x:Ht,y:Jt,wrap:he.wrap,fullyVisible:Xe})}}return ye.sort((he,Ve)=>he.distanceSq-Ve.distanceSq).map(he=>he.tileID)}resize(r,s){this.width=r,this.height=s,this.pixelsToGLUnits=[2/r,-2/s],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(r){return Math.pow(2,r)}scaleZoom(r){return Math.log(r)/Math.LN2}project(r){const s=l.clamp(r.lat,-this.maxValidLatitude,this.maxValidLatitude);return new l.pointGeometry(l.mercatorXfromLng(r.lng)*this.worldSize,l.mercatorYfromLat(s)*this.worldSize)}unproject(r){return new l.MercatorCoordinate(r.x/this.worldSize,r.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}updateElevation(r){this.freezeElevation||(this.elevation=r?this.getElevation(this._center,r):0)}getElevation(r,s){const c=l.MercatorCoordinate.fromLngLat(r),p=(1<<this.tileZoom)*l.EXTENT,_=c.x*p,S=c.y*p,k=Math.floor(_/l.EXTENT),A=Math.floor(S/l.EXTENT),M=new l.OverscaledTileID(this.tileZoom,0,this.tileZoom,k,A);return s.getElevation(M,_%l.EXTENT,S%l.EXTENT,l.EXTENT)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(r){const s=this.pointLocation(this.centerPoint,r),c=this.getElevation(s,r);if(!(this.elevation-c))return;const p=this.getCameraPosition(),_=l.MercatorCoordinate.fromLngLat(p.lngLat,p.altitude),S=l.MercatorCoordinate.fromLngLat(s,c),k=_.x-S.x,A=_.y-S.y,M=_.z-S.z,F=Math.sqrt(k*k+A*A+M*M),q=this.scaleZoom(this.cameraToCenterDistance/F/this.tileSize);this._elevation=c,this._center=s,this.zoom=q}setLocationAtPoint(r,s){const c=this.pointCoordinate(s),p=this.pointCoordinate(this.centerPoint),_=this.locationCoordinate(r),S=new l.MercatorCoordinate(_.x-(c.x-p.x),_.y-(c.y-p.y));this.center=this.coordinateLocation(S),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(r,s){return s?this.coordinatePoint(this.locationCoordinate(r),this.getElevation(r,s),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(r))}pointLocation(r,s){return this.coordinateLocation(this.pointCoordinate(r,s))}locationCoordinate(r){return l.MercatorCoordinate.fromLngLat(r)}coordinateLocation(r){return r&&r.toLngLat()}pointCoordinate(r,s){if(s){const H=s.pointCoordinate(r);if(H!=null)return H}const c=[r.x,r.y,0,1],p=[r.x,r.y,1,1];l.transformMat4(c,c,this.pixelMatrixInverse),l.transformMat4(p,p,this.pixelMatrixInverse);const _=c[3],S=p[3],k=c[1]/_,A=p[1]/S,M=c[2]/_,F=p[2]/S,q=M===F?0:(0-M)/(F-M);return new l.MercatorCoordinate(l.number(c[0]/_,p[0]/S,q)/this.worldSize,l.number(k,A,q)/this.worldSize)}coordinatePoint(r,s=0,c=this.pixelMatrix){const p=[r.x*this.worldSize,r.y*this.worldSize,s,1];return l.transformMat4(p,p,c),new l.pointGeometry(p[0]/p[3],p[1]/p[3])}getBounds(){const r=Math.max(0,this.height/2-this.getHorizon());return new l.LngLatBounds().extend(this.pointLocation(new l.pointGeometry(0,r))).extend(this.pointLocation(new l.pointGeometry(this.width,r))).extend(this.pointLocation(new l.pointGeometry(this.width,this.height))).extend(this.pointLocation(new l.pointGeometry(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new l.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(r){r?(this.lngRange=[r.getWest(),r.getEast()],this.latRange=[r.getSouth(),r.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}calculatePosMatrix(r,s=!1){const c=r.key,p=s?this._alignedPosMatrixCache:this._posMatrixCache;if(p[c])return p[c];const _=r.canonical,S=this.worldSize/this.zoomScale(_.z),k=_.x+Math.pow(2,_.z)*r.wrap,A=l.identity(new Float64Array(16));return l.translate(A,A,[k*S,_.y*S,0]),l.scale(A,A,[S/l.EXTENT,S/l.EXTENT,1]),l.multiply(A,s?this.alignedProjMatrix:this.projMatrix,A),p[c]=new Float32Array(A),p[c]}customLayerMatrix(){return this.mercatorMatrix.slice()}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let r,s,c,p,_=-90,S=90,k=-180,A=180;const M=this.size,F=this._unmodified;if(this.latRange){const le=this.latRange;_=l.mercatorYfromLat(le[1])*this.worldSize,S=l.mercatorYfromLat(le[0])*this.worldSize,r=S-_<M.y?M.y/(S-_):0}if(this.lngRange){const le=this.lngRange;k=l.wrap(l.mercatorXfromLng(le[0])*this.worldSize,0,this.worldSize),A=l.wrap(l.mercatorXfromLng(le[1])*this.worldSize,0,this.worldSize),A<k&&(A+=this.worldSize),s=A-k<M.x?M.x/(A-k):0}const q=this.point,H=Math.max(s||0,r||0);if(H)return this.center=this.unproject(new l.pointGeometry(s?(A+k)/2:q.x,r?(S+_)/2:q.y)),this.zoom+=this.scaleZoom(H),this._unmodified=F,void(this._constraining=!1);if(this.latRange){const le=q.y,te=M.y/2;le-te<_&&(p=_+te),le+te>S&&(p=S-te)}if(this.lngRange){const le=(k+A)/2,te=l.wrap(q.x,le-this.worldSize/2,le+this.worldSize/2),ee=M.x/2;te-ee<k&&(c=k+ee),te+ee>A&&(c=A-ee)}c===void 0&&p===void 0||(this.center=this.unproject(new l.pointGeometry(c!==void 0?c:q.x,p!==void 0?p:q.y)).wrap()),this._unmodified=F,this._constraining=!1}_calcMatrices(){if(!this.height)return;const r=this.centerOffset,s=this.point.x,c=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=l.mercatorZfromAltitude(1,this.center.lat)*this.worldSize;let p=l.identity(new Float64Array(16));l.scale(p,p,[this.width/2,-this.height/2,1]),l.translate(p,p,[1,-1,0]),this.labelPlaneMatrix=p,p=l.identity(new Float64Array(16)),l.scale(p,p,[1,-1,1]),l.translate(p,p,[-1,-1,0]),l.scale(p,p,[2/this.width,2/this.height,1]),this.glCoordMatrix=p,this.cameraToSeaLevelDistance=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch);const _=Math.PI/2+this._pitch,S=this._fov*(.5+r.y/this.height),k=Math.sin(S)*this.cameraToSeaLevelDistance/Math.sin(l.clamp(Math.PI-_-S,.01,Math.PI-.01)),A=this.getHorizon(),M=2*Math.atan(A/this.cameraToCenterDistance)*(.5+r.y/(2*A)),F=Math.sin(M)*this.cameraToSeaLevelDistance/Math.sin(l.clamp(Math.PI-_-M,.01,Math.PI-.01)),q=Math.cos(Math.PI/2-this._pitch)*k+this.cameraToSeaLevelDistance,H=Math.cos(Math.PI/2-this._pitch)*F+this.cameraToSeaLevelDistance,le=1.01*Math.min(q,H),te=this.height/50;p=new Float64Array(16),l.perspective(p,this._fov,this.width/this.height,te,le),p[8]=2*-r.x/this.width,p[9]=2*r.y/this.height,l.scale(p,p,[1,-1,1]),l.translate(p,p,[0,0,-this.cameraToCenterDistance]),l.rotateX(p,p,this._pitch),l.rotateZ(p,p,this.angle),l.translate(p,p,[-s,-c,0]),this.mercatorMatrix=l.scale([],p,[this.worldSize,this.worldSize,this.worldSize]),l.scale(p,p,[1,1,this._pixelPerMeter]),this.pixelMatrix=l.multiply(new Float64Array(16),this.labelPlaneMatrix,p),l.translate(p,p,[0,0,-this.elevation]),this.projMatrix=p,this.invProjMatrix=l.invert([],p),this.pixelMatrix3D=l.multiply(new Float64Array(16),this.labelPlaneMatrix,p);const ee=this.width%2/2,ye=this.height%2/2,Ae=Math.cos(this.angle),Pe=Math.sin(this.angle),he=s-Math.round(s)+Ae*ee+Pe*ye,Ve=c-Math.round(c)+Ae*ye+Pe*ee,Oe=new Float64Array(p);if(l.translate(Oe,Oe,[he>.5?he-1:he,Ve>.5?Ve-1:Ve,0]),this.alignedProjMatrix=Oe,p=l.invert(new Float64Array(16),this.pixelMatrix),!p)throw new Error("failed to invert matrix");this.pixelMatrixInverse=p,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const r=this.pointCoordinate(new l.pointGeometry(0,0)),s=[r.x*this.worldSize,r.y*this.worldSize,0,1];return l.transformMat4(s,s,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const r=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new l.pointGeometry(0,r))}getCameraQueryGeometry(r){const s=this.getCameraPoint();if(r.length===1)return[r[0],s];{let c=s.x,p=s.y,_=s.x,S=s.y;for(const k of r)c=Math.min(c,k.x),p=Math.min(p,k.y),_=Math.max(_,k.x),S=Math.max(S,k.y);return[new l.pointGeometry(c,p),new l.pointGeometry(_,p),new l.pointGeometry(_,S),new l.pointGeometry(c,S),new l.pointGeometry(c,p)]}}}class da{constructor(r){this._hashName=r&&encodeURIComponent(r),l.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=function(s,c){let p=!1,_=null;const S=()=>{_=null,p&&(s(),_=setTimeout(S,300),p=!1)};return()=>(p=!0,_||S(),_)}(this._updateHashUnthrottled.bind(this))}addTo(r){return this._map=r,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(r){const s=this._map.getCenter(),c=Math.round(100*this._map.getZoom())/100,p=Math.ceil((c*Math.LN2+Math.log(512/360/.5))/Math.LN10),_=Math.pow(10,p),S=Math.round(s.lng*_)/_,k=Math.round(s.lat*_)/_,A=this._map.getBearing(),M=this._map.getPitch();let F="";if(F+=r?`/${S}/${k}/${c}`:`${c}/${k}/${S}`,(A||M)&&(F+="/"+Math.round(10*A)/10),M&&(F+=`/${Math.round(M)}`),this._hashName){const q=this._hashName;let H=!1;const le=window.location.hash.slice(1).split("&").map(te=>{const ee=te.split("=")[0];return ee===q?(H=!0,`${ee}=${F}`):te}).filter(te=>te);return H||le.push(`${q}=${F}`),`#${le.join("&")}`}return`#${F}`}_getCurrentHash(){const r=window.location.hash.replace("#","");if(this._hashName){let s;return r.split("&").map(c=>c.split("=")).forEach(c=>{c[0]===this._hashName&&(s=c)}),(s&&s[1]||"").split("/")}return r.split("/")}_onHashChange(){const r=this._getCurrentHash();if(r.length>=3&&!r.some(s=>isNaN(s))){const s=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(r[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+r[2],+r[1]],zoom:+r[0],bearing:s,pitch:+(r[4]||0)}),!0}return!1}_updateHashUnthrottled(){const r=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,r)}catch{}}}const fa={linearity:.3,easing:l.bezier(0,0,.3,1)},lu=l.extend({deceleration:2500,maxSpeed:1400},fa),yl=l.extend({deceleration:20,maxSpeed:1400},fa),fo=l.extend({deceleration:1e3,maxSpeed:360},fa),uu=l.extend({deceleration:1e3,maxSpeed:90},fa);class cu{constructor(r){this._map=r,this.clear()}clear(){this._inertiaBuffer=[]}record(r){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:l.exported.now(),settings:r})}_drainInertiaBuffer(){const r=this._inertiaBuffer,s=l.exported.now();for(;r.length>0&&s-r[0].time>160;)r.shift()}_onMoveEnd(r){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const s={zoom:0,bearing:0,pitch:0,pan:new l.pointGeometry(0,0),pinchAround:void 0,around:void 0};for(const{settings:_}of this._inertiaBuffer)s.zoom+=_.zoomDelta||0,s.bearing+=_.bearingDelta||0,s.pitch+=_.pitchDelta||0,_.panDelta&&s.pan._add(_.panDelta),_.around&&(s.around=_.around),_.pinchAround&&(s.pinchAround=_.pinchAround);const c=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,p={};if(s.pan.mag()){const _=pa(s.pan.mag(),c,l.extend({},lu,r||{}));p.offset=s.pan.mult(_.amount/s.pan.mag()),p.center=this._map.transform.center,Ts(p,_)}if(s.zoom){const _=pa(s.zoom,c,yl);p.zoom=this._map.transform.zoom+_.amount,Ts(p,_)}if(s.bearing){const _=pa(s.bearing,c,fo);p.bearing=this._map.transform.bearing+l.clamp(_.amount,-179,179),Ts(p,_)}if(s.pitch){const _=pa(s.pitch,c,uu);p.pitch=this._map.transform.pitch+_.amount,Ts(p,_)}if(p.zoom||p.bearing){const _=s.pinchAround===void 0?s.around:s.pinchAround;p.around=_?this._map.unproject(_):this._map.getCenter()}return this.clear(),l.extend(p,{noMoveStart:!0})}}function Ts(d,r){(!d.duration||d.duration<r.duration)&&(d.duration=r.duration,d.easing=r.easing)}function pa(d,r,s){const{maxSpeed:c,linearity:p,deceleration:_}=s,S=l.clamp(d*p/(r/1e3),-c,c),k=Math.abs(S)/(_*p);return{easing:s.easing,duration:1e3*k,amount:S*(k/2)}}class ni extends l.Event{constructor(r,s,c,p={}){const _=B.mousePos(s.getCanvasContainer(),c),S=s.unproject(_);super(r,l.extend({point:_,lngLat:S,originalEvent:c},p)),this._defaultPrevented=!1,this.target=s}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class Pn extends l.Event{constructor(r,s,c){const p=r==="touchend"?c.changedTouches:c.touches,_=B.touchPos(s.getCanvasContainer(),p),S=_.map(A=>s.unproject(A)),k=_.reduce((A,M,F,q)=>A.add(M.div(q.length)),new l.pointGeometry(0,0));super(r,{points:_,point:k,lngLats:S,lngLat:s.unproject(k),originalEvent:c}),this._defaultPrevented=!1}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class Hc extends l.Event{constructor(r,s,c){super(r,{originalEvent:c}),this._defaultPrevented=!1}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class po{constructor(r,s){this._map=r,this._clickTolerance=s.clickTolerance}reset(){delete this._mousedownPos}wheel(r){return this._firePreventable(new Hc(r.type,this._map,r))}mousedown(r,s){return this._mousedownPos=s,this._firePreventable(new ni(r.type,this._map,r))}mouseup(r){this._map.fire(new ni(r.type,this._map,r))}click(r,s){this._mousedownPos&&this._mousedownPos.dist(s)>=this._clickTolerance||this._map.fire(new ni(r.type,this._map,r))}dblclick(r){return this._firePreventable(new ni(r.type,this._map,r))}mouseover(r){this._map.fire(new ni(r.type,this._map,r))}mouseout(r){this._map.fire(new ni(r.type,this._map,r))}touchstart(r){return this._firePreventable(new Pn(r.type,this._map,r))}touchmove(r){this._map.fire(new Pn(r.type,this._map,r))}touchend(r){this._map.fire(new Pn(r.type,this._map,r))}touchcancel(r){this._map.fire(new Pn(r.type,this._map,r))}_firePreventable(r){if(this._map.fire(r),r.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class di{constructor(r){this._map=r}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(r){this._map.fire(new ni(r.type,this._map,r))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new ni("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(r){this._delayContextMenu?this._contextMenuEvent=r:this._ignoreContextMenu||this._map.fire(new ni(r.type,this._map,r)),this._map.listens("contextmenu")&&r.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class bi{constructor(r,s){this._map=r,this._el=r.getCanvasContainer(),this._container=r.getContainer(),this._clickTolerance=s.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(r,s){this.isEnabled()&&r.shiftKey&&r.button===0&&(B.disableDrag(),this._startPos=this._lastPos=s,this._active=!0)}mousemoveWindow(r,s){if(!this._active)return;const c=s;if(this._lastPos.equals(c)||!this._box&&c.dist(this._startPos)<this._clickTolerance)return;const p=this._startPos;this._lastPos=c,this._box||(this._box=B.create("div","maplibregl-boxzoom mapboxgl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair","mapboxgl-crosshair"),this._fireEvent("boxzoomstart",r));const _=Math.min(p.x,c.x),S=Math.max(p.x,c.x),k=Math.min(p.y,c.y),A=Math.max(p.y,c.y);B.setTransform(this._box,`translate(${_}px,${k}px)`),this._box.style.width=S-_+"px",this._box.style.height=A-k+"px"}mouseupWindow(r,s){if(!this._active||r.button!==0)return;const c=this._startPos,p=s;if(this.reset(),B.suppressClick(),c.x!==p.x||c.y!==p.y)return this._map.fire(new l.Event("boxzoomend",{originalEvent:r})),{cameraAnimation:_=>_.fitScreenCoordinates(c,p,this._map.getBearing(),{linear:!0})};this._fireEvent("boxzoomcancel",r)}keydown(r){this._active&&r.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",r))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair","mapboxgl-crosshair"),this._box&&(B.remove(this._box),this._box=null),B.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(r,s){return this._map.fire(new l.Event(r,{originalEvent:s}))}}function mo(d,r){if(d.length!==r.length)throw new Error(`The number of touches and points are not equal - touches ${d.length}, points ${r.length}`);const s={};for(let c=0;c<d.length;c++)s[d[c].identifier]=r[c];return s}class Wu{constructor(r){this.reset(),this.numTouches=r.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(r,s,c){(this.centroid||c.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=r.timeStamp),c.length===this.numTouches&&(this.centroid=function(p){const _=new l.pointGeometry(0,0);for(const S of p)_._add(S);return _.div(p.length)}(s),this.touches=mo(c,s)))}touchmove(r,s,c){if(this.aborted||!this.centroid)return;const p=mo(c,s);for(const _ in this.touches){const S=this.touches[_],k=p[_];(!k||k.dist(S)>30)&&(this.aborted=!0)}}touchend(r,s,c){if((!this.centroid||r.timeStamp-this.startTime>500)&&(this.aborted=!0),c.length===0){const p=!this.aborted&&this.centroid;if(this.reset(),p)return p}}}class _l{constructor(r){this.singleTap=new Wu(r),this.numTaps=r.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(r,s,c){this.singleTap.touchstart(r,s,c)}touchmove(r,s,c){this.singleTap.touchmove(r,s,c)}touchend(r,s,c){const p=this.singleTap.touchend(r,s,c);if(p){const _=r.timeStamp-this.lastTime<500,S=!this.lastTap||this.lastTap.dist(p)<30;if(_&&S||this.reset(),this.count++,this.lastTime=r.timeStamp,this.lastTap=p,this.count===this.numTaps)return this.reset(),p}}}class Hu{constructor(){this._zoomIn=new _l({numTouches:1,numTaps:2}),this._zoomOut=new _l({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(r,s,c){this._zoomIn.touchstart(r,s,c),this._zoomOut.touchstart(r,s,c)}touchmove(r,s,c){this._zoomIn.touchmove(r,s,c),this._zoomOut.touchmove(r,s,c)}touchend(r,s,c){const p=this._zoomIn.touchend(r,s,c),_=this._zoomOut.touchend(r,s,c);return p?(this._active=!0,r.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:S=>S.easeTo({duration:300,zoom:S.getZoom()+1,around:S.unproject(p)},{originalEvent:r})}):_?(this._active=!0,r.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:S=>S.easeTo({duration:300,zoom:S.getZoom()-1,around:S.unproject(_)},{originalEvent:r})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const vl={0:1,2:2};class qo{constructor(r){this.reset(),this._clickTolerance=r.clickTolerance||1}reset(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton}_correctButton(r,s){return!1}_move(r,s){return{}}mousedown(r,s){if(this._lastPoint)return;const c=B.mouseButton(r);this._correctButton(r,c)&&(this._lastPoint=s,this._eventButton=c)}mousemoveWindow(r,s){const c=this._lastPoint;if(c){if(r.preventDefault(),function(p,_){const S=vl[_];return p.buttons===void 0||(p.buttons&S)!==S}(r,this._eventButton))this.reset();else if(this._moved||!(s.dist(c)<this._clickTolerance))return this._moved=!0,this._lastPoint=s,this._move(c,s)}}mouseupWindow(r){this._lastPoint&&B.mouseButton(r)===this._eventButton&&(this._moved&&B.suppressClick(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class go extends qo{mousedown(r,s){super.mousedown(r,s),this._lastPoint&&(this._active=!0)}_correctButton(r,s){return s===0&&!r.ctrlKey}_move(r,s){return{around:s,panDelta:s.sub(r)}}}class Pt extends qo{_correctButton(r,s){return s===0&&r.ctrlKey||s===2}_move(r,s){const c=.8*(s.x-r.x);if(c)return this._active=!0,{bearingDelta:c}}contextmenu(r){r.preventDefault()}}class ma extends qo{_correctButton(r,s){return s===0&&r.ctrlKey||s===2}_move(r,s){const c=-.5*(s.y-r.y);if(c)return this._active=!0,{pitchDelta:c}}contextmenu(r){r.preventDefault()}}class Xi{constructor(r,s){this._minTouches=r.cooperativeGestures?2:1,this._clickTolerance=r.clickTolerance||1,this._map=s,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new l.pointGeometry(0,0),setTimeout(()=>{this._cancelCooperativeMessage=!1},200)}touchstart(r,s,c){return this._calculateTransform(r,s,c)}touchmove(r,s,c){if(this._map._cooperativeGestures&&(this._minTouches===2&&c.length<2&&!this._cancelCooperativeMessage?this._map._onCooperativeGesture(r,!1,c.length):this._cancelCooperativeMessage||(this._cancelCooperativeMessage=!0)),this._active&&!(c.length<this._minTouches))return r.preventDefault(),this._calculateTransform(r,s,c)}touchend(r,s,c){this._calculateTransform(r,s,c),this._active&&c.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(r,s,c){c.length>0&&(this._active=!0);const p=mo(c,s),_=new l.pointGeometry(0,0),S=new l.pointGeometry(0,0);let k=0;for(const M in p){const F=p[M],q=this._touches[M];q&&(_._add(F),S._add(F.sub(q)),k++,p[M]=F)}if(this._touches=p,k<this._minTouches||!S.mag())return;const A=S.div(k);return this._sum._add(A),this._sum.mag()<this._clickTolerance?void 0:{around:_.div(k),panDelta:A}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ki{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}_start(r){}_move(r,s,c){return{}}touchstart(r,s,c){this._firstTwoTouches||c.length<2||(this._firstTwoTouches=[c[0].identifier,c[1].identifier],this._start([s[0],s[1]]))}touchmove(r,s,c){if(!this._firstTwoTouches)return;r.preventDefault();const[p,_]=this._firstTwoTouches,S=ks(c,s,p),k=ks(c,s,_);if(!S||!k)return;const A=this._aroundCenter?null:S.add(k).div(2);return this._move([S,k],A,r)}touchend(r,s,c){if(!this._firstTwoTouches)return;const[p,_]=this._firstTwoTouches,S=ks(c,s,p),k=ks(c,s,_);S&&k||(this._active&&B.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(r){this._enabled=!0,this._aroundCenter=!!r&&r.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function ks(d,r,s){for(let c=0;c<d.length;c++)if(d[c].identifier===s)return r[c]}function St(d,r){return Math.log(d/r)/Math.LN2}class yo extends Ki{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(r){this._startDistance=this._distance=r[0].dist(r[1])}_move(r,s){const c=this._distance;if(this._distance=r[0].dist(r[1]),this._active||!(Math.abs(St(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:St(this._distance,c),pinchAround:s}}}function xl(d,r){return 180*d.angleWith(r)/Math.PI}class Xu extends Ki{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(r){this._startVector=this._vector=r[0].sub(r[1]),this._minDiameter=r[0].dist(r[1])}_move(r,s){const c=this._vector;if(this._vector=r[0].sub(r[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:xl(this._vector,c),pinchAround:s}}_isBelowThreshold(r){this._minDiameter=Math.min(this._minDiameter,r.mag());const s=25/(Math.PI*this._minDiameter)*360,c=xl(r,this._startVector);return Math.abs(c)<s}}function _o(d){return Math.abs(d.y)>Math.abs(d.x)}class hu extends Ki{constructor(r){super(),this._map=r}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(r,s,c){super.touchstart(r,s,c),this._currentTouchCount=c.length}_start(r){this._lastPoints=r,_o(r[0].sub(r[1]))&&(this._valid=!1)}_move(r,s,c){if(this._map._cooperativeGestures&&this._currentTouchCount<3)return;const p=r[0].sub(this._lastPoints[0]),_=r[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(p,_,c.timeStamp),this._valid?(this._lastPoints=r,this._active=!0,{pitchDelta:(p.y+_.y)/2*-.5}):void 0}gestureBeginsVertically(r,s,c){if(this._valid!==void 0)return this._valid;const p=r.mag()>=2,_=s.mag()>=2;if(!p&&!_)return;if(!p||!_)return this._firstMove===void 0&&(this._firstMove=c),c-this._firstMove<100&&void 0;const S=r.y>0==s.y>0;return _o(r)&&_o(s)&&S}}const du={panStep:100,bearingStep:15,pitchStep:10};class Ku{constructor(){const r=du;this._panStep=r.panStep,this._bearingStep=r.bearingStep,this._pitchStep=r.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(r){if(r.altKey||r.ctrlKey||r.metaKey)return;let s=0,c=0,p=0,_=0,S=0;switch(r.keyCode){case 61:case 107:case 171:case 187:s=1;break;case 189:case 109:case 173:s=-1;break;case 37:r.shiftKey?c=-1:(r.preventDefault(),_=-1);break;case 39:r.shiftKey?c=1:(r.preventDefault(),_=1);break;case 38:r.shiftKey?p=1:(r.preventDefault(),S=-1);break;case 40:r.shiftKey?p=-1:(r.preventDefault(),S=1);break;default:return}return this._rotationDisabled&&(c=0,p=0),{cameraAnimation:k=>{const A=k.getZoom();k.easeTo({duration:300,easeId:"keyboardHandler",easing:Yu,zoom:s?Math.round(A)+s*(r.shiftKey?2:1):A,bearing:k.getBearing()+c*this._bearingStep,pitch:k.getPitch()+p*this._pitchStep,offset:[-_*this._panStep,-S*this._panStep],center:k.getCenter()},{originalEvent:r})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Yu(d){return d*(2-d)}const ga=4.000244140625;class wl{constructor(r,s){this._map=r,this._el=r.getCanvasContainer(),this._handler=s,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,l.bindAll(["_onTimeout"],this)}setZoomRate(r){this._defaultZoomRate=r}setWheelZoomRate(r){this._wheelZoomRate=r}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(r){this.isEnabled()||(this._enabled=!0,this._aroundCenter=r&&r.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(r){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!this._map._metaPress)return;r.preventDefault()}let s=r.deltaMode===WheelEvent.DOM_DELTA_LINE?40*r.deltaY:r.deltaY;const c=l.exported.now(),p=c-(this._lastWheelEventTime||0);this._lastWheelEventTime=c,s!==0&&s%ga==0?this._type="wheel":s!==0&&Math.abs(s)<4?this._type="trackpad":p>400?(this._type=null,this._lastValue=s,this._timeout=setTimeout(this._onTimeout,40,r)):this._type||(this._type=Math.abs(p*s)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,s+=this._lastValue)),r.shiftKey&&s&&(s/=4),this._type&&(this._lastWheelEvent=r,this._delta-=s,this._active||this._start(r)),r.preventDefault()}_onTimeout(r){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(r)}_start(r){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const s=B.mousePos(this._el,r);this._around=l.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(s)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const r=this._map.transform;if(this._delta!==0){const k=this._type==="wheel"&&Math.abs(this._delta)>ga?this._wheelZoomRate:this._defaultZoomRate;let A=2/(1+Math.exp(-Math.abs(this._delta*k)));this._delta<0&&A!==0&&(A=1/A);const M=typeof this._targetZoom=="number"?r.zoomScale(this._targetZoom):r.scale;this._targetZoom=Math.min(r.maxZoom,Math.max(r.minZoom,r.scaleZoom(M*A))),this._type==="wheel"&&(this._startZoom=r.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const s=typeof this._targetZoom=="number"?this._targetZoom:r.zoom,c=this._startZoom,p=this._easing;let _,S=!1;if(this._type==="wheel"&&c&&p){const k=Math.min((l.exported.now()-this._lastWheelEventTime)/200,1),A=p(k);_=l.number(c,s,A),k<1?this._frameId||(this._frameId=!0):S=!0}else _=s,S=!0;return this._active=!0,S&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!S,zoomDelta:_-r.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(r){let s=l.ease;if(this._prevEase){const c=this._prevEase,p=(l.exported.now()-c.start)/c.duration,_=c.easing(p+.01)-c.easing(p),S=.27/Math.sqrt(_*_+1e-4)*.01,k=Math.sqrt(.0729-S*S);s=l.bezier(S,k,.25,1)}return this._prevEase={start:l.exported.now(),duration:r,easing:s},s}reset(){this._active=!1}}class Li{constructor(r,s){this._clickZoom=r,this._tapZoom=s}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class ya{constructor(){this.reset()}reset(){this._active=!1}dblclick(r,s){return r.preventDefault(),{cameraAnimation:c=>{c.easeTo({duration:300,zoom:c.getZoom()+(r.shiftKey?-1:1),around:c.unproject(s)},{originalEvent:r})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Mn{constructor(){this._tap=new _l({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()}touchstart(r,s,c){this._swipePoint||(this._tapTime&&r.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?c.length>0&&(this._swipePoint=s[0],this._swipeTouch=c[0].identifier):this._tap.touchstart(r,s,c))}touchmove(r,s,c){if(this._tapTime){if(this._swipePoint){if(c[0].identifier!==this._swipeTouch)return;const p=s[0],_=p.y-this._swipePoint.y;return this._swipePoint=p,r.preventDefault(),this._active=!0,{zoomDelta:_/128}}}else this._tap.touchmove(r,s,c)}touchend(r,s,c){this._tapTime?this._swipePoint&&c.length===0&&this.reset():this._tap.touchend(r,s,c)&&(this._tapTime=r.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class vo{constructor(r,s,c){this._el=r,this._mousePan=s,this._touchPan=c}enable(r){this._inertiaOptions=r||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan","mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan","mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Ju{constructor(r,s,c){this._pitchWithRotate=r.pitchWithRotate,this._mouseRotate=s,this._mousePitch=c}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Wo{constructor(r,s,c,p){this._el=r,this._touchZoom=s,this._touchRotate=c,this._tapDragZoom=p,this._rotationDisabled=!1,this._enabled=!0}enable(r){this._touchZoom.enable(r),this._rotationDisabled||this._touchRotate.enable(r),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate","mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate","mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Cs=d=>d.zoom||d.drag||d.pitch||d.rotate;class bl extends l.Event{}function _a(d){return d.panDelta&&d.panDelta.mag()||d.zoomDelta||d.bearingDelta||d.pitchDelta}class _r{constructor(r,s){this._map=r,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new cu(r),this._bearingSnap=s.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(s),l.bindAll(["handleEvent","handleWindowEvent"],this);const c=this._el;this._listeners=[[c,"touchstart",{passive:!0}],[c,"touchmove",{passive:!1}],[c,"touchend",void 0],[c,"touchcancel",void 0],[c,"mousedown",void 0],[c,"mousemove",void 0],[c,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[c,"mouseover",void 0],[c,"mouseout",void 0],[c,"dblclick",void 0],[c,"click",void 0],[c,"keydown",{capture:!1}],[c,"keyup",void 0],[c,"wheel",{passive:!1}],[c,"contextmenu",void 0],[window,"blur",void 0]];for(const[p,_,S]of this._listeners)B.addEventListener(p,_,p===document?this.handleWindowEvent:this.handleEvent,S)}destroy(){for(const[r,s,c]of this._listeners)B.removeEventListener(r,s,r===document?this.handleWindowEvent:this.handleEvent,c)}_addDefaultHandlers(r){const s=this._map,c=s.getCanvasContainer();this._add("mapEvent",new po(s,r));const p=s.boxZoom=new bi(s,r);this._add("boxZoom",p);const _=new Hu,S=new ya;s.doubleClickZoom=new Li(S,_),this._add("tapZoom",_),this._add("clickZoom",S);const k=new Mn;this._add("tapDragZoom",k);const A=s.touchPitch=new hu(s);this._add("touchPitch",A);const M=new Pt(r),F=new ma(r);s.dragRotate=new Ju(r,M,F),this._add("mouseRotate",M,["mousePitch"]),this._add("mousePitch",F,["mouseRotate"]);const q=new go(r),H=new Xi(r,s);s.dragPan=new vo(c,q,H),this._add("mousePan",q),this._add("touchPan",H,["touchZoom","touchRotate"]);const le=new Xu,te=new yo;s.touchZoomRotate=new Wo(c,te,le,k),this._add("touchRotate",le,["touchPan","touchZoom"]),this._add("touchZoom",te,["touchPan","touchRotate"]);const ee=s.scrollZoom=new wl(s,this);this._add("scrollZoom",ee,["mousePan"]);const ye=s.keyboard=new Ku;this._add("keyboard",ye),this._add("blockableMapEvent",new di(s));for(const Ae of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])r.interactive&&r[Ae]&&s[Ae].enable(r[Ae])}_add(r,s,c){this._handlers.push({handlerName:r,handler:s,allowed:c}),this._handlersById[r]=s}stop(r){if(!this._updatingCamera){for(const{handler:s}of this._handlers)s.reset();this._inertia.clear(),this._fireEvents({},{},r),this._changes=[]}}isActive(){for(const{handler:r}of this._handlers)if(r.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Cs(this._eventsInProgress)||this.isZooming()}_blockedByActive(r,s,c){for(const p in r)if(p!==c&&(!s||s.indexOf(p)<0))return!0;return!1}handleWindowEvent(r){this.handleEvent(r,`${r.type}Window`)}_getMapTouches(r){const s=[];for(const c of r)this._el.contains(c.target)&&s.push(c);return s}handleEvent(r,s){if(r.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const c=r.type==="renderFrame"?void 0:r,p={needsRenderFrame:!1},_={},S={},k=r.touches,A=k?this._getMapTouches(k):void 0,M=A?B.touchPos(this._el,A):B.mousePos(this._el,r);for(const{handlerName:H,handler:le,allowed:te}of this._handlers){if(!le.isEnabled())continue;let ee;this._blockedByActive(S,te,H)?le.reset():le[s||r.type]&&(ee=le[s||r.type](r,M,A),this.mergeHandlerResult(p,_,ee,H,c),ee&&ee.needsRenderFrame&&this._triggerRenderFrame()),(ee||le.isActive())&&(S[H]=le)}const F={};for(const H in this._previousActiveHandlers)S[H]||(F[H]=c);this._previousActiveHandlers=S,(Object.keys(F).length||_a(p))&&(this._changes.push([p,_,F]),this._triggerRenderFrame()),(Object.keys(S).length||_a(p))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:q}=p;q&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],q(this._map))}mergeHandlerResult(r,s,c,p,_){if(!c)return;l.extend(r,c);const S={handlerName:p,originalEvent:c.originalEvent||_};c.zoomDelta!==void 0&&(s.zoom=S),c.panDelta!==void 0&&(s.drag=S),c.pitchDelta!==void 0&&(s.pitch=S),c.bearingDelta!==void 0&&(s.rotate=S)}_applyChanges(){const r={},s={},c={};for(const[p,_,S]of this._changes)p.panDelta&&(r.panDelta=(r.panDelta||new l.pointGeometry(0,0))._add(p.panDelta)),p.zoomDelta&&(r.zoomDelta=(r.zoomDelta||0)+p.zoomDelta),p.bearingDelta&&(r.bearingDelta=(r.bearingDelta||0)+p.bearingDelta),p.pitchDelta&&(r.pitchDelta=(r.pitchDelta||0)+p.pitchDelta),p.around!==void 0&&(r.around=p.around),p.pinchAround!==void 0&&(r.pinchAround=p.pinchAround),p.noInertia&&(r.noInertia=p.noInertia),l.extend(s,_),l.extend(c,S);this._updateMapTransform(r,s,c),this._changes=[]}_updateMapTransform(r,s,c){const p=this._map,_=p.transform,S=p.style&&p.style.terrain;if(!(_a(r)||S&&this._drag))return this._fireEvents(s,c,!0);let{panDelta:k,zoomDelta:A,bearingDelta:M,pitchDelta:F,around:q,pinchAround:H}=r;H!==void 0&&(q=H),p._stop(!0),q=q||p.transform.centerPoint;const le=_.pointLocation(k?q.sub(k):q);M&&(_.bearing+=M),F&&(_.pitch+=F),A&&(_.zoom+=A),S?s.drag&&!this._drag?(this._drag={center:_.centerPoint,lngLat:_.pointLocation(q),point:q,handlerName:s.drag.handlerName},p.fire(new l.Event("freezeElevation",{freeze:!0}))):this._drag&&c[this._drag.handlerName]?(p.fire(new l.Event("freezeElevation",{freeze:!1})),this._drag=null):s.drag&&this._drag&&(_.center=_.pointLocation(_.centerPoint.sub(k))):_.setLocationAtPoint(le,q),this._map._update(),r.noInertia||this._inertia.record(r),this._fireEvents(s,c,!0)}_fireEvents(r,s,c){const p=Cs(this._eventsInProgress),_=Cs(r),S={};for(const F in r){const{originalEvent:q}=r[F];this._eventsInProgress[F]||(S[`${F}start`]=q),this._eventsInProgress[F]=r[F]}!p&&_&&this._fireEvent("movestart",_.originalEvent);for(const F in S)this._fireEvent(F,S[F]);_&&this._fireEvent("move",_.originalEvent);for(const F in r){const{originalEvent:q}=r[F];this._fireEvent(F,q)}const k={};let A;for(const F in this._eventsInProgress){const{handlerName:q,originalEvent:H}=this._eventsInProgress[F];this._handlersById[q].isActive()||(delete this._eventsInProgress[F],A=s[q]||H,k[`${F}end`]=A)}for(const F in k)this._fireEvent(F,k[F]);const M=Cs(this._eventsInProgress);if(c&&(p||_)&&!M){this._updatingCamera=!0;const F=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),q=H=>H!==0&&-this._bearingSnap<H&&H<this._bearingSnap;F?(q(F.bearing||this._map.getBearing())&&(F.bearing=0),this._map.easeTo(F,{originalEvent:A})):(this._map.fire(new l.Event("moveend",{originalEvent:A})),q(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(r,s){this._map.fire(new l.Event(r,s?{originalEvent:s}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(r=>{delete this._frameId,this.handleEvent(new bl("renderFrame",{timeStamp:r})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const Mr={extend:(d,...r)=>l.extend(d,...r),run(d){d()},logToElement(d,r=!1,s="log"){const c=window.document.getElementById(s);c&&(r&&(c.innerHTML=""),c.innerHTML+=`<br>${d}`)}};class Ho extends l.Evented{constructor(r,s){super(),this._moving=!1,this._zooming=!1,this.transform=r,this._bearingSnap=s.bearingSnap,l.bindAll(["_renderFrameCallback"],this)}getCenter(){return new l.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(r,s){return this.jumpTo({center:r},s)}panBy(r,s,c){return r=l.pointGeometry.convert(r).mult(-1),this.panTo(this.transform.center,l.extend({offset:r},s),c)}panTo(r,s,c){return this.easeTo(l.extend({center:r},s),c)}getZoom(){return this.transform.zoom}setZoom(r,s){return this.jumpTo({zoom:r},s),this}zoomTo(r,s,c){return this.easeTo(l.extend({zoom:r},s),c)}zoomIn(r,s){return this.zoomTo(this.getZoom()+1,r,s),this}zoomOut(r,s){return this.zoomTo(this.getZoom()-1,r,s),this}getBearing(){return this.transform.bearing}setBearing(r,s){return this.jumpTo({bearing:r},s),this}getPadding(){return this.transform.padding}setPadding(r,s){return this.jumpTo({padding:r},s),this}rotateTo(r,s,c){return this.easeTo(l.extend({bearing:r},s),c)}resetNorth(r,s){return this.rotateTo(0,l.extend({duration:1e3},r),s),this}resetNorthPitch(r,s){return this.easeTo(l.extend({bearing:0,pitch:0,duration:1e3},r),s),this}snapToNorth(r,s){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(r,s):this}getPitch(){return this.transform.pitch}setPitch(r,s){return this.jumpTo({pitch:r},s),this}cameraForBounds(r,s){r=l.LngLatBounds.convert(r);const c=s&&s.bearing||0;return this._cameraForBoxAndBearing(r.getNorthWest(),r.getSouthEast(),c,s)}_cameraForBoxAndBearing(r,s,c,p){const _={top:0,bottom:0,right:0,left:0};if(typeof(p=l.extend({padding:_,offset:[0,0],maxZoom:this.transform.maxZoom},p)).padding=="number"){const Oe=p.padding;p.padding={top:Oe,bottom:Oe,right:Oe,left:Oe}}p.padding=l.extend(_,p.padding);const S=this.transform,k=S.padding,A=S.project(l.LngLat.convert(r)),M=S.project(l.LngLat.convert(s)),F=A.rotate(-c*Math.PI/180),q=M.rotate(-c*Math.PI/180),H=new l.pointGeometry(Math.max(F.x,q.x),Math.max(F.y,q.y)),le=new l.pointGeometry(Math.min(F.x,q.x),Math.min(F.y,q.y)),te=H.sub(le),ee=(S.width-(k.left+k.right+p.padding.left+p.padding.right))/te.x,ye=(S.height-(k.top+k.bottom+p.padding.top+p.padding.bottom))/te.y;if(ye<0||ee<0)return void l.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const Ae=Math.min(S.scaleZoom(S.scale*Math.min(ee,ye)),p.maxZoom),Pe=l.pointGeometry.convert(p.offset),he=new l.pointGeometry((p.padding.left-p.padding.right)/2,(p.padding.top-p.padding.bottom)/2).rotate(c*Math.PI/180),Ve=Pe.add(he).mult(S.scale/S.zoomScale(Ae));return{center:S.unproject(A.add(M).div(2).sub(Ve)),zoom:Ae,bearing:c}}fitBounds(r,s,c){return this._fitInternal(this.cameraForBounds(r,s),s,c)}fitScreenCoordinates(r,s,c,p,_){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(l.pointGeometry.convert(r)),this.transform.pointLocation(l.pointGeometry.convert(s)),c,p),p,_)}_fitInternal(r,s,c){return r?(delete(s=l.extend(r,s)).padding,s.linear?this.easeTo(s,c):this.flyTo(s,c)):this}jumpTo(r,s){this.stop();const c=this.transform;let p=!1,_=!1,S=!1;return"zoom"in r&&c.zoom!==+r.zoom&&(p=!0,c.zoom=+r.zoom),r.center!==void 0&&(c.center=l.LngLat.convert(r.center)),"bearing"in r&&c.bearing!==+r.bearing&&(_=!0,c.bearing=+r.bearing),"pitch"in r&&c.pitch!==+r.pitch&&(S=!0,c.pitch=+r.pitch),r.padding==null||c.isPaddingEqual(r.padding)||(c.padding=r.padding),this.fire(new l.Event("movestart",s)).fire(new l.Event("move",s)),p&&this.fire(new l.Event("zoomstart",s)).fire(new l.Event("zoom",s)).fire(new l.Event("zoomend",s)),_&&this.fire(new l.Event("rotatestart",s)).fire(new l.Event("rotate",s)).fire(new l.Event("rotateend",s)),S&&this.fire(new l.Event("pitchstart",s)).fire(new l.Event("pitch",s)).fire(new l.Event("pitchend",s)),this.fire(new l.Event("moveend",s))}calculateCameraOptionsFromTo(r,s,c,p=0){const _=l.MercatorCoordinate.fromLngLat(r,s),S=l.MercatorCoordinate.fromLngLat(c,p),k=S.x-_.x,A=S.y-_.y,M=S.z-_.z,F=Math.hypot(k,A,M);if(F===0)throw new Error("Can't calculate camera options with same From and To");const q=Math.hypot(k,A),H=this.transform.scaleZoom(this.transform.cameraToCenterDistance/F/this.transform.tileSize),le=180*Math.atan2(k,-A)/Math.PI;let te=180*Math.acos(q/F)/Math.PI;return te=M<0?90-te:90+te,{center:S.toLngLat(),zoom:H,pitch:te,bearing:le}}easeTo(r,s){this._stop(!1,r.easeId),((r=l.extend({offset:[0,0],duration:500,easing:l.ease},r)).animate===!1||!r.essential&&l.exported.prefersReducedMotion)&&(r.duration=0);const c=this.transform,p=this.getZoom(),_=this.getBearing(),S=this.getPitch(),k=this.getPadding(),A="zoom"in r?+r.zoom:p,M="bearing"in r?this._normalizeBearing(r.bearing,_):_,F="pitch"in r?+r.pitch:S,q="padding"in r?r.padding:c.padding,H=l.pointGeometry.convert(r.offset);let le=c.centerPoint.add(H);const te=c.pointLocation(le),ee=l.LngLat.convert(r.center||te);this._normalizeCenter(ee);const ye=c.project(te),Ae=c.project(ee).sub(ye),Pe=c.zoomScale(A-p);let he,Ve;r.around&&(he=l.LngLat.convert(r.around),Ve=c.locationPoint(he));const Oe={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||A!==p,this._rotating=this._rotating||_!==M,this._pitching=this._pitching||F!==S,this._padding=!c.isPaddingEqual(q),this._easeId=r.easeId,this._prepareEase(s,r.noMoveStart,Oe),this._ease(Xe=>{if(this._zooming&&(c.zoom=l.number(p,A,Xe)),this._rotating&&(c.bearing=l.number(_,M,Xe)),this._pitching&&(c.pitch=l.number(S,F,Xe)),this._padding&&(c.interpolatePadding(k,q,Xe),le=c.centerPoint.add(H)),he)c.setLocationAtPoint(he,Ve);else{const rt=c.zoomScale(c.zoom-p),pt=A>p?Math.min(2,Pe):Math.max(.5,Pe),et=Math.pow(pt,1-Xe),It=c.unproject(ye.add(Ae.mult(Xe*et)).mult(rt));c.setLocationAtPoint(c.renderWorldCopies?It.wrap():It,le)}this._fireMoveEvents(s)},Xe=>{this._afterEase(s,Xe)},r),this}_prepareEase(r,s,c={}){this._moving=!0,this.fire(new l.Event("freezeElevation",{freeze:!0})),s||c.moving||this.fire(new l.Event("movestart",r)),this._zooming&&!c.zooming&&this.fire(new l.Event("zoomstart",r)),this._rotating&&!c.rotating&&this.fire(new l.Event("rotatestart",r)),this._pitching&&!c.pitching&&this.fire(new l.Event("pitchstart",r))}_fireMoveEvents(r){this.fire(new l.Event("move",r)),this._zooming&&this.fire(new l.Event("zoom",r)),this._rotating&&this.fire(new l.Event("rotate",r)),this._pitching&&this.fire(new l.Event("pitch",r))}_afterEase(r,s){if(this._easeId&&s&&this._easeId===s)return;delete this._easeId,this.fire(new l.Event("freezeElevation",{freeze:!1}));const c=this._zooming,p=this._rotating,_=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,c&&this.fire(new l.Event("zoomend",r)),p&&this.fire(new l.Event("rotateend",r)),_&&this.fire(new l.Event("pitchend",r)),this.fire(new l.Event("moveend",r))}flyTo(r,s){if(!r.essential&&l.exported.prefersReducedMotion){const jt=l.pick(r,["center","zoom","bearing","pitch","around"]);return this.jumpTo(jt,s)}this.stop(),r=l.extend({offset:[0,0],speed:1.2,curve:1.42,easing:l.ease},r);const c=this.transform,p=this.getZoom(),_=this.getBearing(),S=this.getPitch(),k=this.getPadding(),A="zoom"in r?l.clamp(+r.zoom,c.minZoom,c.maxZoom):p,M="bearing"in r?this._normalizeBearing(r.bearing,_):_,F="pitch"in r?+r.pitch:S,q="padding"in r?r.padding:c.padding,H=c.zoomScale(A-p),le=l.pointGeometry.convert(r.offset);let te=c.centerPoint.add(le);const ee=c.pointLocation(te),ye=l.LngLat.convert(r.center||ee);this._normalizeCenter(ye);const Ae=c.project(ee),Pe=c.project(ye).sub(Ae);let he=r.curve;const Ve=Math.max(c.width,c.height),Oe=Ve/H,Xe=Pe.mag();if("minZoom"in r){const jt=l.clamp(Math.min(r.minZoom,p,A),c.minZoom,c.maxZoom),Ir=Ve/c.zoomScale(jt-p);he=Math.sqrt(Ir/Xe*2)}const rt=he*he;function pt(jt){const Ir=(Oe*Oe-Ve*Ve+(jt?-1:1)*rt*rt*Xe*Xe)/(2*(jt?Oe:Ve)*rt*Xe);return Math.log(Math.sqrt(Ir*Ir+1)-Ir)}function et(jt){return(Math.exp(jt)-Math.exp(-jt))/2}function It(jt){return(Math.exp(jt)+Math.exp(-jt))/2}const wt=pt(0);let Tt=function(jt){return It(wt)/It(wt+he*jt)},Ht=function(jt){return Ve*((It(wt)*(et(Ir=wt+he*jt)/It(Ir))-et(wt))/rt)/Xe;var Ir},Jt=(pt(1)-wt)/he;if(Math.abs(Xe)<1e-6||!isFinite(Jt)){if(Math.abs(Ve-Oe)<1e-6)return this.easeTo(r,s);const jt=Oe<Ve?-1:1;Jt=Math.abs(Math.log(Oe/Ve))/he,Ht=function(){return 0},Tt=function(Ir){return Math.exp(jt*he*Ir)}}return r.duration="duration"in r?+r.duration:1e3*Jt/("screenSpeed"in r?+r.screenSpeed/he:+r.speed),r.maxDuration&&r.duration>r.maxDuration&&(r.duration=0),this._zooming=!0,this._rotating=_!==M,this._pitching=F!==S,this._padding=!c.isPaddingEqual(q),this._prepareEase(s,!1),this._ease(jt=>{const Ir=jt*Jt,cr=1/Tt(Ir);c.zoom=jt===1?A:p+c.scaleZoom(cr),this._rotating&&(c.bearing=l.number(_,M,jt)),this._pitching&&(c.pitch=l.number(S,F,jt)),this._padding&&(c.interpolatePadding(k,q,jt),te=c.centerPoint.add(le));const ir=jt===1?ye:c.unproject(Ae.add(Pe.mult(Ht(Ir))).mult(cr));c.setLocationAtPoint(c.renderWorldCopies?ir.wrap():ir,te),this._fireMoveEvents(s)},()=>this._afterEase(s),r),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(r,s){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const c=this._onEaseEnd;delete this._onEaseEnd,c.call(this,s)}if(!r){const c=this.handlers;c&&c.stop(!1)}return this}_ease(r,s,c){c.animate===!1||c.duration===0?(r(1),s()):(this._easeStart=l.exported.now(),this._easeOptions=c,this._onEaseFrame=r,this._onEaseEnd=s,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const r=Math.min((l.exported.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(r)),r<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(r,s){r=l.wrap(r,-180,180);const c=Math.abs(r-s);return Math.abs(r-360-s)<c&&(r-=360),Math.abs(r+360-s)<c&&(r+=360),r}_normalizeCenter(r){const s=this.transform;if(!s.renderWorldCopies||s.lngRange)return;const c=r.lng-s.center.lng;r.lng+=c>180?-360:c<-180?360:0}}class xo{constructor(r={}){this.options=r,l.bindAll(["_toggleAttribution","_updateData","_updateCompact","_updateCompactMinimize"],this)}getDefaultPosition(){return"bottom-right"}onAdd(r){return this._map=r,this._compact=this.options&&this.options.compact,this._container=B.create("details","maplibregl-ctrl maplibregl-ctrl-attrib mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=B.create("summary","maplibregl-ctrl-attrib-button mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=B.create("div","maplibregl-ctrl-attrib-inner mapboxgl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){B.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(r,s){const c=this._map._getUIString(`AttributionControl.${s}`);r.title=c,r.setAttribute("aria-label",c)}_toggleAttribution(){this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show","mapboxgl-compact-show")):(this._container.classList.add("maplibregl-compact-show","mapboxgl-compact-show"),this._container.removeAttribute("open")))}_updateData(r){!r||r.sourceDataType!=="metadata"&&r.sourceDataType!=="visibility"&&r.dataType!=="style"&&r.type!=="terrain"||this._updateAttributions()}_updateAttributions(){if(!this._map.style)return;let r=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?r=r.concat(this.options.customAttribution.map(p=>typeof p!="string"?"":p)):typeof this.options.customAttribution=="string"&&r.push(this.options.customAttribution)),this._map.style.stylesheet){const p=this._map.style.stylesheet;this.styleOwner=p.owner,this.styleId=p.id}const s=this._map.style.sourceCaches;for(const p in s){const _=s[p];if(_.used||_.usedForTerrain){const S=_.getSource();S.attribution&&r.indexOf(S.attribution)<0&&r.push(S.attribution)}}r=r.filter(p=>String(p).trim()),r.sort((p,_)=>p.length-_.length),r=r.filter((p,_)=>{for(let S=_+1;S<r.length;S++)if(r[S].indexOf(p)>=0)return!1;return!0});const c=r.join(" | ");c!==this._attribHTML&&(this._attribHTML=c,r.length?(this._innerContainer.innerHTML=c,this._container.classList.remove("maplibregl-attrib-empty","mapboxgl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty","mapboxgl-attrib-empty"),this._updateCompact(),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","mapboxgl-compact","maplibregl-compact-show","mapboxgl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show","mapboxgl-compact","mapboxgl-compact-show"))}_updateCompactMinimize(){this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show","mapboxgl-compact-show")}}class Sl{constructor(r={}){this.options=r,l.bindAll(["_updateCompact"],this)}getDefaultPosition(){return"bottom-left"}onAdd(r){this._map=r,this._compact=this.options&&this.options.compact,this._container=B.create("div","maplibregl-ctrl mapboxgl-ctrl");const s=B.create("a","maplibregl-ctrl-logo mapboxgl-ctrl-logo");return s.target="_blank",s.rel="noopener nofollow",s.href="https://maplibre.org/",s.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),s.setAttribute("rel","noopener nofollow"),this._container.appendChild(s),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){B.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}_updateCompact(){const r=this._container.children;if(r.length){const s=r[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&s.classList.add("maplibregl-compact","mapboxgl-compact"):s.classList.remove("maplibregl-compact","mapboxgl-compact")}}}class El{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(r){const s=++this._id;return this._queue.push({callback:r,id:s,cancelled:!1}),s}remove(r){const s=this._currentlyRunning,c=s?this._queue.concat(s):this._queue;for(const p of c)if(p.id===r)return void(p.cancelled=!0)}run(r=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const s=this._currentlyRunning=this._queue;this._queue=[];for(const c of s)if(!c.cancelled&&(c.callback(r),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}const Is={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.enableTerrain":"Enable terrain","TerrainControl.disableTerrain":"Disable terrain"},Tl={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:void 0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,fadeDuration:300,crossSourceCollisions:!0},Vn={showCompass:!0,showZoom:!0,visualizePitch:!1};class va{constructor(r,s,c=!1){this._clickTolerance=10,this.element=s,this.mouseRotate=new Pt({clickTolerance:r.dragRotate._mouseRotate._clickTolerance}),this.map=r,c&&(this.mousePitch=new ma({clickTolerance:r.dragRotate._mousePitch._clickTolerance})),l.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),B.addEventListener(s,"mousedown",this.mousedown),B.addEventListener(s,"touchstart",this.touchstart,{passive:!1}),B.addEventListener(s,"touchmove",this.touchmove),B.addEventListener(s,"touchend",this.touchend),B.addEventListener(s,"touchcancel",this.reset)}down(r,s){this.mouseRotate.mousedown(r,s),this.mousePitch&&this.mousePitch.mousedown(r,s),B.disableDrag()}move(r,s){const c=this.map,p=this.mouseRotate.mousemoveWindow(r,s);if(p&&p.bearingDelta&&c.setBearing(c.getBearing()+p.bearingDelta),this.mousePitch){const _=this.mousePitch.mousemoveWindow(r,s);_&&_.pitchDelta&&c.setPitch(c.getPitch()+_.pitchDelta)}}off(){const r=this.element;B.removeEventListener(r,"mousedown",this.mousedown),B.removeEventListener(r,"touchstart",this.touchstart,{passive:!1}),B.removeEventListener(r,"touchmove",this.touchmove),B.removeEventListener(r,"touchend",this.touchend),B.removeEventListener(r,"touchcancel",this.reset),this.offTemp()}offTemp(){B.enableDrag(),B.removeEventListener(window,"mousemove",this.mousemove),B.removeEventListener(window,"mouseup",this.mouseup)}mousedown(r){this.down(l.extend({},r,{ctrlKey:!0,preventDefault:()=>r.preventDefault()}),B.mousePos(this.element,r)),B.addEventListener(window,"mousemove",this.mousemove),B.addEventListener(window,"mouseup",this.mouseup)}mousemove(r){this.move(r,B.mousePos(this.element,r))}mouseup(r){this.mouseRotate.mouseupWindow(r),this.mousePitch&&this.mousePitch.mouseupWindow(r),this.offTemp()}touchstart(r){r.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=B.touchPos(this.element,r.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>r.preventDefault()},this._startPos))}touchmove(r){r.targetTouches.length!==1?this.reset():(this._lastPos=B.touchPos(this.element,r.targetTouches)[0],this.move({preventDefault:()=>r.preventDefault()},this._lastPos))}touchend(r){r.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}function Ot(d,r,s){if(d=new l.LngLat(d.lng,d.lat),r){const c=new l.LngLat(d.lng-360,d.lat),p=new l.LngLat(d.lng+360,d.lat),_=s.locationPoint(d).distSqr(r);s.locationPoint(c).distSqr(r)<_?d=c:s.locationPoint(p).distSqr(r)<_&&(d=p)}for(;Math.abs(d.lng-s.center.lng)>180;){const c=s.locationPoint(d);if(c.x>=0&&c.y>=0&&c.x<=s.width&&c.y<=s.height)break;d.lng>s.center.lng?d.lng-=360:d.lng+=360}return d}const Gt={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function As(d,r,s){const c=d.classList;for(const p in Gt)c.remove(`maplibregl-${s}-anchor-${p}`,`mapboxgl-${s}-anchor-${p}`);c.add(`maplibregl-${s}-anchor-${r}`,`mapboxgl-${s}-anchor-${r}`)}class wo extends l.Evented{constructor(r,s){if(super(),(r instanceof HTMLElement||s)&&(r=l.extend({element:r},s)),l.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=r&&r.anchor||"center",this._color=r&&r.color||"#3FB1CE",this._scale=r&&r.scale||1,this._draggable=r&&r.draggable||!1,this._clickTolerance=r&&r.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=r&&r.rotation||0,this._rotationAlignment=r&&r.rotationAlignment||"auto",this._pitchAlignment=r&&r.pitchAlignment&&r.pitchAlignment!=="auto"?r.pitchAlignment:this._rotationAlignment,r&&r.element)this._element=r.element,this._offset=l.pointGeometry.convert(r&&r.offset||[0,0]);else{this._defaultMarker=!0,this._element=B.create("div"),this._element.setAttribute("aria-label","Map marker");const c=B.createNS("http://www.w3.org/2000/svg","svg"),p=41,_=27;c.setAttributeNS(null,"display","block"),c.setAttributeNS(null,"height",`${p}px`),c.setAttributeNS(null,"width",`${_}px`),c.setAttributeNS(null,"viewBox",`0 0 ${_} ${p}`);const S=B.createNS("http://www.w3.org/2000/svg","g");S.setAttributeNS(null,"stroke","none"),S.setAttributeNS(null,"stroke-width","1"),S.setAttributeNS(null,"fill","none"),S.setAttributeNS(null,"fill-rule","evenodd");const k=B.createNS("http://www.w3.org/2000/svg","g");k.setAttributeNS(null,"fill-rule","nonzero");const A=B.createNS("http://www.w3.org/2000/svg","g");A.setAttributeNS(null,"transform","translate(3.0, 29.0)"),A.setAttributeNS(null,"fill","#000000");const M=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const Pe of M){const he=B.createNS("http://www.w3.org/2000/svg","ellipse");he.setAttributeNS(null,"opacity","0.04"),he.setAttributeNS(null,"cx","10.5"),he.setAttributeNS(null,"cy","5.80029008"),he.setAttributeNS(null,"rx",Pe.rx),he.setAttributeNS(null,"ry",Pe.ry),A.appendChild(he)}const F=B.createNS("http://www.w3.org/2000/svg","g");F.setAttributeNS(null,"fill",this._color);const q=B.createNS("http://www.w3.org/2000/svg","path");q.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),F.appendChild(q);const H=B.createNS("http://www.w3.org/2000/svg","g");H.setAttributeNS(null,"opacity","0.25"),H.setAttributeNS(null,"fill","#000000");const le=B.createNS("http://www.w3.org/2000/svg","path");le.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),H.appendChild(le);const te=B.createNS("http://www.w3.org/2000/svg","g");te.setAttributeNS(null,"transform","translate(6.0, 7.0)"),te.setAttributeNS(null,"fill","#FFFFFF");const ee=B.createNS("http://www.w3.org/2000/svg","g");ee.setAttributeNS(null,"transform","translate(8.0, 8.0)");const ye=B.createNS("http://www.w3.org/2000/svg","circle");ye.setAttributeNS(null,"fill","#000000"),ye.setAttributeNS(null,"opacity","0.25"),ye.setAttributeNS(null,"cx","5.5"),ye.setAttributeNS(null,"cy","5.5"),ye.setAttributeNS(null,"r","5.4999962");const Ae=B.createNS("http://www.w3.org/2000/svg","circle");Ae.setAttributeNS(null,"fill","#FFFFFF"),Ae.setAttributeNS(null,"cx","5.5"),Ae.setAttributeNS(null,"cy","5.5"),Ae.setAttributeNS(null,"r","5.4999962"),ee.appendChild(ye),ee.appendChild(Ae),k.appendChild(A),k.appendChild(F),k.appendChild(H),k.appendChild(te),k.appendChild(ee),c.appendChild(k),c.setAttributeNS(null,"height",p*this._scale+"px"),c.setAttributeNS(null,"width",_*this._scale+"px"),this._element.appendChild(c),this._offset=l.pointGeometry.convert(r&&r.offset||[0,-14])}this._element.classList.add("maplibregl-marker","mapboxgl-marker"),this._element.addEventListener("dragstart",c=>{c.preventDefault()}),this._element.addEventListener("mousedown",c=>{c.preventDefault()}),As(this._element,this._anchor,"marker"),this._popup=null}addTo(r){return this.remove(),this._map=r,r.getCanvasContainer().appendChild(this._element),r.on("move",this._update),r.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),B.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(r){return this._lngLat=l.LngLat.convert(r),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(r){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),r){if(!("offset"in r.options)){const p=Math.sqrt(Math.pow(13.5,2)/2);r.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[p,-1*(38.1-13.5+p)],"bottom-right":[-p,-1*(38.1-13.5+p)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=r,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}_onKeyPress(r){const s=r.code,c=r.charCode||r.keyCode;s!=="Space"&&s!=="Enter"&&c!==32&&c!==13||this.togglePopup()}_onMapClick(r){const s=r.originalEvent.target,c=this._element;this._popup&&(s===c||c.contains(s))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const r=this._popup;return r?(r.isOpen()?r.remove():r.addTo(this._map),this):this}_update(r){if(!this._map)return;this._map.transform.renderWorldCopies&&(this._lngLat=Ot(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);let s="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?s=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(s=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let c="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?c="rotateX(0deg)":this._pitchAlignment==="map"&&(c=`rotateX(${this._map.getPitch()}deg)`),r&&r.type!=="moveend"||(this._pos=this._pos.round()),B.setTransform(this._element,`${Gt[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${c} ${s}`),this._map.style&&this._map.style.terrain&&!this._opacityTimeout&&(this._opacityTimeout=setTimeout(()=>{const p=this._map.unproject(this._pos),_=40075016686e-3*Math.abs(Math.cos(this._lngLat.lat*Math.PI/180))/Math.pow(2,this._map.transform.tileZoom+8);this._element.style.opacity=p.distanceTo(this._lngLat)>20*_?"0.2":"1.0",this._opacityTimeout=null},100))}getOffset(){return this._offset}setOffset(r){return this._offset=l.pointGeometry.convert(r),this._update(),this}_onMove(r){if(!this._isDragging){const s=this._clickTolerance||this._map._clickTolerance;this._isDragging=r.point.dist(this._pointerdownPos)>=s}this._isDragging&&(this._pos=r.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new l.Event("dragstart"))),this.fire(new l.Event("drag")))}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new l.Event("dragend")),this._state="inactive"}_addDragHandler(r){this._element.contains(r.originalEvent.target)&&(r.preventDefault(),this._positionDelta=r.point.sub(this._pos).add(this._offset),this._pointerdownPos=r.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))}setDraggable(r){return this._draggable=!!r,this._map&&(r?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(r){return this._rotation=r||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(r){return this._rotationAlignment=r||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(r){return this._pitchAlignment=r&&r!=="auto"?r:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}}const zs={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let nn,Yi=0,Dn=!1;const fu={maxWidth:100,unit:"metric"};function xa(d,r,s){const c=s&&s.maxWidth||100,p=d._container.clientHeight/2,_=d.unproject([0,p]),S=d.unproject([c,p]),k=_.distanceTo(S);if(s&&s.unit==="imperial"){const A=3.2808*k;A>5280?Dr(r,c,A/5280,d._getUIString("ScaleControl.Miles")):Dr(r,c,A,d._getUIString("ScaleControl.Feet"))}else s&&s.unit==="nautical"?Dr(r,c,k/1852,d._getUIString("ScaleControl.NauticalMiles")):k>=1e3?Dr(r,c,k/1e3,d._getUIString("ScaleControl.Kilometers")):Dr(r,c,k,d._getUIString("ScaleControl.Meters"))}function Dr(d,r,s,c){const p=function(_){const S=Math.pow(10,`${Math.floor(_)}`.length-1);let k=_/S;return k=k>=10?10:k>=5?5:k>=3?3:k>=2?2:k>=1?1:function(A){const M=Math.pow(10,Math.ceil(-Math.log(A)/Math.LN10));return Math.round(A*M)/M}(k),S*k}(s);d.style.width=r*(p/s)+"px",d.innerHTML=`${p}&nbsp;${c}`}const un={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Qu=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function bo(d){if(d){if(typeof d=="number"){const r=Math.round(Math.sqrt(.5*Math.pow(d,2)));return{center:new l.pointGeometry(0,0),top:new l.pointGeometry(0,d),"top-left":new l.pointGeometry(r,r),"top-right":new l.pointGeometry(-r,r),bottom:new l.pointGeometry(0,-d),"bottom-left":new l.pointGeometry(r,-r),"bottom-right":new l.pointGeometry(-r,-r),left:new l.pointGeometry(d,0),right:new l.pointGeometry(-d,0)}}if(d instanceof l.pointGeometry||Array.isArray(d)){const r=l.pointGeometry.convert(d);return{center:r,top:r,"top-left":r,"top-right":r,bottom:r,"bottom-left":r,"bottom-right":r,left:r,right:r}}return{center:l.pointGeometry.convert(d.center||[0,0]),top:l.pointGeometry.convert(d.top||[0,0]),"top-left":l.pointGeometry.convert(d["top-left"]||[0,0]),"top-right":l.pointGeometry.convert(d["top-right"]||[0,0]),bottom:l.pointGeometry.convert(d.bottom||[0,0]),"bottom-left":l.pointGeometry.convert(d["bottom-left"]||[0,0]),"bottom-right":l.pointGeometry.convert(d["bottom-right"]||[0,0]),left:l.pointGeometry.convert(d.left||[0,0]),right:l.pointGeometry.convert(d.right||[0,0])}}return bo(new l.pointGeometry(0,0))}const fi={supported:R,setRTLTextPlugin:l.setRTLTextPlugin,getRTLTextPluginStatus:l.getRTLTextPluginStatus,Map:class extends Ho{constructor(d){var r;if(l.PerformanceUtils.mark(l.PerformanceMarkers.create),(d=l.extend({},Tl,d)).minZoom!=null&&d.maxZoom!=null&&d.minZoom>d.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(d.minPitch!=null&&d.maxPitch!=null&&d.minPitch>d.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(d.minPitch!=null&&d.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(d.maxPitch!=null&&d.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new gl(d.minZoom,d.maxZoom,d.minPitch,d.maxPitch,d.renderWorldCopies),{bearingSnap:d.bearingSnap}),this._interactive=d.interactive,this._cooperativeGestures=d.cooperativeGestures,this._maxTileCacheSize=d.maxTileCacheSize,this._failIfMajorPerformanceCaveat=d.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=d.preserveDrawingBuffer,this._antialias=d.antialias,this._trackResize=d.trackResize,this._bearingSnap=d.bearingSnap,this._refreshExpiredTiles=d.refreshExpiredTiles,this._fadeDuration=d.fadeDuration,this._crossSourceCollisions=d.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=d.collectResourceTiming,this._renderTaskQueue=new El,this._controls=[],this._mapId=l.uniqueId(),this._locale=l.extend({},Is,d.locale),this._clickTolerance=d.clickTolerance,this._pixelRatio=(r=d.pixelRatio)!==null&&r!==void 0?r:devicePixelRatio,this._requestManager=new Z(d.transformRequest),typeof d.container=="string"){if(this._container=document.getElementById(d.container),!this._container)throw new Error(`Container '${d.container}' not found.`)}else{if(!(d.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=d.container}if(d.maxBounds&&this.setMaxBounds(d.maxBounds),l.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),typeof window<"u"&&(addEventListener("online",this._onWindowOnline,!1),addEventListener("resize",this._onWindowResize,!1),addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new _r(this,d),this._cooperativeGestures&&this._setupCooperativeGestures(),this._hash=d.hash&&new da(typeof d.hash=="string"&&d.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:d.center,zoom:d.zoom,bearing:d.bearing,pitch:d.pitch}),d.bounds&&(this.resize(),this.fitBounds(d.bounds,l.extend({},d.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=d.localIdeographFontFamily,d.style&&this.setStyle(d.style,{localIdeographFontFamily:d.localIdeographFontFamily}),d.attributionControl&&this.addControl(new xo({customAttribution:d.customAttribution})),d.maplibreLogo&&this.addControl(new Sl,d.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",s=>{this._update(s.dataType==="style"),this.fire(new l.Event(`${s.dataType}data`,s))}),this.on("dataloading",s=>{this.fire(new l.Event(`${s.dataType}dataloading`,s))}),this.on("dataabort",s=>{this.fire(new l.Event("sourcedataabort",s))})}_getMapId(){return this._mapId}addControl(d,r){if(r===void 0&&(r=d.getDefaultPosition?d.getDefaultPosition():"top-right"),!d||!d.onAdd)return this.fire(new l.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const s=d.onAdd(this);this._controls.push(d);const c=this._controlPositions[r];return r.indexOf("bottom")!==-1?c.insertBefore(s,c.firstChild):c.appendChild(s),this}removeControl(d){if(!d||!d.onRemove)return this.fire(new l.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const r=this._controls.indexOf(d);return r>-1&&this._controls.splice(r,1),d.onRemove(this),this}hasControl(d){return this._controls.indexOf(d)>-1}calculateCameraOptionsFromTo(d,r,s,c){return c==null&&this.style.terrain&&(c=this.transform.getElevation(s,this.style.terrain)),super.calculateCameraOptionsFromTo(d,r,s,c)}resize(d){const r=this._containerDimensions(),s=r[0],c=r[1];this._resizeCanvas(s,c,this.getPixelRatio()),this.transform.resize(s,c),this.painter.resize(s,c,this.getPixelRatio());const p=!this._moving;return p&&(this.stop(),this.fire(new l.Event("movestart",d)).fire(new l.Event("move",d))),this.fire(new l.Event("resize",d)),p&&this.fire(new l.Event("moveend",d)),this}getPixelRatio(){return this._pixelRatio}setPixelRatio(d){const[r,s]=this._containerDimensions();this._pixelRatio=d,this._resizeCanvas(r,s,d),this.painter.resize(r,s,d)}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(d){return this.transform.setMaxBounds(l.LngLatBounds.convert(d)),this._update()}setMinZoom(d){if((d=d??-2)>=-2&&d<=this.transform.maxZoom)return this.transform.minZoom=d,this._update(),this.getZoom()<d&&this.setZoom(d),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(d){if((d=d??22)>=this.transform.minZoom)return this.transform.maxZoom=d,this._update(),this.getZoom()>d&&this.setZoom(d),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(d){if((d=d??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(d>=0&&d<=this.transform.maxPitch)return this.transform.minPitch=d,this._update(),this.getPitch()<d&&this.setPitch(d),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(d){if((d=d??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(d>=this.transform.minPitch)return this.transform.maxPitch=d,this._update(),this.getPitch()>d&&this.setPitch(d),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(d){return this.transform.renderWorldCopies=d,this._update()}project(d){return this.transform.locationPoint(l.LngLat.convert(d),this.style&&this.style.terrain)}unproject(d){return this.transform.pointLocation(l.pointGeometry.convert(d),this.style&&this.style.terrain)}isMoving(){return this._moving||this.handlers.isMoving()}isZooming(){return this._zooming||this.handlers.isZooming()}isRotating(){return this._rotating||this.handlers.isRotating()}_createDelegatedListener(d,r,s){if(d==="mouseenter"||d==="mouseover"){let c=!1;return{layer:r,listener:s,delegates:{mousemove:_=>{const S=this.getLayer(r)?this.queryRenderedFeatures(_.point,{layers:[r]}):[];S.length?c||(c=!0,s.call(this,new ni(d,this,_.originalEvent,{features:S}))):c=!1},mouseout:()=>{c=!1}}}}if(d==="mouseleave"||d==="mouseout"){let c=!1;return{layer:r,listener:s,delegates:{mousemove:S=>{(this.getLayer(r)?this.queryRenderedFeatures(S.point,{layers:[r]}):[]).length?c=!0:c&&(c=!1,s.call(this,new ni(d,this,S.originalEvent)))},mouseout:S=>{c&&(c=!1,s.call(this,new ni(d,this,S.originalEvent)))}}}}{const c=p=>{const _=this.getLayer(r)?this.queryRenderedFeatures(p.point,{layers:[r]}):[];_.length&&(p.features=_,s.call(this,p),delete p.features)};return{layer:r,listener:s,delegates:{[d]:c}}}}on(d,r,s){if(s===void 0)return super.on(d,r);const c=this._createDelegatedListener(d,r,s);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[d]=this._delegatedListeners[d]||[],this._delegatedListeners[d].push(c);for(const p in c.delegates)this.on(p,c.delegates[p]);return this}once(d,r,s){if(s===void 0)return super.once(d,r);const c=this._createDelegatedListener(d,r,s);for(const p in c.delegates)this.once(p,c.delegates[p]);return this}off(d,r,s){return s===void 0?super.off(d,r):(this._delegatedListeners&&this._delegatedListeners[d]&&(c=>{const p=this._delegatedListeners[d];for(let _=0;_<p.length;_++){const S=p[_];if(S.layer===r&&S.listener===s){for(const k in S.delegates)this.off(k,S.delegates[k]);return p.splice(_,1),this}}})(),this)}queryRenderedFeatures(d,r){if(!this.style)return[];let s;if(r!==void 0||d===void 0||d instanceof l.pointGeometry||Array.isArray(d)||(r=d,d=void 0),r=r||{},(d=d||[[0,0],[this.transform.width,this.transform.height]])instanceof l.pointGeometry||typeof d[0]=="number")s=[l.pointGeometry.convert(d)];else{const c=l.pointGeometry.convert(d[0]),p=l.pointGeometry.convert(d[1]);s=[c,new l.pointGeometry(p.x,c.y),p,new l.pointGeometry(c.x,p.y),c]}return this.style.queryRenderedFeatures(s,r,this.transform)}querySourceFeatures(d,r){return this.style.querySourceFeatures(d,r)}setStyle(d,r){return(r=l.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},r)).diff!==!1&&r.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&d?(this._diffStyle(d,r),this):(this._localIdeographFontFamily=r.localIdeographFontFamily,this._updateStyle(d,r))}setTransformRequest(d){return this._requestManager.setTransformRequest(d),this}_getUIString(d){const r=this._locale[d];if(r==null)throw new Error(`Missing UI string '${d}'`);return r}_updateStyle(d,r){return this.style&&(this.style.setEventedParent(null),this.style._remove()),d?(this.style=new bn(this,r||{}),this.style.setEventedParent(this,{style:this.style}),typeof d=="string"?this.style.loadURL(d):this.style.loadJSON(d),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new bn(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(d,r){if(typeof d=="string"){const s=this._requestManager.transformRequest(d,l.ResourceType.Style);l.getJSON(s,(c,p)=>{c?this.fire(new l.ErrorEvent(c)):p&&this._updateDiff(p,r)})}else typeof d=="object"&&this._updateDiff(d,r)}_updateDiff(d,r){try{this.style.setState(d)&&this._update(!0)}catch(s){l.warnOnce(`Unable to perform style diff: ${s.message||s.error||s}.  Rebuilding the style from scratch.`),this._updateStyle(d,r)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():l.warnOnce("There is no style added to the map.")}addSource(d,r){return this._lazyInitEmptyStyle(),this.style.addSource(d,r),this._update(!0)}isSourceLoaded(d){const r=this.style&&this.style.sourceCaches[d];if(r!==void 0)return r.loaded();this.fire(new l.ErrorEvent(new Error(`There is no source with ID '${d}'`)))}setTerrain(d){return this.style.setTerrain(d),this}getTerrain(){return this.style.terrain&&this.style.terrain.options}areTilesLoaded(){const d=this.style&&this.style.sourceCaches;for(const r in d){const s=d[r]._tiles;for(const c in s){const p=s[c];if(p.state!=="loaded"&&p.state!=="errored")return!1}}return!0}addSourceType(d,r,s){return this._lazyInitEmptyStyle(),this.style.addSourceType(d,r,s)}removeSource(d){return this.style.removeSource(d),this._update(!0)}getSource(d){return this.style.getSource(d)}addImage(d,r,{pixelRatio:s=1,sdf:c=!1,stretchX:p,stretchY:_,content:S}={}){if(this._lazyInitEmptyStyle(),r instanceof HTMLImageElement||l.isImageBitmap(r)){const{width:k,height:A,data:M}=l.exported.getImageData(r);this.style.addImage(d,{data:new l.RGBAImage({width:k,height:A},M),pixelRatio:s,stretchX:p,stretchY:_,content:S,sdf:c,version:0})}else{if(r.width===void 0||r.height===void 0)return this.fire(new l.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:k,height:A,data:M}=r,F=r;this.style.addImage(d,{data:new l.RGBAImage({width:k,height:A},new Uint8Array(M)),pixelRatio:s,stretchX:p,stretchY:_,content:S,sdf:c,version:0,userImage:F}),F.onAdd&&F.onAdd(this,d)}}}updateImage(d,r){const s=this.style.getImage(d);if(!s)return this.fire(new l.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const c=r instanceof HTMLImageElement||l.isImageBitmap(r)?l.exported.getImageData(r):r,{width:p,height:_,data:S}=c;if(p===void 0||_===void 0)return this.fire(new l.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(p!==s.data.width||_!==s.data.height)return this.fire(new l.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image")));const k=!(r instanceof HTMLImageElement||l.isImageBitmap(r));s.data.replace(S,k),this.style.updateImage(d,s)}hasImage(d){return d?!!this.style.getImage(d):(this.fire(new l.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(d){this.style.removeImage(d)}loadImage(d,r){l.getImage(this._requestManager.transformRequest(d,l.ResourceType.Image),r)}listImages(){return this.style.listImages()}addLayer(d,r){return this._lazyInitEmptyStyle(),this.style.addLayer(d,r),this._update(!0)}moveLayer(d,r){return this.style.moveLayer(d,r),this._update(!0)}removeLayer(d){return this.style.removeLayer(d),this._update(!0)}getLayer(d){return this.style.getLayer(d)}setLayerZoomRange(d,r,s){return this.style.setLayerZoomRange(d,r,s),this._update(!0)}setFilter(d,r,s={}){return this.style.setFilter(d,r,s),this._update(!0)}getFilter(d){return this.style.getFilter(d)}setPaintProperty(d,r,s,c={}){return this.style.setPaintProperty(d,r,s,c),this._update(!0)}getPaintProperty(d,r){return this.style.getPaintProperty(d,r)}setLayoutProperty(d,r,s,c={}){return this.style.setLayoutProperty(d,r,s,c),this._update(!0)}getLayoutProperty(d,r){return this.style.getLayoutProperty(d,r)}setLight(d,r={}){return this._lazyInitEmptyStyle(),this.style.setLight(d,r),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(d,r){return this.style.setFeatureState(d,r),this._update()}removeFeatureState(d,r){return this.style.removeFeatureState(d,r),this._update()}getFeatureState(d){return this.style.getFeatureState(d)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let d=0,r=0;return this._container&&(d=this._container.clientWidth||400,r=this._container.clientHeight||300),[d,r]}_setupContainer(){const d=this._container;d.classList.add("maplibregl-map","mapboxgl-map");const r=this._canvasContainer=B.create("div","maplibregl-canvas-container mapboxgl-canvas-container",d);this._interactive&&r.classList.add("maplibregl-interactive","mapboxgl-interactive"),this._canvas=B.create("canvas","maplibregl-canvas mapboxgl-canvas",r),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");const s=this._containerDimensions();this._resizeCanvas(s[0],s[1],this.getPixelRatio());const c=this._controlContainer=B.create("div","maplibregl-control-container mapboxgl-control-container",d),p=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(_=>{p[_]=B.create("div",`maplibregl-ctrl-${_} mapboxgl-ctrl-${_}`,c)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_setupCooperativeGestures(){const d=this._container;this._metaPress=!1,this._cooperativeGesturesScreen=B.create("div","maplibregl-cooperative-gesture-screen",d);let r="Control",s=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.windowsHelpText?this._cooperativeGestures.windowsHelpText:"Use Ctrl + scroll to zoom the map";navigator.platform.indexOf("Mac")===0&&(s=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.macHelpText?this._cooperativeGestures.macHelpText:"Use ⌘ + scroll to zoom the map",r="Meta"),this._cooperativeGesturesScreen.innerHTML=`
            <div class="maplibregl-desktop-message">${s}</div>
            <div class="maplibregl-mobile-message">${typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.mobileHelpText?this._cooperativeGestures.mobileHelpText:"Use two fingers to move the map"}</div>
        `,document.addEventListener("keydown",c=>{c.key===r&&(this._metaPress=!0)}),document.addEventListener("keyup",c=>{c.key===r&&(this._metaPress=!1)}),this._canvasContainer.addEventListener("wheel",c=>{this._onCooperativeGesture(c,this._metaPress,1)},!1),this._canvasContainer.classList.remove("mapboxgl-touch-drag-pan","maplibregl-touch-drag-pan")}_resizeCanvas(d,r,s){this._canvas.width=s*d,this._canvas.height=s*r,this._canvas.style.width=`${d}px`,this._canvas.style.height=`${r}px`}_setupPainter(){const d=l.extend({},R.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),r=this._canvas.getContext("webgl",d)||this._canvas.getContext("experimental-webgl",d);r?(this.painter=new au(r,this.transform),l.exported$1.testSupport(r)):this.fire(new l.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(d){d.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new l.Event("webglcontextlost",{originalEvent:d}))}_contextRestored(d){this._setupPainter(),this.resize(),this._update(),this.fire(new l.Event("webglcontextrestored",{originalEvent:d}))}_onMapScroll(d){if(d.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}_onCooperativeGesture(d,r,s){return!r&&s<2&&(this._cooperativeGesturesScreen.classList.add("maplibregl-show"),setTimeout(()=>{this._cooperativeGesturesScreen.classList.remove("maplibregl-show")},100)),!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(d){return this.style?(this._styleDirty=this._styleDirty||d,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(d){return this._update(),this._renderTaskQueue.add(d)}_cancelRenderFrame(d){this._renderTaskQueue.remove(d)}_render(d){let r,s=0;const c=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(r=c.createQueryEXT(),c.beginQueryEXT(c.TIME_ELAPSED_EXT,r),s=l.exported.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(d),this._removed)return;let p=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const S=this.transform.zoom,k=l.exported.now();this.style.zoomHistory.update(S,k);const A=new l.EvaluationParameters(S,{now:k,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),M=A.crossFadingFactor();M===1&&M===this._crossFadingFactor||(p=!0,this._crossFadingFactor=M),this.style.update(A)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.style.terrain&&this.style.terrain.sourceCache.update(this.transform,this.style.terrain),this.transform.updateElevation(this.style.terrain),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new l.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,l.PerformanceUtils.mark(l.PerformanceMarkers.load),this.fire(new l.Event("load"))),this.style&&(this.style.hasTransitions()||p)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){const S=l.exported.now()-s;c.endQueryEXT(c.TIME_ELAPSED_EXT,r),setTimeout(()=>{const k=c.getQueryObjectEXT(r,c.QUERY_RESULT_EXT)/1e6;c.deleteQueryEXT(r),this.fire(new l.Event("gpu-timing-frame",{cpuTime:S,gpuTime:k}))},50)}if(this.listens("gpu-timing-layer")){const S=this.painter.collectGpuTimers();setTimeout(()=>{const k=this.painter.queryGpuTimers(S);this.fire(new l.Event("gpu-timing-layer",{layerTimes:k}))},50)}const _=this._sourcesDirty||this._styleDirty||this._placementDirty;return _||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new l.Event("idle")),!this._loaded||this._fullyLoaded||_||(this._fullyLoaded=!0,l.PerformanceUtils.mark(l.PerformanceMarkers.fullLoad)),this}redraw(){return this.style&&(this._frame&&(this._frame.cancel(),this._frame=null),this._render(0)),this}remove(){this._hash&&this._hash.remove();for(const r of this._controls)r.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&(removeEventListener("resize",this._onWindowResize,!1),removeEventListener("orientationchange",this._onWindowResize,!1),removeEventListener("online",this._onWindowOnline,!1));const d=this.painter.context.gl.getExtension("WEBGL_lose_context");d&&d.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),B.remove(this._canvasContainer),B.remove(this._controlContainer),this._cooperativeGestures&&B.remove(this._cooperativeGesturesScreen),this._container.classList.remove("maplibregl-map","mapboxgl-map"),l.PerformanceUtils.clearMetrics(),this._removed=!0,this.fire(new l.Event("remove"))}triggerRepaint(){this.style&&!this._frame&&(this._frame=l.exported.frame(d=>{l.PerformanceUtils.frame(d),this._frame=null,this._render(d)}))}_onWindowOnline(){this._update()}_onWindowResize(d){this._trackResize&&this.resize({originalEvent:d})._update()}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(d){this._showTileBoundaries!==d&&(this._showTileBoundaries=d,this._update())}get showPadding(){return!!this._showPadding}set showPadding(d){this._showPadding!==d&&(this._showPadding=d,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(d){this._showCollisionBoxes!==d&&(this._showCollisionBoxes=d,d?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(d){this._showOverdrawInspector!==d&&(this._showOverdrawInspector=d,this._update())}get repaint(){return!!this._repaint}set repaint(d){this._repaint!==d&&(this._repaint=d,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(d){this._vertices=d,this._update()}_setCacheLimits(d,r){l.setCacheLimits(d,r)}get version(){return"2.4.0"}},NavigationControl:class{constructor(d){this.options=l.extend({},Vn,d),this._container=B.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",r=>r.preventDefault()),this.options.showZoom&&(l.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in mapboxgl-ctrl-zoom-in",r=>this._map.zoomIn({},{originalEvent:r})),B.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out mapboxgl-ctrl-zoom-out",r=>this._map.zoomOut({},{originalEvent:r})),B.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(l.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("maplibregl-ctrl-compass mapboxgl-ctrl-compass",r=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:r}):this._map.resetNorth({},{originalEvent:r})}),this._compassIcon=B.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const d=this._map.getZoom(),r=d===this._map.getMaxZoom(),s=d===this._map.getMinZoom();this._zoomInButton.disabled=r,this._zoomOutButton.disabled=s,this._zoomInButton.setAttribute("aria-disabled",r.toString()),this._zoomOutButton.setAttribute("aria-disabled",s.toString())}_rotateCompassArrow(){const d=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=d}onAdd(d){return this._map=d,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new va(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){B.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(d,r){const s=B.create("button",d,this._container);return s.type="button",s.addEventListener("click",r),s}_setButtonTitle(d,r){const s=this._map._getUIString(`NavigationControl.${r}`);d.title=s,d.setAttribute("aria-label",s)}},GeolocateControl:class extends l.Evented{constructor(d){super(),this.options=l.extend({},zs,d),l.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}onAdd(d){var r;return this._map=d,this._container=B.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),r=this._setupUI,nn!==void 0?r(nn):window.navigator.permissions!==void 0?window.navigator.permissions.query({name:"geolocation"}).then(s=>{nn=s.state!=="denied",r(nn)}):(nn=!!window.navigator.geolocation,r(nn)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),B.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Yi=0,Dn=!1}_isOutOfMapMaxBounds(d){const r=this._map.getMaxBounds(),s=d.coords;return r&&(s.longitude<r.getWest()||s.longitude>r.getEast()||s.latitude<r.getSouth()||s.latitude>r.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_onSuccess(d){if(this._map){if(this._isOutOfMapMaxBounds(d))return this._setErrorState(),this.fire(new l.Event("outofmaxbounds",d)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=d,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(d),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(d),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale","mapboxgl-user-location-dot-stale"),this.fire(new l.Event("geolocate",d)),this._finish()}}_updateCamera(d){const r=new l.LngLat(d.coords.longitude,d.coords.latitude),s=d.coords.accuracy,c=this._map.getBearing(),p=l.extend({bearing:c},this.options.fitBoundsOptions);this._map.fitBounds(r.toBounds(s),p,{geolocateSource:!0})}_updateMarker(d){if(d){const r=new l.LngLat(d.coords.longitude,d.coords.latitude);this._accuracyCircleMarker.setLngLat(r).addTo(this._map),this._userLocationDotMarker.setLngLat(r).addTo(this._map),this._accuracy=d.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const d=this._map._container.clientHeight/2,r=this._map.unproject([0,d]),s=this._map.unproject([1,d]),c=r.distanceTo(s),p=Math.ceil(2*this._accuracy/c);this._circleElement.style.width=`${p}px`,this._circleElement.style.height=`${p}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_onError(d){if(this._map){if(this.options.trackUserLocation)if(d.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=r,this._geolocateButton.setAttribute("aria-label",r),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(d.code===3&&Dn)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale","mapboxgl-user-location-dot-stale"),this.fire(new l.Event("error",d)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(d){if(this._container.addEventListener("contextmenu",r=>r.preventDefault()),this._geolocateButton=B.create("button","maplibregl-ctrl-geolocate mapboxgl-ctrl-geolocate",this._container),B.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",d===!1){l.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=r,this._geolocateButton.setAttribute("aria-label",r)}else{const r=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=r,this._geolocateButton.setAttribute("aria-label",r)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=B.create("div","maplibregl-user-location-dot mapboxgl-user-location-dot"),this._userLocationDotMarker=new wo(this._dotElement),this._circleElement=B.create("div","maplibregl-user-location-accuracy-circle mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new wo({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",r=>{r.geolocateSource||this._watchState!=="ACTIVE_LOCK"||r.originalEvent&&r.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this.fire(new l.Event("trackuserlocationend")))})}trigger(){if(!this._setup)return l.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new l.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Yi--,Dn=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this.fire(new l.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new l.Event("trackuserlocationstart"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let d;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Yi++,Yi>1?(d={maximumAge:6e5,timeout:0},Dn=!0):(d=this.options.positionOptions,Dn=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,d)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:xo,LogoControl:Sl,ScaleControl:class{constructor(d){this.options=l.extend({},fu,d),l.bindAll(["_onMove","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_onMove(){xa(this._map,this._container,this.options)}onAdd(d){return this._map=d,this._container=B.create("div","maplibregl-ctrl maplibregl-ctrl-scale mapboxgl-ctrl mapboxgl-ctrl-scale",d.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){B.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}setUnit(d){this.options.unit=d,xa(this._map,this._container,this.options)}},FullscreenControl:class{constructor(d){this._fullscreen=!1,d&&d.container&&(d.container instanceof HTMLElement?this._container=d.container:l.warnOnce("Full screen control 'container' must be a DOM element.")),l.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(d){return this._map=d,this._container||(this._container=this._map.getContainer()),this._controlContainer=B.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",l.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){B.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!!(document.fullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled||document.webkitFullscreenEnabled)}_setupUI(){const d=this._fullscreenButton=B.create("button","maplibregl-ctrl-fullscreen mapboxgl-ctrl-fullscreen",this._controlContainer);B.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",d).setAttribute("aria-hidden","true"),d.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const d=this._getTitle();this._fullscreenButton.setAttribute("aria-label",d),this._fullscreenButton.title=d}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen&&window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},TerrainControl:class{constructor(d){this.options=d,l.bindAll(["_toggleTerrain","_updateTerrainIcon"],this)}onAdd(d){return this._map=d,this._container=B.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._terrainButton=B.create("button","maplibregl-ctrl-terrain mapboxgl-ctrl-terrain",this._container),B.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){B.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}_toggleTerrain(){this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()}_updateTerrainIcon(){this._terrainButton.classList.remove("maplibregl-ctrl-terrain","mapboxgl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled","mapboxgl-ctrl-terrain-enabled"),this._map.style.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled","mapboxgl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.disableTerrain")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain","mapboxgl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.enableTerrain"))}},Popup:class extends l.Evented{constructor(d){super(),this.options=l.extend(Object.create(un),d),l.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}addTo(d){return this._map&&this.remove(),this._map=d,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer","mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new l.Event("open")),this}isOpen(){return!!this._map}remove(){return this._content&&B.remove(this._content),this._container&&(B.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new l.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(d){return this._lngLat=l.LngLat.convert(d),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer","mapboxgl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer","mapboxgl-track-pointer")),this}getElement(){return this._container}setText(d){return this.setDOMContent(document.createTextNode(d))}setHTML(d){const r=document.createDocumentFragment(),s=document.createElement("body");let c;for(s.innerHTML=d;c=s.firstChild,c;)r.appendChild(c);return this.setDOMContent(r)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(d){return this.options.maxWidth=d,this._update(),this}setDOMContent(d){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=B.create("div","maplibregl-popup-content mapboxgl-popup-content",this._container);return this._content.appendChild(d),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(d){this._container&&this._container.classList.add(d)}removeClassName(d){this._container&&this._container.classList.remove(d)}setOffset(d){return this.options.offset=d,this._update(),this}toggleClassName(d){if(this._container)return this._container.classList.toggle(d)}_createCloseButton(){this.options.closeButton&&(this._closeButton=B.create("button","maplibregl-popup-close-button mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_onMouseUp(d){this._update(d.point)}_onMouseMove(d){this._update(d.point)}_onDrag(d){this._update(d.point)}_update(d){if(!this._map||!this._lngLat&&!this._trackPointer||!this._content||(this._container||(this._container=B.create("div","maplibregl-popup mapboxgl-popup",this._map.getContainer()),this._tip=B.create("div","maplibregl-popup-tip mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(_=>this._container.classList.add(_)),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Ot(this._lngLat,this._pos,this._map.transform)),this._trackPointer&&!d))return;const r=this._pos=this._trackPointer&&d?d:this._map.project(this._lngLat);let s=this.options.anchor;const c=bo(this.options.offset);if(!s){const _=this._container.offsetWidth,S=this._container.offsetHeight;let k;k=r.y+c.bottom.y<S?["top"]:r.y>this._map.transform.height-S?["bottom"]:[],r.x<_/2?k.push("left"):r.x>this._map.transform.width-_/2&&k.push("right"),s=k.length===0?"bottom":k.join("-")}const p=r.add(c[s]).round();B.setTransform(this._container,`${Gt[s]} translate(${p.x}px,${p.y}px)`),As(this._container,s,"popup")}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const d=this._container.querySelector(Qu);d&&d.focus()}_onClose(){this.remove()}},Marker:wo,Style:bn,LngLat:l.LngLat,LngLatBounds:l.LngLatBounds,Point:l.pointGeometry,MercatorCoordinate:l.MercatorCoordinate,Evented:l.Evented,AJAXError:l.AJAXError,config:l.config,CanvasSource:fe,GeoJSONSource:Ke,ImageSource:Fe,RasterDEMTileSource:ht,RasterTileSource:j,VectorTileSource:$e,VideoSource:ae,prewarm:function(){He().acquire(sr)},clearPrewarmedResources:function(){const d=it;d&&(d.isPreloaded()&&d.numActive()===1?(d.release(sr),it=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get version(){return"2.4.0"},get workerCount(){return pr.workerCount},set workerCount(d){pr.workerCount=d},get maxParallelImageRequests(){return l.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(d){l.config.MAX_PARALLEL_IMAGE_REQUESTS=d},clearStorage(d){l.clearTileCache(d)},workerUrl:"",addProtocol(d,r){l.config.REGISTERED_PROTOCOLS[d]=r},removeProtocol(d){delete l.config.REGISTERED_PROTOCOLS[d]}};return Mr.extend(fi,{isSafari:l.isSafari,getPerformanceMetrics:l.PerformanceUtils.getPerformanceMetrics}),fi});var P=C;return P})}(Ud)),Ud.exports}var xg=vg();const Of=Uc(xg);function Ld(m){throw new Error('Could not dynamically require "'+m+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var kf={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/var Sp;function wg(){return Sp||(Sp=1,function(m,b){(function(x){m.exports=x()})(function(){return function x(I,C,T){function P(L,G){if(!C[L]){if(!I[L]){var $=typeof Ld=="function"&&Ld;if(!G&&$)return $(L,!0);if(l)return l(L,!0);var B=new Error("Cannot find module '"+L+"'");throw B.code="MODULE_NOT_FOUND",B}var Z=C[L]={exports:{}};I[L][0].call(Z.exports,function(Q){var V=I[L][1][Q];return P(V||Q)},Z,Z.exports,x,I,C,T)}return C[L].exports}for(var l=typeof Ld=="function"&&Ld,R=0;R<T.length;R++)P(T[R]);return P}({1:[function(x,I,C){var T=x("./utils"),P=x("./support"),l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";C.encode=function(R){for(var L,G,$,B,Z,Q,V,K=[],Y=0,ne=R.length,ce=ne,be=T.getTypeOf(R)!=="string";Y<R.length;)ce=ne-Y,$=be?(L=R[Y++],G=Y<ne?R[Y++]:0,Y<ne?R[Y++]:0):(L=R.charCodeAt(Y++),G=Y<ne?R.charCodeAt(Y++):0,Y<ne?R.charCodeAt(Y++):0),B=L>>2,Z=(3&L)<<4|G>>4,Q=1<ce?(15&G)<<2|$>>6:64,V=2<ce?63&$:64,K.push(l.charAt(B)+l.charAt(Z)+l.charAt(Q)+l.charAt(V));return K.join("")},C.decode=function(R){var L,G,$,B,Z,Q,V=0,K=0,Y="data:";if(R.substr(0,Y.length)===Y)throw new Error("Invalid base64 input, it looks like a data url.");var ne,ce=3*(R=R.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(R.charAt(R.length-1)===l.charAt(64)&&ce--,R.charAt(R.length-2)===l.charAt(64)&&ce--,ce%1!=0)throw new Error("Invalid base64 input, bad content length.");for(ne=P.uint8array?new Uint8Array(0|ce):new Array(0|ce);V<R.length;)L=l.indexOf(R.charAt(V++))<<2|(B=l.indexOf(R.charAt(V++)))>>4,G=(15&B)<<4|(Z=l.indexOf(R.charAt(V++)))>>2,$=(3&Z)<<6|(Q=l.indexOf(R.charAt(V++))),ne[K++]=L,Z!==64&&(ne[K++]=G),Q!==64&&(ne[K++]=$);return ne}},{"./support":30,"./utils":32}],2:[function(x,I,C){var T=x("./external"),P=x("./stream/DataWorker"),l=x("./stream/Crc32Probe"),R=x("./stream/DataLengthProbe");function L(G,$,B,Z,Q){this.compressedSize=G,this.uncompressedSize=$,this.crc32=B,this.compression=Z,this.compressedContent=Q}L.prototype={getContentWorker:function(){var G=new P(T.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new R("data_length")),$=this;return G.on("end",function(){if(this.streamInfo.data_length!==$.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),G},getCompressedWorker:function(){return new P(T.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},L.createWorkerFrom=function(G,$,B){return G.pipe(new l).pipe(new R("uncompressedSize")).pipe($.compressWorker(B)).pipe(new R("compressedSize")).withStreamInfo("compression",$)},I.exports=L},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(x,I,C){var T=x("./stream/GenericWorker");C.STORE={magic:"\0\0",compressWorker:function(){return new T("STORE compression")},uncompressWorker:function(){return new T("STORE decompression")}},C.DEFLATE=x("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(x,I,C){var T=x("./utils"),P=function(){for(var l,R=[],L=0;L<256;L++){l=L;for(var G=0;G<8;G++)l=1&l?3988292384^l>>>1:l>>>1;R[L]=l}return R}();I.exports=function(l,R){return l!==void 0&&l.length?T.getTypeOf(l)!=="string"?function(L,G,$,B){var Z=P,Q=B+$;L^=-1;for(var V=B;V<Q;V++)L=L>>>8^Z[255&(L^G[V])];return-1^L}(0|R,l,l.length,0):function(L,G,$,B){var Z=P,Q=B+$;L^=-1;for(var V=B;V<Q;V++)L=L>>>8^Z[255&(L^G.charCodeAt(V))];return-1^L}(0|R,l,l.length,0):0}},{"./utils":32}],5:[function(x,I,C){C.base64=!1,C.binary=!1,C.dir=!1,C.createFolders=!0,C.date=null,C.compression=null,C.compressionOptions=null,C.comment=null,C.unixPermissions=null,C.dosPermissions=null},{}],6:[function(x,I,C){var T=null;T=typeof Promise<"u"?Promise:x("lie"),I.exports={Promise:T}},{lie:37}],7:[function(x,I,C){var T=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",P=x("pako"),l=x("./utils"),R=x("./stream/GenericWorker"),L=T?"uint8array":"array";function G($,B){R.call(this,"FlateWorker/"+$),this._pako=null,this._pakoAction=$,this._pakoOptions=B,this.meta={}}C.magic="\b\0",l.inherits(G,R),G.prototype.processChunk=function($){this.meta=$.meta,this._pako===null&&this._createPako(),this._pako.push(l.transformTo(L,$.data),!1)},G.prototype.flush=function(){R.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},G.prototype.cleanUp=function(){R.prototype.cleanUp.call(this),this._pako=null},G.prototype._createPako=function(){this._pako=new P[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var $=this;this._pako.onData=function(B){$.push({data:B,meta:$.meta})}},C.compressWorker=function($){return new G("Deflate",$)},C.uncompressWorker=function(){return new G("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(x,I,C){function T(Z,Q){var V,K="";for(V=0;V<Q;V++)K+=String.fromCharCode(255&Z),Z>>>=8;return K}function P(Z,Q,V,K,Y,ne){var ce,be,_e=Z.file,Ue=Z.compression,De=ne!==L.utf8encode,Ze=l.transformTo("string",ne(_e.name)),je=l.transformTo("string",L.utf8encode(_e.name)),lt=_e.comment,vt=l.transformTo("string",ne(lt)),me=l.transformTo("string",L.utf8encode(lt)),$e=je.length!==_e.name.length,j=me.length!==lt.length,qe="",ht="",Ke="",st=_e.dir,Fe=_e.date,ae={crc32:0,compressedSize:0,uncompressedSize:0};Q&&!V||(ae.crc32=Z.crc32,ae.compressedSize=Z.compressedSize,ae.uncompressedSize=Z.uncompressedSize);var fe=0;Q&&(fe|=8),De||!$e&&!j||(fe|=2048);var Se=0,gt=0;st&&(Se|=16),Y==="UNIX"?(gt=798,Se|=function(dt,bt){var Vt=dt;return dt||(Vt=bt?16893:33204),(65535&Vt)<<16}(_e.unixPermissions,st)):(gt=20,Se|=function(dt){return 63&(dt||0)}(_e.dosPermissions)),ce=Fe.getUTCHours(),ce<<=6,ce|=Fe.getUTCMinutes(),ce<<=5,ce|=Fe.getUTCSeconds()/2,be=Fe.getUTCFullYear()-1980,be<<=4,be|=Fe.getUTCMonth()+1,be<<=5,be|=Fe.getUTCDate(),$e&&(ht=T(1,1)+T(G(Ze),4)+je,qe+="up"+T(ht.length,2)+ht),j&&(Ke=T(1,1)+T(G(vt),4)+me,qe+="uc"+T(Ke.length,2)+Ke);var ct="";return ct+=`
\0`,ct+=T(fe,2),ct+=Ue.magic,ct+=T(ce,2),ct+=T(be,2),ct+=T(ae.crc32,4),ct+=T(ae.compressedSize,4),ct+=T(ae.uncompressedSize,4),ct+=T(Ze.length,2),ct+=T(qe.length,2),{fileRecord:$.LOCAL_FILE_HEADER+ct+Ze+qe,dirRecord:$.CENTRAL_FILE_HEADER+T(gt,2)+ct+T(vt.length,2)+"\0\0\0\0"+T(Se,4)+T(K,4)+Ze+qe+vt}}var l=x("../utils"),R=x("../stream/GenericWorker"),L=x("../utf8"),G=x("../crc32"),$=x("../signature");function B(Z,Q,V,K){R.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=Q,this.zipPlatform=V,this.encodeFileName=K,this.streamFiles=Z,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}l.inherits(B,R),B.prototype.push=function(Z){var Q=Z.meta.percent||0,V=this.entriesCount,K=this._sources.length;this.accumulate?this.contentBuffer.push(Z):(this.bytesWritten+=Z.data.length,R.prototype.push.call(this,{data:Z.data,meta:{currentFile:this.currentFile,percent:V?(Q+100*(V-K-1))/V:100}}))},B.prototype.openedSource=function(Z){this.currentSourceOffset=this.bytesWritten,this.currentFile=Z.file.name;var Q=this.streamFiles&&!Z.file.dir;if(Q){var V=P(Z,Q,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:V.fileRecord,meta:{percent:0}})}else this.accumulate=!0},B.prototype.closedSource=function(Z){this.accumulate=!1;var Q=this.streamFiles&&!Z.file.dir,V=P(Z,Q,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(V.dirRecord),Q)this.push({data:function(K){return $.DATA_DESCRIPTOR+T(K.crc32,4)+T(K.compressedSize,4)+T(K.uncompressedSize,4)}(Z),meta:{percent:100}});else for(this.push({data:V.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},B.prototype.flush=function(){for(var Z=this.bytesWritten,Q=0;Q<this.dirRecords.length;Q++)this.push({data:this.dirRecords[Q],meta:{percent:100}});var V=this.bytesWritten-Z,K=function(Y,ne,ce,be,_e){var Ue=l.transformTo("string",_e(be));return $.CENTRAL_DIRECTORY_END+"\0\0\0\0"+T(Y,2)+T(Y,2)+T(ne,4)+T(ce,4)+T(Ue.length,2)+Ue}(this.dirRecords.length,V,Z,this.zipComment,this.encodeFileName);this.push({data:K,meta:{percent:100}})},B.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},B.prototype.registerPrevious=function(Z){this._sources.push(Z);var Q=this;return Z.on("data",function(V){Q.processChunk(V)}),Z.on("end",function(){Q.closedSource(Q.previous.streamInfo),Q._sources.length?Q.prepareNextSource():Q.end()}),Z.on("error",function(V){Q.error(V)}),this},B.prototype.resume=function(){return!!R.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},B.prototype.error=function(Z){var Q=this._sources;if(!R.prototype.error.call(this,Z))return!1;for(var V=0;V<Q.length;V++)try{Q[V].error(Z)}catch{}return!0},B.prototype.lock=function(){R.prototype.lock.call(this);for(var Z=this._sources,Q=0;Q<Z.length;Q++)Z[Q].lock()},I.exports=B},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(x,I,C){var T=x("../compressions"),P=x("./ZipFileWorker");C.generateWorker=function(l,R,L){var G=new P(R.streamFiles,L,R.platform,R.encodeFileName),$=0;try{l.forEach(function(B,Z){$++;var Q=function(ne,ce){var be=ne||ce,_e=T[be];if(!_e)throw new Error(be+" is not a valid compression method !");return _e}(Z.options.compression,R.compression),V=Z.options.compressionOptions||R.compressionOptions||{},K=Z.dir,Y=Z.date;Z._compressWorker(Q,V).withStreamInfo("file",{name:B,dir:K,date:Y,comment:Z.comment||"",unixPermissions:Z.unixPermissions,dosPermissions:Z.dosPermissions}).pipe(G)}),G.entriesCount=$}catch(B){G.error(B)}return G}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(x,I,C){function T(){if(!(this instanceof T))return new T;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var P=new T;for(var l in this)typeof this[l]!="function"&&(P[l]=this[l]);return P}}(T.prototype=x("./object")).loadAsync=x("./load"),T.support=x("./support"),T.defaults=x("./defaults"),T.version="3.10.1",T.loadAsync=function(P,l){return new T().loadAsync(P,l)},T.external=x("./external"),I.exports=T},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(x,I,C){var T=x("./utils"),P=x("./external"),l=x("./utf8"),R=x("./zipEntries"),L=x("./stream/Crc32Probe"),G=x("./nodejsUtils");function $(B){return new P.Promise(function(Z,Q){var V=B.decompressed.getContentWorker().pipe(new L);V.on("error",function(K){Q(K)}).on("end",function(){V.streamInfo.crc32!==B.decompressed.crc32?Q(new Error("Corrupted zip : CRC32 mismatch")):Z()}).resume()})}I.exports=function(B,Z){var Q=this;return Z=T.extend(Z||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:l.utf8decode}),G.isNode&&G.isStream(B)?P.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):T.prepareContent("the loaded zip file",B,!0,Z.optimizedBinaryString,Z.base64).then(function(V){var K=new R(Z);return K.load(V),K}).then(function(V){var K=[P.Promise.resolve(V)],Y=V.files;if(Z.checkCRC32)for(var ne=0;ne<Y.length;ne++)K.push($(Y[ne]));return P.Promise.all(K)}).then(function(V){for(var K=V.shift(),Y=K.files,ne=0;ne<Y.length;ne++){var ce=Y[ne],be=ce.fileNameStr,_e=T.resolve(ce.fileNameStr);Q.file(_e,ce.decompressed,{binary:!0,optimizedBinaryString:!0,date:ce.date,dir:ce.dir,comment:ce.fileCommentStr.length?ce.fileCommentStr:null,unixPermissions:ce.unixPermissions,dosPermissions:ce.dosPermissions,createFolders:Z.createFolders}),ce.dir||(Q.file(_e).unsafeOriginalName=be)}return K.zipComment.length&&(Q.comment=K.zipComment),Q})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(x,I,C){var T=x("../utils"),P=x("../stream/GenericWorker");function l(R,L){P.call(this,"Nodejs stream input adapter for "+R),this._upstreamEnded=!1,this._bindStream(L)}T.inherits(l,P),l.prototype._bindStream=function(R){var L=this;(this._stream=R).pause(),R.on("data",function(G){L.push({data:G,meta:{percent:0}})}).on("error",function(G){L.isPaused?this.generatedError=G:L.error(G)}).on("end",function(){L.isPaused?L._upstreamEnded=!0:L.end()})},l.prototype.pause=function(){return!!P.prototype.pause.call(this)&&(this._stream.pause(),!0)},l.prototype.resume=function(){return!!P.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},I.exports=l},{"../stream/GenericWorker":28,"../utils":32}],13:[function(x,I,C){var T=x("readable-stream").Readable;function P(l,R,L){T.call(this,R),this._helper=l;var G=this;l.on("data",function($,B){G.push($)||G._helper.pause(),L&&L(B)}).on("error",function($){G.emit("error",$)}).on("end",function(){G.push(null)})}x("../utils").inherits(P,T),P.prototype._read=function(){this._helper.resume()},I.exports=P},{"../utils":32,"readable-stream":16}],14:[function(x,I,C){I.exports={isNode:typeof Buffer<"u",newBufferFrom:function(T,P){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(T,P);if(typeof T=="number")throw new Error('The "data" argument must not be a number');return new Buffer(T,P)},allocBuffer:function(T){if(Buffer.alloc)return Buffer.alloc(T);var P=new Buffer(T);return P.fill(0),P},isBuffer:function(T){return Buffer.isBuffer(T)},isStream:function(T){return T&&typeof T.on=="function"&&typeof T.pause=="function"&&typeof T.resume=="function"}}},{}],15:[function(x,I,C){function T(_e,Ue,De){var Ze,je=l.getTypeOf(Ue),lt=l.extend(De||{},G);lt.date=lt.date||new Date,lt.compression!==null&&(lt.compression=lt.compression.toUpperCase()),typeof lt.unixPermissions=="string"&&(lt.unixPermissions=parseInt(lt.unixPermissions,8)),lt.unixPermissions&&16384&lt.unixPermissions&&(lt.dir=!0),lt.dosPermissions&&16&lt.dosPermissions&&(lt.dir=!0),lt.dir&&(_e=Y(_e)),lt.createFolders&&(Ze=K(_e))&&ne.call(this,Ze,!0);var vt=je==="string"&&lt.binary===!1&&lt.base64===!1;De&&De.binary!==void 0||(lt.binary=!vt),(Ue instanceof $&&Ue.uncompressedSize===0||lt.dir||!Ue||Ue.length===0)&&(lt.base64=!1,lt.binary=!0,Ue="",lt.compression="STORE",je="string");var me=null;me=Ue instanceof $||Ue instanceof R?Ue:Q.isNode&&Q.isStream(Ue)?new V(_e,Ue):l.prepareContent(_e,Ue,lt.binary,lt.optimizedBinaryString,lt.base64);var $e=new B(_e,me,lt);this.files[_e]=$e}var P=x("./utf8"),l=x("./utils"),R=x("./stream/GenericWorker"),L=x("./stream/StreamHelper"),G=x("./defaults"),$=x("./compressedObject"),B=x("./zipObject"),Z=x("./generate"),Q=x("./nodejsUtils"),V=x("./nodejs/NodejsStreamInputAdapter"),K=function(_e){_e.slice(-1)==="/"&&(_e=_e.substring(0,_e.length-1));var Ue=_e.lastIndexOf("/");return 0<Ue?_e.substring(0,Ue):""},Y=function(_e){return _e.slice(-1)!=="/"&&(_e+="/"),_e},ne=function(_e,Ue){return Ue=Ue!==void 0?Ue:G.createFolders,_e=Y(_e),this.files[_e]||T.call(this,_e,null,{dir:!0,createFolders:Ue}),this.files[_e]};function ce(_e){return Object.prototype.toString.call(_e)==="[object RegExp]"}var be={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(_e){var Ue,De,Ze;for(Ue in this.files)Ze=this.files[Ue],(De=Ue.slice(this.root.length,Ue.length))&&Ue.slice(0,this.root.length)===this.root&&_e(De,Ze)},filter:function(_e){var Ue=[];return this.forEach(function(De,Ze){_e(De,Ze)&&Ue.push(Ze)}),Ue},file:function(_e,Ue,De){if(arguments.length!==1)return _e=this.root+_e,T.call(this,_e,Ue,De),this;if(ce(_e)){var Ze=_e;return this.filter(function(lt,vt){return!vt.dir&&Ze.test(lt)})}var je=this.files[this.root+_e];return je&&!je.dir?je:null},folder:function(_e){if(!_e)return this;if(ce(_e))return this.filter(function(je,lt){return lt.dir&&_e.test(je)});var Ue=this.root+_e,De=ne.call(this,Ue),Ze=this.clone();return Ze.root=De.name,Ze},remove:function(_e){_e=this.root+_e;var Ue=this.files[_e];if(Ue||(_e.slice(-1)!=="/"&&(_e+="/"),Ue=this.files[_e]),Ue&&!Ue.dir)delete this.files[_e];else for(var De=this.filter(function(je,lt){return lt.name.slice(0,_e.length)===_e}),Ze=0;Ze<De.length;Ze++)delete this.files[De[Ze].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(_e){var Ue,De={};try{if((De=l.extend(_e||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:P.utf8encode})).type=De.type.toLowerCase(),De.compression=De.compression.toUpperCase(),De.type==="binarystring"&&(De.type="string"),!De.type)throw new Error("No output type specified.");l.checkSupport(De.type),De.platform!=="darwin"&&De.platform!=="freebsd"&&De.platform!=="linux"&&De.platform!=="sunos"||(De.platform="UNIX"),De.platform==="win32"&&(De.platform="DOS");var Ze=De.comment||this.comment||"";Ue=Z.generateWorker(this,De,Ze)}catch(je){(Ue=new R("error")).error(je)}return new L(Ue,De.type||"string",De.mimeType)},generateAsync:function(_e,Ue){return this.generateInternalStream(_e).accumulate(Ue)},generateNodeStream:function(_e,Ue){return(_e=_e||{}).type||(_e.type="nodebuffer"),this.generateInternalStream(_e).toNodejsStream(Ue)}};I.exports=be},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(x,I,C){I.exports=x("stream")},{stream:void 0}],17:[function(x,I,C){var T=x("./DataReader");function P(l){T.call(this,l);for(var R=0;R<this.data.length;R++)l[R]=255&l[R]}x("../utils").inherits(P,T),P.prototype.byteAt=function(l){return this.data[this.zero+l]},P.prototype.lastIndexOfSignature=function(l){for(var R=l.charCodeAt(0),L=l.charCodeAt(1),G=l.charCodeAt(2),$=l.charCodeAt(3),B=this.length-4;0<=B;--B)if(this.data[B]===R&&this.data[B+1]===L&&this.data[B+2]===G&&this.data[B+3]===$)return B-this.zero;return-1},P.prototype.readAndCheckSignature=function(l){var R=l.charCodeAt(0),L=l.charCodeAt(1),G=l.charCodeAt(2),$=l.charCodeAt(3),B=this.readData(4);return R===B[0]&&L===B[1]&&G===B[2]&&$===B[3]},P.prototype.readData=function(l){if(this.checkOffset(l),l===0)return[];var R=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,R},I.exports=P},{"../utils":32,"./DataReader":18}],18:[function(x,I,C){var T=x("../utils");function P(l){this.data=l,this.length=l.length,this.index=0,this.zero=0}P.prototype={checkOffset:function(l){this.checkIndex(this.index+l)},checkIndex:function(l){if(this.length<this.zero+l||l<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+l+"). Corrupted zip ?")},setIndex:function(l){this.checkIndex(l),this.index=l},skip:function(l){this.setIndex(this.index+l)},byteAt:function(){},readInt:function(l){var R,L=0;for(this.checkOffset(l),R=this.index+l-1;R>=this.index;R--)L=(L<<8)+this.byteAt(R);return this.index+=l,L},readString:function(l){return T.transformTo("string",this.readData(l))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var l=this.readInt(4);return new Date(Date.UTC(1980+(l>>25&127),(l>>21&15)-1,l>>16&31,l>>11&31,l>>5&63,(31&l)<<1))}},I.exports=P},{"../utils":32}],19:[function(x,I,C){var T=x("./Uint8ArrayReader");function P(l){T.call(this,l)}x("../utils").inherits(P,T),P.prototype.readData=function(l){this.checkOffset(l);var R=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,R},I.exports=P},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(x,I,C){var T=x("./DataReader");function P(l){T.call(this,l)}x("../utils").inherits(P,T),P.prototype.byteAt=function(l){return this.data.charCodeAt(this.zero+l)},P.prototype.lastIndexOfSignature=function(l){return this.data.lastIndexOf(l)-this.zero},P.prototype.readAndCheckSignature=function(l){return l===this.readData(4)},P.prototype.readData=function(l){this.checkOffset(l);var R=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,R},I.exports=P},{"../utils":32,"./DataReader":18}],21:[function(x,I,C){var T=x("./ArrayReader");function P(l){T.call(this,l)}x("../utils").inherits(P,T),P.prototype.readData=function(l){if(this.checkOffset(l),l===0)return new Uint8Array(0);var R=this.data.subarray(this.zero+this.index,this.zero+this.index+l);return this.index+=l,R},I.exports=P},{"../utils":32,"./ArrayReader":17}],22:[function(x,I,C){var T=x("../utils"),P=x("../support"),l=x("./ArrayReader"),R=x("./StringReader"),L=x("./NodeBufferReader"),G=x("./Uint8ArrayReader");I.exports=function($){var B=T.getTypeOf($);return T.checkSupport(B),B!=="string"||P.uint8array?B==="nodebuffer"?new L($):P.uint8array?new G(T.transformTo("uint8array",$)):new l(T.transformTo("array",$)):new R($)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(x,I,C){C.LOCAL_FILE_HEADER="PK",C.CENTRAL_FILE_HEADER="PK",C.CENTRAL_DIRECTORY_END="PK",C.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",C.ZIP64_CENTRAL_DIRECTORY_END="PK",C.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(x,I,C){var T=x("./GenericWorker"),P=x("../utils");function l(R){T.call(this,"ConvertWorker to "+R),this.destType=R}P.inherits(l,T),l.prototype.processChunk=function(R){this.push({data:P.transformTo(this.destType,R.data),meta:R.meta})},I.exports=l},{"../utils":32,"./GenericWorker":28}],25:[function(x,I,C){var T=x("./GenericWorker"),P=x("../crc32");function l(){T.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}x("../utils").inherits(l,T),l.prototype.processChunk=function(R){this.streamInfo.crc32=P(R.data,this.streamInfo.crc32||0),this.push(R)},I.exports=l},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(x,I,C){var T=x("../utils"),P=x("./GenericWorker");function l(R){P.call(this,"DataLengthProbe for "+R),this.propName=R,this.withStreamInfo(R,0)}T.inherits(l,P),l.prototype.processChunk=function(R){if(R){var L=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=L+R.data.length}P.prototype.processChunk.call(this,R)},I.exports=l},{"../utils":32,"./GenericWorker":28}],27:[function(x,I,C){var T=x("../utils"),P=x("./GenericWorker");function l(R){P.call(this,"DataWorker");var L=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,R.then(function(G){L.dataIsReady=!0,L.data=G,L.max=G&&G.length||0,L.type=T.getTypeOf(G),L.isPaused||L._tickAndRepeat()},function(G){L.error(G)})}T.inherits(l,P),l.prototype.cleanUp=function(){P.prototype.cleanUp.call(this),this.data=null},l.prototype.resume=function(){return!!P.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,T.delay(this._tickAndRepeat,[],this)),!0)},l.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(T.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},l.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var R=null,L=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":R=this.data.substring(this.index,L);break;case"uint8array":R=this.data.subarray(this.index,L);break;case"array":case"nodebuffer":R=this.data.slice(this.index,L)}return this.index=L,this.push({data:R,meta:{percent:this.max?this.index/this.max*100:0}})},I.exports=l},{"../utils":32,"./GenericWorker":28}],28:[function(x,I,C){function T(P){this.name=P||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}T.prototype={push:function(P){this.emit("data",P)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(P){this.emit("error",P)}return!0},error:function(P){return!this.isFinished&&(this.isPaused?this.generatedError=P:(this.isFinished=!0,this.emit("error",P),this.previous&&this.previous.error(P),this.cleanUp()),!0)},on:function(P,l){return this._listeners[P].push(l),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(P,l){if(this._listeners[P])for(var R=0;R<this._listeners[P].length;R++)this._listeners[P][R].call(this,l)},pipe:function(P){return P.registerPrevious(this)},registerPrevious:function(P){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=P.streamInfo,this.mergeStreamInfo(),this.previous=P;var l=this;return P.on("data",function(R){l.processChunk(R)}),P.on("end",function(){l.end()}),P.on("error",function(R){l.error(R)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var P=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),P=!0),this.previous&&this.previous.resume(),!P},flush:function(){},processChunk:function(P){this.push(P)},withStreamInfo:function(P,l){return this.extraStreamInfo[P]=l,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var P in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,P)&&(this.streamInfo[P]=this.extraStreamInfo[P])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var P="Worker "+this.name;return this.previous?this.previous+" -> "+P:P}},I.exports=T},{}],29:[function(x,I,C){var T=x("../utils"),P=x("./ConvertWorker"),l=x("./GenericWorker"),R=x("../base64"),L=x("../support"),G=x("../external"),$=null;if(L.nodestream)try{$=x("../nodejs/NodejsStreamOutputAdapter")}catch{}function B(Q,V){return new G.Promise(function(K,Y){var ne=[],ce=Q._internalType,be=Q._outputType,_e=Q._mimeType;Q.on("data",function(Ue,De){ne.push(Ue),V&&V(De)}).on("error",function(Ue){ne=[],Y(Ue)}).on("end",function(){try{var Ue=function(De,Ze,je){switch(De){case"blob":return T.newBlob(T.transformTo("arraybuffer",Ze),je);case"base64":return R.encode(Ze);default:return T.transformTo(De,Ze)}}(be,function(De,Ze){var je,lt=0,vt=null,me=0;for(je=0;je<Ze.length;je++)me+=Ze[je].length;switch(De){case"string":return Ze.join("");case"array":return Array.prototype.concat.apply([],Ze);case"uint8array":for(vt=new Uint8Array(me),je=0;je<Ze.length;je++)vt.set(Ze[je],lt),lt+=Ze[je].length;return vt;case"nodebuffer":return Buffer.concat(Ze);default:throw new Error("concat : unsupported type '"+De+"'")}}(ce,ne),_e);K(Ue)}catch(De){Y(De)}ne=[]}).resume()})}function Z(Q,V,K){var Y=V;switch(V){case"blob":case"arraybuffer":Y="uint8array";break;case"base64":Y="string"}try{this._internalType=Y,this._outputType=V,this._mimeType=K,T.checkSupport(Y),this._worker=Q.pipe(new P(Y)),Q.lock()}catch(ne){this._worker=new l("error"),this._worker.error(ne)}}Z.prototype={accumulate:function(Q){return B(this,Q)},on:function(Q,V){var K=this;return Q==="data"?this._worker.on(Q,function(Y){V.call(K,Y.data,Y.meta)}):this._worker.on(Q,function(){T.delay(V,arguments,K)}),this},resume:function(){return T.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(Q){if(T.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new $(this,{objectMode:this._outputType!=="nodebuffer"},Q)}},I.exports=Z},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(x,I,C){if(C.base64=!0,C.array=!0,C.string=!0,C.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",C.nodebuffer=typeof Buffer<"u",C.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")C.blob=!1;else{var T=new ArrayBuffer(0);try{C.blob=new Blob([T],{type:"application/zip"}).size===0}catch{try{var P=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);P.append(T),C.blob=P.getBlob("application/zip").size===0}catch{C.blob=!1}}}try{C.nodestream=!!x("readable-stream").Readable}catch{C.nodestream=!1}},{"readable-stream":16}],31:[function(x,I,C){for(var T=x("./utils"),P=x("./support"),l=x("./nodejsUtils"),R=x("./stream/GenericWorker"),L=new Array(256),G=0;G<256;G++)L[G]=252<=G?6:248<=G?5:240<=G?4:224<=G?3:192<=G?2:1;L[254]=L[254]=1;function $(){R.call(this,"utf-8 decode"),this.leftOver=null}function B(){R.call(this,"utf-8 encode")}C.utf8encode=function(Z){return P.nodebuffer?l.newBufferFrom(Z,"utf-8"):function(Q){var V,K,Y,ne,ce,be=Q.length,_e=0;for(ne=0;ne<be;ne++)(64512&(K=Q.charCodeAt(ne)))==55296&&ne+1<be&&(64512&(Y=Q.charCodeAt(ne+1)))==56320&&(K=65536+(K-55296<<10)+(Y-56320),ne++),_e+=K<128?1:K<2048?2:K<65536?3:4;for(V=P.uint8array?new Uint8Array(_e):new Array(_e),ne=ce=0;ce<_e;ne++)(64512&(K=Q.charCodeAt(ne)))==55296&&ne+1<be&&(64512&(Y=Q.charCodeAt(ne+1)))==56320&&(K=65536+(K-55296<<10)+(Y-56320),ne++),K<128?V[ce++]=K:(K<2048?V[ce++]=192|K>>>6:(K<65536?V[ce++]=224|K>>>12:(V[ce++]=240|K>>>18,V[ce++]=128|K>>>12&63),V[ce++]=128|K>>>6&63),V[ce++]=128|63&K);return V}(Z)},C.utf8decode=function(Z){return P.nodebuffer?T.transformTo("nodebuffer",Z).toString("utf-8"):function(Q){var V,K,Y,ne,ce=Q.length,be=new Array(2*ce);for(V=K=0;V<ce;)if((Y=Q[V++])<128)be[K++]=Y;else if(4<(ne=L[Y]))be[K++]=65533,V+=ne-1;else{for(Y&=ne===2?31:ne===3?15:7;1<ne&&V<ce;)Y=Y<<6|63&Q[V++],ne--;1<ne?be[K++]=65533:Y<65536?be[K++]=Y:(Y-=65536,be[K++]=55296|Y>>10&1023,be[K++]=56320|1023&Y)}return be.length!==K&&(be.subarray?be=be.subarray(0,K):be.length=K),T.applyFromCharCode(be)}(Z=T.transformTo(P.uint8array?"uint8array":"array",Z))},T.inherits($,R),$.prototype.processChunk=function(Z){var Q=T.transformTo(P.uint8array?"uint8array":"array",Z.data);if(this.leftOver&&this.leftOver.length){if(P.uint8array){var V=Q;(Q=new Uint8Array(V.length+this.leftOver.length)).set(this.leftOver,0),Q.set(V,this.leftOver.length)}else Q=this.leftOver.concat(Q);this.leftOver=null}var K=function(ne,ce){var be;for((ce=ce||ne.length)>ne.length&&(ce=ne.length),be=ce-1;0<=be&&(192&ne[be])==128;)be--;return be<0||be===0?ce:be+L[ne[be]]>ce?be:ce}(Q),Y=Q;K!==Q.length&&(P.uint8array?(Y=Q.subarray(0,K),this.leftOver=Q.subarray(K,Q.length)):(Y=Q.slice(0,K),this.leftOver=Q.slice(K,Q.length))),this.push({data:C.utf8decode(Y),meta:Z.meta})},$.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:C.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},C.Utf8DecodeWorker=$,T.inherits(B,R),B.prototype.processChunk=function(Z){this.push({data:C.utf8encode(Z.data),meta:Z.meta})},C.Utf8EncodeWorker=B},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(x,I,C){var T=x("./support"),P=x("./base64"),l=x("./nodejsUtils"),R=x("./external");function L(V){return V}function G(V,K){for(var Y=0;Y<V.length;++Y)K[Y]=255&V.charCodeAt(Y);return K}x("setimmediate"),C.newBlob=function(V,K){C.checkSupport("blob");try{return new Blob([V],{type:K})}catch{try{var Y=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return Y.append(V),Y.getBlob(K)}catch{throw new Error("Bug : can't construct the Blob.")}}};var $={stringifyByChunk:function(V,K,Y){var ne=[],ce=0,be=V.length;if(be<=Y)return String.fromCharCode.apply(null,V);for(;ce<be;)K==="array"||K==="nodebuffer"?ne.push(String.fromCharCode.apply(null,V.slice(ce,Math.min(ce+Y,be)))):ne.push(String.fromCharCode.apply(null,V.subarray(ce,Math.min(ce+Y,be)))),ce+=Y;return ne.join("")},stringifyByChar:function(V){for(var K="",Y=0;Y<V.length;Y++)K+=String.fromCharCode(V[Y]);return K},applyCanBeUsed:{uint8array:function(){try{return T.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return T.nodebuffer&&String.fromCharCode.apply(null,l.allocBuffer(1)).length===1}catch{return!1}}()}};function B(V){var K=65536,Y=C.getTypeOf(V),ne=!0;if(Y==="uint8array"?ne=$.applyCanBeUsed.uint8array:Y==="nodebuffer"&&(ne=$.applyCanBeUsed.nodebuffer),ne)for(;1<K;)try{return $.stringifyByChunk(V,Y,K)}catch{K=Math.floor(K/2)}return $.stringifyByChar(V)}function Z(V,K){for(var Y=0;Y<V.length;Y++)K[Y]=V[Y];return K}C.applyFromCharCode=B;var Q={};Q.string={string:L,array:function(V){return G(V,new Array(V.length))},arraybuffer:function(V){return Q.string.uint8array(V).buffer},uint8array:function(V){return G(V,new Uint8Array(V.length))},nodebuffer:function(V){return G(V,l.allocBuffer(V.length))}},Q.array={string:B,array:L,arraybuffer:function(V){return new Uint8Array(V).buffer},uint8array:function(V){return new Uint8Array(V)},nodebuffer:function(V){return l.newBufferFrom(V)}},Q.arraybuffer={string:function(V){return B(new Uint8Array(V))},array:function(V){return Z(new Uint8Array(V),new Array(V.byteLength))},arraybuffer:L,uint8array:function(V){return new Uint8Array(V)},nodebuffer:function(V){return l.newBufferFrom(new Uint8Array(V))}},Q.uint8array={string:B,array:function(V){return Z(V,new Array(V.length))},arraybuffer:function(V){return V.buffer},uint8array:L,nodebuffer:function(V){return l.newBufferFrom(V)}},Q.nodebuffer={string:B,array:function(V){return Z(V,new Array(V.length))},arraybuffer:function(V){return Q.nodebuffer.uint8array(V).buffer},uint8array:function(V){return Z(V,new Uint8Array(V.length))},nodebuffer:L},C.transformTo=function(V,K){if(K=K||"",!V)return K;C.checkSupport(V);var Y=C.getTypeOf(K);return Q[Y][V](K)},C.resolve=function(V){for(var K=V.split("/"),Y=[],ne=0;ne<K.length;ne++){var ce=K[ne];ce==="."||ce===""&&ne!==0&&ne!==K.length-1||(ce===".."?Y.pop():Y.push(ce))}return Y.join("/")},C.getTypeOf=function(V){return typeof V=="string"?"string":Object.prototype.toString.call(V)==="[object Array]"?"array":T.nodebuffer&&l.isBuffer(V)?"nodebuffer":T.uint8array&&V instanceof Uint8Array?"uint8array":T.arraybuffer&&V instanceof ArrayBuffer?"arraybuffer":void 0},C.checkSupport=function(V){if(!T[V.toLowerCase()])throw new Error(V+" is not supported by this platform")},C.MAX_VALUE_16BITS=65535,C.MAX_VALUE_32BITS=-1,C.pretty=function(V){var K,Y,ne="";for(Y=0;Y<(V||"").length;Y++)ne+="\\x"+((K=V.charCodeAt(Y))<16?"0":"")+K.toString(16).toUpperCase();return ne},C.delay=function(V,K,Y){setImmediate(function(){V.apply(Y||null,K||[])})},C.inherits=function(V,K){function Y(){}Y.prototype=K.prototype,V.prototype=new Y},C.extend=function(){var V,K,Y={};for(V=0;V<arguments.length;V++)for(K in arguments[V])Object.prototype.hasOwnProperty.call(arguments[V],K)&&Y[K]===void 0&&(Y[K]=arguments[V][K]);return Y},C.prepareContent=function(V,K,Y,ne,ce){return R.Promise.resolve(K).then(function(be){return T.blob&&(be instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(be))!==-1)&&typeof FileReader<"u"?new R.Promise(function(_e,Ue){var De=new FileReader;De.onload=function(Ze){_e(Ze.target.result)},De.onerror=function(Ze){Ue(Ze.target.error)},De.readAsArrayBuffer(be)}):be}).then(function(be){var _e=C.getTypeOf(be);return _e?(_e==="arraybuffer"?be=C.transformTo("uint8array",be):_e==="string"&&(ce?be=P.decode(be):Y&&ne!==!0&&(be=function(Ue){return G(Ue,T.uint8array?new Uint8Array(Ue.length):new Array(Ue.length))}(be))),be):R.Promise.reject(new Error("Can't read the data of '"+V+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(x,I,C){var T=x("./reader/readerFor"),P=x("./utils"),l=x("./signature"),R=x("./zipEntry"),L=x("./support");function G($){this.files=[],this.loadOptions=$}G.prototype={checkSignature:function($){if(!this.reader.readAndCheckSignature($)){this.reader.index-=4;var B=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+P.pretty(B)+", expected "+P.pretty($)+")")}},isSignature:function($,B){var Z=this.reader.index;this.reader.setIndex($);var Q=this.reader.readString(4)===B;return this.reader.setIndex(Z),Q},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var $=this.reader.readData(this.zipCommentLength),B=L.uint8array?"uint8array":"array",Z=P.transformTo(B,$);this.zipComment=this.loadOptions.decodeFileName(Z)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var $,B,Z,Q=this.zip64EndOfCentralSize-44;0<Q;)$=this.reader.readInt(2),B=this.reader.readInt(4),Z=this.reader.readData(B),this.zip64ExtensibleData[$]={id:$,length:B,value:Z}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var $,B;for($=0;$<this.files.length;$++)B=this.files[$],this.reader.setIndex(B.localHeaderOffset),this.checkSignature(l.LOCAL_FILE_HEADER),B.readLocalPart(this.reader),B.handleUTF8(),B.processAttributes()},readCentralDir:function(){var $;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(l.CENTRAL_FILE_HEADER);)($=new R({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push($);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var $=this.reader.lastIndexOfSignature(l.CENTRAL_DIRECTORY_END);if($<0)throw this.isSignature(0,l.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex($);var B=$;if(this.checkSignature(l.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===P.MAX_VALUE_16BITS||this.diskWithCentralDirStart===P.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===P.MAX_VALUE_16BITS||this.centralDirRecords===P.MAX_VALUE_16BITS||this.centralDirSize===P.MAX_VALUE_32BITS||this.centralDirOffset===P.MAX_VALUE_32BITS){if(this.zip64=!0,($=this.reader.lastIndexOfSignature(l.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex($),this.checkSignature(l.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,l.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(l.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(l.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var Z=this.centralDirOffset+this.centralDirSize;this.zip64&&(Z+=20,Z+=12+this.zip64EndOfCentralSize);var Q=B-Z;if(0<Q)this.isSignature(B,l.CENTRAL_FILE_HEADER)||(this.reader.zero=Q);else if(Q<0)throw new Error("Corrupted zip: missing "+Math.abs(Q)+" bytes.")},prepareReader:function($){this.reader=T($)},load:function($){this.prepareReader($),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},I.exports=G},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(x,I,C){var T=x("./reader/readerFor"),P=x("./utils"),l=x("./compressedObject"),R=x("./crc32"),L=x("./utf8"),G=x("./compressions"),$=x("./support");function B(Z,Q){this.options=Z,this.loadOptions=Q}B.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(Z){var Q,V;if(Z.skip(22),this.fileNameLength=Z.readInt(2),V=Z.readInt(2),this.fileName=Z.readData(this.fileNameLength),Z.skip(V),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((Q=function(K){for(var Y in G)if(Object.prototype.hasOwnProperty.call(G,Y)&&G[Y].magic===K)return G[Y];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+P.pretty(this.compressionMethod)+" unknown (inner file : "+P.transformTo("string",this.fileName)+")");this.decompressed=new l(this.compressedSize,this.uncompressedSize,this.crc32,Q,Z.readData(this.compressedSize))},readCentralPart:function(Z){this.versionMadeBy=Z.readInt(2),Z.skip(2),this.bitFlag=Z.readInt(2),this.compressionMethod=Z.readString(2),this.date=Z.readDate(),this.crc32=Z.readInt(4),this.compressedSize=Z.readInt(4),this.uncompressedSize=Z.readInt(4);var Q=Z.readInt(2);if(this.extraFieldsLength=Z.readInt(2),this.fileCommentLength=Z.readInt(2),this.diskNumberStart=Z.readInt(2),this.internalFileAttributes=Z.readInt(2),this.externalFileAttributes=Z.readInt(4),this.localHeaderOffset=Z.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");Z.skip(Q),this.readExtraFields(Z),this.parseZIP64ExtraField(Z),this.fileComment=Z.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var Z=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),Z==0&&(this.dosPermissions=63&this.externalFileAttributes),Z==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var Z=T(this.extraFields[1].value);this.uncompressedSize===P.MAX_VALUE_32BITS&&(this.uncompressedSize=Z.readInt(8)),this.compressedSize===P.MAX_VALUE_32BITS&&(this.compressedSize=Z.readInt(8)),this.localHeaderOffset===P.MAX_VALUE_32BITS&&(this.localHeaderOffset=Z.readInt(8)),this.diskNumberStart===P.MAX_VALUE_32BITS&&(this.diskNumberStart=Z.readInt(4))}},readExtraFields:function(Z){var Q,V,K,Y=Z.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});Z.index+4<Y;)Q=Z.readInt(2),V=Z.readInt(2),K=Z.readData(V),this.extraFields[Q]={id:Q,length:V,value:K};Z.setIndex(Y)},handleUTF8:function(){var Z=$.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=L.utf8decode(this.fileName),this.fileCommentStr=L.utf8decode(this.fileComment);else{var Q=this.findExtraFieldUnicodePath();if(Q!==null)this.fileNameStr=Q;else{var V=P.transformTo(Z,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(V)}var K=this.findExtraFieldUnicodeComment();if(K!==null)this.fileCommentStr=K;else{var Y=P.transformTo(Z,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(Y)}}},findExtraFieldUnicodePath:function(){var Z=this.extraFields[28789];if(Z){var Q=T(Z.value);return Q.readInt(1)!==1||R(this.fileName)!==Q.readInt(4)?null:L.utf8decode(Q.readData(Z.length-5))}return null},findExtraFieldUnicodeComment:function(){var Z=this.extraFields[25461];if(Z){var Q=T(Z.value);return Q.readInt(1)!==1||R(this.fileComment)!==Q.readInt(4)?null:L.utf8decode(Q.readData(Z.length-5))}return null}},I.exports=B},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(x,I,C){function T(Q,V,K){this.name=Q,this.dir=K.dir,this.date=K.date,this.comment=K.comment,this.unixPermissions=K.unixPermissions,this.dosPermissions=K.dosPermissions,this._data=V,this._dataBinary=K.binary,this.options={compression:K.compression,compressionOptions:K.compressionOptions}}var P=x("./stream/StreamHelper"),l=x("./stream/DataWorker"),R=x("./utf8"),L=x("./compressedObject"),G=x("./stream/GenericWorker");T.prototype={internalStream:function(Q){var V=null,K="string";try{if(!Q)throw new Error("No output type specified.");var Y=(K=Q.toLowerCase())==="string"||K==="text";K!=="binarystring"&&K!=="text"||(K="string"),V=this._decompressWorker();var ne=!this._dataBinary;ne&&!Y&&(V=V.pipe(new R.Utf8EncodeWorker)),!ne&&Y&&(V=V.pipe(new R.Utf8DecodeWorker))}catch(ce){(V=new G("error")).error(ce)}return new P(V,K,"")},async:function(Q,V){return this.internalStream(Q).accumulate(V)},nodeStream:function(Q,V){return this.internalStream(Q||"nodebuffer").toNodejsStream(V)},_compressWorker:function(Q,V){if(this._data instanceof L&&this._data.compression.magic===Q.magic)return this._data.getCompressedWorker();var K=this._decompressWorker();return this._dataBinary||(K=K.pipe(new R.Utf8EncodeWorker)),L.createWorkerFrom(K,Q,V)},_decompressWorker:function(){return this._data instanceof L?this._data.getContentWorker():this._data instanceof G?this._data:new l(this._data)}};for(var $=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],B=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},Z=0;Z<$.length;Z++)T.prototype[$[Z]]=B;I.exports=T},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(x,I,C){(function(T){var P,l,R=T.MutationObserver||T.WebKitMutationObserver;if(R){var L=0,G=new R(Q),$=T.document.createTextNode("");G.observe($,{characterData:!0}),P=function(){$.data=L=++L%2}}else if(T.setImmediate||T.MessageChannel===void 0)P="document"in T&&"onreadystatechange"in T.document.createElement("script")?function(){var V=T.document.createElement("script");V.onreadystatechange=function(){Q(),V.onreadystatechange=null,V.parentNode.removeChild(V),V=null},T.document.documentElement.appendChild(V)}:function(){setTimeout(Q,0)};else{var B=new T.MessageChannel;B.port1.onmessage=Q,P=function(){B.port2.postMessage(0)}}var Z=[];function Q(){var V,K;l=!0;for(var Y=Z.length;Y;){for(K=Z,Z=[],V=-1;++V<Y;)K[V]();Y=Z.length}l=!1}I.exports=function(V){Z.push(V)!==1||l||P()}}).call(this,typeof Zl<"u"?Zl:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(x,I,C){var T=x("immediate");function P(){}var l={},R=["REJECTED"],L=["FULFILLED"],G=["PENDING"];function $(Y){if(typeof Y!="function")throw new TypeError("resolver must be a function");this.state=G,this.queue=[],this.outcome=void 0,Y!==P&&V(this,Y)}function B(Y,ne,ce){this.promise=Y,typeof ne=="function"&&(this.onFulfilled=ne,this.callFulfilled=this.otherCallFulfilled),typeof ce=="function"&&(this.onRejected=ce,this.callRejected=this.otherCallRejected)}function Z(Y,ne,ce){T(function(){var be;try{be=ne(ce)}catch(_e){return l.reject(Y,_e)}be===Y?l.reject(Y,new TypeError("Cannot resolve promise with itself")):l.resolve(Y,be)})}function Q(Y){var ne=Y&&Y.then;if(Y&&(typeof Y=="object"||typeof Y=="function")&&typeof ne=="function")return function(){ne.apply(Y,arguments)}}function V(Y,ne){var ce=!1;function be(De){ce||(ce=!0,l.reject(Y,De))}function _e(De){ce||(ce=!0,l.resolve(Y,De))}var Ue=K(function(){ne(_e,be)});Ue.status==="error"&&be(Ue.value)}function K(Y,ne){var ce={};try{ce.value=Y(ne),ce.status="success"}catch(be){ce.status="error",ce.value=be}return ce}(I.exports=$).prototype.finally=function(Y){if(typeof Y!="function")return this;var ne=this.constructor;return this.then(function(ce){return ne.resolve(Y()).then(function(){return ce})},function(ce){return ne.resolve(Y()).then(function(){throw ce})})},$.prototype.catch=function(Y){return this.then(null,Y)},$.prototype.then=function(Y,ne){if(typeof Y!="function"&&this.state===L||typeof ne!="function"&&this.state===R)return this;var ce=new this.constructor(P);return this.state!==G?Z(ce,this.state===L?Y:ne,this.outcome):this.queue.push(new B(ce,Y,ne)),ce},B.prototype.callFulfilled=function(Y){l.resolve(this.promise,Y)},B.prototype.otherCallFulfilled=function(Y){Z(this.promise,this.onFulfilled,Y)},B.prototype.callRejected=function(Y){l.reject(this.promise,Y)},B.prototype.otherCallRejected=function(Y){Z(this.promise,this.onRejected,Y)},l.resolve=function(Y,ne){var ce=K(Q,ne);if(ce.status==="error")return l.reject(Y,ce.value);var be=ce.value;if(be)V(Y,be);else{Y.state=L,Y.outcome=ne;for(var _e=-1,Ue=Y.queue.length;++_e<Ue;)Y.queue[_e].callFulfilled(ne)}return Y},l.reject=function(Y,ne){Y.state=R,Y.outcome=ne;for(var ce=-1,be=Y.queue.length;++ce<be;)Y.queue[ce].callRejected(ne);return Y},$.resolve=function(Y){return Y instanceof this?Y:l.resolve(new this(P),Y)},$.reject=function(Y){var ne=new this(P);return l.reject(ne,Y)},$.all=function(Y){var ne=this;if(Object.prototype.toString.call(Y)!=="[object Array]")return this.reject(new TypeError("must be an array"));var ce=Y.length,be=!1;if(!ce)return this.resolve([]);for(var _e=new Array(ce),Ue=0,De=-1,Ze=new this(P);++De<ce;)je(Y[De],De);return Ze;function je(lt,vt){ne.resolve(lt).then(function(me){_e[vt]=me,++Ue!==ce||be||(be=!0,l.resolve(Ze,_e))},function(me){be||(be=!0,l.reject(Ze,me))})}},$.race=function(Y){var ne=this;if(Object.prototype.toString.call(Y)!=="[object Array]")return this.reject(new TypeError("must be an array"));var ce=Y.length,be=!1;if(!ce)return this.resolve([]);for(var _e=-1,Ue=new this(P);++_e<ce;)De=Y[_e],ne.resolve(De).then(function(Ze){be||(be=!0,l.resolve(Ue,Ze))},function(Ze){be||(be=!0,l.reject(Ue,Ze))});var De;return Ue}},{immediate:36}],38:[function(x,I,C){var T={};(0,x("./lib/utils/common").assign)(T,x("./lib/deflate"),x("./lib/inflate"),x("./lib/zlib/constants")),I.exports=T},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(x,I,C){var T=x("./zlib/deflate"),P=x("./utils/common"),l=x("./utils/strings"),R=x("./zlib/messages"),L=x("./zlib/zstream"),G=Object.prototype.toString,$=0,B=-1,Z=0,Q=8;function V(Y){if(!(this instanceof V))return new V(Y);this.options=P.assign({level:B,method:Q,chunkSize:16384,windowBits:15,memLevel:8,strategy:Z,to:""},Y||{});var ne=this.options;ne.raw&&0<ne.windowBits?ne.windowBits=-ne.windowBits:ne.gzip&&0<ne.windowBits&&ne.windowBits<16&&(ne.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new L,this.strm.avail_out=0;var ce=T.deflateInit2(this.strm,ne.level,ne.method,ne.windowBits,ne.memLevel,ne.strategy);if(ce!==$)throw new Error(R[ce]);if(ne.header&&T.deflateSetHeader(this.strm,ne.header),ne.dictionary){var be;if(be=typeof ne.dictionary=="string"?l.string2buf(ne.dictionary):G.call(ne.dictionary)==="[object ArrayBuffer]"?new Uint8Array(ne.dictionary):ne.dictionary,(ce=T.deflateSetDictionary(this.strm,be))!==$)throw new Error(R[ce]);this._dict_set=!0}}function K(Y,ne){var ce=new V(ne);if(ce.push(Y,!0),ce.err)throw ce.msg||R[ce.err];return ce.result}V.prototype.push=function(Y,ne){var ce,be,_e=this.strm,Ue=this.options.chunkSize;if(this.ended)return!1;be=ne===~~ne?ne:ne===!0?4:0,typeof Y=="string"?_e.input=l.string2buf(Y):G.call(Y)==="[object ArrayBuffer]"?_e.input=new Uint8Array(Y):_e.input=Y,_e.next_in=0,_e.avail_in=_e.input.length;do{if(_e.avail_out===0&&(_e.output=new P.Buf8(Ue),_e.next_out=0,_e.avail_out=Ue),(ce=T.deflate(_e,be))!==1&&ce!==$)return this.onEnd(ce),!(this.ended=!0);_e.avail_out!==0&&(_e.avail_in!==0||be!==4&&be!==2)||(this.options.to==="string"?this.onData(l.buf2binstring(P.shrinkBuf(_e.output,_e.next_out))):this.onData(P.shrinkBuf(_e.output,_e.next_out)))}while((0<_e.avail_in||_e.avail_out===0)&&ce!==1);return be===4?(ce=T.deflateEnd(this.strm),this.onEnd(ce),this.ended=!0,ce===$):be!==2||(this.onEnd($),!(_e.avail_out=0))},V.prototype.onData=function(Y){this.chunks.push(Y)},V.prototype.onEnd=function(Y){Y===$&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=P.flattenChunks(this.chunks)),this.chunks=[],this.err=Y,this.msg=this.strm.msg},C.Deflate=V,C.deflate=K,C.deflateRaw=function(Y,ne){return(ne=ne||{}).raw=!0,K(Y,ne)},C.gzip=function(Y,ne){return(ne=ne||{}).gzip=!0,K(Y,ne)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(x,I,C){var T=x("./zlib/inflate"),P=x("./utils/common"),l=x("./utils/strings"),R=x("./zlib/constants"),L=x("./zlib/messages"),G=x("./zlib/zstream"),$=x("./zlib/gzheader"),B=Object.prototype.toString;function Z(V){if(!(this instanceof Z))return new Z(V);this.options=P.assign({chunkSize:16384,windowBits:0,to:""},V||{});var K=this.options;K.raw&&0<=K.windowBits&&K.windowBits<16&&(K.windowBits=-K.windowBits,K.windowBits===0&&(K.windowBits=-15)),!(0<=K.windowBits&&K.windowBits<16)||V&&V.windowBits||(K.windowBits+=32),15<K.windowBits&&K.windowBits<48&&(15&K.windowBits)==0&&(K.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new G,this.strm.avail_out=0;var Y=T.inflateInit2(this.strm,K.windowBits);if(Y!==R.Z_OK)throw new Error(L[Y]);this.header=new $,T.inflateGetHeader(this.strm,this.header)}function Q(V,K){var Y=new Z(K);if(Y.push(V,!0),Y.err)throw Y.msg||L[Y.err];return Y.result}Z.prototype.push=function(V,K){var Y,ne,ce,be,_e,Ue,De=this.strm,Ze=this.options.chunkSize,je=this.options.dictionary,lt=!1;if(this.ended)return!1;ne=K===~~K?K:K===!0?R.Z_FINISH:R.Z_NO_FLUSH,typeof V=="string"?De.input=l.binstring2buf(V):B.call(V)==="[object ArrayBuffer]"?De.input=new Uint8Array(V):De.input=V,De.next_in=0,De.avail_in=De.input.length;do{if(De.avail_out===0&&(De.output=new P.Buf8(Ze),De.next_out=0,De.avail_out=Ze),(Y=T.inflate(De,R.Z_NO_FLUSH))===R.Z_NEED_DICT&&je&&(Ue=typeof je=="string"?l.string2buf(je):B.call(je)==="[object ArrayBuffer]"?new Uint8Array(je):je,Y=T.inflateSetDictionary(this.strm,Ue)),Y===R.Z_BUF_ERROR&&lt===!0&&(Y=R.Z_OK,lt=!1),Y!==R.Z_STREAM_END&&Y!==R.Z_OK)return this.onEnd(Y),!(this.ended=!0);De.next_out&&(De.avail_out!==0&&Y!==R.Z_STREAM_END&&(De.avail_in!==0||ne!==R.Z_FINISH&&ne!==R.Z_SYNC_FLUSH)||(this.options.to==="string"?(ce=l.utf8border(De.output,De.next_out),be=De.next_out-ce,_e=l.buf2string(De.output,ce),De.next_out=be,De.avail_out=Ze-be,be&&P.arraySet(De.output,De.output,ce,be,0),this.onData(_e)):this.onData(P.shrinkBuf(De.output,De.next_out)))),De.avail_in===0&&De.avail_out===0&&(lt=!0)}while((0<De.avail_in||De.avail_out===0)&&Y!==R.Z_STREAM_END);return Y===R.Z_STREAM_END&&(ne=R.Z_FINISH),ne===R.Z_FINISH?(Y=T.inflateEnd(this.strm),this.onEnd(Y),this.ended=!0,Y===R.Z_OK):ne!==R.Z_SYNC_FLUSH||(this.onEnd(R.Z_OK),!(De.avail_out=0))},Z.prototype.onData=function(V){this.chunks.push(V)},Z.prototype.onEnd=function(V){V===R.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=P.flattenChunks(this.chunks)),this.chunks=[],this.err=V,this.msg=this.strm.msg},C.Inflate=Z,C.inflate=Q,C.inflateRaw=function(V,K){return(K=K||{}).raw=!0,Q(V,K)},C.ungzip=Q},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(x,I,C){var T=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";C.assign=function(R){for(var L=Array.prototype.slice.call(arguments,1);L.length;){var G=L.shift();if(G){if(typeof G!="object")throw new TypeError(G+"must be non-object");for(var $ in G)G.hasOwnProperty($)&&(R[$]=G[$])}}return R},C.shrinkBuf=function(R,L){return R.length===L?R:R.subarray?R.subarray(0,L):(R.length=L,R)};var P={arraySet:function(R,L,G,$,B){if(L.subarray&&R.subarray)R.set(L.subarray(G,G+$),B);else for(var Z=0;Z<$;Z++)R[B+Z]=L[G+Z]},flattenChunks:function(R){var L,G,$,B,Z,Q;for(L=$=0,G=R.length;L<G;L++)$+=R[L].length;for(Q=new Uint8Array($),L=B=0,G=R.length;L<G;L++)Z=R[L],Q.set(Z,B),B+=Z.length;return Q}},l={arraySet:function(R,L,G,$,B){for(var Z=0;Z<$;Z++)R[B+Z]=L[G+Z]},flattenChunks:function(R){return[].concat.apply([],R)}};C.setTyped=function(R){R?(C.Buf8=Uint8Array,C.Buf16=Uint16Array,C.Buf32=Int32Array,C.assign(C,P)):(C.Buf8=Array,C.Buf16=Array,C.Buf32=Array,C.assign(C,l))},C.setTyped(T)},{}],42:[function(x,I,C){var T=x("./common"),P=!0,l=!0;try{String.fromCharCode.apply(null,[0])}catch{P=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{l=!1}for(var R=new T.Buf8(256),L=0;L<256;L++)R[L]=252<=L?6:248<=L?5:240<=L?4:224<=L?3:192<=L?2:1;function G($,B){if(B<65537&&($.subarray&&l||!$.subarray&&P))return String.fromCharCode.apply(null,T.shrinkBuf($,B));for(var Z="",Q=0;Q<B;Q++)Z+=String.fromCharCode($[Q]);return Z}R[254]=R[254]=1,C.string2buf=function($){var B,Z,Q,V,K,Y=$.length,ne=0;for(V=0;V<Y;V++)(64512&(Z=$.charCodeAt(V)))==55296&&V+1<Y&&(64512&(Q=$.charCodeAt(V+1)))==56320&&(Z=65536+(Z-55296<<10)+(Q-56320),V++),ne+=Z<128?1:Z<2048?2:Z<65536?3:4;for(B=new T.Buf8(ne),V=K=0;K<ne;V++)(64512&(Z=$.charCodeAt(V)))==55296&&V+1<Y&&(64512&(Q=$.charCodeAt(V+1)))==56320&&(Z=65536+(Z-55296<<10)+(Q-56320),V++),Z<128?B[K++]=Z:(Z<2048?B[K++]=192|Z>>>6:(Z<65536?B[K++]=224|Z>>>12:(B[K++]=240|Z>>>18,B[K++]=128|Z>>>12&63),B[K++]=128|Z>>>6&63),B[K++]=128|63&Z);return B},C.buf2binstring=function($){return G($,$.length)},C.binstring2buf=function($){for(var B=new T.Buf8($.length),Z=0,Q=B.length;Z<Q;Z++)B[Z]=$.charCodeAt(Z);return B},C.buf2string=function($,B){var Z,Q,V,K,Y=B||$.length,ne=new Array(2*Y);for(Z=Q=0;Z<Y;)if((V=$[Z++])<128)ne[Q++]=V;else if(4<(K=R[V]))ne[Q++]=65533,Z+=K-1;else{for(V&=K===2?31:K===3?15:7;1<K&&Z<Y;)V=V<<6|63&$[Z++],K--;1<K?ne[Q++]=65533:V<65536?ne[Q++]=V:(V-=65536,ne[Q++]=55296|V>>10&1023,ne[Q++]=56320|1023&V)}return G(ne,Q)},C.utf8border=function($,B){var Z;for((B=B||$.length)>$.length&&(B=$.length),Z=B-1;0<=Z&&(192&$[Z])==128;)Z--;return Z<0||Z===0?B:Z+R[$[Z]]>B?Z:B}},{"./common":41}],43:[function(x,I,C){I.exports=function(T,P,l,R){for(var L=65535&T|0,G=T>>>16&65535|0,$=0;l!==0;){for(l-=$=2e3<l?2e3:l;G=G+(L=L+P[R++]|0)|0,--$;);L%=65521,G%=65521}return L|G<<16|0}},{}],44:[function(x,I,C){I.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(x,I,C){var T=function(){for(var P,l=[],R=0;R<256;R++){P=R;for(var L=0;L<8;L++)P=1&P?3988292384^P>>>1:P>>>1;l[R]=P}return l}();I.exports=function(P,l,R,L){var G=T,$=L+R;P^=-1;for(var B=L;B<$;B++)P=P>>>8^G[255&(P^l[B])];return-1^P}},{}],46:[function(x,I,C){var T,P=x("../utils/common"),l=x("./trees"),R=x("./adler32"),L=x("./crc32"),G=x("./messages"),$=0,B=4,Z=0,Q=-2,V=-1,K=4,Y=2,ne=8,ce=9,be=286,_e=30,Ue=19,De=2*be+1,Ze=15,je=3,lt=258,vt=lt+je+1,me=42,$e=113,j=1,qe=2,ht=3,Ke=4;function st(O,it){return O.msg=G[it],it}function Fe(O){return(O<<1)-(4<O?9:0)}function ae(O){for(var it=O.length;0<=--it;)O[it]=0}function fe(O){var it=O.state,He=it.pending;He>O.avail_out&&(He=O.avail_out),He!==0&&(P.arraySet(O.output,it.pending_buf,it.pending_out,He,O.next_out),O.next_out+=He,it.pending_out+=He,O.total_out+=He,O.avail_out-=He,it.pending-=He,it.pending===0&&(it.pending_out=0))}function Se(O,it){l._tr_flush_block(O,0<=O.block_start?O.block_start:-1,O.strstart-O.block_start,it),O.block_start=O.strstart,fe(O.strm)}function gt(O,it){O.pending_buf[O.pending++]=it}function ct(O,it){O.pending_buf[O.pending++]=it>>>8&255,O.pending_buf[O.pending++]=255&it}function dt(O,it){var He,de,oe=O.max_chain_length,Ee=O.strstart,ot=O.prev_length,ft=O.nice_match,Ne=O.strstart>O.w_size-vt?O.strstart-(O.w_size-vt):0,_t=O.window,We=O.w_mask,Qe=O.prev,kt=O.strstart+lt,Me=_t[Ee+ot-1],Je=_t[Ee+ot];O.prev_length>=O.good_match&&(oe>>=2),ft>O.lookahead&&(ft=O.lookahead);do if(_t[(He=it)+ot]===Je&&_t[He+ot-1]===Me&&_t[He]===_t[Ee]&&_t[++He]===_t[Ee+1]){Ee+=2,He++;do;while(_t[++Ee]===_t[++He]&&_t[++Ee]===_t[++He]&&_t[++Ee]===_t[++He]&&_t[++Ee]===_t[++He]&&_t[++Ee]===_t[++He]&&_t[++Ee]===_t[++He]&&_t[++Ee]===_t[++He]&&_t[++Ee]===_t[++He]&&Ee<kt);if(de=lt-(kt-Ee),Ee=kt-lt,ot<de){if(O.match_start=it,ft<=(ot=de))break;Me=_t[Ee+ot-1],Je=_t[Ee+ot]}}while((it=Qe[it&We])>Ne&&--oe!=0);return ot<=O.lookahead?ot:O.lookahead}function bt(O){var it,He,de,oe,Ee,ot,ft,Ne,_t,We,Qe=O.w_size;do{if(oe=O.window_size-O.lookahead-O.strstart,O.strstart>=Qe+(Qe-vt)){for(P.arraySet(O.window,O.window,Qe,Qe,0),O.match_start-=Qe,O.strstart-=Qe,O.block_start-=Qe,it=He=O.hash_size;de=O.head[--it],O.head[it]=Qe<=de?de-Qe:0,--He;);for(it=He=Qe;de=O.prev[--it],O.prev[it]=Qe<=de?de-Qe:0,--He;);oe+=Qe}if(O.strm.avail_in===0)break;if(ot=O.strm,ft=O.window,Ne=O.strstart+O.lookahead,_t=oe,We=void 0,We=ot.avail_in,_t<We&&(We=_t),He=We===0?0:(ot.avail_in-=We,P.arraySet(ft,ot.input,ot.next_in,We,Ne),ot.state.wrap===1?ot.adler=R(ot.adler,ft,We,Ne):ot.state.wrap===2&&(ot.adler=L(ot.adler,ft,We,Ne)),ot.next_in+=We,ot.total_in+=We,We),O.lookahead+=He,O.lookahead+O.insert>=je)for(Ee=O.strstart-O.insert,O.ins_h=O.window[Ee],O.ins_h=(O.ins_h<<O.hash_shift^O.window[Ee+1])&O.hash_mask;O.insert&&(O.ins_h=(O.ins_h<<O.hash_shift^O.window[Ee+je-1])&O.hash_mask,O.prev[Ee&O.w_mask]=O.head[O.ins_h],O.head[O.ins_h]=Ee,Ee++,O.insert--,!(O.lookahead+O.insert<je)););}while(O.lookahead<vt&&O.strm.avail_in!==0)}function Vt(O,it){for(var He,de;;){if(O.lookahead<vt){if(bt(O),O.lookahead<vt&&it===$)return j;if(O.lookahead===0)break}if(He=0,O.lookahead>=je&&(O.ins_h=(O.ins_h<<O.hash_shift^O.window[O.strstart+je-1])&O.hash_mask,He=O.prev[O.strstart&O.w_mask]=O.head[O.ins_h],O.head[O.ins_h]=O.strstart),He!==0&&O.strstart-He<=O.w_size-vt&&(O.match_length=dt(O,He)),O.match_length>=je)if(de=l._tr_tally(O,O.strstart-O.match_start,O.match_length-je),O.lookahead-=O.match_length,O.match_length<=O.max_lazy_match&&O.lookahead>=je){for(O.match_length--;O.strstart++,O.ins_h=(O.ins_h<<O.hash_shift^O.window[O.strstart+je-1])&O.hash_mask,He=O.prev[O.strstart&O.w_mask]=O.head[O.ins_h],O.head[O.ins_h]=O.strstart,--O.match_length!=0;);O.strstart++}else O.strstart+=O.match_length,O.match_length=0,O.ins_h=O.window[O.strstart],O.ins_h=(O.ins_h<<O.hash_shift^O.window[O.strstart+1])&O.hash_mask;else de=l._tr_tally(O,0,O.window[O.strstart]),O.lookahead--,O.strstart++;if(de&&(Se(O,!1),O.strm.avail_out===0))return j}return O.insert=O.strstart<je-1?O.strstart:je-1,it===B?(Se(O,!0),O.strm.avail_out===0?ht:Ke):O.last_lit&&(Se(O,!1),O.strm.avail_out===0)?j:qe}function At(O,it){for(var He,de,oe;;){if(O.lookahead<vt){if(bt(O),O.lookahead<vt&&it===$)return j;if(O.lookahead===0)break}if(He=0,O.lookahead>=je&&(O.ins_h=(O.ins_h<<O.hash_shift^O.window[O.strstart+je-1])&O.hash_mask,He=O.prev[O.strstart&O.w_mask]=O.head[O.ins_h],O.head[O.ins_h]=O.strstart),O.prev_length=O.match_length,O.prev_match=O.match_start,O.match_length=je-1,He!==0&&O.prev_length<O.max_lazy_match&&O.strstart-He<=O.w_size-vt&&(O.match_length=dt(O,He),O.match_length<=5&&(O.strategy===1||O.match_length===je&&4096<O.strstart-O.match_start)&&(O.match_length=je-1)),O.prev_length>=je&&O.match_length<=O.prev_length){for(oe=O.strstart+O.lookahead-je,de=l._tr_tally(O,O.strstart-1-O.prev_match,O.prev_length-je),O.lookahead-=O.prev_length-1,O.prev_length-=2;++O.strstart<=oe&&(O.ins_h=(O.ins_h<<O.hash_shift^O.window[O.strstart+je-1])&O.hash_mask,He=O.prev[O.strstart&O.w_mask]=O.head[O.ins_h],O.head[O.ins_h]=O.strstart),--O.prev_length!=0;);if(O.match_available=0,O.match_length=je-1,O.strstart++,de&&(Se(O,!1),O.strm.avail_out===0))return j}else if(O.match_available){if((de=l._tr_tally(O,0,O.window[O.strstart-1]))&&Se(O,!1),O.strstart++,O.lookahead--,O.strm.avail_out===0)return j}else O.match_available=1,O.strstart++,O.lookahead--}return O.match_available&&(de=l._tr_tally(O,0,O.window[O.strstart-1]),O.match_available=0),O.insert=O.strstart<je-1?O.strstart:je-1,it===B?(Se(O,!0),O.strm.avail_out===0?ht:Ke):O.last_lit&&(Se(O,!1),O.strm.avail_out===0)?j:qe}function Rt(O,it,He,de,oe){this.good_length=O,this.max_lazy=it,this.nice_length=He,this.max_chain=de,this.func=oe}function $t(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=ne,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new P.Buf16(2*De),this.dyn_dtree=new P.Buf16(2*(2*_e+1)),this.bl_tree=new P.Buf16(2*(2*Ue+1)),ae(this.dyn_ltree),ae(this.dyn_dtree),ae(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new P.Buf16(Ze+1),this.heap=new P.Buf16(2*be+1),ae(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new P.Buf16(2*be+1),ae(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function or(O){var it;return O&&O.state?(O.total_in=O.total_out=0,O.data_type=Y,(it=O.state).pending=0,it.pending_out=0,it.wrap<0&&(it.wrap=-it.wrap),it.status=it.wrap?me:$e,O.adler=it.wrap===2?0:1,it.last_flush=$,l._tr_init(it),Z):st(O,Q)}function sr(O){var it=or(O);return it===Z&&function(He){He.window_size=2*He.w_size,ae(He.head),He.max_lazy_match=T[He.level].max_lazy,He.good_match=T[He.level].good_length,He.nice_match=T[He.level].nice_length,He.max_chain_length=T[He.level].max_chain,He.strstart=0,He.block_start=0,He.lookahead=0,He.insert=0,He.match_length=He.prev_length=je-1,He.match_available=0,He.ins_h=0}(O.state),it}function pr(O,it,He,de,oe,Ee){if(!O)return Q;var ot=1;if(it===V&&(it=6),de<0?(ot=0,de=-de):15<de&&(ot=2,de-=16),oe<1||ce<oe||He!==ne||de<8||15<de||it<0||9<it||Ee<0||K<Ee)return st(O,Q);de===8&&(de=9);var ft=new $t;return(O.state=ft).strm=O,ft.wrap=ot,ft.gzhead=null,ft.w_bits=de,ft.w_size=1<<ft.w_bits,ft.w_mask=ft.w_size-1,ft.hash_bits=oe+7,ft.hash_size=1<<ft.hash_bits,ft.hash_mask=ft.hash_size-1,ft.hash_shift=~~((ft.hash_bits+je-1)/je),ft.window=new P.Buf8(2*ft.w_size),ft.head=new P.Buf16(ft.hash_size),ft.prev=new P.Buf16(ft.w_size),ft.lit_bufsize=1<<oe+6,ft.pending_buf_size=4*ft.lit_bufsize,ft.pending_buf=new P.Buf8(ft.pending_buf_size),ft.d_buf=1*ft.lit_bufsize,ft.l_buf=3*ft.lit_bufsize,ft.level=it,ft.strategy=Ee,ft.method=He,sr(O)}T=[new Rt(0,0,0,0,function(O,it){var He=65535;for(He>O.pending_buf_size-5&&(He=O.pending_buf_size-5);;){if(O.lookahead<=1){if(bt(O),O.lookahead===0&&it===$)return j;if(O.lookahead===0)break}O.strstart+=O.lookahead,O.lookahead=0;var de=O.block_start+He;if((O.strstart===0||O.strstart>=de)&&(O.lookahead=O.strstart-de,O.strstart=de,Se(O,!1),O.strm.avail_out===0)||O.strstart-O.block_start>=O.w_size-vt&&(Se(O,!1),O.strm.avail_out===0))return j}return O.insert=0,it===B?(Se(O,!0),O.strm.avail_out===0?ht:Ke):(O.strstart>O.block_start&&(Se(O,!1),O.strm.avail_out),j)}),new Rt(4,4,8,4,Vt),new Rt(4,5,16,8,Vt),new Rt(4,6,32,32,Vt),new Rt(4,4,16,16,At),new Rt(8,16,32,32,At),new Rt(8,16,128,128,At),new Rt(8,32,128,256,At),new Rt(32,128,258,1024,At),new Rt(32,258,258,4096,At)],C.deflateInit=function(O,it){return pr(O,it,ne,15,8,0)},C.deflateInit2=pr,C.deflateReset=sr,C.deflateResetKeep=or,C.deflateSetHeader=function(O,it){return O&&O.state?O.state.wrap!==2?Q:(O.state.gzhead=it,Z):Q},C.deflate=function(O,it){var He,de,oe,Ee;if(!O||!O.state||5<it||it<0)return O?st(O,Q):Q;if(de=O.state,!O.output||!O.input&&O.avail_in!==0||de.status===666&&it!==B)return st(O,O.avail_out===0?-5:Q);if(de.strm=O,He=de.last_flush,de.last_flush=it,de.status===me)if(de.wrap===2)O.adler=0,gt(de,31),gt(de,139),gt(de,8),de.gzhead?(gt(de,(de.gzhead.text?1:0)+(de.gzhead.hcrc?2:0)+(de.gzhead.extra?4:0)+(de.gzhead.name?8:0)+(de.gzhead.comment?16:0)),gt(de,255&de.gzhead.time),gt(de,de.gzhead.time>>8&255),gt(de,de.gzhead.time>>16&255),gt(de,de.gzhead.time>>24&255),gt(de,de.level===9?2:2<=de.strategy||de.level<2?4:0),gt(de,255&de.gzhead.os),de.gzhead.extra&&de.gzhead.extra.length&&(gt(de,255&de.gzhead.extra.length),gt(de,de.gzhead.extra.length>>8&255)),de.gzhead.hcrc&&(O.adler=L(O.adler,de.pending_buf,de.pending,0)),de.gzindex=0,de.status=69):(gt(de,0),gt(de,0),gt(de,0),gt(de,0),gt(de,0),gt(de,de.level===9?2:2<=de.strategy||de.level<2?4:0),gt(de,3),de.status=$e);else{var ot=ne+(de.w_bits-8<<4)<<8;ot|=(2<=de.strategy||de.level<2?0:de.level<6?1:de.level===6?2:3)<<6,de.strstart!==0&&(ot|=32),ot+=31-ot%31,de.status=$e,ct(de,ot),de.strstart!==0&&(ct(de,O.adler>>>16),ct(de,65535&O.adler)),O.adler=1}if(de.status===69)if(de.gzhead.extra){for(oe=de.pending;de.gzindex<(65535&de.gzhead.extra.length)&&(de.pending!==de.pending_buf_size||(de.gzhead.hcrc&&de.pending>oe&&(O.adler=L(O.adler,de.pending_buf,de.pending-oe,oe)),fe(O),oe=de.pending,de.pending!==de.pending_buf_size));)gt(de,255&de.gzhead.extra[de.gzindex]),de.gzindex++;de.gzhead.hcrc&&de.pending>oe&&(O.adler=L(O.adler,de.pending_buf,de.pending-oe,oe)),de.gzindex===de.gzhead.extra.length&&(de.gzindex=0,de.status=73)}else de.status=73;if(de.status===73)if(de.gzhead.name){oe=de.pending;do{if(de.pending===de.pending_buf_size&&(de.gzhead.hcrc&&de.pending>oe&&(O.adler=L(O.adler,de.pending_buf,de.pending-oe,oe)),fe(O),oe=de.pending,de.pending===de.pending_buf_size)){Ee=1;break}Ee=de.gzindex<de.gzhead.name.length?255&de.gzhead.name.charCodeAt(de.gzindex++):0,gt(de,Ee)}while(Ee!==0);de.gzhead.hcrc&&de.pending>oe&&(O.adler=L(O.adler,de.pending_buf,de.pending-oe,oe)),Ee===0&&(de.gzindex=0,de.status=91)}else de.status=91;if(de.status===91)if(de.gzhead.comment){oe=de.pending;do{if(de.pending===de.pending_buf_size&&(de.gzhead.hcrc&&de.pending>oe&&(O.adler=L(O.adler,de.pending_buf,de.pending-oe,oe)),fe(O),oe=de.pending,de.pending===de.pending_buf_size)){Ee=1;break}Ee=de.gzindex<de.gzhead.comment.length?255&de.gzhead.comment.charCodeAt(de.gzindex++):0,gt(de,Ee)}while(Ee!==0);de.gzhead.hcrc&&de.pending>oe&&(O.adler=L(O.adler,de.pending_buf,de.pending-oe,oe)),Ee===0&&(de.status=103)}else de.status=103;if(de.status===103&&(de.gzhead.hcrc?(de.pending+2>de.pending_buf_size&&fe(O),de.pending+2<=de.pending_buf_size&&(gt(de,255&O.adler),gt(de,O.adler>>8&255),O.adler=0,de.status=$e)):de.status=$e),de.pending!==0){if(fe(O),O.avail_out===0)return de.last_flush=-1,Z}else if(O.avail_in===0&&Fe(it)<=Fe(He)&&it!==B)return st(O,-5);if(de.status===666&&O.avail_in!==0)return st(O,-5);if(O.avail_in!==0||de.lookahead!==0||it!==$&&de.status!==666){var ft=de.strategy===2?function(Ne,_t){for(var We;;){if(Ne.lookahead===0&&(bt(Ne),Ne.lookahead===0)){if(_t===$)return j;break}if(Ne.match_length=0,We=l._tr_tally(Ne,0,Ne.window[Ne.strstart]),Ne.lookahead--,Ne.strstart++,We&&(Se(Ne,!1),Ne.strm.avail_out===0))return j}return Ne.insert=0,_t===B?(Se(Ne,!0),Ne.strm.avail_out===0?ht:Ke):Ne.last_lit&&(Se(Ne,!1),Ne.strm.avail_out===0)?j:qe}(de,it):de.strategy===3?function(Ne,_t){for(var We,Qe,kt,Me,Je=Ne.window;;){if(Ne.lookahead<=lt){if(bt(Ne),Ne.lookahead<=lt&&_t===$)return j;if(Ne.lookahead===0)break}if(Ne.match_length=0,Ne.lookahead>=je&&0<Ne.strstart&&(Qe=Je[kt=Ne.strstart-1])===Je[++kt]&&Qe===Je[++kt]&&Qe===Je[++kt]){Me=Ne.strstart+lt;do;while(Qe===Je[++kt]&&Qe===Je[++kt]&&Qe===Je[++kt]&&Qe===Je[++kt]&&Qe===Je[++kt]&&Qe===Je[++kt]&&Qe===Je[++kt]&&Qe===Je[++kt]&&kt<Me);Ne.match_length=lt-(Me-kt),Ne.match_length>Ne.lookahead&&(Ne.match_length=Ne.lookahead)}if(Ne.match_length>=je?(We=l._tr_tally(Ne,1,Ne.match_length-je),Ne.lookahead-=Ne.match_length,Ne.strstart+=Ne.match_length,Ne.match_length=0):(We=l._tr_tally(Ne,0,Ne.window[Ne.strstart]),Ne.lookahead--,Ne.strstart++),We&&(Se(Ne,!1),Ne.strm.avail_out===0))return j}return Ne.insert=0,_t===B?(Se(Ne,!0),Ne.strm.avail_out===0?ht:Ke):Ne.last_lit&&(Se(Ne,!1),Ne.strm.avail_out===0)?j:qe}(de,it):T[de.level].func(de,it);if(ft!==ht&&ft!==Ke||(de.status=666),ft===j||ft===ht)return O.avail_out===0&&(de.last_flush=-1),Z;if(ft===qe&&(it===1?l._tr_align(de):it!==5&&(l._tr_stored_block(de,0,0,!1),it===3&&(ae(de.head),de.lookahead===0&&(de.strstart=0,de.block_start=0,de.insert=0))),fe(O),O.avail_out===0))return de.last_flush=-1,Z}return it!==B?Z:de.wrap<=0?1:(de.wrap===2?(gt(de,255&O.adler),gt(de,O.adler>>8&255),gt(de,O.adler>>16&255),gt(de,O.adler>>24&255),gt(de,255&O.total_in),gt(de,O.total_in>>8&255),gt(de,O.total_in>>16&255),gt(de,O.total_in>>24&255)):(ct(de,O.adler>>>16),ct(de,65535&O.adler)),fe(O),0<de.wrap&&(de.wrap=-de.wrap),de.pending!==0?Z:1)},C.deflateEnd=function(O){var it;return O&&O.state?(it=O.state.status)!==me&&it!==69&&it!==73&&it!==91&&it!==103&&it!==$e&&it!==666?st(O,Q):(O.state=null,it===$e?st(O,-3):Z):Q},C.deflateSetDictionary=function(O,it){var He,de,oe,Ee,ot,ft,Ne,_t,We=it.length;if(!O||!O.state||(Ee=(He=O.state).wrap)===2||Ee===1&&He.status!==me||He.lookahead)return Q;for(Ee===1&&(O.adler=R(O.adler,it,We,0)),He.wrap=0,We>=He.w_size&&(Ee===0&&(ae(He.head),He.strstart=0,He.block_start=0,He.insert=0),_t=new P.Buf8(He.w_size),P.arraySet(_t,it,We-He.w_size,He.w_size,0),it=_t,We=He.w_size),ot=O.avail_in,ft=O.next_in,Ne=O.input,O.avail_in=We,O.next_in=0,O.input=it,bt(He);He.lookahead>=je;){for(de=He.strstart,oe=He.lookahead-(je-1);He.ins_h=(He.ins_h<<He.hash_shift^He.window[de+je-1])&He.hash_mask,He.prev[de&He.w_mask]=He.head[He.ins_h],He.head[He.ins_h]=de,de++,--oe;);He.strstart=de,He.lookahead=je-1,bt(He)}return He.strstart+=He.lookahead,He.block_start=He.strstart,He.insert=He.lookahead,He.lookahead=0,He.match_length=He.prev_length=je-1,He.match_available=0,O.next_in=ft,O.input=Ne,O.avail_in=ot,He.wrap=Ee,Z},C.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(x,I,C){I.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(x,I,C){I.exports=function(T,P){var l,R,L,G,$,B,Z,Q,V,K,Y,ne,ce,be,_e,Ue,De,Ze,je,lt,vt,me,$e,j,qe;l=T.state,R=T.next_in,j=T.input,L=R+(T.avail_in-5),G=T.next_out,qe=T.output,$=G-(P-T.avail_out),B=G+(T.avail_out-257),Z=l.dmax,Q=l.wsize,V=l.whave,K=l.wnext,Y=l.window,ne=l.hold,ce=l.bits,be=l.lencode,_e=l.distcode,Ue=(1<<l.lenbits)-1,De=(1<<l.distbits)-1;e:do{ce<15&&(ne+=j[R++]<<ce,ce+=8,ne+=j[R++]<<ce,ce+=8),Ze=be[ne&Ue];t:for(;;){if(ne>>>=je=Ze>>>24,ce-=je,(je=Ze>>>16&255)===0)qe[G++]=65535&Ze;else{if(!(16&je)){if((64&je)==0){Ze=be[(65535&Ze)+(ne&(1<<je)-1)];continue t}if(32&je){l.mode=12;break e}T.msg="invalid literal/length code",l.mode=30;break e}lt=65535&Ze,(je&=15)&&(ce<je&&(ne+=j[R++]<<ce,ce+=8),lt+=ne&(1<<je)-1,ne>>>=je,ce-=je),ce<15&&(ne+=j[R++]<<ce,ce+=8,ne+=j[R++]<<ce,ce+=8),Ze=_e[ne&De];r:for(;;){if(ne>>>=je=Ze>>>24,ce-=je,!(16&(je=Ze>>>16&255))){if((64&je)==0){Ze=_e[(65535&Ze)+(ne&(1<<je)-1)];continue r}T.msg="invalid distance code",l.mode=30;break e}if(vt=65535&Ze,ce<(je&=15)&&(ne+=j[R++]<<ce,(ce+=8)<je&&(ne+=j[R++]<<ce,ce+=8)),Z<(vt+=ne&(1<<je)-1)){T.msg="invalid distance too far back",l.mode=30;break e}if(ne>>>=je,ce-=je,(je=G-$)<vt){if(V<(je=vt-je)&&l.sane){T.msg="invalid distance too far back",l.mode=30;break e}if($e=Y,(me=0)===K){if(me+=Q-je,je<lt){for(lt-=je;qe[G++]=Y[me++],--je;);me=G-vt,$e=qe}}else if(K<je){if(me+=Q+K-je,(je-=K)<lt){for(lt-=je;qe[G++]=Y[me++],--je;);if(me=0,K<lt){for(lt-=je=K;qe[G++]=Y[me++],--je;);me=G-vt,$e=qe}}}else if(me+=K-je,je<lt){for(lt-=je;qe[G++]=Y[me++],--je;);me=G-vt,$e=qe}for(;2<lt;)qe[G++]=$e[me++],qe[G++]=$e[me++],qe[G++]=$e[me++],lt-=3;lt&&(qe[G++]=$e[me++],1<lt&&(qe[G++]=$e[me++]))}else{for(me=G-vt;qe[G++]=qe[me++],qe[G++]=qe[me++],qe[G++]=qe[me++],2<(lt-=3););lt&&(qe[G++]=qe[me++],1<lt&&(qe[G++]=qe[me++]))}break}}break}}while(R<L&&G<B);R-=lt=ce>>3,ne&=(1<<(ce-=lt<<3))-1,T.next_in=R,T.next_out=G,T.avail_in=R<L?L-R+5:5-(R-L),T.avail_out=G<B?B-G+257:257-(G-B),l.hold=ne,l.bits=ce}},{}],49:[function(x,I,C){var T=x("../utils/common"),P=x("./adler32"),l=x("./crc32"),R=x("./inffast"),L=x("./inftrees"),G=1,$=2,B=0,Z=-2,Q=1,V=852,K=592;function Y(me){return(me>>>24&255)+(me>>>8&65280)+((65280&me)<<8)+((255&me)<<24)}function ne(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new T.Buf16(320),this.work=new T.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function ce(me){var $e;return me&&me.state?($e=me.state,me.total_in=me.total_out=$e.total=0,me.msg="",$e.wrap&&(me.adler=1&$e.wrap),$e.mode=Q,$e.last=0,$e.havedict=0,$e.dmax=32768,$e.head=null,$e.hold=0,$e.bits=0,$e.lencode=$e.lendyn=new T.Buf32(V),$e.distcode=$e.distdyn=new T.Buf32(K),$e.sane=1,$e.back=-1,B):Z}function be(me){var $e;return me&&me.state?(($e=me.state).wsize=0,$e.whave=0,$e.wnext=0,ce(me)):Z}function _e(me,$e){var j,qe;return me&&me.state?(qe=me.state,$e<0?(j=0,$e=-$e):(j=1+($e>>4),$e<48&&($e&=15)),$e&&($e<8||15<$e)?Z:(qe.window!==null&&qe.wbits!==$e&&(qe.window=null),qe.wrap=j,qe.wbits=$e,be(me))):Z}function Ue(me,$e){var j,qe;return me?(qe=new ne,(me.state=qe).window=null,(j=_e(me,$e))!==B&&(me.state=null),j):Z}var De,Ze,je=!0;function lt(me){if(je){var $e;for(De=new T.Buf32(512),Ze=new T.Buf32(32),$e=0;$e<144;)me.lens[$e++]=8;for(;$e<256;)me.lens[$e++]=9;for(;$e<280;)me.lens[$e++]=7;for(;$e<288;)me.lens[$e++]=8;for(L(G,me.lens,0,288,De,0,me.work,{bits:9}),$e=0;$e<32;)me.lens[$e++]=5;L($,me.lens,0,32,Ze,0,me.work,{bits:5}),je=!1}me.lencode=De,me.lenbits=9,me.distcode=Ze,me.distbits=5}function vt(me,$e,j,qe){var ht,Ke=me.state;return Ke.window===null&&(Ke.wsize=1<<Ke.wbits,Ke.wnext=0,Ke.whave=0,Ke.window=new T.Buf8(Ke.wsize)),qe>=Ke.wsize?(T.arraySet(Ke.window,$e,j-Ke.wsize,Ke.wsize,0),Ke.wnext=0,Ke.whave=Ke.wsize):(qe<(ht=Ke.wsize-Ke.wnext)&&(ht=qe),T.arraySet(Ke.window,$e,j-qe,ht,Ke.wnext),(qe-=ht)?(T.arraySet(Ke.window,$e,j-qe,qe,0),Ke.wnext=qe,Ke.whave=Ke.wsize):(Ke.wnext+=ht,Ke.wnext===Ke.wsize&&(Ke.wnext=0),Ke.whave<Ke.wsize&&(Ke.whave+=ht))),0}C.inflateReset=be,C.inflateReset2=_e,C.inflateResetKeep=ce,C.inflateInit=function(me){return Ue(me,15)},C.inflateInit2=Ue,C.inflate=function(me,$e){var j,qe,ht,Ke,st,Fe,ae,fe,Se,gt,ct,dt,bt,Vt,At,Rt,$t,or,sr,pr,O,it,He,de,oe=0,Ee=new T.Buf8(4),ot=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!me||!me.state||!me.output||!me.input&&me.avail_in!==0)return Z;(j=me.state).mode===12&&(j.mode=13),st=me.next_out,ht=me.output,ae=me.avail_out,Ke=me.next_in,qe=me.input,Fe=me.avail_in,fe=j.hold,Se=j.bits,gt=Fe,ct=ae,it=B;e:for(;;)switch(j.mode){case Q:if(j.wrap===0){j.mode=13;break}for(;Se<16;){if(Fe===0)break e;Fe--,fe+=qe[Ke++]<<Se,Se+=8}if(2&j.wrap&&fe===35615){Ee[j.check=0]=255&fe,Ee[1]=fe>>>8&255,j.check=l(j.check,Ee,2,0),Se=fe=0,j.mode=2;break}if(j.flags=0,j.head&&(j.head.done=!1),!(1&j.wrap)||(((255&fe)<<8)+(fe>>8))%31){me.msg="incorrect header check",j.mode=30;break}if((15&fe)!=8){me.msg="unknown compression method",j.mode=30;break}if(Se-=4,O=8+(15&(fe>>>=4)),j.wbits===0)j.wbits=O;else if(O>j.wbits){me.msg="invalid window size",j.mode=30;break}j.dmax=1<<O,me.adler=j.check=1,j.mode=512&fe?10:12,Se=fe=0;break;case 2:for(;Se<16;){if(Fe===0)break e;Fe--,fe+=qe[Ke++]<<Se,Se+=8}if(j.flags=fe,(255&j.flags)!=8){me.msg="unknown compression method",j.mode=30;break}if(57344&j.flags){me.msg="unknown header flags set",j.mode=30;break}j.head&&(j.head.text=fe>>8&1),512&j.flags&&(Ee[0]=255&fe,Ee[1]=fe>>>8&255,j.check=l(j.check,Ee,2,0)),Se=fe=0,j.mode=3;case 3:for(;Se<32;){if(Fe===0)break e;Fe--,fe+=qe[Ke++]<<Se,Se+=8}j.head&&(j.head.time=fe),512&j.flags&&(Ee[0]=255&fe,Ee[1]=fe>>>8&255,Ee[2]=fe>>>16&255,Ee[3]=fe>>>24&255,j.check=l(j.check,Ee,4,0)),Se=fe=0,j.mode=4;case 4:for(;Se<16;){if(Fe===0)break e;Fe--,fe+=qe[Ke++]<<Se,Se+=8}j.head&&(j.head.xflags=255&fe,j.head.os=fe>>8),512&j.flags&&(Ee[0]=255&fe,Ee[1]=fe>>>8&255,j.check=l(j.check,Ee,2,0)),Se=fe=0,j.mode=5;case 5:if(1024&j.flags){for(;Se<16;){if(Fe===0)break e;Fe--,fe+=qe[Ke++]<<Se,Se+=8}j.length=fe,j.head&&(j.head.extra_len=fe),512&j.flags&&(Ee[0]=255&fe,Ee[1]=fe>>>8&255,j.check=l(j.check,Ee,2,0)),Se=fe=0}else j.head&&(j.head.extra=null);j.mode=6;case 6:if(1024&j.flags&&(Fe<(dt=j.length)&&(dt=Fe),dt&&(j.head&&(O=j.head.extra_len-j.length,j.head.extra||(j.head.extra=new Array(j.head.extra_len)),T.arraySet(j.head.extra,qe,Ke,dt,O)),512&j.flags&&(j.check=l(j.check,qe,dt,Ke)),Fe-=dt,Ke+=dt,j.length-=dt),j.length))break e;j.length=0,j.mode=7;case 7:if(2048&j.flags){if(Fe===0)break e;for(dt=0;O=qe[Ke+dt++],j.head&&O&&j.length<65536&&(j.head.name+=String.fromCharCode(O)),O&&dt<Fe;);if(512&j.flags&&(j.check=l(j.check,qe,dt,Ke)),Fe-=dt,Ke+=dt,O)break e}else j.head&&(j.head.name=null);j.length=0,j.mode=8;case 8:if(4096&j.flags){if(Fe===0)break e;for(dt=0;O=qe[Ke+dt++],j.head&&O&&j.length<65536&&(j.head.comment+=String.fromCharCode(O)),O&&dt<Fe;);if(512&j.flags&&(j.check=l(j.check,qe,dt,Ke)),Fe-=dt,Ke+=dt,O)break e}else j.head&&(j.head.comment=null);j.mode=9;case 9:if(512&j.flags){for(;Se<16;){if(Fe===0)break e;Fe--,fe+=qe[Ke++]<<Se,Se+=8}if(fe!==(65535&j.check)){me.msg="header crc mismatch",j.mode=30;break}Se=fe=0}j.head&&(j.head.hcrc=j.flags>>9&1,j.head.done=!0),me.adler=j.check=0,j.mode=12;break;case 10:for(;Se<32;){if(Fe===0)break e;Fe--,fe+=qe[Ke++]<<Se,Se+=8}me.adler=j.check=Y(fe),Se=fe=0,j.mode=11;case 11:if(j.havedict===0)return me.next_out=st,me.avail_out=ae,me.next_in=Ke,me.avail_in=Fe,j.hold=fe,j.bits=Se,2;me.adler=j.check=1,j.mode=12;case 12:if($e===5||$e===6)break e;case 13:if(j.last){fe>>>=7&Se,Se-=7&Se,j.mode=27;break}for(;Se<3;){if(Fe===0)break e;Fe--,fe+=qe[Ke++]<<Se,Se+=8}switch(j.last=1&fe,Se-=1,3&(fe>>>=1)){case 0:j.mode=14;break;case 1:if(lt(j),j.mode=20,$e!==6)break;fe>>>=2,Se-=2;break e;case 2:j.mode=17;break;case 3:me.msg="invalid block type",j.mode=30}fe>>>=2,Se-=2;break;case 14:for(fe>>>=7&Se,Se-=7&Se;Se<32;){if(Fe===0)break e;Fe--,fe+=qe[Ke++]<<Se,Se+=8}if((65535&fe)!=(fe>>>16^65535)){me.msg="invalid stored block lengths",j.mode=30;break}if(j.length=65535&fe,Se=fe=0,j.mode=15,$e===6)break e;case 15:j.mode=16;case 16:if(dt=j.length){if(Fe<dt&&(dt=Fe),ae<dt&&(dt=ae),dt===0)break e;T.arraySet(ht,qe,Ke,dt,st),Fe-=dt,Ke+=dt,ae-=dt,st+=dt,j.length-=dt;break}j.mode=12;break;case 17:for(;Se<14;){if(Fe===0)break e;Fe--,fe+=qe[Ke++]<<Se,Se+=8}if(j.nlen=257+(31&fe),fe>>>=5,Se-=5,j.ndist=1+(31&fe),fe>>>=5,Se-=5,j.ncode=4+(15&fe),fe>>>=4,Se-=4,286<j.nlen||30<j.ndist){me.msg="too many length or distance symbols",j.mode=30;break}j.have=0,j.mode=18;case 18:for(;j.have<j.ncode;){for(;Se<3;){if(Fe===0)break e;Fe--,fe+=qe[Ke++]<<Se,Se+=8}j.lens[ot[j.have++]]=7&fe,fe>>>=3,Se-=3}for(;j.have<19;)j.lens[ot[j.have++]]=0;if(j.lencode=j.lendyn,j.lenbits=7,He={bits:j.lenbits},it=L(0,j.lens,0,19,j.lencode,0,j.work,He),j.lenbits=He.bits,it){me.msg="invalid code lengths set",j.mode=30;break}j.have=0,j.mode=19;case 19:for(;j.have<j.nlen+j.ndist;){for(;Rt=(oe=j.lencode[fe&(1<<j.lenbits)-1])>>>16&255,$t=65535&oe,!((At=oe>>>24)<=Se);){if(Fe===0)break e;Fe--,fe+=qe[Ke++]<<Se,Se+=8}if($t<16)fe>>>=At,Se-=At,j.lens[j.have++]=$t;else{if($t===16){for(de=At+2;Se<de;){if(Fe===0)break e;Fe--,fe+=qe[Ke++]<<Se,Se+=8}if(fe>>>=At,Se-=At,j.have===0){me.msg="invalid bit length repeat",j.mode=30;break}O=j.lens[j.have-1],dt=3+(3&fe),fe>>>=2,Se-=2}else if($t===17){for(de=At+3;Se<de;){if(Fe===0)break e;Fe--,fe+=qe[Ke++]<<Se,Se+=8}Se-=At,O=0,dt=3+(7&(fe>>>=At)),fe>>>=3,Se-=3}else{for(de=At+7;Se<de;){if(Fe===0)break e;Fe--,fe+=qe[Ke++]<<Se,Se+=8}Se-=At,O=0,dt=11+(127&(fe>>>=At)),fe>>>=7,Se-=7}if(j.have+dt>j.nlen+j.ndist){me.msg="invalid bit length repeat",j.mode=30;break}for(;dt--;)j.lens[j.have++]=O}}if(j.mode===30)break;if(j.lens[256]===0){me.msg="invalid code -- missing end-of-block",j.mode=30;break}if(j.lenbits=9,He={bits:j.lenbits},it=L(G,j.lens,0,j.nlen,j.lencode,0,j.work,He),j.lenbits=He.bits,it){me.msg="invalid literal/lengths set",j.mode=30;break}if(j.distbits=6,j.distcode=j.distdyn,He={bits:j.distbits},it=L($,j.lens,j.nlen,j.ndist,j.distcode,0,j.work,He),j.distbits=He.bits,it){me.msg="invalid distances set",j.mode=30;break}if(j.mode=20,$e===6)break e;case 20:j.mode=21;case 21:if(6<=Fe&&258<=ae){me.next_out=st,me.avail_out=ae,me.next_in=Ke,me.avail_in=Fe,j.hold=fe,j.bits=Se,R(me,ct),st=me.next_out,ht=me.output,ae=me.avail_out,Ke=me.next_in,qe=me.input,Fe=me.avail_in,fe=j.hold,Se=j.bits,j.mode===12&&(j.back=-1);break}for(j.back=0;Rt=(oe=j.lencode[fe&(1<<j.lenbits)-1])>>>16&255,$t=65535&oe,!((At=oe>>>24)<=Se);){if(Fe===0)break e;Fe--,fe+=qe[Ke++]<<Se,Se+=8}if(Rt&&(240&Rt)==0){for(or=At,sr=Rt,pr=$t;Rt=(oe=j.lencode[pr+((fe&(1<<or+sr)-1)>>or)])>>>16&255,$t=65535&oe,!(or+(At=oe>>>24)<=Se);){if(Fe===0)break e;Fe--,fe+=qe[Ke++]<<Se,Se+=8}fe>>>=or,Se-=or,j.back+=or}if(fe>>>=At,Se-=At,j.back+=At,j.length=$t,Rt===0){j.mode=26;break}if(32&Rt){j.back=-1,j.mode=12;break}if(64&Rt){me.msg="invalid literal/length code",j.mode=30;break}j.extra=15&Rt,j.mode=22;case 22:if(j.extra){for(de=j.extra;Se<de;){if(Fe===0)break e;Fe--,fe+=qe[Ke++]<<Se,Se+=8}j.length+=fe&(1<<j.extra)-1,fe>>>=j.extra,Se-=j.extra,j.back+=j.extra}j.was=j.length,j.mode=23;case 23:for(;Rt=(oe=j.distcode[fe&(1<<j.distbits)-1])>>>16&255,$t=65535&oe,!((At=oe>>>24)<=Se);){if(Fe===0)break e;Fe--,fe+=qe[Ke++]<<Se,Se+=8}if((240&Rt)==0){for(or=At,sr=Rt,pr=$t;Rt=(oe=j.distcode[pr+((fe&(1<<or+sr)-1)>>or)])>>>16&255,$t=65535&oe,!(or+(At=oe>>>24)<=Se);){if(Fe===0)break e;Fe--,fe+=qe[Ke++]<<Se,Se+=8}fe>>>=or,Se-=or,j.back+=or}if(fe>>>=At,Se-=At,j.back+=At,64&Rt){me.msg="invalid distance code",j.mode=30;break}j.offset=$t,j.extra=15&Rt,j.mode=24;case 24:if(j.extra){for(de=j.extra;Se<de;){if(Fe===0)break e;Fe--,fe+=qe[Ke++]<<Se,Se+=8}j.offset+=fe&(1<<j.extra)-1,fe>>>=j.extra,Se-=j.extra,j.back+=j.extra}if(j.offset>j.dmax){me.msg="invalid distance too far back",j.mode=30;break}j.mode=25;case 25:if(ae===0)break e;if(dt=ct-ae,j.offset>dt){if((dt=j.offset-dt)>j.whave&&j.sane){me.msg="invalid distance too far back",j.mode=30;break}bt=dt>j.wnext?(dt-=j.wnext,j.wsize-dt):j.wnext-dt,dt>j.length&&(dt=j.length),Vt=j.window}else Vt=ht,bt=st-j.offset,dt=j.length;for(ae<dt&&(dt=ae),ae-=dt,j.length-=dt;ht[st++]=Vt[bt++],--dt;);j.length===0&&(j.mode=21);break;case 26:if(ae===0)break e;ht[st++]=j.length,ae--,j.mode=21;break;case 27:if(j.wrap){for(;Se<32;){if(Fe===0)break e;Fe--,fe|=qe[Ke++]<<Se,Se+=8}if(ct-=ae,me.total_out+=ct,j.total+=ct,ct&&(me.adler=j.check=j.flags?l(j.check,ht,ct,st-ct):P(j.check,ht,ct,st-ct)),ct=ae,(j.flags?fe:Y(fe))!==j.check){me.msg="incorrect data check",j.mode=30;break}Se=fe=0}j.mode=28;case 28:if(j.wrap&&j.flags){for(;Se<32;){if(Fe===0)break e;Fe--,fe+=qe[Ke++]<<Se,Se+=8}if(fe!==(4294967295&j.total)){me.msg="incorrect length check",j.mode=30;break}Se=fe=0}j.mode=29;case 29:it=1;break e;case 30:it=-3;break e;case 31:return-4;case 32:default:return Z}return me.next_out=st,me.avail_out=ae,me.next_in=Ke,me.avail_in=Fe,j.hold=fe,j.bits=Se,(j.wsize||ct!==me.avail_out&&j.mode<30&&(j.mode<27||$e!==4))&&vt(me,me.output,me.next_out,ct-me.avail_out)?(j.mode=31,-4):(gt-=me.avail_in,ct-=me.avail_out,me.total_in+=gt,me.total_out+=ct,j.total+=ct,j.wrap&&ct&&(me.adler=j.check=j.flags?l(j.check,ht,ct,me.next_out-ct):P(j.check,ht,ct,me.next_out-ct)),me.data_type=j.bits+(j.last?64:0)+(j.mode===12?128:0)+(j.mode===20||j.mode===15?256:0),(gt==0&&ct===0||$e===4)&&it===B&&(it=-5),it)},C.inflateEnd=function(me){if(!me||!me.state)return Z;var $e=me.state;return $e.window&&($e.window=null),me.state=null,B},C.inflateGetHeader=function(me,$e){var j;return me&&me.state?(2&(j=me.state).wrap)==0?Z:((j.head=$e).done=!1,B):Z},C.inflateSetDictionary=function(me,$e){var j,qe=$e.length;return me&&me.state?(j=me.state).wrap!==0&&j.mode!==11?Z:j.mode===11&&P(1,$e,qe,0)!==j.check?-3:vt(me,$e,qe,qe)?(j.mode=31,-4):(j.havedict=1,B):Z},C.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(x,I,C){var T=x("../utils/common"),P=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],l=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],R=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],L=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];I.exports=function(G,$,B,Z,Q,V,K,Y){var ne,ce,be,_e,Ue,De,Ze,je,lt,vt=Y.bits,me=0,$e=0,j=0,qe=0,ht=0,Ke=0,st=0,Fe=0,ae=0,fe=0,Se=null,gt=0,ct=new T.Buf16(16),dt=new T.Buf16(16),bt=null,Vt=0;for(me=0;me<=15;me++)ct[me]=0;for($e=0;$e<Z;$e++)ct[$[B+$e]]++;for(ht=vt,qe=15;1<=qe&&ct[qe]===0;qe--);if(qe<ht&&(ht=qe),qe===0)return Q[V++]=20971520,Q[V++]=20971520,Y.bits=1,0;for(j=1;j<qe&&ct[j]===0;j++);for(ht<j&&(ht=j),me=Fe=1;me<=15;me++)if(Fe<<=1,(Fe-=ct[me])<0)return-1;if(0<Fe&&(G===0||qe!==1))return-1;for(dt[1]=0,me=1;me<15;me++)dt[me+1]=dt[me]+ct[me];for($e=0;$e<Z;$e++)$[B+$e]!==0&&(K[dt[$[B+$e]]++]=$e);if(De=G===0?(Se=bt=K,19):G===1?(Se=P,gt-=257,bt=l,Vt-=257,256):(Se=R,bt=L,-1),me=j,Ue=V,st=$e=fe=0,be=-1,_e=(ae=1<<(Ke=ht))-1,G===1&&852<ae||G===2&&592<ae)return 1;for(;;){for(Ze=me-st,lt=K[$e]<De?(je=0,K[$e]):K[$e]>De?(je=bt[Vt+K[$e]],Se[gt+K[$e]]):(je=96,0),ne=1<<me-st,j=ce=1<<Ke;Q[Ue+(fe>>st)+(ce-=ne)]=Ze<<24|je<<16|lt|0,ce!==0;);for(ne=1<<me-1;fe&ne;)ne>>=1;if(ne!==0?(fe&=ne-1,fe+=ne):fe=0,$e++,--ct[me]==0){if(me===qe)break;me=$[B+K[$e]]}if(ht<me&&(fe&_e)!==be){for(st===0&&(st=ht),Ue+=j,Fe=1<<(Ke=me-st);Ke+st<qe&&!((Fe-=ct[Ke+st])<=0);)Ke++,Fe<<=1;if(ae+=1<<Ke,G===1&&852<ae||G===2&&592<ae)return 1;Q[be=fe&_e]=ht<<24|Ke<<16|Ue-V|0}}return fe!==0&&(Q[Ue+fe]=me-st<<24|64<<16|0),Y.bits=ht,0}},{"../utils/common":41}],51:[function(x,I,C){I.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(x,I,C){var T=x("../utils/common"),P=0,l=1;function R(oe){for(var Ee=oe.length;0<=--Ee;)oe[Ee]=0}var L=0,G=29,$=256,B=$+1+G,Z=30,Q=19,V=2*B+1,K=15,Y=16,ne=7,ce=256,be=16,_e=17,Ue=18,De=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],Ze=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],je=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],lt=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],vt=new Array(2*(B+2));R(vt);var me=new Array(2*Z);R(me);var $e=new Array(512);R($e);var j=new Array(256);R(j);var qe=new Array(G);R(qe);var ht,Ke,st,Fe=new Array(Z);function ae(oe,Ee,ot,ft,Ne){this.static_tree=oe,this.extra_bits=Ee,this.extra_base=ot,this.elems=ft,this.max_length=Ne,this.has_stree=oe&&oe.length}function fe(oe,Ee){this.dyn_tree=oe,this.max_code=0,this.stat_desc=Ee}function Se(oe){return oe<256?$e[oe]:$e[256+(oe>>>7)]}function gt(oe,Ee){oe.pending_buf[oe.pending++]=255&Ee,oe.pending_buf[oe.pending++]=Ee>>>8&255}function ct(oe,Ee,ot){oe.bi_valid>Y-ot?(oe.bi_buf|=Ee<<oe.bi_valid&65535,gt(oe,oe.bi_buf),oe.bi_buf=Ee>>Y-oe.bi_valid,oe.bi_valid+=ot-Y):(oe.bi_buf|=Ee<<oe.bi_valid&65535,oe.bi_valid+=ot)}function dt(oe,Ee,ot){ct(oe,ot[2*Ee],ot[2*Ee+1])}function bt(oe,Ee){for(var ot=0;ot|=1&oe,oe>>>=1,ot<<=1,0<--Ee;);return ot>>>1}function Vt(oe,Ee,ot){var ft,Ne,_t=new Array(K+1),We=0;for(ft=1;ft<=K;ft++)_t[ft]=We=We+ot[ft-1]<<1;for(Ne=0;Ne<=Ee;Ne++){var Qe=oe[2*Ne+1];Qe!==0&&(oe[2*Ne]=bt(_t[Qe]++,Qe))}}function At(oe){var Ee;for(Ee=0;Ee<B;Ee++)oe.dyn_ltree[2*Ee]=0;for(Ee=0;Ee<Z;Ee++)oe.dyn_dtree[2*Ee]=0;for(Ee=0;Ee<Q;Ee++)oe.bl_tree[2*Ee]=0;oe.dyn_ltree[2*ce]=1,oe.opt_len=oe.static_len=0,oe.last_lit=oe.matches=0}function Rt(oe){8<oe.bi_valid?gt(oe,oe.bi_buf):0<oe.bi_valid&&(oe.pending_buf[oe.pending++]=oe.bi_buf),oe.bi_buf=0,oe.bi_valid=0}function $t(oe,Ee,ot,ft){var Ne=2*Ee,_t=2*ot;return oe[Ne]<oe[_t]||oe[Ne]===oe[_t]&&ft[Ee]<=ft[ot]}function or(oe,Ee,ot){for(var ft=oe.heap[ot],Ne=ot<<1;Ne<=oe.heap_len&&(Ne<oe.heap_len&&$t(Ee,oe.heap[Ne+1],oe.heap[Ne],oe.depth)&&Ne++,!$t(Ee,ft,oe.heap[Ne],oe.depth));)oe.heap[ot]=oe.heap[Ne],ot=Ne,Ne<<=1;oe.heap[ot]=ft}function sr(oe,Ee,ot){var ft,Ne,_t,We,Qe=0;if(oe.last_lit!==0)for(;ft=oe.pending_buf[oe.d_buf+2*Qe]<<8|oe.pending_buf[oe.d_buf+2*Qe+1],Ne=oe.pending_buf[oe.l_buf+Qe],Qe++,ft===0?dt(oe,Ne,Ee):(dt(oe,(_t=j[Ne])+$+1,Ee),(We=De[_t])!==0&&ct(oe,Ne-=qe[_t],We),dt(oe,_t=Se(--ft),ot),(We=Ze[_t])!==0&&ct(oe,ft-=Fe[_t],We)),Qe<oe.last_lit;);dt(oe,ce,Ee)}function pr(oe,Ee){var ot,ft,Ne,_t=Ee.dyn_tree,We=Ee.stat_desc.static_tree,Qe=Ee.stat_desc.has_stree,kt=Ee.stat_desc.elems,Me=-1;for(oe.heap_len=0,oe.heap_max=V,ot=0;ot<kt;ot++)_t[2*ot]!==0?(oe.heap[++oe.heap_len]=Me=ot,oe.depth[ot]=0):_t[2*ot+1]=0;for(;oe.heap_len<2;)_t[2*(Ne=oe.heap[++oe.heap_len]=Me<2?++Me:0)]=1,oe.depth[Ne]=0,oe.opt_len--,Qe&&(oe.static_len-=We[2*Ne+1]);for(Ee.max_code=Me,ot=oe.heap_len>>1;1<=ot;ot--)or(oe,_t,ot);for(Ne=kt;ot=oe.heap[1],oe.heap[1]=oe.heap[oe.heap_len--],or(oe,_t,1),ft=oe.heap[1],oe.heap[--oe.heap_max]=ot,oe.heap[--oe.heap_max]=ft,_t[2*Ne]=_t[2*ot]+_t[2*ft],oe.depth[Ne]=(oe.depth[ot]>=oe.depth[ft]?oe.depth[ot]:oe.depth[ft])+1,_t[2*ot+1]=_t[2*ft+1]=Ne,oe.heap[1]=Ne++,or(oe,_t,1),2<=oe.heap_len;);oe.heap[--oe.heap_max]=oe.heap[1],function(Je,xr){var kr,Wt,vr,Qt,dn,Rr,yt=xr.dyn_tree,qt=xr.max_code,Zt=xr.stat_desc.static_tree,qr=xr.stat_desc.has_stree,fn=xr.stat_desc.extra_bits,Lt=xr.stat_desc.extra_base,gr=xr.stat_desc.max_length,Ar=0;for(Qt=0;Qt<=K;Qt++)Je.bl_count[Qt]=0;for(yt[2*Je.heap[Je.heap_max]+1]=0,kr=Je.heap_max+1;kr<V;kr++)gr<(Qt=yt[2*yt[2*(Wt=Je.heap[kr])+1]+1]+1)&&(Qt=gr,Ar++),yt[2*Wt+1]=Qt,qt<Wt||(Je.bl_count[Qt]++,dn=0,Lt<=Wt&&(dn=fn[Wt-Lt]),Rr=yt[2*Wt],Je.opt_len+=Rr*(Qt+dn),qr&&(Je.static_len+=Rr*(Zt[2*Wt+1]+dn)));if(Ar!==0){do{for(Qt=gr-1;Je.bl_count[Qt]===0;)Qt--;Je.bl_count[Qt]--,Je.bl_count[Qt+1]+=2,Je.bl_count[gr]--,Ar-=2}while(0<Ar);for(Qt=gr;Qt!==0;Qt--)for(Wt=Je.bl_count[Qt];Wt!==0;)qt<(vr=Je.heap[--kr])||(yt[2*vr+1]!==Qt&&(Je.opt_len+=(Qt-yt[2*vr+1])*yt[2*vr],yt[2*vr+1]=Qt),Wt--)}}(oe,Ee),Vt(_t,Me,oe.bl_count)}function O(oe,Ee,ot){var ft,Ne,_t=-1,We=Ee[1],Qe=0,kt=7,Me=4;for(We===0&&(kt=138,Me=3),Ee[2*(ot+1)+1]=65535,ft=0;ft<=ot;ft++)Ne=We,We=Ee[2*(ft+1)+1],++Qe<kt&&Ne===We||(Qe<Me?oe.bl_tree[2*Ne]+=Qe:Ne!==0?(Ne!==_t&&oe.bl_tree[2*Ne]++,oe.bl_tree[2*be]++):Qe<=10?oe.bl_tree[2*_e]++:oe.bl_tree[2*Ue]++,_t=Ne,Me=(Qe=0)===We?(kt=138,3):Ne===We?(kt=6,3):(kt=7,4))}function it(oe,Ee,ot){var ft,Ne,_t=-1,We=Ee[1],Qe=0,kt=7,Me=4;for(We===0&&(kt=138,Me=3),ft=0;ft<=ot;ft++)if(Ne=We,We=Ee[2*(ft+1)+1],!(++Qe<kt&&Ne===We)){if(Qe<Me)for(;dt(oe,Ne,oe.bl_tree),--Qe!=0;);else Ne!==0?(Ne!==_t&&(dt(oe,Ne,oe.bl_tree),Qe--),dt(oe,be,oe.bl_tree),ct(oe,Qe-3,2)):Qe<=10?(dt(oe,_e,oe.bl_tree),ct(oe,Qe-3,3)):(dt(oe,Ue,oe.bl_tree),ct(oe,Qe-11,7));_t=Ne,Me=(Qe=0)===We?(kt=138,3):Ne===We?(kt=6,3):(kt=7,4)}}R(Fe);var He=!1;function de(oe,Ee,ot,ft){ct(oe,(L<<1)+(ft?1:0),3),function(Ne,_t,We,Qe){Rt(Ne),gt(Ne,We),gt(Ne,~We),T.arraySet(Ne.pending_buf,Ne.window,_t,We,Ne.pending),Ne.pending+=We}(oe,Ee,ot)}C._tr_init=function(oe){He||(function(){var Ee,ot,ft,Ne,_t,We=new Array(K+1);for(Ne=ft=0;Ne<G-1;Ne++)for(qe[Ne]=ft,Ee=0;Ee<1<<De[Ne];Ee++)j[ft++]=Ne;for(j[ft-1]=Ne,Ne=_t=0;Ne<16;Ne++)for(Fe[Ne]=_t,Ee=0;Ee<1<<Ze[Ne];Ee++)$e[_t++]=Ne;for(_t>>=7;Ne<Z;Ne++)for(Fe[Ne]=_t<<7,Ee=0;Ee<1<<Ze[Ne]-7;Ee++)$e[256+_t++]=Ne;for(ot=0;ot<=K;ot++)We[ot]=0;for(Ee=0;Ee<=143;)vt[2*Ee+1]=8,Ee++,We[8]++;for(;Ee<=255;)vt[2*Ee+1]=9,Ee++,We[9]++;for(;Ee<=279;)vt[2*Ee+1]=7,Ee++,We[7]++;for(;Ee<=287;)vt[2*Ee+1]=8,Ee++,We[8]++;for(Vt(vt,B+1,We),Ee=0;Ee<Z;Ee++)me[2*Ee+1]=5,me[2*Ee]=bt(Ee,5);ht=new ae(vt,De,$+1,B,K),Ke=new ae(me,Ze,0,Z,K),st=new ae(new Array(0),je,0,Q,ne)}(),He=!0),oe.l_desc=new fe(oe.dyn_ltree,ht),oe.d_desc=new fe(oe.dyn_dtree,Ke),oe.bl_desc=new fe(oe.bl_tree,st),oe.bi_buf=0,oe.bi_valid=0,At(oe)},C._tr_stored_block=de,C._tr_flush_block=function(oe,Ee,ot,ft){var Ne,_t,We=0;0<oe.level?(oe.strm.data_type===2&&(oe.strm.data_type=function(Qe){var kt,Me=4093624447;for(kt=0;kt<=31;kt++,Me>>>=1)if(1&Me&&Qe.dyn_ltree[2*kt]!==0)return P;if(Qe.dyn_ltree[18]!==0||Qe.dyn_ltree[20]!==0||Qe.dyn_ltree[26]!==0)return l;for(kt=32;kt<$;kt++)if(Qe.dyn_ltree[2*kt]!==0)return l;return P}(oe)),pr(oe,oe.l_desc),pr(oe,oe.d_desc),We=function(Qe){var kt;for(O(Qe,Qe.dyn_ltree,Qe.l_desc.max_code),O(Qe,Qe.dyn_dtree,Qe.d_desc.max_code),pr(Qe,Qe.bl_desc),kt=Q-1;3<=kt&&Qe.bl_tree[2*lt[kt]+1]===0;kt--);return Qe.opt_len+=3*(kt+1)+5+5+4,kt}(oe),Ne=oe.opt_len+3+7>>>3,(_t=oe.static_len+3+7>>>3)<=Ne&&(Ne=_t)):Ne=_t=ot+5,ot+4<=Ne&&Ee!==-1?de(oe,Ee,ot,ft):oe.strategy===4||_t===Ne?(ct(oe,2+(ft?1:0),3),sr(oe,vt,me)):(ct(oe,4+(ft?1:0),3),function(Qe,kt,Me,Je){var xr;for(ct(Qe,kt-257,5),ct(Qe,Me-1,5),ct(Qe,Je-4,4),xr=0;xr<Je;xr++)ct(Qe,Qe.bl_tree[2*lt[xr]+1],3);it(Qe,Qe.dyn_ltree,kt-1),it(Qe,Qe.dyn_dtree,Me-1)}(oe,oe.l_desc.max_code+1,oe.d_desc.max_code+1,We+1),sr(oe,oe.dyn_ltree,oe.dyn_dtree)),At(oe),ft&&Rt(oe)},C._tr_tally=function(oe,Ee,ot){return oe.pending_buf[oe.d_buf+2*oe.last_lit]=Ee>>>8&255,oe.pending_buf[oe.d_buf+2*oe.last_lit+1]=255&Ee,oe.pending_buf[oe.l_buf+oe.last_lit]=255&ot,oe.last_lit++,Ee===0?oe.dyn_ltree[2*ot]++:(oe.matches++,Ee--,oe.dyn_ltree[2*(j[ot]+$+1)]++,oe.dyn_dtree[2*Se(Ee)]++),oe.last_lit===oe.lit_bufsize-1},C._tr_align=function(oe){ct(oe,2,3),dt(oe,ce,vt),function(Ee){Ee.bi_valid===16?(gt(Ee,Ee.bi_buf),Ee.bi_buf=0,Ee.bi_valid=0):8<=Ee.bi_valid&&(Ee.pending_buf[Ee.pending++]=255&Ee.bi_buf,Ee.bi_buf>>=8,Ee.bi_valid-=8)}(oe)}},{"../utils/common":41}],53:[function(x,I,C){I.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(x,I,C){(function(T){(function(P,l){if(!P.setImmediate){var R,L,G,$,B=1,Z={},Q=!1,V=P.document,K=Object.getPrototypeOf&&Object.getPrototypeOf(P);K=K&&K.setTimeout?K:P,R={}.toString.call(P.process)==="[object process]"?function(be){process.nextTick(function(){ne(be)})}:function(){if(P.postMessage&&!P.importScripts){var be=!0,_e=P.onmessage;return P.onmessage=function(){be=!1},P.postMessage("","*"),P.onmessage=_e,be}}()?($="setImmediate$"+Math.random()+"$",P.addEventListener?P.addEventListener("message",ce,!1):P.attachEvent("onmessage",ce),function(be){P.postMessage($+be,"*")}):P.MessageChannel?((G=new MessageChannel).port1.onmessage=function(be){ne(be.data)},function(be){G.port2.postMessage(be)}):V&&"onreadystatechange"in V.createElement("script")?(L=V.documentElement,function(be){var _e=V.createElement("script");_e.onreadystatechange=function(){ne(be),_e.onreadystatechange=null,L.removeChild(_e),_e=null},L.appendChild(_e)}):function(be){setTimeout(ne,0,be)},K.setImmediate=function(be){typeof be!="function"&&(be=new Function(""+be));for(var _e=new Array(arguments.length-1),Ue=0;Ue<_e.length;Ue++)_e[Ue]=arguments[Ue+1];var De={callback:be,args:_e};return Z[B]=De,R(B),B++},K.clearImmediate=Y}function Y(be){delete Z[be]}function ne(be){if(Q)setTimeout(ne,0,be);else{var _e=Z[be];if(_e){Q=!0;try{(function(Ue){var De=Ue.callback,Ze=Ue.args;switch(Ze.length){case 0:De();break;case 1:De(Ze[0]);break;case 2:De(Ze[0],Ze[1]);break;case 3:De(Ze[0],Ze[1],Ze[2]);break;default:De.apply(l,Ze)}})(_e)}finally{Y(be),Q=!1}}}}function ce(be){be.source===P&&typeof be.data=="string"&&be.data.indexOf($)===0&&ne(+be.data.slice($.length))}})(typeof self>"u"?T===void 0?this:T:self)}).call(this,typeof Zl<"u"?Zl:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})}(kf)),kf.exports}var bg=wg();const Sg=Uc(bg);var jd={exports:{}},Eg=jd.exports,Ep;function Tg(){return Ep||(Ep=1,function(m,b){(function(x,I){I()})(Eg,function(){function x(L,G){return typeof G>"u"?G={autoBom:!1}:typeof G!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),G={autoBom:!G}),G.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(L.type)?new Blob(["\uFEFF",L],{type:L.type}):L}function I(L,G,$){var B=new XMLHttpRequest;B.open("GET",L),B.responseType="blob",B.onload=function(){R(B.response,G,$)},B.onerror=function(){console.error("could not download file")},B.send()}function C(L){var G=new XMLHttpRequest;G.open("HEAD",L,!1);try{G.send()}catch{}return 200<=G.status&&299>=G.status}function T(L){try{L.dispatchEvent(new MouseEvent("click"))}catch{var G=document.createEvent("MouseEvents");G.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),L.dispatchEvent(G)}}var P=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof Zl=="object"&&Zl.global===Zl?Zl:void 0,l=P.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),R=P.saveAs||(typeof window!="object"||window!==P?function(){}:"download"in HTMLAnchorElement.prototype&&!l?function(L,G,$){var B=P.URL||P.webkitURL,Z=document.createElement("a");G=G||L.name||"download",Z.download=G,Z.rel="noopener",typeof L=="string"?(Z.href=L,Z.origin===location.origin?T(Z):C(Z.href)?I(L,G,$):T(Z,Z.target="_blank")):(Z.href=B.createObjectURL(L),setTimeout(function(){B.revokeObjectURL(Z.href)},4e4),setTimeout(function(){T(Z)},0))}:"msSaveOrOpenBlob"in navigator?function(L,G,$){if(G=G||L.name||"download",typeof L!="string")navigator.msSaveOrOpenBlob(x(L,$),G);else if(C(L))I(L,G,$);else{var B=document.createElement("a");B.href=L,B.target="_blank",setTimeout(function(){T(B)})}}:function(L,G,$,B){if(B=B||open("","_blank"),B&&(B.document.title=B.document.body.innerText="downloading..."),typeof L=="string")return I(L,G,$);var Z=L.type==="application/octet-stream",Q=/constructor/i.test(P.HTMLElement)||P.safari,V=/CriOS\/[\d]+/.test(navigator.userAgent);if((V||Z&&Q||l)&&typeof FileReader<"u"){var K=new FileReader;K.onloadend=function(){var ce=K.result;ce=V?ce:ce.replace(/^data:[^;]*;/,"data:attachment/file;"),B?B.location.href=ce:location=ce,B=null},K.readAsDataURL(L)}else{var Y=P.URL||P.webkitURL,ne=Y.createObjectURL(L);B?B.location=ne:location.href=ne,B=null,setTimeout(function(){Y.revokeObjectURL(ne)},4e4)}});P.saveAs=R.saveAs=R,m.exports=R})}(jd)),jd.exports}var kg=Tg();const Vh="Noto Sans Regular",Cg=[{name:'Font stack "Barlow Regular"',files:["Barlow-Regular.ttf"]},{name:'Font stack "Lato Bold"',files:["Lato-Bold.ttf"]},{name:'Font stack "Lato Bold,Barlow Regular"',files:["Lato-Bold.ttf","Barlow-Regular.ttf"]}],Ig=[["name","default"],["name:en","en"],["name:ru","ru"],["name:ar","ar"],["name:zh-Hant","zh-Hant"],["name:zh-Hans","zh-Hans"],["name:ja","ja"],["name:ko","ko"],["name:fr","fr"],["name:uk","uk"],["name:de","de"],["name:fi","fi"],["name:pl","pl"],["name:es","es"],["name:be","be"],["name:br","br"],["name:he","he"],["name:sr","sr"],["name:sv","sv"],["name:it","it"],["name:ga","ga"],["name:el","el"],["name:kn","kn"],["name:th","th"],["name:nl","nl"],["name:ca","ca"],["name:hu","hu"],["name:eu","eu"],["name:oc","oc"],["name:lt","lt"],["name:cs","cs"],["name:ro","ro"],["name:hi","hi"],["name:ka","ka"],["name:fa","fa"],["name:pt","pt"],["name:my","my"],["name:nan","nan"],["name:ku","ku"],["name:ur","ur"],["name:vi","vi"],["name:bg","bg"],["name:hsb","hsb"],["name:bo","bo"],["name:hak","hak"],["name:tay","tay"],["name:szy","szy"],["name:ami","ami"],["name:se","se"]];var Ya=cm();function Ag(){for(var m=arguments.length,b=new Array(m),x=0;x<m;x++)b[x]=arguments[x];return Ie.useMemo(()=>I=>{b.forEach(C=>C(I))},b)}const Jd=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function jc(m){const b=Object.prototype.toString.call(m);return b==="[object Window]"||b==="[object global]"}function Qf(m){return"nodeType"in m}function Mi(m){var b,x;return m?jc(m)?m:Qf(m)&&(b=(x=m.ownerDocument)==null?void 0:x.defaultView)!=null?b:window:window}function ep(m){const{Document:b}=Mi(m);return m instanceof b}function Zh(m){return jc(m)?!1:m instanceof Mi(m).HTMLElement}function zg(m){return m instanceof Mi(m).SVGElement}function Vc(m){return m?jc(m)?m.document:Qf(m)?ep(m)?m:Zh(m)?m.ownerDocument:document:document:document}const Ro=Jd?Ie.useLayoutEffect:Ie.useEffect;function Qd(m){const b=Ie.useRef(m);return Ro(()=>{b.current=m}),Ie.useCallback(function(){for(var x=arguments.length,I=new Array(x),C=0;C<x;C++)I[C]=arguments[C];return b.current==null?void 0:b.current(...I)},[])}function Pg(){const m=Ie.useRef(null),b=Ie.useCallback((I,C)=>{m.current=setInterval(I,C)},[]),x=Ie.useCallback(()=>{m.current!==null&&(clearInterval(m.current),m.current=null)},[]);return[b,x]}function $h(m,b){b===void 0&&(b=[m]);const x=Ie.useRef(m);return Ro(()=>{x.current!==m&&(x.current=m)},b),x}function qh(m,b){const x=Ie.useRef();return Ie.useMemo(()=>{const I=m(x.current);return x.current=I,I},[...b])}function $d(m){const b=Qd(m),x=Ie.useRef(null),I=Ie.useCallback(C=>{C!==x.current&&(b==null||b(C,x.current)),x.current=C},[]);return[x,I]}function Gd(m){const b=Ie.useRef();return Ie.useEffect(()=>{b.current=m},[m]),b.current}let Cf={};function Wh(m,b){return Ie.useMemo(()=>{if(b)return b;const x=Cf[m]==null?0:Cf[m]+1;return Cf[m]=x,m+"-"+x},[m,b])}function dm(m){return function(b){for(var x=arguments.length,I=new Array(x>1?x-1:0),C=1;C<x;C++)I[C-1]=arguments[C];return I.reduce((T,P)=>{const l=Object.entries(P);for(const[R,L]of l){const G=T[R];G!=null&&(T[R]=G+m*L)}return T},{...b})}}const Bc=dm(1),Zd=dm(-1);function Mg(m){return"clientX"in m&&"clientY"in m}function ef(m){if(!m)return!1;const{KeyboardEvent:b}=Mi(m.target);return b&&m instanceof b}function Dg(m){if(!m)return!1;const{TouchEvent:b}=Mi(m.target);return b&&m instanceof b}function qd(m){if(Dg(m)){if(m.touches&&m.touches.length){const{clientX:b,clientY:x}=m.touches[0];return{x:b,y:x}}else if(m.changedTouches&&m.changedTouches.length){const{clientX:b,clientY:x}=m.changedTouches[0];return{x:b,y:x}}}return Mg(m)?{x:m.clientX,y:m.clientY}:null}const Hs=Object.freeze({Translate:{toString(m){if(!m)return;const{x:b,y:x}=m;return"translate3d("+(b?Math.round(b):0)+"px, "+(x?Math.round(x):0)+"px, 0)"}},Scale:{toString(m){if(!m)return;const{scaleX:b,scaleY:x}=m;return"scaleX("+b+") scaleY("+x+")"}},Transform:{toString(m){if(m)return[Hs.Translate.toString(m),Hs.Scale.toString(m)].join(" ")}},Transition:{toString(m){let{property:b,duration:x,easing:I}=m;return b+" "+x+"ms "+I}}}),Tp="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function Rg(m){return m.matches(Tp)?m:m.querySelector(Tp)}const Lg={display:"none"};function Bg(m){let{id:b,value:x}=m;return ln.createElement("div",{id:b,style:Lg},x)}const Fg={position:"fixed",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};function Og(m){let{id:b,announcement:x}=m;return ln.createElement("div",{id:b,style:Fg,role:"status","aria-live":"assertive","aria-atomic":!0},x)}function Ng(){const[m,b]=Ie.useState("");return{announce:Ie.useCallback(I=>{I!=null&&b(I)},[]),announcement:m}}const fm=Ie.createContext(null);function Ug(m){const b=Ie.useContext(fm);Ie.useEffect(()=>{if(!b)throw new Error("useDndMonitor must be used within a children of <DndContext>");return b(m)},[m,b])}function jg(){const[m]=Ie.useState(()=>new Set),b=Ie.useCallback(I=>(m.add(I),()=>m.delete(I)),[m]);return[Ie.useCallback(I=>{let{type:C,event:T}=I;m.forEach(P=>{var l;return(l=P[C])==null?void 0:l.call(P,T)})},[m]),b]}const Vg={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},$g={onDragStart(m){let{active:b}=m;return"Picked up draggable item "+b.id+"."},onDragOver(m){let{active:b,over:x}=m;return x?"Draggable item "+b.id+" was moved over droppable area "+x.id+".":"Draggable item "+b.id+" is no longer over a droppable area."},onDragEnd(m){let{active:b,over:x}=m;return x?"Draggable item "+b.id+" was dropped over droppable area "+x.id:"Draggable item "+b.id+" was dropped."},onDragCancel(m){let{active:b}=m;return"Dragging was cancelled. Draggable item "+b.id+" was dropped."}};function Gg(m){let{announcements:b=$g,container:x,hiddenTextDescribedById:I,screenReaderInstructions:C=Vg}=m;const{announce:T,announcement:P}=Ng(),l=Wh("DndLiveRegion"),[R,L]=Ie.useState(!1);if(Ie.useEffect(()=>{L(!0)},[]),Ug(Ie.useMemo(()=>({onDragStart($){let{active:B}=$;T(b.onDragStart({active:B}))},onDragMove($){let{active:B,over:Z}=$;b.onDragMove&&T(b.onDragMove({active:B,over:Z}))},onDragOver($){let{active:B,over:Z}=$;T(b.onDragOver({active:B,over:Z}))},onDragEnd($){let{active:B,over:Z}=$;T(b.onDragEnd({active:B,over:Z}))},onDragCancel($){let{active:B,over:Z}=$;T(b.onDragCancel({active:B,over:Z}))}}),[T,b])),!R)return null;const G=ln.createElement(ln.Fragment,null,ln.createElement(Bg,{id:I,value:C.draggable}),ln.createElement(Og,{id:l,announcement:P}));return x?Ya.createPortal(G,x):G}var Wn;(function(m){m.DragStart="dragStart",m.DragMove="dragMove",m.DragEnd="dragEnd",m.DragCancel="dragCancel",m.DragOver="dragOver",m.RegisterDroppable="registerDroppable",m.SetDroppableDisabled="setDroppableDisabled",m.UnregisterDroppable="unregisterDroppable"})(Wn||(Wn={}));function Wd(){}function Zg(m,b){return Ie.useMemo(()=>({sensor:m,options:{}}),[m,b])}function qg(){for(var m=arguments.length,b=new Array(m),x=0;x<m;x++)b[x]=arguments[x];return Ie.useMemo(()=>[...b].filter(I=>I!=null),[...b])}const hs=Object.freeze({x:0,y:0});function Wg(m,b){return Math.sqrt(Math.pow(m.x-b.x,2)+Math.pow(m.y-b.y,2))}function Hg(m,b){const x=qd(m);if(!x)return"0 0";const I={x:(x.x-b.left)/b.width*100,y:(x.y-b.top)/b.height*100};return I.x+"% "+I.y+"%"}function Xg(m,b){let{data:{value:x}}=m,{data:{value:I}}=b;return x-I}function Kg(m,b){let{data:{value:x}}=m,{data:{value:I}}=b;return I-x}function Yg(m,b){if(!m||m.length===0)return null;const[x]=m;return x[b]}function kp(m,b,x){return b===void 0&&(b=m.left),x===void 0&&(x=m.top),{x:b+m.width*.5,y:x+m.height*.5}}const Jg=m=>{let{collisionRect:b,droppableRects:x,droppableContainers:I}=m;const C=kp(b,b.left,b.top),T=[];for(const P of I){const{id:l}=P,R=x.get(l);if(R){const L=Wg(kp(R),C);T.push({id:l,data:{droppableContainer:P,value:L}})}}return T.sort(Xg)};function Qg(m,b){const x=Math.max(b.top,m.top),I=Math.max(b.left,m.left),C=Math.min(b.left+b.width,m.left+m.width),T=Math.min(b.top+b.height,m.top+m.height),P=C-I,l=T-x;if(I<C&&x<T){const R=b.width*b.height,L=m.width*m.height,G=P*l,$=G/(R+L-G);return Number($.toFixed(4))}return 0}const ey=m=>{let{collisionRect:b,droppableRects:x,droppableContainers:I}=m;const C=[];for(const T of I){const{id:P}=T,l=x.get(P);if(l){const R=Qg(l,b);R>0&&C.push({id:P,data:{droppableContainer:T,value:R}})}}return C.sort(Kg)};function ty(m,b,x){return{...m,scaleX:b&&x?b.width/x.width:1,scaleY:b&&x?b.height/x.height:1}}function pm(m,b){return m&&b?{x:m.left-b.left,y:m.top-b.top}:hs}function ry(m){return function(x){for(var I=arguments.length,C=new Array(I>1?I-1:0),T=1;T<I;T++)C[T-1]=arguments[T];return C.reduce((P,l)=>({...P,top:P.top+m*l.y,bottom:P.bottom+m*l.y,left:P.left+m*l.x,right:P.right+m*l.x}),{...x})}}const ny=ry(1);function mm(m){if(m.startsWith("matrix3d(")){const b=m.slice(9,-1).split(/, /);return{x:+b[12],y:+b[13],scaleX:+b[0],scaleY:+b[5]}}else if(m.startsWith("matrix(")){const b=m.slice(7,-1).split(/, /);return{x:+b[4],y:+b[5],scaleX:+b[0],scaleY:+b[3]}}return null}function iy(m,b,x){const I=mm(b);if(!I)return m;const{scaleX:C,scaleY:T,x:P,y:l}=I,R=m.left-P-(1-C)*parseFloat(x),L=m.top-l-(1-T)*parseFloat(x.slice(x.indexOf(" ")+1)),G=C?m.width/C:m.width,$=T?m.height/T:m.height;return{width:G,height:$,top:L,right:R+G,bottom:L+$,left:R}}const oy={ignoreTransform:!1};function $c(m,b){b===void 0&&(b=oy);let x=m.getBoundingClientRect();if(b.ignoreTransform){const{transform:L,transformOrigin:G}=Mi(m).getComputedStyle(m);L&&(x=iy(x,L,G))}const{top:I,left:C,width:T,height:P,bottom:l,right:R}=x;return{top:I,left:C,width:T,height:P,bottom:l,right:R}}function Cp(m){return $c(m,{ignoreTransform:!0})}function sy(m){const b=m.innerWidth,x=m.innerHeight;return{top:0,left:0,right:b,bottom:x,width:b,height:x}}function ay(m,b){return b===void 0&&(b=Mi(m).getComputedStyle(m)),b.position==="fixed"}function ly(m,b){b===void 0&&(b=Mi(m).getComputedStyle(m));const x=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(C=>{const T=b[C];return typeof T=="string"?x.test(T):!1})}function tp(m,b){const x=[];function I(C){if(b!=null&&x.length>=b||!C)return x;if(ep(C)&&C.scrollingElement!=null&&!x.includes(C.scrollingElement))return x.push(C.scrollingElement),x;if(!Zh(C)||zg(C)||x.includes(C))return x;const T=Mi(m).getComputedStyle(C);return C!==m&&ly(C,T)&&x.push(C),ay(C,T)?x:I(C.parentNode)}return m?I(m):x}function gm(m){const[b]=tp(m,1);return b??null}function If(m){return!Jd||!m?null:jc(m)?m:Qf(m)?ep(m)||m===Vc(m).scrollingElement?window:Zh(m)?m:null:null}function ym(m){return jc(m)?m.scrollX:m.scrollLeft}function _m(m){return jc(m)?m.scrollY:m.scrollTop}function Nf(m){return{x:ym(m),y:_m(m)}}var ei;(function(m){m[m.Forward=1]="Forward",m[m.Backward=-1]="Backward"})(ei||(ei={}));function vm(m){return!Jd||!m?!1:m===document.scrollingElement}function xm(m){const b={x:0,y:0},x=vm(m)?{height:window.innerHeight,width:window.innerWidth}:{height:m.clientHeight,width:m.clientWidth},I={x:m.scrollWidth-x.width,y:m.scrollHeight-x.height},C=m.scrollTop<=b.y,T=m.scrollLeft<=b.x,P=m.scrollTop>=I.y,l=m.scrollLeft>=I.x;return{isTop:C,isLeft:T,isBottom:P,isRight:l,maxScroll:I,minScroll:b}}const uy={x:.2,y:.2};function cy(m,b,x,I,C){let{top:T,left:P,right:l,bottom:R}=x;I===void 0&&(I=10),C===void 0&&(C=uy);const{isTop:L,isBottom:G,isLeft:$,isRight:B}=xm(m),Z={x:0,y:0},Q={x:0,y:0},V={height:b.height*C.y,width:b.width*C.x};return!L&&T<=b.top+V.height?(Z.y=ei.Backward,Q.y=I*Math.abs((b.top+V.height-T)/V.height)):!G&&R>=b.bottom-V.height&&(Z.y=ei.Forward,Q.y=I*Math.abs((b.bottom-V.height-R)/V.height)),!B&&l>=b.right-V.width?(Z.x=ei.Forward,Q.x=I*Math.abs((b.right-V.width-l)/V.width)):!$&&P<=b.left+V.width&&(Z.x=ei.Backward,Q.x=I*Math.abs((b.left+V.width-P)/V.width)),{direction:Z,speed:Q}}function hy(m){if(m===document.scrollingElement){const{innerWidth:T,innerHeight:P}=window;return{top:0,left:0,right:T,bottom:P,width:T,height:P}}const{top:b,left:x,right:I,bottom:C}=m.getBoundingClientRect();return{top:b,left:x,right:I,bottom:C,width:m.clientWidth,height:m.clientHeight}}function wm(m){return m.reduce((b,x)=>Bc(b,Nf(x)),hs)}function dy(m){return m.reduce((b,x)=>b+ym(x),0)}function fy(m){return m.reduce((b,x)=>b+_m(x),0)}function bm(m,b){if(b===void 0&&(b=$c),!m)return;const{top:x,left:I,bottom:C,right:T}=b(m);gm(m)&&(C<=0||T<=0||x>=window.innerHeight||I>=window.innerWidth)&&m.scrollIntoView({block:"center",inline:"center"})}const py=[["x",["left","right"],dy],["y",["top","bottom"],fy]];class rp{constructor(b,x){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const I=tp(x),C=wm(I);this.rect={...b},this.width=b.width,this.height=b.height;for(const[T,P,l]of py)for(const R of P)Object.defineProperty(this,R,{get:()=>{const L=l(I),G=C[T]-L;return this.rect[R]+G},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class Nh{constructor(b){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(x=>{var I;return(I=this.target)==null?void 0:I.removeEventListener(...x)})},this.target=b}add(b,x,I){var C;(C=this.target)==null||C.addEventListener(b,x,I),this.listeners.push([b,x,I])}}function my(m){const{EventTarget:b}=Mi(m);return m instanceof b?m:Vc(m)}function Af(m,b){const x=Math.abs(m.x),I=Math.abs(m.y);return typeof b=="number"?Math.sqrt(x**2+I**2)>b:"x"in b&&"y"in b?x>b.x&&I>b.y:"x"in b?x>b.x:"y"in b?I>b.y:!1}var Do;(function(m){m.Click="click",m.DragStart="dragstart",m.Keydown="keydown",m.ContextMenu="contextmenu",m.Resize="resize",m.SelectionChange="selectionchange",m.VisibilityChange="visibilitychange"})(Do||(Do={}));function Ip(m){m.preventDefault()}function gy(m){m.stopPropagation()}var Or;(function(m){m.Space="Space",m.Down="ArrowDown",m.Right="ArrowRight",m.Left="ArrowLeft",m.Up="ArrowUp",m.Esc="Escape",m.Enter="Enter"})(Or||(Or={}));const Sm={start:[Or.Space,Or.Enter],cancel:[Or.Esc],end:[Or.Space,Or.Enter]},yy=(m,b)=>{let{currentCoordinates:x}=b;switch(m.code){case Or.Right:return{...x,x:x.x+25};case Or.Left:return{...x,x:x.x-25};case Or.Down:return{...x,y:x.y+25};case Or.Up:return{...x,y:x.y-25}}};class Em{constructor(b){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=b;const{event:{target:x}}=b;this.props=b,this.listeners=new Nh(Vc(x)),this.windowListeners=new Nh(Mi(x)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(Do.Resize,this.handleCancel),this.windowListeners.add(Do.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(Do.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:b,onStart:x}=this.props,I=b.node.current;I&&bm(I),x(hs)}handleKeyDown(b){if(ef(b)){const{active:x,context:I,options:C}=this.props,{keyboardCodes:T=Sm,coordinateGetter:P=yy,scrollBehavior:l="smooth"}=C,{code:R}=b;if(T.end.includes(R)){this.handleEnd(b);return}if(T.cancel.includes(R)){this.handleCancel(b);return}const{collisionRect:L}=I.current,G=L?{x:L.left,y:L.top}:hs;this.referenceCoordinates||(this.referenceCoordinates=G);const $=P(b,{active:x,context:I.current,currentCoordinates:G});if($){const B=Zd($,G),Z={x:0,y:0},{scrollableAncestors:Q}=I.current;for(const V of Q){const K=b.code,{isTop:Y,isRight:ne,isLeft:ce,isBottom:be,maxScroll:_e,minScroll:Ue}=xm(V),De=hy(V),Ze={x:Math.min(K===Or.Right?De.right-De.width/2:De.right,Math.max(K===Or.Right?De.left:De.left+De.width/2,$.x)),y:Math.min(K===Or.Down?De.bottom-De.height/2:De.bottom,Math.max(K===Or.Down?De.top:De.top+De.height/2,$.y))},je=K===Or.Right&&!ne||K===Or.Left&&!ce,lt=K===Or.Down&&!be||K===Or.Up&&!Y;if(je&&Ze.x!==$.x){const vt=V.scrollLeft+B.x,me=K===Or.Right&&vt<=_e.x||K===Or.Left&&vt>=Ue.x;if(me&&!B.y){V.scrollTo({left:vt,behavior:l});return}me?Z.x=V.scrollLeft-vt:Z.x=K===Or.Right?V.scrollLeft-_e.x:V.scrollLeft-Ue.x,Z.x&&V.scrollBy({left:-Z.x,behavior:l});break}else if(lt&&Ze.y!==$.y){const vt=V.scrollTop+B.y,me=K===Or.Down&&vt<=_e.y||K===Or.Up&&vt>=Ue.y;if(me&&!B.x){V.scrollTo({top:vt,behavior:l});return}me?Z.y=V.scrollTop-vt:Z.y=K===Or.Down?V.scrollTop-_e.y:V.scrollTop-Ue.y,Z.y&&V.scrollBy({top:-Z.y,behavior:l});break}}this.handleMove(b,Bc(Zd($,this.referenceCoordinates),Z))}}}handleMove(b,x){const{onMove:I}=this.props;b.preventDefault(),I(x)}handleEnd(b){const{onEnd:x}=this.props;b.preventDefault(),this.detach(),x()}handleCancel(b){const{onCancel:x}=this.props;b.preventDefault(),this.detach(),x()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}Em.activators=[{eventName:"onKeyDown",handler:(m,b,x)=>{let{keyboardCodes:I=Sm,onActivation:C}=b,{active:T}=x;const{code:P}=m.nativeEvent;if(I.start.includes(P)){const l=T.activatorNode.current;return l&&m.target!==l?!1:(m.preventDefault(),C==null||C({event:m.nativeEvent}),!0)}return!1}}];function Ap(m){return!!(m&&"distance"in m)}function zp(m){return!!(m&&"delay"in m)}class np{constructor(b,x,I){var C;I===void 0&&(I=my(b.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=b,this.events=x;const{event:T}=b,{target:P}=T;this.props=b,this.events=x,this.document=Vc(P),this.documentListeners=new Nh(this.document),this.listeners=new Nh(I),this.windowListeners=new Nh(Mi(P)),this.initialCoordinates=(C=qd(T))!=null?C:hs,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:b,props:{options:{activationConstraint:x}}}=this;if(this.listeners.add(b.move.name,this.handleMove,{passive:!1}),this.listeners.add(b.end.name,this.handleEnd),this.windowListeners.add(Do.Resize,this.handleCancel),this.windowListeners.add(Do.DragStart,Ip),this.windowListeners.add(Do.VisibilityChange,this.handleCancel),this.windowListeners.add(Do.ContextMenu,Ip),this.documentListeners.add(Do.Keydown,this.handleKeydown),x){if(Ap(x))return;if(zp(x)){this.timeoutId=setTimeout(this.handleStart,x.delay);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handleStart(){const{initialCoordinates:b}=this,{onStart:x}=this.props;b&&(this.activated=!0,this.documentListeners.add(Do.Click,gy,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(Do.SelectionChange,this.removeTextSelection),x(b))}handleMove(b){var x;const{activated:I,initialCoordinates:C,props:T}=this,{onMove:P,options:{activationConstraint:l}}=T;if(!C)return;const R=(x=qd(b))!=null?x:hs,L=Zd(C,R);if(!I&&l){if(zp(l))return Af(L,l.tolerance)?this.handleCancel():void 0;if(Ap(l))return l.tolerance!=null&&Af(L,l.tolerance)?this.handleCancel():Af(L,l.distance)?this.handleStart():void 0}b.cancelable&&b.preventDefault(),P(R)}handleEnd(){const{onEnd:b}=this.props;this.detach(),b()}handleCancel(){const{onCancel:b}=this.props;this.detach(),b()}handleKeydown(b){b.code===Or.Esc&&this.handleCancel()}removeTextSelection(){var b;(b=this.document.getSelection())==null||b.removeAllRanges()}}const _y={move:{name:"pointermove"},end:{name:"pointerup"}};class ip extends np{constructor(b){const{event:x}=b,I=Vc(x.target);super(b,_y,I)}}ip.activators=[{eventName:"onPointerDown",handler:(m,b)=>{let{nativeEvent:x}=m,{onActivation:I}=b;return!x.isPrimary||x.button!==0?!1:(I==null||I({event:x}),!0)}}];const vy={move:{name:"mousemove"},end:{name:"mouseup"}};var Uf;(function(m){m[m.RightClick=2]="RightClick"})(Uf||(Uf={}));class xy extends np{constructor(b){super(b,vy,Vc(b.event.target))}}xy.activators=[{eventName:"onMouseDown",handler:(m,b)=>{let{nativeEvent:x}=m,{onActivation:I}=b;return x.button===Uf.RightClick?!1:(I==null||I({event:x}),!0)}}];const zf={move:{name:"touchmove"},end:{name:"touchend"}};class wy extends np{constructor(b){super(b,zf)}static setup(){return window.addEventListener(zf.move.name,b,{capture:!1,passive:!1}),function(){window.removeEventListener(zf.move.name,b)};function b(){}}}wy.activators=[{eventName:"onTouchStart",handler:(m,b)=>{let{nativeEvent:x}=m,{onActivation:I}=b;const{touches:C}=x;return C.length>1?!1:(I==null||I({event:x}),!0)}}];var Uh;(function(m){m[m.Pointer=0]="Pointer",m[m.DraggableRect=1]="DraggableRect"})(Uh||(Uh={}));var Hd;(function(m){m[m.TreeOrder=0]="TreeOrder",m[m.ReversedTreeOrder=1]="ReversedTreeOrder"})(Hd||(Hd={}));function by(m){let{acceleration:b,activator:x=Uh.Pointer,canScroll:I,draggingRect:C,enabled:T,interval:P=5,order:l=Hd.TreeOrder,pointerCoordinates:R,scrollableAncestors:L,scrollableAncestorRects:G,delta:$,threshold:B}=m;const Z=Ey({delta:$,disabled:!T}),[Q,V]=Pg(),K=Ie.useRef({x:0,y:0}),Y=Ie.useRef({x:0,y:0}),ne=Ie.useMemo(()=>{switch(x){case Uh.Pointer:return R?{top:R.y,bottom:R.y,left:R.x,right:R.x}:null;case Uh.DraggableRect:return C}},[x,C,R]),ce=Ie.useRef(null),be=Ie.useCallback(()=>{const Ue=ce.current;if(!Ue)return;const De=K.current.x*Y.current.x,Ze=K.current.y*Y.current.y;Ue.scrollBy(De,Ze)},[]),_e=Ie.useMemo(()=>l===Hd.TreeOrder?[...L].reverse():L,[l,L]);Ie.useEffect(()=>{if(!T||!L.length||!ne){V();return}for(const Ue of _e){if((I==null?void 0:I(Ue))===!1)continue;const De=L.indexOf(Ue),Ze=G[De];if(!Ze)continue;const{direction:je,speed:lt}=cy(Ue,Ze,ne,b,B);for(const vt of["x","y"])Z[vt][je[vt]]||(lt[vt]=0,je[vt]=0);if(lt.x>0||lt.y>0){V(),ce.current=Ue,Q(be,P),K.current=lt,Y.current=je;return}}K.current={x:0,y:0},Y.current={x:0,y:0},V()},[b,be,I,V,T,P,JSON.stringify(ne),JSON.stringify(Z),Q,L,_e,G,JSON.stringify(B)])}const Sy={x:{[ei.Backward]:!1,[ei.Forward]:!1},y:{[ei.Backward]:!1,[ei.Forward]:!1}};function Ey(m){let{delta:b,disabled:x}=m;const I=Gd(b);return qh(C=>{if(x||!I||!C)return Sy;const T={x:Math.sign(b.x-I.x),y:Math.sign(b.y-I.y)};return{x:{[ei.Backward]:C.x[ei.Backward]||T.x===-1,[ei.Forward]:C.x[ei.Forward]||T.x===1},y:{[ei.Backward]:C.y[ei.Backward]||T.y===-1,[ei.Forward]:C.y[ei.Forward]||T.y===1}}},[x,b,I])}function Ty(m,b){const x=b!==null?m.get(b):void 0,I=x?x.node.current:null;return qh(C=>{var T;return b===null?null:(T=I??C)!=null?T:null},[I,b])}function ky(m,b){return Ie.useMemo(()=>m.reduce((x,I)=>{const{sensor:C}=I,T=C.activators.map(P=>({eventName:P.eventName,handler:b(P.handler,I)}));return[...x,...T]},[]),[m,b])}var Oc;(function(m){m[m.Always=0]="Always",m[m.BeforeDragging=1]="BeforeDragging",m[m.WhileDragging=2]="WhileDragging"})(Oc||(Oc={}));var jf;(function(m){m.Optimized="optimized"})(jf||(jf={}));const Pp=new Map;function Cy(m,b){let{dragging:x,dependencies:I,config:C}=b;const[T,P]=Ie.useState(null),{frequency:l,measure:R,strategy:L}=C,G=Ie.useRef(m),$=K(),B=$h($),Z=Ie.useCallback(function(Y){Y===void 0&&(Y=[]),!B.current&&P(ne=>ne===null?Y:ne.concat(Y.filter(ce=>!ne.includes(ce))))},[B]),Q=Ie.useRef(null),V=qh(Y=>{if($&&!x)return Pp;if(!Y||Y===Pp||G.current!==m||T!=null){const ne=new Map;for(let ce of m){if(!ce)continue;if(T&&T.length>0&&!T.includes(ce.id)&&ce.rect.current){ne.set(ce.id,ce.rect.current);continue}const be=ce.node.current,_e=be?new rp(R(be),be):null;ce.rect.current=_e,_e&&ne.set(ce.id,_e)}return ne}return Y},[m,T,x,$,R]);return Ie.useEffect(()=>{G.current=m},[m]),Ie.useEffect(()=>{$||Z()},[x,$]),Ie.useEffect(()=>{T&&T.length>0&&P(null)},[JSON.stringify(T)]),Ie.useEffect(()=>{$||typeof l!="number"||Q.current!==null||(Q.current=setTimeout(()=>{Z(),Q.current=null},l))},[l,$,Z,...I]),{droppableRects:V,measureDroppableContainers:Z,measuringScheduled:T!=null};function K(){switch(L){case Oc.Always:return!1;case Oc.BeforeDragging:return x;default:return!x}}}function op(m,b){return qh(x=>m?x||(typeof b=="function"?b(m):m):null,[b,m])}function Iy(m,b){return op(m,b)}function Ay(m){let{callback:b,disabled:x}=m;const I=Qd(b),C=Ie.useMemo(()=>{if(x||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:T}=window;return new T(I)},[I,x]);return Ie.useEffect(()=>()=>C==null?void 0:C.disconnect(),[C]),C}function tf(m){let{callback:b,disabled:x}=m;const I=Qd(b),C=Ie.useMemo(()=>{if(x||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:T}=window;return new T(I)},[x]);return Ie.useEffect(()=>()=>C==null?void 0:C.disconnect(),[C]),C}function zy(m){return new rp($c(m),m)}function Mp(m,b,x){b===void 0&&(b=zy);const[I,C]=Ie.useReducer(l,null),T=Ay({callback(R){if(m)for(const L of R){const{type:G,target:$}=L;if(G==="childList"&&$ instanceof HTMLElement&&$.contains(m)){C();break}}}}),P=tf({callback:C});return Ro(()=>{C(),m?(P==null||P.observe(m),T==null||T.observe(document.body,{childList:!0,subtree:!0})):(P==null||P.disconnect(),T==null||T.disconnect())},[m]),I;function l(R){if(!m)return null;if(m.isConnected===!1){var L;return(L=R??x)!=null?L:null}const G=b(m);return JSON.stringify(R)===JSON.stringify(G)?R:G}}function Py(m){const b=op(m);return pm(m,b)}const Dp=[];function My(m){const b=Ie.useRef(m),x=qh(I=>m?I&&I!==Dp&&m&&b.current&&m.parentNode===b.current.parentNode?I:tp(m):Dp,[m]);return Ie.useEffect(()=>{b.current=m},[m]),x}function Dy(m){const[b,x]=Ie.useState(null),I=Ie.useRef(m),C=Ie.useCallback(T=>{const P=If(T.target);P&&x(l=>l?(l.set(P,Nf(P)),new Map(l)):null)},[]);return Ie.useEffect(()=>{const T=I.current;if(m!==T){P(T);const l=m.map(R=>{const L=If(R);return L?(L.addEventListener("scroll",C,{passive:!0}),[L,Nf(L)]):null}).filter(R=>R!=null);x(l.length?new Map(l):null),I.current=m}return()=>{P(m),P(T)};function P(l){l.forEach(R=>{const L=If(R);L==null||L.removeEventListener("scroll",C)})}},[C,m]),Ie.useMemo(()=>m.length?b?Array.from(b.values()).reduce((T,P)=>Bc(T,P),hs):wm(m):hs,[m,b])}function Rp(m,b){b===void 0&&(b=[]);const x=Ie.useRef(null);return Ie.useEffect(()=>{x.current=null},b),Ie.useEffect(()=>{const I=m!==hs;I&&!x.current&&(x.current=m),!I&&x.current&&(x.current=null)},[m]),x.current?Zd(m,x.current):hs}function Ry(m){Ie.useEffect(()=>{if(!Jd)return;const b=m.map(x=>{let{sensor:I}=x;return I.setup==null?void 0:I.setup()});return()=>{for(const x of b)x==null||x()}},m.map(b=>{let{sensor:x}=b;return x}))}function Ly(m,b){return Ie.useMemo(()=>m.reduce((x,I)=>{let{eventName:C,handler:T}=I;return x[C]=P=>{T(P,b)},x},{}),[m,b])}function Tm(m){return Ie.useMemo(()=>m?sy(m):null,[m])}const Pf=[];function By(m,b){b===void 0&&(b=$c);const[x]=m,I=Tm(x?Mi(x):null),[C,T]=Ie.useReducer(l,Pf),P=tf({callback:T});return m.length>0&&C===Pf&&T(),Ro(()=>{m.length?m.forEach(R=>P==null?void 0:P.observe(R)):(P==null||P.disconnect(),T())},[m]),C;function l(){return m.length?m.map(R=>vm(R)?I:new rp(b(R),R)):Pf}}function km(m){if(!m)return null;if(m.children.length>1)return m;const b=m.children[0];return Zh(b)?b:m}function Fy(m){let{measure:b}=m;const[x,I]=Ie.useState(null),C=Ie.useCallback(L=>{for(const{target:G}of L)if(Zh(G)){I($=>{const B=b(G);return $?{...$,width:B.width,height:B.height}:B});break}},[b]),T=tf({callback:C}),P=Ie.useCallback(L=>{const G=km(L);T==null||T.disconnect(),G&&(T==null||T.observe(G)),I(G?b(G):null)},[b,T]),[l,R]=$d(P);return Ie.useMemo(()=>({nodeRef:l,rect:x,setRef:R}),[x,l,R])}const Oy=[{sensor:ip,options:{}},{sensor:Em,options:{}}],Ny={current:{}},Vd={draggable:{measure:Cp},droppable:{measure:Cp,strategy:Oc.WhileDragging,frequency:jf.Optimized},dragOverlay:{measure:$c}};class jh extends Map{get(b){var x;return b!=null&&(x=super.get(b))!=null?x:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(b=>{let{disabled:x}=b;return!x})}getNodeFor(b){var x,I;return(x=(I=this.get(b))==null?void 0:I.node.current)!=null?x:void 0}}const Uy={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new jh,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:Wd},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:Vd,measureDroppableContainers:Wd,windowRect:null,measuringScheduled:!1},Cm={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:Wd,draggableNodes:new Map,over:null,measureDroppableContainers:Wd},Hh=Ie.createContext(Cm),Im=Ie.createContext(Uy);function jy(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new jh}}}function Vy(m,b){switch(b.type){case Wn.DragStart:return{...m,draggable:{...m.draggable,initialCoordinates:b.initialCoordinates,active:b.active}};case Wn.DragMove:return m.draggable.active?{...m,draggable:{...m.draggable,translate:{x:b.coordinates.x-m.draggable.initialCoordinates.x,y:b.coordinates.y-m.draggable.initialCoordinates.y}}}:m;case Wn.DragEnd:case Wn.DragCancel:return{...m,draggable:{...m.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case Wn.RegisterDroppable:{const{element:x}=b,{id:I}=x,C=new jh(m.droppable.containers);return C.set(I,x),{...m,droppable:{...m.droppable,containers:C}}}case Wn.SetDroppableDisabled:{const{id:x,key:I,disabled:C}=b,T=m.droppable.containers.get(x);if(!T||I!==T.key)return m;const P=new jh(m.droppable.containers);return P.set(x,{...T,disabled:C}),{...m,droppable:{...m.droppable,containers:P}}}case Wn.UnregisterDroppable:{const{id:x,key:I}=b,C=m.droppable.containers.get(x);if(!C||I!==C.key)return m;const T=new jh(m.droppable.containers);return T.delete(x),{...m,droppable:{...m.droppable,containers:T}}}default:return m}}function $y(m){let{disabled:b}=m;const{active:x,activatorEvent:I,draggableNodes:C}=Ie.useContext(Hh),T=Gd(I),P=Gd(x==null?void 0:x.id);return Ie.useEffect(()=>{if(!b&&!I&&T&&P!=null){if(!ef(T)||document.activeElement===T.target)return;const l=C.get(P);if(!l)return;const{activatorNode:R,node:L}=l;if(!R.current&&!L.current)return;requestAnimationFrame(()=>{for(const G of[R.current,L.current]){if(!G)continue;const $=Rg(G);if($){$.focus();break}}})}},[I,b,C,P,T]),null}function Am(m,b){let{transform:x,...I}=b;return m!=null&&m.length?m.reduce((C,T)=>T({transform:C,...I}),x):x}function Gy(m){return Ie.useMemo(()=>({draggable:{...Vd.draggable,...m==null?void 0:m.draggable},droppable:{...Vd.droppable,...m==null?void 0:m.droppable},dragOverlay:{...Vd.dragOverlay,...m==null?void 0:m.dragOverlay}}),[m==null?void 0:m.draggable,m==null?void 0:m.droppable,m==null?void 0:m.dragOverlay])}function Zy(m){let{activeNode:b,measure:x,initialRect:I,config:C=!0}=m;const T=Ie.useRef(!1),{x:P,y:l}=typeof C=="boolean"?{x:C,y:C}:C;Ro(()=>{if(!P&&!l||!b){T.current=!1;return}if(T.current||!I)return;const L=b==null?void 0:b.node.current;if(!L||L.isConnected===!1)return;const G=x(L),$=pm(G,I);if(P||($.x=0),l||($.y=0),T.current=!0,Math.abs($.x)>0||Math.abs($.y)>0){const B=gm(L);B&&B.scrollBy({top:$.y,left:$.x})}},[b,P,l,I,x])}const rf=Ie.createContext({...hs,scaleX:1,scaleY:1});var $l;(function(m){m[m.Uninitialized=0]="Uninitialized",m[m.Initializing=1]="Initializing",m[m.Initialized=2]="Initialized"})($l||($l={}));const qy=Ie.memo(function(b){var x,I,C,T;let{id:P,accessibility:l,autoScroll:R=!0,children:L,sensors:G=Oy,collisionDetection:$=ey,measuring:B,modifiers:Z,...Q}=b;const V=Ie.useReducer(Vy,void 0,jy),[K,Y]=V,[ne,ce]=jg(),[be,_e]=Ie.useState($l.Uninitialized),Ue=be===$l.Initialized,{draggable:{active:De,nodes:Ze,translate:je},droppable:{containers:lt}}=K,vt=De?Ze.get(De):null,me=Ie.useRef({initial:null,translated:null}),$e=Ie.useMemo(()=>{var Lt;return De!=null?{id:De,data:(Lt=vt==null?void 0:vt.data)!=null?Lt:Ny,rect:me}:null},[De,vt]),j=Ie.useRef(null),[qe,ht]=Ie.useState(null),[Ke,st]=Ie.useState(null),Fe=$h(Q,Object.values(Q)),ae=Wh("DndDescribedBy",P),fe=Ie.useMemo(()=>lt.getEnabled(),[lt]),Se=Gy(B),{droppableRects:gt,measureDroppableContainers:ct,measuringScheduled:dt}=Cy(fe,{dragging:Ue,dependencies:[je.x,je.y],config:Se.droppable}),bt=Ty(Ze,De),Vt=Ie.useMemo(()=>Ke?qd(Ke):null,[Ke]),At=fn(),Rt=Iy(bt,Se.draggable.measure);Zy({activeNode:De?Ze.get(De):null,config:At.layoutShiftCompensation,initialRect:Rt,measure:Se.draggable.measure});const $t=Mp(bt,Se.draggable.measure,Rt),or=Mp(bt?bt.parentElement:null),sr=Ie.useRef({activatorEvent:null,active:null,activeNode:bt,collisionRect:null,collisions:null,droppableRects:gt,draggableNodes:Ze,draggingNode:null,draggingNodeRect:null,droppableContainers:lt,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),pr=lt.getNodeFor((x=sr.current.over)==null?void 0:x.id),O=Fy({measure:Se.dragOverlay.measure}),it=(I=O.nodeRef.current)!=null?I:bt,He=Ue?(C=O.rect)!=null?C:$t:null,de=!!(O.nodeRef.current&&O.rect),oe=Py(de?null:$t),Ee=Tm(it?Mi(it):null),ot=My(Ue?pr??bt:null),ft=By(ot),Ne=Am(Z,{transform:{x:je.x-oe.x,y:je.y-oe.y,scaleX:1,scaleY:1},activatorEvent:Ke,active:$e,activeNodeRect:$t,containerNodeRect:or,draggingNodeRect:He,over:sr.current.over,overlayNodeRect:O.rect,scrollableAncestors:ot,scrollableAncestorRects:ft,windowRect:Ee}),_t=Vt?Bc(Vt,je):null,We=Dy(ot),Qe=Rp(We),kt=Rp(We,[$t]),Me=Bc(Ne,Qe),Je=He?ny(He,Ne):null,xr=$e&&Je?$({active:$e,collisionRect:Je,droppableRects:gt,droppableContainers:fe,pointerCoordinates:_t}):null,kr=Yg(xr,"id"),[Wt,vr]=Ie.useState(null),Qt=de?Ne:Bc(Ne,kt),dn=ty(Qt,(T=Wt==null?void 0:Wt.rect)!=null?T:null,$t),Rr=Ie.useCallback((Lt,gr)=>{let{sensor:Ar,options:Lr}=gr;if(j.current==null)return;const Kr=Ze.get(j.current);if(!Kr)return;const lr=Lt.nativeEvent,ur=new Ar({active:j.current,activeNode:Kr,event:lr,options:Lr,context:sr,onStart(Wr){const gn=j.current;if(gn==null)return;const wn=Ze.get(gn);if(!wn)return;const{onDragStart:Hn}=Fe.current,Di={active:{id:gn,data:wn.data,rect:me}};Ya.unstable_batchedUpdates(()=>{Hn==null||Hn(Di),_e($l.Initializing),Y({type:Wn.DragStart,initialCoordinates:Wr,active:gn}),ne({type:"onDragStart",event:Di})})},onMove(Wr){Y({type:Wn.DragMove,coordinates:Wr})},onEnd:An(Wn.DragEnd),onCancel:An(Wn.DragCancel)});Ya.unstable_batchedUpdates(()=>{ht(ur),st(Lt.nativeEvent)});function An(Wr){return async function(){const{active:wn,collisions:Hn,over:Di,scrollAdjustedTranslate:zn}=sr.current;let J=null;if(wn&&zn){const{cancelDrop:D}=Fe.current;J={activatorEvent:lr,active:wn,collisions:Hn,delta:zn,over:Di},Wr===Wn.DragEnd&&typeof D=="function"&&await Promise.resolve(D(J))&&(Wr=Wn.DragCancel)}j.current=null,Ya.unstable_batchedUpdates(()=>{Y({type:Wr}),_e($l.Uninitialized),vr(null),ht(null),st(null);const D=Wr===Wn.DragEnd?"onDragEnd":"onDragCancel";if(J){const U=Fe.current[D];U==null||U(J),ne({type:D,event:J})}})}}},[Ze]),yt=Ie.useCallback((Lt,gr)=>(Ar,Lr)=>{const Kr=Ar.nativeEvent,lr=Ze.get(Lr);if(j.current!==null||!lr||Kr.dndKit||Kr.defaultPrevented)return;const ur={active:lr};Lt(Ar,gr.options,ur)===!0&&(Kr.dndKit={capturedBy:gr.sensor},j.current=Lr,Rr(Ar,gr))},[Ze,Rr]),qt=ky(G,yt);Ry(G),Ro(()=>{$t&&be===$l.Initializing&&_e($l.Initialized)},[$t,be]),Ie.useEffect(()=>{const{onDragMove:Lt}=Fe.current,{active:gr,activatorEvent:Ar,collisions:Lr,over:Kr}=sr.current;if(!gr||!Ar)return;const lr={active:gr,activatorEvent:Ar,collisions:Lr,delta:{x:Me.x,y:Me.y},over:Kr};Ya.unstable_batchedUpdates(()=>{Lt==null||Lt(lr),ne({type:"onDragMove",event:lr})})},[Me.x,Me.y]),Ie.useEffect(()=>{const{active:Lt,activatorEvent:gr,collisions:Ar,droppableContainers:Lr,scrollAdjustedTranslate:Kr}=sr.current;if(!Lt||j.current==null||!gr||!Kr)return;const{onDragOver:lr}=Fe.current,ur=Lr.get(kr),An=ur&&ur.rect.current?{id:ur.id,rect:ur.rect.current,data:ur.data,disabled:ur.disabled}:null,Wr={active:Lt,activatorEvent:gr,collisions:Ar,delta:{x:Kr.x,y:Kr.y},over:An};Ya.unstable_batchedUpdates(()=>{vr(An),lr==null||lr(Wr),ne({type:"onDragOver",event:Wr})})},[kr]),Ro(()=>{sr.current={activatorEvent:Ke,active:$e,activeNode:bt,collisionRect:Je,collisions:xr,droppableRects:gt,draggableNodes:Ze,draggingNode:it,draggingNodeRect:He,droppableContainers:lt,over:Wt,scrollableAncestors:ot,scrollAdjustedTranslate:Me},me.current={initial:He,translated:Je}},[$e,bt,xr,Je,Ze,it,He,gt,lt,Wt,ot,Me]),by({...At,delta:je,draggingRect:Je,pointerCoordinates:_t,scrollableAncestors:ot,scrollableAncestorRects:ft});const Zt=Ie.useMemo(()=>({active:$e,activeNode:bt,activeNodeRect:$t,activatorEvent:Ke,collisions:xr,containerNodeRect:or,dragOverlay:O,draggableNodes:Ze,droppableContainers:lt,droppableRects:gt,over:Wt,measureDroppableContainers:ct,scrollableAncestors:ot,scrollableAncestorRects:ft,measuringConfiguration:Se,measuringScheduled:dt,windowRect:Ee}),[$e,bt,$t,Ke,xr,or,O,Ze,lt,gt,Wt,ct,ot,ft,Se,dt,Ee]),qr=Ie.useMemo(()=>({activatorEvent:Ke,activators:qt,active:$e,activeNodeRect:$t,ariaDescribedById:{draggable:ae},dispatch:Y,draggableNodes:Ze,over:Wt,measureDroppableContainers:ct}),[Ke,qt,$e,$t,Y,ae,Ze,Wt,ct]);return ln.createElement(fm.Provider,{value:ce},ln.createElement(Hh.Provider,{value:qr},ln.createElement(Im.Provider,{value:Zt},ln.createElement(rf.Provider,{value:dn},L)),ln.createElement($y,{disabled:(l==null?void 0:l.restoreFocus)===!1})),ln.createElement(Gg,{...l,hiddenTextDescribedById:ae}));function fn(){const Lt=(qe==null?void 0:qe.autoScrollEnabled)===!1,gr=typeof R=="object"?R.enabled===!1:R===!1,Ar=Ue&&!Lt&&!gr;return typeof R=="object"?{...R,enabled:Ar}:{enabled:Ar}}}),Wy=Ie.createContext(null),Lp="button",Hy="Droppable";function Xy(m){let{id:b,data:x,disabled:I=!1,attributes:C}=m;const T=Wh(Hy),{activators:P,activatorEvent:l,active:R,activeNodeRect:L,ariaDescribedById:G,draggableNodes:$,over:B}=Ie.useContext(Hh),{role:Z=Lp,roleDescription:Q="draggable",tabIndex:V=0}=C??{},K=(R==null?void 0:R.id)===b,Y=Ie.useContext(K?rf:Wy),[ne,ce]=$d(),[be,_e]=$d(),Ue=Ly(P,b),De=$h(x);Ro(()=>($.set(b,{id:b,key:T,node:ne,activatorNode:be,data:De}),()=>{const je=$.get(b);je&&je.key===T&&$.delete(b)}),[$,b]);const Ze=Ie.useMemo(()=>({role:Z,tabIndex:V,"aria-disabled":I,"aria-pressed":K&&Z===Lp?!0:void 0,"aria-roledescription":Q,"aria-describedby":G.draggable}),[I,Z,V,K,Q,G.draggable]);return{active:R,activatorEvent:l,activeNodeRect:L,attributes:Ze,isDragging:K,listeners:I?void 0:Ue,node:ne,over:B,setNodeRef:ce,setActivatorNodeRef:_e,transform:Y}}function zm(){return Ie.useContext(Im)}const Ky="Droppable",Yy={timeout:25};function Pm(m){let{data:b,disabled:x=!1,id:I,resizeObserverConfig:C}=m;const T=Wh(Ky),{active:P,dispatch:l,over:R,measureDroppableContainers:L}=Ie.useContext(Hh),G=Ie.useRef({disabled:x}),$=Ie.useRef(!1),B=Ie.useRef(null),Z=Ie.useRef(null),{disabled:Q,updateMeasurementsFor:V,timeout:K}={...Yy,...C},Y=$h(V??I),ne=Ie.useCallback(()=>{if(!$.current){$.current=!0;return}Z.current!=null&&clearTimeout(Z.current),Z.current=setTimeout(()=>{L(Array.isArray(Y.current)?Y.current:[Y.current]),Z.current=null},K)},[K]),ce=tf({callback:ne,disabled:Q||!P}),be=Ie.useCallback((Ze,je)=>{ce&&(je&&(ce.unobserve(je),$.current=!1),Ze&&ce.observe(Ze))},[ce]),[_e,Ue]=$d(be),De=$h(b);return Ie.useEffect(()=>{!ce||!_e.current||(ce.disconnect(),$.current=!1,ce.observe(_e.current))},[_e,ce]),Ro(()=>(l({type:Wn.RegisterDroppable,element:{id:I,key:T,disabled:x,node:_e,rect:B,data:De}}),()=>l({type:Wn.UnregisterDroppable,key:T,id:I})),[I]),Ie.useEffect(()=>{x!==G.current.disabled&&(l({type:Wn.SetDroppableDisabled,id:I,key:T,disabled:x}),G.current.disabled=x)},[I,T,x,l]),{active:P,rect:B,isOver:(R==null?void 0:R.id)===I,node:_e,over:R,setNodeRef:Ue}}function Jy(m){let{animation:b,children:x}=m;const[I,C]=Ie.useState(null),[T,P]=Ie.useState(null),l=Gd(x);return!x&&!I&&l&&C(l),Ro(()=>{if(!T)return;const R=I==null?void 0:I.key,L=I==null?void 0:I.props.id;if(R==null||L==null){C(null);return}Promise.resolve(b(L,T)).then(()=>{C(null)})},[b,I,T]),ln.createElement(ln.Fragment,null,x,I?Ie.cloneElement(I,{ref:P}):null)}const Qy={x:0,y:0,scaleX:1,scaleY:1};function e_(m){let{children:b}=m;return ln.createElement(Hh.Provider,{value:Cm},ln.createElement(rf.Provider,{value:Qy},b))}const t_={position:"fixed",touchAction:"none"},r_=m=>ef(m)?"transform 250ms ease":void 0,n_=Ie.forwardRef((m,b)=>{let{as:x,activatorEvent:I,adjustScale:C,children:T,className:P,rect:l,style:R,transform:L,transition:G=r_}=m;if(!l)return null;const $=C?L:{...L,scaleX:1,scaleY:1},B={...t_,width:l.width,height:l.height,top:l.top,left:l.left,transform:Hs.Transform.toString($),transformOrigin:C&&I?Hg(I,l):void 0,transition:typeof G=="function"?G(I):G,...R};return ln.createElement(x,{className:P,style:B,ref:b},T)}),i_=m=>b=>{let{active:x,dragOverlay:I}=b;const C={},{styles:T,className:P}=m;if(T!=null&&T.active)for(const[l,R]of Object.entries(T.active))R!==void 0&&(C[l]=x.node.style.getPropertyValue(l),x.node.style.setProperty(l,R));if(T!=null&&T.dragOverlay)for(const[l,R]of Object.entries(T.dragOverlay))R!==void 0&&I.node.style.setProperty(l,R);return P!=null&&P.active&&x.node.classList.add(P.active),P!=null&&P.dragOverlay&&I.node.classList.add(P.dragOverlay),function(){for(const[R,L]of Object.entries(C))x.node.style.setProperty(R,L);P!=null&&P.active&&x.node.classList.remove(P.active)}},o_=m=>{let{transform:{initial:b,final:x}}=m;return[{transform:Hs.Transform.toString(b)},{transform:Hs.Transform.toString(x)}]},Vf={duration:250,easing:"ease",keyframes:o_,sideEffects:i_({styles:{active:{opacity:"0"}}})};function s_(m){let{config:b,draggableNodes:x,droppableContainers:I,measuringConfiguration:C}=m;return Qd((T,P)=>{if(b===null)return;const l=x.get(T);if(!l)return;const R=l.node.current;if(!R)return;const L=km(P);if(!L)return;const{transform:G}=Mi(P).getComputedStyle(P),$=mm(G);if(!$)return;const B=typeof b=="function"?b:a_(b);return bm(R,C.draggable.measure),B({active:{id:T,data:l.data,node:R,rect:C.draggable.measure(R)},draggableNodes:x,dragOverlay:{node:P,rect:C.dragOverlay.measure(L)},droppableContainers:I,measuringConfiguration:C,transform:$})})}function a_(m){const{duration:b,easing:x,sideEffects:I,keyframes:C}={...Vf,...m};return T=>{let{active:P,dragOverlay:l,transform:R,...L}=T;if(!b)return;const G={x:l.rect.left-P.rect.left,y:l.rect.top-P.rect.top},$={scaleX:R.scaleX!==1?P.rect.width*R.scaleX/l.rect.width:1,scaleY:R.scaleY!==1?P.rect.height*R.scaleY/l.rect.height:1},B={x:R.x-G.x,y:R.y-G.y,...$},Z=C({...L,active:P,dragOverlay:l,transform:{initial:R,final:B}}),[Q]=Z,V=Z[Z.length-1];if(JSON.stringify(Q)===JSON.stringify(V))return;const K=I==null?void 0:I({active:P,dragOverlay:l,...L}),Y=l.node.animate(Z,{duration:b,easing:x,fill:"forwards"});return new Promise(ne=>{Y.onfinish=()=>{K==null||K(),ne()}})}}let Bp=0;function l_(m){return Ie.useMemo(()=>{if(m!=null)return Bp++,Bp},[m])}const u_=ln.memo(m=>{let{adjustScale:b=!1,children:x,dropAnimation:I,style:C,transition:T,modifiers:P,wrapperElement:l="div",className:R,zIndex:L=999}=m;const{activatorEvent:G,active:$,activeNodeRect:B,containerNodeRect:Z,draggableNodes:Q,droppableContainers:V,dragOverlay:K,over:Y,measuringConfiguration:ne,scrollableAncestors:ce,scrollableAncestorRects:be,windowRect:_e}=zm(),Ue=Ie.useContext(rf),De=l_($==null?void 0:$.id),Ze=Am(P,{activatorEvent:G,active:$,activeNodeRect:B,containerNodeRect:Z,draggingNodeRect:K.rect,over:Y,overlayNodeRect:K.rect,scrollableAncestors:ce,scrollableAncestorRects:be,transform:Ue,windowRect:_e}),je=op(B),lt=s_({config:I,draggableNodes:Q,droppableContainers:V,measuringConfiguration:ne}),vt=je?K.setRef:void 0;return ln.createElement(e_,null,ln.createElement(Jy,{animation:lt},$&&De?ln.createElement(n_,{key:De,id:$.id,ref:vt,as:l,activatorEvent:G,adjustScale:b,className:R,transition:T,rect:je,style:{zIndex:L,...C},transform:Ze},x):null))});function nf(m,b,x){const I=m.slice();return I.splice(x<0?I.length+x:x,0,I.splice(b,1)[0]),I}function c_(m,b){return m.reduce((x,I,C)=>{const T=b.get(I);return T&&(x[C]=T),x},Array(m.length))}function Bd(m){return m!==null&&m>=0}function h_(m,b){if(m===b)return!0;if(m.length!==b.length)return!1;for(let x=0;x<m.length;x++)if(m[x]!==b[x])return!1;return!0}function d_(m){return typeof m=="boolean"?{draggable:m,droppable:m}:m}const Mm=m=>{let{rects:b,activeIndex:x,overIndex:I,index:C}=m;const T=nf(b,I,x),P=b[C],l=T[C];return!l||!P?null:{x:l.left-P.left,y:l.top-P.top,scaleX:l.width/P.width,scaleY:l.height/P.height}},Fd={scaleX:1,scaleY:1},f_=m=>{var b;let{activeIndex:x,activeNodeRect:I,index:C,rects:T,overIndex:P}=m;const l=(b=T[x])!=null?b:I;if(!l)return null;if(C===x){const L=T[P];return L?{x:0,y:x<P?L.top+L.height-(l.top+l.height):L.top-l.top,...Fd}:null}const R=p_(T,C,x);return C>x&&C<=P?{x:0,y:-l.height-R,...Fd}:C<x&&C>=P?{x:0,y:l.height+R,...Fd}:{x:0,y:0,...Fd}};function p_(m,b,x){const I=m[b],C=m[b-1],T=m[b+1];return I?x<b?C?I.top-(C.top+C.height):T?T.top-(I.top+I.height):0:T?T.top-(I.top+I.height):C?I.top-(C.top+C.height):0:0}const Dm="Sortable",Rm=ln.createContext({activeIndex:-1,containerId:Dm,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:Mm,disabled:{draggable:!1,droppable:!1}});function m_(m){let{children:b,id:x,items:I,strategy:C=Mm,disabled:T=!1}=m;const{active:P,dragOverlay:l,droppableRects:R,over:L,measureDroppableContainers:G}=zm(),$=Wh(Dm,x),B=l.rect!==null,Z=Ie.useMemo(()=>I.map(Ue=>typeof Ue=="object"&&"id"in Ue?Ue.id:Ue),[I]),Q=P!=null,V=P?Z.indexOf(P.id):-1,K=L?Z.indexOf(L.id):-1,Y=Ie.useRef(Z),ne=!h_(Z,Y.current),ce=K!==-1&&V===-1||ne,be=d_(T);Ro(()=>{ne&&Q&&G(Z)},[ne,Z,Q,G]),Ie.useEffect(()=>{Y.current=Z},[Z]);const _e=Ie.useMemo(()=>({activeIndex:V,containerId:$,disabled:be,disableTransforms:ce,items:Z,overIndex:K,useDragOverlay:B,sortedRects:c_(Z,R),strategy:C}),[V,$,be.draggable,be.droppable,ce,Z,K,R,B,C]);return ln.createElement(Rm.Provider,{value:_e},b)}const g_=m=>{let{id:b,items:x,activeIndex:I,overIndex:C}=m;return nf(x,I,C).indexOf(b)},y_=m=>{let{containerId:b,isSorting:x,wasDragging:I,index:C,items:T,newIndex:P,previousItems:l,previousContainerId:R,transition:L}=m;return!L||!I||l!==T&&C===P?!1:x?!0:P!==C&&b===R},__={duration:200,easing:"ease"},Lm="transform",v_=Hs.Transition.toString({property:Lm,duration:0,easing:"linear"}),x_={roleDescription:"sortable"};function w_(m){let{disabled:b,index:x,node:I,rect:C}=m;const[T,P]=Ie.useState(null),l=Ie.useRef(x);return Ro(()=>{if(!b&&x!==l.current&&I.current){const R=C.current;if(R){const L=$c(I.current,{ignoreTransform:!0}),G={x:R.left-L.left,y:R.top-L.top,scaleX:R.width/L.width,scaleY:R.height/L.height};(G.x||G.y)&&P(G)}}x!==l.current&&(l.current=x)},[b,x,I,C]),Ie.useEffect(()=>{T&&P(null)},[T]),T}function b_(m){let{animateLayoutChanges:b=y_,attributes:x,disabled:I,data:C,getNewIndex:T=g_,id:P,strategy:l,resizeObserverConfig:R,transition:L=__}=m;const{items:G,containerId:$,activeIndex:B,disabled:Z,disableTransforms:Q,sortedRects:V,overIndex:K,useDragOverlay:Y,strategy:ne}=Ie.useContext(Rm),ce=S_(I,Z),be=G.indexOf(P),_e=Ie.useMemo(()=>({sortable:{containerId:$,index:be,items:G},...C}),[$,C,be,G]),Ue=Ie.useMemo(()=>G.slice(G.indexOf(P)),[G,P]),{rect:De,node:Ze,isOver:je,setNodeRef:lt}=Pm({id:P,data:_e,disabled:ce.droppable,resizeObserverConfig:{updateMeasurementsFor:Ue,...R}}),{active:vt,activatorEvent:me,activeNodeRect:$e,attributes:j,setNodeRef:qe,listeners:ht,isDragging:Ke,over:st,setActivatorNodeRef:Fe,transform:ae}=Xy({id:P,data:_e,attributes:{...x_,...x},disabled:ce.draggable}),fe=Ag(lt,qe),Se=!!vt,gt=Se&&!Q&&Bd(B)&&Bd(K),ct=!Y&&Ke,dt=ct&&gt?ae:null,Vt=gt?dt??(l??ne)({rects:V,activeNodeRect:$e,activeIndex:B,overIndex:K,index:be}):null,At=Bd(B)&&Bd(K)?T({id:P,items:G,activeIndex:B,overIndex:K}):be,Rt=vt==null?void 0:vt.id,$t=Ie.useRef({activeId:Rt,items:G,newIndex:At,containerId:$}),or=G!==$t.current.items,sr=b({active:vt,containerId:$,isDragging:Ke,isSorting:Se,id:P,index:be,items:G,newIndex:$t.current.newIndex,previousItems:$t.current.items,previousContainerId:$t.current.containerId,transition:L,wasDragging:$t.current.activeId!=null}),pr=w_({disabled:!sr,index:be,node:Ze,rect:De});return Ie.useEffect(()=>{Se&&$t.current.newIndex!==At&&($t.current.newIndex=At),$!==$t.current.containerId&&($t.current.containerId=$),G!==$t.current.items&&($t.current.items=G)},[Se,At,$,G]),Ie.useEffect(()=>{if(Rt===$t.current.activeId)return;if(Rt&&!$t.current.activeId){$t.current.activeId=Rt;return}const it=setTimeout(()=>{$t.current.activeId=Rt},50);return()=>clearTimeout(it)},[Rt]),{active:vt,activeIndex:B,attributes:j,data:_e,rect:De,index:be,newIndex:At,items:G,isOver:je,isSorting:Se,isDragging:Ke,listeners:ht,node:Ze,overIndex:K,over:st,setNodeRef:fe,setActivatorNodeRef:Fe,setDroppableNodeRef:lt,setDraggableNodeRef:qe,transform:pr??Vt,transition:O()};function O(){if(pr||or&&$t.current.newIndex===be)return v_;if(!(ct&&!ef(me)||!L)&&(Se||sr))return Hs.Transition.toString({...L,property:Lm})}}function S_(m,b){var x,I;return typeof m=="boolean"?{draggable:m,droppable:!1}:{draggable:(x=m==null?void 0:m.draggable)!=null?x:b.draggable,droppable:(I=m==null?void 0:m.droppable)!=null?I:b.droppable}}Or.Down,Or.Right,Or.Up,Or.Left;function E_(m,b,x,I,C,T){const P=m.findIndex(Ou(x)),l=m.findIndex(Ou(b)),R=m[l],L=nf(m,l,P),G=L[P-1],$=L[P+1],B=Math.round(I/C),Z=R.depth+B,Q=($==null?void 0:$.depth)??0,V=Math.min(((G==null?void 0:G.depth)??-1)+1,T),K=Math.min(Math.max(Z,Q),V),Y=function(){if(K)for(let ce=P-1;ce>=0;ce--){const be=L[ce];if(K>be.depth)return be;if(K===be.depth)return be.parent}}();return{depth:K,parent:Y}}function $f(m){return m!=null&&m.parent?$f(m.parent):m}function*Bm(m,b,x=0){for(const I of m)yield{...I,depth:x},b!=null&&b.includes(I.id)||(yield*Bm(I.children,b,x+1))}function Fc(m,b){return Array.from(Bm(m,b))}function Ou(m){return b=>b.id===m}function Fm(m,b=0){return m.reduce((x,I)=>Fm(I.children,x+1),b)}function Gf(m){var I;const b={children:[]},x=new Map(m.map(C=>[C.id,{...C,children:[]}]));for(const C of x.values()){const T=x.get((I=C.parent)==null?void 0:I.id);C.parent=T,(T||b).children.push(C)}return b.children}function Om(m,b,x=[{children:m}]){if(!m.length)return m;for(const I of m)if(I.children.length&&x.length>b){const[C]=x,T=Fc([I]).map(R=>({...R,parent:C,children:[]})),P=C.children,l=P.findIndex(Ou(I.id));P.splice(l,1,...T)}else Om(I.children,b,[I,...x]);return m}function Nm(m){return{id:Math.random().toString(36).slice(2,7),parent:void 0,children:[],data:{file:m}}}async function T_(m){const[b,...x]=await Promise.all(m.files.map(I=>fetch(I).then(C=>C.blob()).then(C=>new File([C],I)).then(Nm)));return Object.assign(b,{children:x.map(I=>({...I,parent:b}))})}function Lc(m){var b;return((b=m.data.glyphs)==null?void 0:b.length)===256}function k_(m){const[b]=Gf(Fc([m]).map(x=>({...x,data:{...x.data,stackName:void 0,glyphs:void 0}})));return b}var Vi=(m=>(m.Ready="Ready",m.Running="Running",m.Finished="Finished",m))(Vi||{});const C_={stacks:[],status:Vi.Ready,config:{font:Vh,fontSize:14,langCode:"name",customText:""}};function I_(m,b){var x;switch(b.type){case"addFontStacks":return{...m,status:Vi.Ready,stacks:[...m.stacks,...b.stacks]};case"setFontStacks":{const I=b.stacks.map(P=>{var l;return(l=b.modifiedStackIds)!=null&&l.includes(P.id)?k_(P):P}),C=I.filter(Lc),T=C.some(P=>P.id===m.config.font)?m.config.font:((x=C.at(-1))==null?void 0:x.id)||Vh;return{...m,status:I.length&&I.every(Lc)?Vi.Finished:Vi.Ready,stacks:I,config:m.config.font!==T?{...m.config,font:T}:m.config}}case"startConversion":return{...m,status:b.toConvert.length?Vi.Running:Vi.Finished,stacks:m.stacks.map(I=>b.toConvert.includes(I)?{...I,data:{...I.data,glyphs:[]}}:I)};case"updateConversionStatus":{const{stackId:I,stackName:C,glyph:T}=b.data;let P=!1;const l=m.stacks.map(R=>{if(R.id===I){const L=[...R.data.glyphs,T],G={...R,data:{...R.data,stackName:C,glyphs:L}};return P=Lc(G),G}return R});return{...m,status:l.every(Lc)?Vi.Finished:Vi.Running,stacks:l,config:P?{...m.config,font:I}:m.config}}case"updateMapConfig":return{...m,config:{...m.config,...b.changes}};default:return m}}function A_(){return Ut.jsx("svg",{viewBox:"0 0 98 96",xmlns:"http://www.w3.org/2000/svg",children:Ut.jsx("path",{d:"M48.854 0C21.839 0 0 22 0 49.217c0 21.756 13.993 40.172 33.405 46.69 2.427.49 3.316-1.059 3.316-2.362 0-1.141-.08-5.052-.08-9.127-13.59 2.934-16.42-5.867-16.42-5.867-2.184-5.704-5.42-7.17-5.42-7.17-4.448-3.015.324-3.015.324-3.015 4.934.326 7.523 5.052 7.523 5.052 4.367 7.496 11.404 5.378 14.235 4.074.404-3.178 1.699-5.378 3.074-6.6-10.839-1.141-22.243-5.378-22.243-24.283 0-5.378 1.94-9.778 5.014-13.2-.485-1.222-2.184-6.275.486-13.038 0 0 4.125-1.304 13.426 5.052a46.97 46.97 0 0 1 12.214-1.63c4.125 0 8.33.571 12.213 1.63 9.302-6.356 13.427-5.052 13.427-5.052 2.67 6.763.97 11.816.485 13.038 3.155 3.422 5.015 7.822 5.015 13.2 0 18.905-11.404 23.06-22.324 24.283 1.78 1.548 3.316 4.481 3.316 9.126 0 6.6-.08 11.897-.08 13.526 0 1.304.89 2.853 3.316 2.364 19.412-6.52 33.405-24.935 33.405-46.691C97.707 22 75.788 0 48.854 0z",fill:"#24292f"})})}const z_="_ExampleItem_1b4yh_1",P_={ExampleItem:z_};function M_({status:m,onExampleLoad:b}){return Ut.jsx("ul",{children:Cg.map(x=>Ut.jsx("li",{className:P_.ExampleItem,children:Ut.jsx("button",{disabled:m===Vi.Running,onClick:()=>b(x),children:x.name})},x.name))})}var Mf={exports:{}},Df,Fp;function D_(){if(Fp)return Df;Fp=1;var m="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return Df=m,Df}var Rf,Op;function R_(){if(Op)return Rf;Op=1;var m=D_();function b(){}function x(){}return x.resetWarningCache=b,Rf=function(){function I(P,l,R,L,G,$){if($!==m){var B=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw B.name="Invariant Violation",B}}I.isRequired=I;function C(){return I}var T={array:I,bigint:I,bool:I,func:I,number:I,object:I,string:I,symbol:I,any:I,arrayOf:C,element:I,elementType:I,instanceOf:C,node:I,objectOf:C,oneOf:C,oneOfType:C,shape:C,exact:C,checkPropTypes:x,resetWarningCache:b};return T.PropTypes=T,T},Rf}var Np;function L_(){return Np||(Np=1,Mf.exports=R_()()),Mf.exports}var B_=L_();const Xr=Uc(B_);function Gc(m,b,x,I){function C(T){return T instanceof x?T:new x(function(P){P(T)})}return new(x||(x=Promise))(function(T,P){function l(G){try{L(I.next(G))}catch($){P($)}}function R(G){try{L(I.throw(G))}catch($){P($)}}function L(G){G.done?T(G.value):C(G.value).then(l,R)}L((I=I.apply(m,[])).next())})}function Zc(m,b){var x={label:0,sent:function(){if(T[0]&1)throw T[1];return T[1]},trys:[],ops:[]},I,C,T,P;return P={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(P[Symbol.iterator]=function(){return this}),P;function l(L){return function(G){return R([L,G])}}function R(L){if(I)throw new TypeError("Generator is already executing.");for(;P&&(P=0,L[0]&&(x=0)),x;)try{if(I=1,C&&(T=L[0]&2?C.return:L[0]?C.throw||((T=C.return)&&T.call(C),0):C.next)&&!(T=T.call(C,L[1])).done)return T;switch(C=0,T&&(L=[L[0]&2,T.value]),L[0]){case 0:case 1:T=L;break;case 4:return x.label++,{value:L[1],done:!1};case 5:x.label++,C=L[1],L=[0];continue;case 7:L=x.ops.pop(),x.trys.pop();continue;default:if(T=x.trys,!(T=T.length>0&&T[T.length-1])&&(L[0]===6||L[0]===2)){x=0;continue}if(L[0]===3&&(!T||L[1]>T[0]&&L[1]<T[3])){x.label=L[1];break}if(L[0]===6&&x.label<T[1]){x.label=T[1],T=L;break}if(T&&x.label<T[2]){x.label=T[2],x.ops.push(L);break}T[2]&&x.ops.pop(),x.trys.pop();continue}L=b.call(m,x)}catch(G){L=[6,G],C=0}finally{I=T=0}if(L[0]&5)throw L[1];return{value:L[0]?L[1]:void 0,done:!0}}}function Up(m,b){var x=typeof Symbol=="function"&&m[Symbol.iterator];if(!x)return m;var I=x.call(m),C,T=[],P;try{for(;(b===void 0||b-- >0)&&!(C=I.next()).done;)T.push(C.value)}catch(l){P={error:l}}finally{try{C&&!C.done&&(x=I.return)&&x.call(I)}finally{if(P)throw P.error}}return T}function jp(m,b,x){if(arguments.length===2)for(var I=0,C=b.length,T;I<C;I++)(T||!(I in b))&&(T||(T=Array.prototype.slice.call(b,0,I)),T[I]=b[I]);return m.concat(T||Array.prototype.slice.call(b))}var F_=new Map([["aac","audio/aac"],["abw","application/x-abiword"],["arc","application/x-freearc"],["avif","image/avif"],["avi","video/x-msvideo"],["azw","application/vnd.amazon.ebook"],["bin","application/octet-stream"],["bmp","image/bmp"],["bz","application/x-bzip"],["bz2","application/x-bzip2"],["cda","application/x-cdf"],["csh","application/x-csh"],["css","text/css"],["csv","text/csv"],["doc","application/msword"],["docx","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],["eot","application/vnd.ms-fontobject"],["epub","application/epub+zip"],["gz","application/gzip"],["gif","image/gif"],["heic","image/heic"],["heif","image/heif"],["htm","text/html"],["html","text/html"],["ico","image/vnd.microsoft.icon"],["ics","text/calendar"],["jar","application/java-archive"],["jpeg","image/jpeg"],["jpg","image/jpeg"],["js","text/javascript"],["json","application/json"],["jsonld","application/ld+json"],["mid","audio/midi"],["midi","audio/midi"],["mjs","text/javascript"],["mp3","audio/mpeg"],["mp4","video/mp4"],["mpeg","video/mpeg"],["mpkg","application/vnd.apple.installer+xml"],["odp","application/vnd.oasis.opendocument.presentation"],["ods","application/vnd.oasis.opendocument.spreadsheet"],["odt","application/vnd.oasis.opendocument.text"],["oga","audio/ogg"],["ogv","video/ogg"],["ogx","application/ogg"],["opus","audio/opus"],["otf","font/otf"],["png","image/png"],["pdf","application/pdf"],["php","application/x-httpd-php"],["ppt","application/vnd.ms-powerpoint"],["pptx","application/vnd.openxmlformats-officedocument.presentationml.presentation"],["rar","application/vnd.rar"],["rtf","application/rtf"],["sh","application/x-sh"],["svg","image/svg+xml"],["swf","application/x-shockwave-flash"],["tar","application/x-tar"],["tif","image/tiff"],["tiff","image/tiff"],["ts","video/mp2t"],["ttf","font/ttf"],["txt","text/plain"],["vsd","application/vnd.visio"],["wav","audio/wav"],["weba","audio/webm"],["webm","video/webm"],["webp","image/webp"],["woff","font/woff"],["woff2","font/woff2"],["xhtml","application/xhtml+xml"],["xls","application/vnd.ms-excel"],["xlsx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],["xml","application/xml"],["xul","application/vnd.mozilla.xul+xml"],["zip","application/zip"],["7z","application/x-7z-compressed"],["mkv","video/x-matroska"],["mov","video/quicktime"],["msg","application/vnd.ms-outlook"]]);function Xh(m,b){var x=O_(m);if(typeof x.path!="string"){var I=m.webkitRelativePath;Object.defineProperty(x,"path",{value:typeof b=="string"?b:typeof I=="string"&&I.length>0?I:m.name,writable:!1,configurable:!1,enumerable:!0})}return x}function O_(m){var b=m.name,x=b&&b.lastIndexOf(".")!==-1;if(x&&!m.type){var I=b.split(".").pop().toLowerCase(),C=F_.get(I);C&&Object.defineProperty(m,"type",{value:C,writable:!1,configurable:!1,enumerable:!0})}return m}var N_=[".DS_Store","Thumbs.db"];function U_(m){return Gc(this,void 0,void 0,function(){return Zc(this,function(b){return Xd(m)&&j_(m.dataTransfer)?[2,Z_(m.dataTransfer,m.type)]:V_(m)?[2,$_(m)]:Array.isArray(m)&&m.every(function(x){return"getFile"in x&&typeof x.getFile=="function"})?[2,G_(m)]:[2,[]]})})}function j_(m){return Xd(m)}function V_(m){return Xd(m)&&Xd(m.target)}function Xd(m){return typeof m=="object"&&m!==null}function $_(m){return Zf(m.target.files).map(function(b){return Xh(b)})}function G_(m){return Gc(this,void 0,void 0,function(){var b;return Zc(this,function(x){switch(x.label){case 0:return[4,Promise.all(m.map(function(I){return I.getFile()}))];case 1:return b=x.sent(),[2,b.map(function(I){return Xh(I)})]}})})}function Z_(m,b){return Gc(this,void 0,void 0,function(){var x,I;return Zc(this,function(C){switch(C.label){case 0:return m.items?(x=Zf(m.items).filter(function(T){return T.kind==="file"}),b!=="drop"?[2,x]:[4,Promise.all(x.map(q_))]):[3,2];case 1:return I=C.sent(),[2,Vp(Um(I))];case 2:return[2,Vp(Zf(m.files).map(function(T){return Xh(T)}))]}})})}function Vp(m){return m.filter(function(b){return N_.indexOf(b.name)===-1})}function Zf(m){if(m===null)return[];for(var b=[],x=0;x<m.length;x++){var I=m[x];b.push(I)}return b}function q_(m){if(typeof m.webkitGetAsEntry!="function")return $p(m);var b=m.webkitGetAsEntry();return b&&b.isDirectory?jm(b):$p(m)}function Um(m){return m.reduce(function(b,x){return jp(jp([],Up(b),!1),Up(Array.isArray(x)?Um(x):[x]),!1)},[])}function $p(m){var b=m.getAsFile();if(!b)return Promise.reject("".concat(m," is not a File"));var x=Xh(b);return Promise.resolve(x)}function W_(m){return Gc(this,void 0,void 0,function(){return Zc(this,function(b){return[2,m.isDirectory?jm(m):H_(m)]})})}function jm(m){var b=m.createReader();return new Promise(function(x,I){var C=[];function T(){var P=this;b.readEntries(function(l){return Gc(P,void 0,void 0,function(){var R,L,G;return Zc(this,function($){switch($.label){case 0:if(l.length)return[3,5];$.label=1;case 1:return $.trys.push([1,3,,4]),[4,Promise.all(C)];case 2:return R=$.sent(),x(R),[3,4];case 3:return L=$.sent(),I(L),[3,4];case 4:return[3,6];case 5:G=Promise.all(l.map(W_)),C.push(G),T(),$.label=6;case 6:return[2]}})})},function(l){I(l)})}T()})}function H_(m){return Gc(this,void 0,void 0,function(){return Zc(this,function(b){return[2,new Promise(function(x,I){m.file(function(C){var T=Xh(C,m.fullPath);x(T)},function(C){I(C)})})]})})}var Od={},Gp;function X_(){return Gp||(Gp=1,Od.__esModule=!0,Od.default=function(m,b){if(m&&b){var x=Array.isArray(b)?b:b.split(","),I=m.name||"",C=(m.type||"").toLowerCase(),T=C.replace(/\/.*$/,"");return x.some(function(P){var l=P.trim().toLowerCase();return l.charAt(0)==="."?I.toLowerCase().endsWith(l):l.endsWith("/*")?T===l.replace(/\/.*$/,""):C===l})}return!0}),Od}var K_=X_();const Y_=Uc(K_);function Zp(m){return ev(m)||Q_(m)||$m(m)||J_()}function J_(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Q_(m){if(typeof Symbol<"u"&&m[Symbol.iterator]!=null||m["@@iterator"]!=null)return Array.from(m)}function ev(m){if(Array.isArray(m))return qf(m)}function qp(m,b){var x=Object.keys(m);if(Object.getOwnPropertySymbols){var I=Object.getOwnPropertySymbols(m);b&&(I=I.filter(function(C){return Object.getOwnPropertyDescriptor(m,C).enumerable})),x.push.apply(x,I)}return x}function Wp(m){for(var b=1;b<arguments.length;b++){var x=arguments[b]!=null?arguments[b]:{};b%2?qp(Object(x),!0).forEach(function(I){Vm(m,I,x[I])}):Object.getOwnPropertyDescriptors?Object.defineProperties(m,Object.getOwnPropertyDescriptors(x)):qp(Object(x)).forEach(function(I){Object.defineProperty(m,I,Object.getOwnPropertyDescriptor(x,I))})}return m}function Vm(m,b,x){return b in m?Object.defineProperty(m,b,{value:x,enumerable:!0,configurable:!0,writable:!0}):m[b]=x,m}function Gh(m,b){return nv(m)||rv(m,b)||$m(m,b)||tv()}function tv(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $m(m,b){if(m){if(typeof m=="string")return qf(m,b);var x=Object.prototype.toString.call(m).slice(8,-1);if(x==="Object"&&m.constructor&&(x=m.constructor.name),x==="Map"||x==="Set")return Array.from(m);if(x==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(x))return qf(m,b)}}function qf(m,b){(b==null||b>m.length)&&(b=m.length);for(var x=0,I=new Array(b);x<b;x++)I[x]=m[x];return I}function rv(m,b){var x=m==null?null:typeof Symbol<"u"&&m[Symbol.iterator]||m["@@iterator"];if(x!=null){var I=[],C=!0,T=!1,P,l;try{for(x=x.call(m);!(C=(P=x.next()).done)&&(I.push(P.value),!(b&&I.length===b));C=!0);}catch(R){T=!0,l=R}finally{try{!C&&x.return!=null&&x.return()}finally{if(T)throw l}}return I}}function nv(m){if(Array.isArray(m))return m}var iv="file-invalid-type",ov="file-too-large",sv="file-too-small",av="too-many-files",lv=function(b){b=Array.isArray(b)&&b.length===1?b[0]:b;var x=Array.isArray(b)?"one of ".concat(b.join(", ")):b;return{code:iv,message:"File type must be ".concat(x)}},Hp=function(b){return{code:ov,message:"File is larger than ".concat(b," ").concat(b===1?"byte":"bytes")}},Xp=function(b){return{code:sv,message:"File is smaller than ".concat(b," ").concat(b===1?"byte":"bytes")}},uv={code:av,message:"Too many files"};function Gm(m,b){var x=m.type==="application/x-moz-file"||Y_(m,b);return[x,x?null:lv(b)]}function Zm(m,b,x){if(Fu(m.size))if(Fu(b)&&Fu(x)){if(m.size>x)return[!1,Hp(x)];if(m.size<b)return[!1,Xp(b)]}else{if(Fu(b)&&m.size<b)return[!1,Xp(b)];if(Fu(x)&&m.size>x)return[!1,Hp(x)]}return[!0,null]}function Fu(m){return m!=null}function cv(m){var b=m.files,x=m.accept,I=m.minSize,C=m.maxSize,T=m.multiple,P=m.maxFiles,l=m.validator;return!T&&b.length>1||T&&P>=1&&b.length>P?!1:b.every(function(R){var L=Gm(R,x),G=Gh(L,1),$=G[0],B=Zm(R,I,C),Z=Gh(B,1),Q=Z[0],V=l?l(R):null;return $&&Q&&!V})}function Kd(m){return typeof m.isPropagationStopped=="function"?m.isPropagationStopped():typeof m.cancelBubble<"u"?m.cancelBubble:!1}function Nd(m){return m.dataTransfer?Array.prototype.some.call(m.dataTransfer.types,function(b){return b==="Files"||b==="application/x-moz-file"}):!!m.target&&!!m.target.files}function Kp(m){m.preventDefault()}function hv(m){return m.indexOf("MSIE")!==-1||m.indexOf("Trident/")!==-1}function dv(m){return m.indexOf("Edge/")!==-1}function fv(){var m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.navigator.userAgent;return hv(m)||dv(m)}function qs(){for(var m=arguments.length,b=new Array(m),x=0;x<m;x++)b[x]=arguments[x];return function(I){for(var C=arguments.length,T=new Array(C>1?C-1:0),P=1;P<C;P++)T[P-1]=arguments[P];return b.some(function(l){return!Kd(I)&&l&&l.apply(void 0,[I].concat(T)),Kd(I)})}}function pv(){return"showOpenFilePicker"in window}function mv(m){if(Fu(m)){var b=Object.entries(m).filter(function(x){var I=Gh(x,2),C=I[0],T=I[1],P=!0;return qm(C)||(console.warn('Skipped "'.concat(C,'" because it is not a valid MIME type. Check https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types/Common_types for a list of valid MIME types.')),P=!1),(!Array.isArray(T)||!T.every(Wm))&&(console.warn('Skipped "'.concat(C,'" because an invalid file extension was provided.')),P=!1),P}).reduce(function(x,I){var C=Gh(I,2),T=C[0],P=C[1];return Wp(Wp({},x),{},Vm({},T,P))},{});return[{description:"Files",accept:b}]}return m}function gv(m){if(Fu(m))return Object.entries(m).reduce(function(b,x){var I=Gh(x,2),C=I[0],T=I[1];return[].concat(Zp(b),[C],Zp(T))},[]).filter(function(b){return qm(b)||Wm(b)}).join(",")}function yv(m){return m instanceof DOMException&&(m.name==="AbortError"||m.code===m.ABORT_ERR)}function _v(m){return m instanceof DOMException&&(m.name==="SecurityError"||m.code===m.SECURITY_ERR)}function qm(m){return m==="audio/*"||m==="video/*"||m==="image/*"||m==="text/*"||/\w+\/[-+.\w]+/g.test(m)}function Wm(m){return/^.*\.[\w]+$/.test(m)}var vv=["children"],xv=["open"],wv=["refKey","role","onKeyDown","onFocus","onBlur","onClick","onDragEnter","onDragOver","onDragLeave","onDrop"],bv=["refKey","onChange","onClick"];function Sv(m){return kv(m)||Tv(m)||Hm(m)||Ev()}function Ev(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Tv(m){if(typeof Symbol<"u"&&m[Symbol.iterator]!=null||m["@@iterator"]!=null)return Array.from(m)}function kv(m){if(Array.isArray(m))return Wf(m)}function Lf(m,b){return Av(m)||Iv(m,b)||Hm(m,b)||Cv()}function Cv(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Hm(m,b){if(m){if(typeof m=="string")return Wf(m,b);var x=Object.prototype.toString.call(m).slice(8,-1);if(x==="Object"&&m.constructor&&(x=m.constructor.name),x==="Map"||x==="Set")return Array.from(m);if(x==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(x))return Wf(m,b)}}function Wf(m,b){(b==null||b>m.length)&&(b=m.length);for(var x=0,I=new Array(b);x<b;x++)I[x]=m[x];return I}function Iv(m,b){var x=m==null?null:typeof Symbol<"u"&&m[Symbol.iterator]||m["@@iterator"];if(x!=null){var I=[],C=!0,T=!1,P,l;try{for(x=x.call(m);!(C=(P=x.next()).done)&&(I.push(P.value),!(b&&I.length===b));C=!0);}catch(R){T=!0,l=R}finally{try{!C&&x.return!=null&&x.return()}finally{if(T)throw l}}return I}}function Av(m){if(Array.isArray(m))return m}function Yp(m,b){var x=Object.keys(m);if(Object.getOwnPropertySymbols){var I=Object.getOwnPropertySymbols(m);b&&(I=I.filter(function(C){return Object.getOwnPropertyDescriptor(m,C).enumerable})),x.push.apply(x,I)}return x}function mn(m){for(var b=1;b<arguments.length;b++){var x=arguments[b]!=null?arguments[b]:{};b%2?Yp(Object(x),!0).forEach(function(I){Hf(m,I,x[I])}):Object.getOwnPropertyDescriptors?Object.defineProperties(m,Object.getOwnPropertyDescriptors(x)):Yp(Object(x)).forEach(function(I){Object.defineProperty(m,I,Object.getOwnPropertyDescriptor(x,I))})}return m}function Hf(m,b,x){return b in m?Object.defineProperty(m,b,{value:x,enumerable:!0,configurable:!0,writable:!0}):m[b]=x,m}function Yd(m,b){if(m==null)return{};var x=zv(m,b),I,C;if(Object.getOwnPropertySymbols){var T=Object.getOwnPropertySymbols(m);for(C=0;C<T.length;C++)I=T[C],!(b.indexOf(I)>=0)&&Object.prototype.propertyIsEnumerable.call(m,I)&&(x[I]=m[I])}return x}function zv(m,b){if(m==null)return{};var x={},I=Object.keys(m),C,T;for(T=0;T<I.length;T++)C=I[T],!(b.indexOf(C)>=0)&&(x[C]=m[C]);return x}var sp=Ie.forwardRef(function(m,b){var x=m.children,I=Yd(m,vv),C=Km(I),T=C.open,P=Yd(C,xv);return Ie.useImperativeHandle(b,function(){return{open:T}},[T]),ln.createElement(Ie.Fragment,null,x(mn(mn({},P),{},{open:T})))});sp.displayName="Dropzone";var Xm={disabled:!1,getFilesFromEvent:U_,maxSize:1/0,minSize:0,multiple:!0,maxFiles:0,preventDropOnDocument:!0,noClick:!1,noKeyboard:!1,noDrag:!1,noDragEventsBubbling:!1,validator:null,useFsAccessApi:!0,autoFocus:!1};sp.defaultProps=Xm;sp.propTypes={children:Xr.func,accept:Xr.objectOf(Xr.arrayOf(Xr.string)),multiple:Xr.bool,preventDropOnDocument:Xr.bool,noClick:Xr.bool,noKeyboard:Xr.bool,noDrag:Xr.bool,noDragEventsBubbling:Xr.bool,minSize:Xr.number,maxSize:Xr.number,maxFiles:Xr.number,disabled:Xr.bool,getFilesFromEvent:Xr.func,onFileDialogCancel:Xr.func,onFileDialogOpen:Xr.func,useFsAccessApi:Xr.bool,autoFocus:Xr.bool,onDragEnter:Xr.func,onDragLeave:Xr.func,onDragOver:Xr.func,onDrop:Xr.func,onDropAccepted:Xr.func,onDropRejected:Xr.func,onError:Xr.func,validator:Xr.func};var Xf={isFocused:!1,isFileDialogActive:!1,isDragActive:!1,isDragAccept:!1,isDragReject:!1,acceptedFiles:[],fileRejections:[]};function Km(){var m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},b=mn(mn({},Xm),m),x=b.accept,I=b.disabled,C=b.getFilesFromEvent,T=b.maxSize,P=b.minSize,l=b.multiple,R=b.maxFiles,L=b.onDragEnter,G=b.onDragLeave,$=b.onDragOver,B=b.onDrop,Z=b.onDropAccepted,Q=b.onDropRejected,V=b.onFileDialogCancel,K=b.onFileDialogOpen,Y=b.useFsAccessApi,ne=b.autoFocus,ce=b.preventDropOnDocument,be=b.noClick,_e=b.noKeyboard,Ue=b.noDrag,De=b.noDragEventsBubbling,Ze=b.onError,je=b.validator,lt=Ie.useMemo(function(){return gv(x)},[x]),vt=Ie.useMemo(function(){return mv(x)},[x]),me=Ie.useMemo(function(){return typeof K=="function"?K:Jp},[K]),$e=Ie.useMemo(function(){return typeof V=="function"?V:Jp},[V]),j=Ie.useRef(null),qe=Ie.useRef(null),ht=Ie.useReducer(Pv,Xf),Ke=Lf(ht,2),st=Ke[0],Fe=Ke[1],ae=st.isFocused,fe=st.isFileDialogActive,Se=Ie.useRef(typeof window<"u"&&window.isSecureContext&&Y&&pv()),gt=function(){!Se.current&&fe&&setTimeout(function(){if(qe.current){var Qe=qe.current.files;Qe.length||(Fe({type:"closeDialog"}),$e())}},300)};Ie.useEffect(function(){return window.addEventListener("focus",gt,!1),function(){window.removeEventListener("focus",gt,!1)}},[qe,fe,$e,Se]);var ct=Ie.useRef([]),dt=function(Qe){j.current&&j.current.contains(Qe.target)||(Qe.preventDefault(),ct.current=[])};Ie.useEffect(function(){return ce&&(document.addEventListener("dragover",Kp,!1),document.addEventListener("drop",dt,!1)),function(){ce&&(document.removeEventListener("dragover",Kp),document.removeEventListener("drop",dt))}},[j,ce]),Ie.useEffect(function(){return!I&&ne&&j.current&&j.current.focus(),function(){}},[j,ne,I]);var bt=Ie.useCallback(function(We){Ze?Ze(We):console.error(We)},[Ze]),Vt=Ie.useCallback(function(We){We.preventDefault(),We.persist(),ot(We),ct.current=[].concat(Sv(ct.current),[We.target]),Nd(We)&&Promise.resolve(C(We)).then(function(Qe){if(!(Kd(We)&&!De)){var kt=Qe.length,Me=kt>0&&cv({files:Qe,accept:lt,minSize:P,maxSize:T,multiple:l,maxFiles:R,validator:je}),Je=kt>0&&!Me;Fe({isDragAccept:Me,isDragReject:Je,isDragActive:!0,type:"setDraggedFiles"}),L&&L(We)}}).catch(function(Qe){return bt(Qe)})},[C,L,bt,De,lt,P,T,l,R,je]),At=Ie.useCallback(function(We){We.preventDefault(),We.persist(),ot(We);var Qe=Nd(We);if(Qe&&We.dataTransfer)try{We.dataTransfer.dropEffect="copy"}catch{}return Qe&&$&&$(We),!1},[$,De]),Rt=Ie.useCallback(function(We){We.preventDefault(),We.persist(),ot(We);var Qe=ct.current.filter(function(Me){return j.current&&j.current.contains(Me)}),kt=Qe.indexOf(We.target);kt!==-1&&Qe.splice(kt,1),ct.current=Qe,!(Qe.length>0)&&(Fe({type:"setDraggedFiles",isDragActive:!1,isDragAccept:!1,isDragReject:!1}),Nd(We)&&G&&G(We))},[j,G,De]),$t=Ie.useCallback(function(We,Qe){var kt=[],Me=[];We.forEach(function(Je){var xr=Gm(Je,lt),kr=Lf(xr,2),Wt=kr[0],vr=kr[1],Qt=Zm(Je,P,T),dn=Lf(Qt,2),Rr=dn[0],yt=dn[1],qt=je?je(Je):null;if(Wt&&Rr&&!qt)kt.push(Je);else{var Zt=[vr,yt];qt&&(Zt=Zt.concat(qt)),Me.push({file:Je,errors:Zt.filter(function(qr){return qr})})}}),(!l&&kt.length>1||l&&R>=1&&kt.length>R)&&(kt.forEach(function(Je){Me.push({file:Je,errors:[uv]})}),kt.splice(0)),Fe({acceptedFiles:kt,fileRejections:Me,type:"setFiles"}),B&&B(kt,Me,Qe),Me.length>0&&Q&&Q(Me,Qe),kt.length>0&&Z&&Z(kt,Qe)},[Fe,l,lt,P,T,R,B,Z,Q,je]),or=Ie.useCallback(function(We){We.preventDefault(),We.persist(),ot(We),ct.current=[],Nd(We)&&Promise.resolve(C(We)).then(function(Qe){Kd(We)&&!De||$t(Qe,We)}).catch(function(Qe){return bt(Qe)}),Fe({type:"reset"})},[C,$t,bt,De]),sr=Ie.useCallback(function(){if(Se.current){Fe({type:"openDialog"}),me();var We={multiple:l,types:vt};window.showOpenFilePicker(We).then(function(Qe){return C(Qe)}).then(function(Qe){$t(Qe,null),Fe({type:"closeDialog"})}).catch(function(Qe){yv(Qe)?($e(Qe),Fe({type:"closeDialog"})):_v(Qe)?(Se.current=!1,qe.current?(qe.current.value=null,qe.current.click()):bt(new Error("Cannot open the file picker because the https://developer.mozilla.org/en-US/docs/Web/API/File_System_Access_API is not supported and no <input> was provided."))):bt(Qe)});return}qe.current&&(Fe({type:"openDialog"}),me(),qe.current.value=null,qe.current.click())},[Fe,me,$e,Y,$t,bt,vt,l]),pr=Ie.useCallback(function(We){!j.current||!j.current.isEqualNode(We.target)||(We.key===" "||We.key==="Enter"||We.keyCode===32||We.keyCode===13)&&(We.preventDefault(),sr())},[j,sr]),O=Ie.useCallback(function(){Fe({type:"focus"})},[]),it=Ie.useCallback(function(){Fe({type:"blur"})},[]),He=Ie.useCallback(function(){be||(fv()?setTimeout(sr,0):sr())},[be,sr]),de=function(Qe){return I?null:Qe},oe=function(Qe){return _e?null:de(Qe)},Ee=function(Qe){return Ue?null:de(Qe)},ot=function(Qe){De&&Qe.stopPropagation()},ft=Ie.useMemo(function(){return function(){var We=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Qe=We.refKey,kt=Qe===void 0?"ref":Qe,Me=We.role,Je=We.onKeyDown,xr=We.onFocus,kr=We.onBlur,Wt=We.onClick,vr=We.onDragEnter,Qt=We.onDragOver,dn=We.onDragLeave,Rr=We.onDrop,yt=Yd(We,wv);return mn(mn(Hf({onKeyDown:oe(qs(Je,pr)),onFocus:oe(qs(xr,O)),onBlur:oe(qs(kr,it)),onClick:de(qs(Wt,He)),onDragEnter:Ee(qs(vr,Vt)),onDragOver:Ee(qs(Qt,At)),onDragLeave:Ee(qs(dn,Rt)),onDrop:Ee(qs(Rr,or)),role:typeof Me=="string"&&Me!==""?Me:"presentation"},kt,j),!I&&!_e?{tabIndex:0}:{}),yt)}},[j,pr,O,it,He,Vt,At,Rt,or,_e,Ue,I]),Ne=Ie.useCallback(function(We){We.stopPropagation()},[]),_t=Ie.useMemo(function(){return function(){var We=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Qe=We.refKey,kt=Qe===void 0?"ref":Qe,Me=We.onChange,Je=We.onClick,xr=Yd(We,bv),kr=Hf({accept:lt,multiple:l,type:"file",style:{display:"none"},onChange:de(qs(Me,or)),onClick:de(qs(Je,Ne)),tabIndex:-1},kt,qe);return mn(mn({},kr),xr)}},[qe,x,l,or,I]);return mn(mn({},st),{},{isFocused:ae&&!I,getRootProps:ft,getInputProps:_t,rootRef:j,inputRef:qe,open:de(sr)})}function Pv(m,b){switch(b.type){case"focus":return mn(mn({},m),{},{isFocused:!0});case"blur":return mn(mn({},m),{},{isFocused:!1});case"openDialog":return mn(mn({},Xf),{},{isFileDialogActive:!0});case"closeDialog":return mn(mn({},m),{},{isFileDialogActive:!1});case"setDraggedFiles":return mn(mn({},m),{},{isDragActive:b.isDragActive,isDragAccept:b.isDragAccept,isDragReject:b.isDragReject});case"setFiles":return mn(mn({},m),{},{acceptedFiles:b.acceptedFiles,fileRejections:b.fileRejections});case"reset":return mn({},Xf);default:return m}}function Jp(){}const Mv="_Input_yn5x9_1",Dv="_Button_yn5x9_28",Rv="_outline_yn5x9_42",Lv="_FileInput_yn5x9_57",Bv="_Select_yn5x9_81",Fv="_Range_yn5x9_92",Ja={Input:Mv,Button:Dv,outline:Rv,FileInput:Lv,Select:Bv,Range:Fv};function Ym(m){var b,x,I="";if(typeof m=="string"||typeof m=="number")I+=m;else if(typeof m=="object")if(Array.isArray(m))for(b=0;b<m.length;b++)m[b]&&(x=Ym(m[b]))&&(I&&(I+=" "),I+=x);else for(b in m)m[b]&&(I&&(I+=" "),I+=b);return I}function Qa(){for(var m,b,x=0,I="";x<arguments.length;)(m=arguments[x++])&&(b=Ym(m))&&(I&&(I+=" "),I+=b);return I}const Kf=Ie.forwardRef(function({className:b,outline:x,...I},C){return Ut.jsx("button",{ref:C,...I,className:Qa(Ja.Input,Ja.Button,x&&Ja.outline,b)})}),Ov=Ie.forwardRef(function(b,x){return Ut.jsx("input",{ref:x,type:"file",...b,className:Qa(Ja.Input,Ja.FileInput,b.className)})});function Qp(m){return Ut.jsx("select",{...m,className:Qa(Ja.Input,Ja.Select,m.className)})}function Nv(m){return Ut.jsx("input",{...m,className:Qa(Ja.Input,m.className)})}function Uv(m){return Ut.jsx("input",{type:"range",...m,className:Qa(Ja.Range,m.className)})}const jv="_FileTreeItem_nzhk4_1",Vv="_dragOverlay_nzhk4_6",$v="_Draggable_nzhk4_12",Gv="_newPositionOutline_nzhk4_19",Zv="_disabledInteraction_nzhk4_23",qv="_disabled_nzhk4_23",Wv="_overTrashBin_nzhk4_34",Hv="_deletionWarning_nzhk4_39",Xv="_ProgressBar_nzhk4_61",Kv="_ChildrenCount_nzhk4_103",Ws={FileTreeItem:jv,dragOverlay:Vv,Draggable:$v,newPositionOutline:Gv,disabledInteraction:Zv,disabled:qv,overTrashBin:Wv,deletionWarning:Hv,ProgressBar:Xv,ChildrenCount:Kv},Yv=m=>!(m.isSorting||m.wasDragging);function em(m){const{id:b,depth:x,indentationWidth:I,fileName:C,disabled:T,progress:P,tooltip:l,dragOverlay:R,childCount:L,overTrashBin:G}=m,{attributes:$,isDragging:B,isSorting:Z,listeners:Q,setDraggableNodeRef:V,setDroppableNodeRef:K,transform:Y,transition:ne}=b_({id:b,animateLayoutChanges:Yv,disabled:T});return Ie.useEffect(()=>{if(R)return document.body.style.setProperty("cursor","grabbing"),()=>{document.body.style.removeProperty("cursor")}},[R]),Ut.jsx("li",{className:Qa(Ws.FileTreeItem,R&&Ws.dragOverlay,B&&Ws.newPositionOutline,(Z||T)&&Ws.disabledInteraction,T&&Ws.disabled,G&&Ws.overTrashBin),ref:K,style:{"--indent":`${I*x}px`},"data-tooltip":l,children:Ut.jsxs("div",{className:Ws.Draggable,ref:V,style:{transform:Hs.Translate.toString(Y),transition:ne},...$,...Q,tabIndex:void 0,children:[G?Ut.jsx("span",{className:Ws.deletionWarning,children:"Remove"}):null,Ut.jsx("span",{children:C}),P!==void 0?Ut.jsx("progress",{value:P,max:256,className:Ws.ProgressBar}):null,L?Ut.jsx("span",{className:Ws.ChildrenCount,children:L+1}):null]})})}const Jv="_FilesSection_177tf_1",Qv="_UploadFilesDropzoneActive_177tf_21",e0="_FilesSectionHeader_177tf_32",t0="_ClearButton_177tf_42",r0="_FilesSectionFooter_177tf_56",n0="_importantButton_177tf_57",i0="_loading_177tf_66",Vl={FilesSection:Jv,UploadFilesDropzoneActive:Qv,FilesSectionHeader:e0,ClearButton:t0,FilesSectionFooter:r0,importantButton:n0,loading:i0},o0={droppable:{strategy:Oc.Always}},s0={keyframes({transform:m}){return[{opacity:1,transform:Hs.Transform.toString(m.initial)},{opacity:0,transform:Hs.Transform.toString({...m.final,x:m.final.x+5,y:m.final.y+5})}]},easing:"ease-out",sideEffects({active:m}){m.node.animate([{opacity:0},{opacity:1}],{duration:Vf.duration,easing:Vf.easing})}};function a0(m){const{status:b,stacks:x,indentationWidth:I=24,depthLimit:C=1,onFilesUpload:T,onStacksChange:P,onConversionStart:l,onDownloadZip:R}=m,L=b===Vi.Running,{getRootProps:G,getInputProps:$,isDragActive:B}=Km({disabled:L,onDrop:T,accept:{"font/otf":[".otf"],"font/ttf":[".ttf"]},multiple:!0,noClick:!0,noKeyboard:!0}),[Z,Q]=Ie.useState(),[V,K]=Ie.useState(),[Y,ne]=Ie.useState(0),ce=Ie.useMemo(()=>Fc(x,Z?[Z]:[]),[Z,x]),be=Z?ce.find(Ou(Z)):void 0,_e=Z&&V?E_(ce,Z,V,Y,I,C):void 0,Ue=qg(Zg(ip)),De=Ie.useMemo(()=>ce.map(({id:j})=>j),[ce]);return Ut.jsx("ul",{...G(),className:Qa(Vl.FilesSection,B&&Vl.UploadFilesDropzoneActive),children:Ut.jsxs(qy,{sensors:Ue,collisionDetection:Jg,measuring:o0,onDragStart:Ze,onDragMove:je,onDragOver:lt,onDragEnd:vt,onDragCancel:me,children:[Ut.jsxs("li",{className:Vl.FilesSectionHeader,children:[Ut.jsx(Ov,{...$({tabIndex:void 0,style:void 0}),disabled:L,title:`Loaded ${x.length} font stacks`,value:""}),Ut.jsx(l0,{outline:!0,className:Vl.ClearButton,"data-hidden":!x.length,disabled:!x.length||L,title:"Clear all files",onClick:()=>P([]),children:"Clear"})]}),Ut.jsxs(m_,{items:De,strategy:f_,disabled:L,children:[ce.map(({id:j,depth:qe,data:ht})=>{var Ke;return Ut.jsx(em,{id:j,depth:j===Z&&_e?_e.depth:qe,indentationWidth:I,fileName:ht.file.name,disabled:L,progress:L?(Ke=ht.glyphs)==null?void 0:Ke.length:void 0,tooltip:L&&ht.glyphs?[ht.stackName,`${ht.glyphs.length} / 256 files generated`].filter(Boolean).join(`\r
`):void 0},j)}),Ya.createPortal(Ut.jsx(u_,{dropAnimation:s0,children:be?Ut.jsx(em,{id:be.id,depth:be.depth,indentationWidth:I,fileName:be.data.file.name,dragOverlay:!0,childCount:Fm(be.children),overTrashBin:V===Yf}):null}),document.body)]}),Ut.jsx("li",{className:Qa(Vl.FilesSectionFooter),children:b===Vi.Ready?Ut.jsx(Kf,{className:Vl.importantButton,disabled:!x.length,onClick:l,children:"Convert"}):Ut.jsx(Kf,{className:Qa(Vl.importantButton,b===Vi.Running&&Vl.loading),disabled:b!==Vi.Finished,onClick:R,children:"Download .zip"})})]})});function Ze({active:{id:j}}){Q(j),K(j)}function je({delta:j}){ne(j.x)}function lt({over:j}){K(j==null?void 0:j.id)}function vt({active:j,over:qe}){var ht,Ke,st,Fe;if($e(),(qe==null?void 0:qe.id)===Yf){const ae=Fc(x,[j.id]).filter(fe=>fe.id!==j.id);return P(Gf(ae))}if(_e&&qe){const ae=Fc(x),fe=ae.findIndex(Ou(qe.id)),Se=ae.findIndex(Ou(j.id)),gt=ae[Se];if(fe!==Se||((ht=gt.parent)==null?void 0:ht.id)!==((Ke=_e.parent)==null?void 0:Ke.id)){const ct=[$f(gt).id,(st=$f(_e.parent))==null?void 0:st.id];gt.parent=(Fe=_e.parent)!=null&&Fe.id?ae.find(Ou(_e.parent.id)):void 0;const dt=nf(ae,Se,fe),bt=Gf(dt);return Om(bt,C),P(bt,ct)}}}function me(){$e()}function $e(){K(void 0),Q(void 0),ne(0)}}const Yf="trash";function l0(m){const{setNodeRef:b,isOver:x}=Pm({id:Yf});return Ut.jsx(Kf,{ref:b,...m,"data-remove-file":x})}const u0="_MapSettingSection_ojf16_1",c0="_fontSizeValue_ojf16_19",tm={MapSettingSection:u0,fontSizeValue:c0};function h0(m){const{stacks:b,mapConfig:x,onMapConfigChange:I}=m,C=b.filter(Lc);return Ut.jsxs("ul",{className:tm.MapSettingSection,children:[Ut.jsx("li",{children:Ut.jsxs("label",{children:["Font",Ut.jsxs(Qp,{value:x.font,onChange:T=>{I({font:T.target.value})},children:[Ut.jsx("option",{value:Vh,children:Vh}),C.map(({id:T,data:{stackName:P}})=>Ut.jsx("option",{value:T,children:P},T)),Ut.jsx("option",{disabled:!0,children:"Convert files to add more fonts"})]})]})}),Ut.jsx("li",{children:Ut.jsxs("label",{children:["Language",Ut.jsx(Qp,{value:x.langCode,onChange:T=>{I({langCode:T.target.value})},children:Ig.map(([T,P])=>Ut.jsx("option",{value:T,children:P},T))})]})}),Ut.jsx("li",{children:Ut.jsxs("label",{children:["Custom text",Ut.jsx(Nv,{type:"search",value:x.customText,onChange:T=>{I({customText:T.target.value})}})]})}),Ut.jsx("li",{children:Ut.jsxs("label",{children:["Text Size ",Ut.jsxs("span",{className:tm.fontSizeValue,children:[x.fontSize,"px"]}),Ut.jsx(Uv,{min:"8",max:"48",value:x.fontSize,onChange:T=>{I({fontSize:+T.target.value})}})]})})]})}const d0="modulepreload",f0=function(m){return"/font-maker/"+m},rm={},p0=function(b,x,I){let C=Promise.resolve();if(x&&x.length>0){let P=function(L){return Promise.all(L.map(G=>Promise.resolve(G).then($=>({status:"fulfilled",value:$}),$=>({status:"rejected",reason:$}))))};document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),R=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));C=P(x.map(L=>{if(L=f0(L),L in rm)return;rm[L]=!0;const G=L.endsWith(".css"),$=G?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${L}"]${$}`))return;const B=document.createElement("link");if(B.rel=G?"stylesheet":d0,G||(B.as="script"),B.crossOrigin="",B.href=L,R&&B.setAttribute("nonce",R),document.head.appendChild(B),G)return new Promise((Z,Q)=>{B.addEventListener("load",Z),B.addEventListener("error",()=>Q(new Error(`Unable to preload CSS for ${L}`)))})}))}function T(P){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=P,window.dispatchEvent(l),!l.defaultPrevented)throw P}return C.then(P=>{for(const l of P||[])l.status==="rejected"&&T(l.reason);return b().catch(T)})},m0=Ie.createContext(null);function g0(m){const b=m.clone();return b.pixelsToGLUnits=m.pixelsToGLUnits,b}function nm(m){return{longitude:m.center.lng,latitude:m.center.lat,zoom:m.zoom,pitch:m.pitch,bearing:m.bearing,padding:m.padding}}function im(m,b){const x=b.viewState||b;let I=!1;if("longitude"in x&&"latitude"in x){const C=m.center;m.center=new C.constructor(x.longitude,x.latitude),I=I||C!==m.center}if("zoom"in x){const C=m.zoom;m.zoom=x.zoom,I=I||C!==m.zoom}if("bearing"in x){const C=m.bearing;m.bearing=x.bearing,I=I||C!==m.bearing}if("pitch"in x){const C=m.pitch;m.pitch=x.pitch,I=I||C!==m.pitch}return x.padding&&!m.isPaddingEqual(x.padding)&&(I=!0,m.padding=x.padding),I}const y0=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function om(m){if(!m)return null;if(typeof m=="string"||("toJS"in m&&(m=m.toJS()),!m.layers))return m;const b={};for(const I of m.layers)b[I.id]=I;const x=m.layers.map(I=>{const C=b[I.ref];let T=null;if("interactive"in I&&(T={...I},delete T.interactive),C){T=T||{...I},delete T.ref;for(const P of y0)P in C&&(T[P]=C[P])}return T||I});return{...m,layers:x}}function _0(m,b){const x=Array.isArray(m)?m[0]:m?m.x:0,I=Array.isArray(m)?m[1]:m?m.y:0,C=Array.isArray(b)?b[0]:b?b.x:0,T=Array.isArray(b)?b[1]:b?b.y:0;return x===C&&I===T}function Gl(m,b){if(m===b)return!0;if(!m||!b)return!1;if(Array.isArray(m)){if(!Array.isArray(b)||m.length!==b.length)return!1;for(let x=0;x<m.length;x++)if(!Gl(m[x],b[x]))return!1;return!0}else if(Array.isArray(b))return!1;if(typeof m=="object"&&typeof b=="object"){const x=Object.keys(m),I=Object.keys(b);if(x.length!==I.length)return!1;for(const C of x)if(!b.hasOwnProperty(C)||!Gl(m[C],b[C]))return!1;return!0}return!1}var sm={};const am={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},Bf={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},lm={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},v0=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],x0=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class Nc{constructor(b,x,I){this._map=null,this._internalUpdate=!1,this._inRender=!1,this._hoveredFeatures=null,this._deferredEvents={move:!1,zoom:!1,pitch:!1,rotate:!1},this._onEvent=C=>{const T=this.props[lm[C.type]];T&&T(C)},this._onPointerEvent=C=>{(C.type==="mousemove"||C.type==="mouseout")&&this._updateHover(C);const T=this.props[am[C.type]];T&&(this.props.interactiveLayerIds&&C.type!=="mouseover"&&C.type!=="mouseout"&&(C.features=this._hoveredFeatures||this._queryRenderedFeatures(C.point)),T(C),delete C.features)},this._onCameraEvent=C=>{if(!this._internalUpdate){const T=this.props[Bf[C.type]];T&&T(C)}C.type in this._deferredEvents&&(this._deferredEvents[C.type]=!1)},this._MapClass=b,this.props=x,this._initialize(I)}get map(){return this._map}get transform(){return this._renderTransform}setProps(b){const x=this.props;this.props=b;const I=this._updateSettings(b,x);I&&this._createShadowTransform(this._map);const C=this._updateSize(b),T=this._updateViewState(b,!0);this._updateStyle(b,x),this._updateStyleComponents(b,x),this._updateHandlers(b,x),(I||C||T&&!this._map.isMoving())&&this.redraw()}static reuse(b,x){const I=Nc.savedMaps.pop();if(!I)return null;const C=I.map,T=C.getContainer();for(x.className=T.className;T.childNodes.length>0;)x.appendChild(T.childNodes[0]);C._container=x,I.setProps({...b,styleDiffing:!1}),C.resize();const{initialViewState:P}=b;return P&&(P.bounds?C.fitBounds(P.bounds,{...P.fitBoundsOptions,duration:0}):I._updateViewState(P,!1)),C.isStyleLoaded()?C.fire("load"):C.once("styledata",()=>C.fire("load")),C.triggerRepaint(),I}_initialize(b){const{props:x}=this,I={...x,...x.initialViewState,accessToken:x.mapboxAccessToken||w0()||null,container:b,style:om(x.mapStyle)},C=I.initialViewState||I.viewState||I;if(Object.assign(I,{center:[C.longitude||0,C.latitude||0],zoom:C.zoom||0,pitch:C.pitch||0,bearing:C.bearing||0}),x.gl){const L=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=L,x.gl)}const T=new this._MapClass(I);C.padding&&T.setPadding(C.padding),x.cursor&&(T.getCanvas().style.cursor=x.cursor),this._createShadowTransform(T);const P=T._render;T._render=L=>{this._inRender=!0,P.call(T,L),this._inRender=!1};const l=T._renderTaskQueue.run;T._renderTaskQueue.run=L=>{l.call(T._renderTaskQueue,L),this._onBeforeRepaint()},T.on("render",()=>this._onAfterRepaint());const R=T.fire;T.fire=this._fireEvent.bind(this,R),T.on("resize",()=>{this._renderTransform.resize(T.transform.width,T.transform.height)}),T.on("styledata",()=>this._updateStyleComponents(this.props,{})),T.on("sourcedata",()=>this._updateStyleComponents(this.props,{}));for(const L in am)T.on(L,this._onPointerEvent);for(const L in Bf)T.on(L,this._onCameraEvent);for(const L in lm)T.on(L,this._onEvent);this._map=T}recycle(){const x=this.map.getContainer().querySelector("[mapboxgl-children]");x==null||x.remove(),Nc.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){const b=this._map;!this._inRender&&b.style&&(b._frame&&(b._frame.cancel(),b._frame=null),b._render())}_createShadowTransform(b){const x=g0(b.transform);b.painter.transform=x,this._renderTransform=x}_updateSize(b){const{viewState:x}=b;if(x){const I=this._map;if(x.width!==I.transform.width||x.height!==I.transform.height)return I.resize(),!0}return!1}_updateViewState(b,x){if(this._internalUpdate)return!1;const I=this._map,C=this._renderTransform,{zoom:T,pitch:P,bearing:l}=C,R=I.isMoving();R&&(C.cameraElevationReference="sea");const L=im(C,{...nm(I.transform),...b});if(R&&(C.cameraElevationReference="ground"),L&&x){const G=this._deferredEvents;G.move=!0,G.zoom||(G.zoom=T!==C.zoom),G.rotate||(G.rotate=l!==C.bearing),G.pitch||(G.pitch=P!==C.pitch)}return R||im(I.transform,b),L}_updateSettings(b,x){const I=this._map;let C=!1;for(const T of v0)T in b&&!Gl(b[T],x[T])&&(C=!0,I[`set${T[0].toUpperCase()}${T.slice(1)}`](b[T]));return C}_updateStyle(b,x){if(b.cursor!==x.cursor&&(this._map.getCanvas().style.cursor=b.cursor),b.mapStyle!==x.mapStyle){const I={diff:b.styleDiffing};return"localIdeographFontFamily"in b&&(I.localIdeographFontFamily=b.localIdeographFontFamily),this._map.setStyle(om(b.mapStyle),I),!0}return!1}_updateStyleComponents(b,x){const I=this._map;let C=!1;return I.style.loaded()&&("light"in b&&!Gl(b.light,x.light)&&(C=!0,I.setLight(b.light)),"fog"in b&&!Gl(b.fog,x.fog)&&(C=!0,I.setFog(b.fog)),"terrain"in b&&!Gl(b.terrain,x.terrain)&&(!b.terrain||I.getSource(b.terrain.source))&&(C=!0,I.setTerrain(b.terrain))),C}_updateHandlers(b,x){const I=this._map;let C=!1;for(const T of x0){const P=b[T];Gl(P,x[T])||(C=!0,P?I[T].enable(P):I[T].disable())}return C}_queryRenderedFeatures(b){const x=this._map,{interactiveLayerIds:I=[]}=this.props;try{return x.queryRenderedFeatures(b,{layers:I.filter(x.getLayer.bind(x))})}catch{return[]}}_updateHover(b){var x;const{props:I}=this;if(I.interactiveLayerIds&&(I.onMouseMove||I.onMouseEnter||I.onMouseLeave)){const T=b.type,P=((x=this._hoveredFeatures)===null||x===void 0?void 0:x.length)>0,l=this._queryRenderedFeatures(b.point),R=l.length>0;!R&&P&&(b.type="mouseleave",this._onPointerEvent(b)),this._hoveredFeatures=l,R&&!P&&(b.type="mouseenter",this._onPointerEvent(b)),b.type=T}else this._hoveredFeatures=null}_fireEvent(b,x,I){const C=this._map,T=C.transform,P=typeof x=="string"?x:x.type;return P==="move"&&this._updateViewState(this.props,!1),P in Bf&&(typeof x=="object"&&(x.viewState=nm(T)),this._map.isMoving())?(C.transform=this._renderTransform,b.call(C,x,I),C.transform=T,C):(b.call(C,x,I),C)}_onBeforeRepaint(){const b=this._map;this._internalUpdate=!0;for(const I in this._deferredEvents)this._deferredEvents[I]&&b.fire(I);this._internalUpdate=!1;const x=this._map.transform;this._map.transform=this._renderTransform,this._onAfterRepaint=()=>{this._map.transform=x}}}Nc.savedMaps=[];function w0(){let m=null;if(typeof location<"u"){const b=/access_token=([^&\/]*)/.exec(location.search);m=b&&b[1]}try{m=m||sm.MapboxAccessToken}catch{}try{m=m||sm.REACT_APP_MAPBOX_ACCESS_TOKEN}catch{}return m}const b0=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function S0(m,b){if(!m)return null;const x=m.map,I={getMap:()=>x,getCenter:()=>m.transform.center,getZoom:()=>m.transform.zoom,getBearing:()=>m.transform.bearing,getPitch:()=>m.transform.pitch,getPadding:()=>m.transform.padding,getBounds:()=>m.transform.getBounds(),project:C=>m.transform.locationPoint(b.LngLat.convert(C)),unproject:C=>m.transform.pointLocation(b.Point.convert(C)),queryTerrainElevation:(C,T)=>{const P=x.transform;x.transform=m.transform;const l=x.queryTerrainElevation(C,T);return x.transform=P,l}};for(const C of E0(x))!(C in I)&&!b0.includes(C)&&(I[C]=x[C].bind(x));return I}function E0(m){const b=new Set;let x=m;for(;x;){for(const I of Object.getOwnPropertyNames(x))I[0]!=="_"&&typeof m[I]=="function"&&I!=="fire"&&I!=="setEventedParent"&&b.add(I);x=Object.getPrototypeOf(x)}return Array.from(b)}const T0=typeof document<"u"?Ie.useLayoutEffect:Ie.useEffect,k0=["baseApiUrl","maxParallelImageRequests","workerClass","workerCount","workerUrl"];function C0(m,b){for(const x of k0)x in b&&(m[x]=b[x]);b.RTLTextPlugin&&m.getRTLTextPluginStatus&&m.getRTLTextPluginStatus()==="unavailable"&&m.setRTLTextPlugin(b.RTLTextPlugin,x=>{x&&console.error(x)},!1)}const of=Ie.createContext(null),I0={minZoom:0,maxZoom:22,minPitch:0,maxPitch:60,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,mapStyle:{version:8,sources:{},layers:[]},styleDiffing:!0,projection:"mercator",renderWorldCopies:!0,onError:m=>console.error(m.error),RTLTextPlugin:"https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.js"},ap=Ie.forwardRef((m,b)=>{const x=Ie.useContext(m0),[I,C]=Ie.useState(null),T=Ie.useRef(),{current:P}=Ie.useRef({mapLib:null,map:null});Ie.useEffect(()=>{const L=m.mapLib;let G=!0,$;return Promise.resolve(L||p0(()=>import("./index-CZNsyPWO.js").then(B=>B.i),[])).then(B=>{if(G){if(B.Map||(B=B.default),!B||!B.Map)throw new Error("Invalid mapLib");if(C0(B,m),B.supported(m))m.reuseMaps&&($=Nc.reuse(m,T.current)),$||($=new Nc(B.Map,m,T.current)),P.map=S0($,B),P.mapLib=B,C($),x==null||x.onMapMount(P.map,m.id);else throw new Error("Map is not supported by this browser")}}).catch(B=>{m.onError({type:"error",target:null,originalEvent:null,error:B})}),()=>{G=!1,$&&(x==null||x.onMapUnmount(m.id),m.reuseMaps?$.recycle():$.destroy())}},[]),T0(()=>{I&&I.setProps(m)}),Ie.useImperativeHandle(b,()=>P.map,[I]);const l=Ie.useMemo(()=>({position:"relative",width:"100%",height:"100%",...m.style}),[m.style]),R={height:"100%"};return Ie.createElement("div",{id:m.id,ref:T,style:l},I&&Ie.createElement(of.Provider,{value:P},Ie.createElement("div",{"mapboxgl-children":"",style:R},m.children)))});ap.displayName="Map";ap.defaultProps=I0;const A0=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function Nu(m,b){if(!m||!b)return;const x=m.style;for(const I in b){const C=b[I];Number.isFinite(C)&&!A0.test(I)?x[I]=`${C}px`:x[I]=C}}const z0={draggable:!1,popup:null,rotation:0,rotationAlignment:"auto",pitchAlignment:"auto"};function Jm(m){const{map:b,mapLib:x}=Ie.useContext(of),I=Ie.useRef({props:m});I.current.props=m;const C=Ie.useMemo(()=>{let T=!1;Ie.Children.forEach(m.children,R=>{R&&(T=!0)});const P={...m,element:T?document.createElement("div"):null},l=new x.Marker(P).setLngLat([m.longitude,m.latitude]);return l.getElement().addEventListener("click",R=>{var L,G;(G=(L=I.current.props).onClick)===null||G===void 0||G.call(L,{type:"click",target:l,originalEvent:R})}),l.on("dragstart",R=>{var L,G;const $=R;$.lngLat=C.getLngLat(),(G=(L=I.current.props).onDragStart)===null||G===void 0||G.call(L,$)}),l.on("drag",R=>{var L,G;const $=R;$.lngLat=C.getLngLat(),(G=(L=I.current.props).onDrag)===null||G===void 0||G.call(L,$)}),l.on("dragend",R=>{var L,G;const $=R;$.lngLat=C.getLngLat(),(G=(L=I.current.props).onDragEnd)===null||G===void 0||G.call(L,$)}),l},[]);return Ie.useEffect(()=>(C.addTo(b.getMap()),()=>{C.remove()}),[]),Ie.useEffect(()=>{Nu(C.getElement(),m.style)},[m.style]),(C.getLngLat().lng!==m.longitude||C.getLngLat().lat!==m.latitude)&&C.setLngLat([m.longitude,m.latitude]),m.offset&&!_0(C.getOffset(),m.offset)&&C.setOffset(m.offset),C.isDraggable()!==m.draggable&&C.setDraggable(m.draggable),C.getRotation()!==m.rotation&&C.setRotation(m.rotation),C.getRotationAlignment()!==m.rotationAlignment&&C.setRotationAlignment(m.rotationAlignment),C.getPitchAlignment()!==m.pitchAlignment&&C.setPitchAlignment(m.pitchAlignment),C.getPopup()!==m.popup&&C.setPopup(m.popup),Ya.createPortal(m.children,C.getElement())}Jm.defaultProps=z0;Ie.memo(Jm);function um(m){return new Set(m?m.trim().split(/\s+/):[])}function P0(m){const{map:b,mapLib:x}=Ie.useContext(of),I=Ie.useMemo(()=>document.createElement("div"),[]),C=Ie.useRef({props:m});C.current.props=m;const T=Ie.useMemo(()=>{const P={...m},l=new x.Popup(P).setLngLat([m.longitude,m.latitude]);return l.once("open",R=>{var L,G;(G=(L=C.current.props).onOpen)===null||G===void 0||G.call(L,R)}),l},[]);if(Ie.useEffect(()=>{const P=l=>{var R,L;(L=(R=C.current.props).onClose)===null||L===void 0||L.call(R,l)};return T.on("close",P),T.setDOMContent(I).addTo(b.getMap()),()=>{T.off("close",P),T.isOpen()&&T.remove()}},[]),Ie.useEffect(()=>{Nu(T.getElement(),m.style)},[m.style]),T.isOpen()&&((T.getLngLat().lng!==m.longitude||T.getLngLat().lat!==m.latitude)&&T.setLngLat([m.longitude,m.latitude]),m.offset&&!Gl(T.options.offset,m.offset)&&T.setOffset(m.offset),(T.options.anchor!==m.anchor||T.options.maxWidth!==m.maxWidth)&&(T.options.anchor=m.anchor,T.setMaxWidth(m.maxWidth)),T.options.className!==m.className)){const P=um(T.options.className),l=um(m.className);for(const R of P)l.has(R)||T.removeClassName(R);for(const R of l)P.has(R)||T.addClassName(R);T.options.className=m.className}return Ya.createPortal(m.children,I)}Ie.memo(P0);function Kh(m,b,x,I){const C=Ie.useContext(of),T=Ie.useMemo(()=>m(C),[]);return Ie.useEffect(()=>{const P=b,l=null,R=typeof b=="function"?b:null,{map:L}=C;return L.hasControl(T)||(L.addControl(T,P==null?void 0:P.position),l&&l(C)),()=>{R&&R(C),L.hasControl(T)&&L.removeControl(T)}},[]),T}function M0(m){const b=Kh(({mapLib:x})=>new x.AttributionControl(m),{position:m.position});return Ie.useEffect(()=>{Nu(b._container,m.style)},[m.style]),null}Ie.memo(M0);function D0(m){const b=Kh(({mapLib:x})=>new x.FullscreenControl({container:m.containerId&&document.getElementById(m.containerId)}),{position:m.position});return Ie.useEffect(()=>{Nu(b._controlContainer,m.style)},[m.style]),null}Ie.memo(D0);const Qm=Ie.forwardRef((m,b)=>{const x=Ie.useRef({props:m}),I=Kh(({mapLib:C})=>{const T=new C.GeolocateControl(m),P=T._setupUI;return T._setupUI=l=>{T._container.hasChildNodes()||P(l)},T.on("geolocate",l=>{var R,L;(L=(R=x.current.props).onGeolocate)===null||L===void 0||L.call(R,l)}),T.on("error",l=>{var R,L;(L=(R=x.current.props).onError)===null||L===void 0||L.call(R,l)}),T.on("outofmaxbounds",l=>{var R,L;(L=(R=x.current.props).onOutOfMaxBounds)===null||L===void 0||L.call(R,l)}),T.on("trackuserlocationstart",l=>{var R,L;(L=(R=x.current.props).onTrackUserLocationStart)===null||L===void 0||L.call(R,l)}),T.on("trackuserlocationend",l=>{var R,L;(L=(R=x.current.props).onTrackUserLocationEnd)===null||L===void 0||L.call(R,l)}),T},{position:m.position});return x.current.props=m,Ie.useImperativeHandle(b,()=>({trigger:()=>I.trigger()}),[]),Ie.useEffect(()=>{Nu(I._container,m.style)},[m.style]),null});Qm.displayName="GeolocateControl";Ie.memo(Qm);function R0(m){const b=Kh(({mapLib:x})=>new x.NavigationControl(m),{position:m.position});return Ie.useEffect(()=>{Nu(b._container,m.style)},[m.style]),null}const L0=Ie.memo(R0),B0={unit:"metric",maxWidth:100};function eg(m){const b=Kh(({mapLib:x})=>new x.ScaleControl(m),{position:m.position});return(b.options.unit!==m.unit||b.options.maxWidth!==m.maxWidth)&&(b.options.maxWidth=m.maxWidth,b.setUnit(m.unit)),Ie.useEffect(()=>{Nu(b._container,m.style)},[m.style]),null}eg.defaultProps=B0;Ie.memo(eg);function F0(m){return Ie.useMemo(()=>({version:8,name:"MapLibre",metadata:{"maptiler:copyright":"This style was generated on MapTiler Cloud. Usage is governed by the license terms in https://github.com/maplibre/demotiles/blob/gh-pages/LICENSE"},sources:{maplibre:{url:"https://demotiles.maplibre.org/tiles/tiles.json",type:"vector"},capitals:{type:"geojson",data:"capitals_filtered.geojson",attribution:'<a href="https://openstreetmap.org/copyright">City data © OpenStreetMap</a>'},crimea:{type:"geojson",data:{type:"Feature",geometry:{type:"Polygon",coordinates:[[[34.00905273547181,46.55925987559425],[33.64325260204026,46.34533545368038],[33.628682598560204,46.12569762665683],[33.64292861730951,46.10476396128129],[33.648473474905984,46.09033047763651],[33.63876482059936,46.077976784785335],[33.62782672238245,46.06747935719011],[33.62911357645072,46.05708111413949],[33.642686868727424,46.02192963417187],[33.6429723910654,46.01521185644708],[33.636224138774026,46.006705833212465],[33.63052626465907,45.99692992186792],[33.63193836679693,45.988472992911284],[33.64276684834442,45.984575360297384],[33.646928693041986,45.97981936210982],[33.638745893564305,45.96829769147004],[33.61958133326394,45.951176418494185],[33.63181380398527,45.9445404758078],[33.638921676216,45.94737012930554],[33.64561542516918,45.95403251372139],[33.65666403976448,45.95687114427736],[33.6825817382811,45.95878100879199],[33.738791807037614,45.94836945227263],[33.758180142697,45.94072970008301],[33.77735917288169,45.92923970233858],[33.75927796793485,45.92241179584471],[33.72529865009221,45.91587363154565],[33.70875012326826,45.91008760988058],[33.69378857293381,45.91480850795665],[33.69092650243843,45.89657370898402],[33.693592356906805,45.87271465766318],[33.69226765972388,45.86041392418218],[33.6704813511748,45.8584273836251],[33.65936345808916,45.85944682601249],[33.653870582376726,45.86425922279372],[33.65107345584843,45.87089907254003],[33.63067378180233,45.88040685247182],[33.61945300059696,45.88147266102649],[33.60987421595539,45.88048951126686],[33.59906957603934,45.877610457390375],[33.57828877687868,45.86810261756233],[33.55357394560386,45.84700625141778],[33.530220674480375,45.84221983655459],[33.5192297395441,45.84121682367507],[33.50832088442496,45.84313067048083],[33.48901101848409,45.85268298292175],[33.482152996405716,45.854578171799005],[33.46719955896293,45.849912739405056],[33.42447496599681,45.83075886348303],[33.40940172404095,45.82691953557702],[33.37918350072067,45.802867525073566],[33.37362145339398,45.79619281922518],[33.33805543634864,45.78577808972071],[33.26498872665803,45.75410774187094],[33.22887541283427,45.75131270772724],[33.19548267281132,45.7644887297206],[33.1789202379222,45.78010311364778],[33.1688456078636,45.78470227904205],[33.161012432811674,45.77921593899549],[33.15951585299757,45.76864464913777],[33.165962301438725,45.762685940125465],[33.1750888126426,45.759218220695715],[33.181464829753,45.75490447884948],[33.17613930782352,45.7437961960276],[33.16369168844906,45.735912015025065],[32.93692665480876,45.662114646778264],[32.86839112407645,45.63044340698664],[32.83803944575723,45.60834075026611],[32.82702772424804,45.59576101516498],[32.82433467080986,45.58705137380335],[32.82563941622885,45.579605763895614],[32.82993674258438,45.56978311819469],[32.82851940940563,45.56227808675749],[32.813310142795274,45.55930933158257],[32.80213583657516,45.560145780074464],[32.78258622159436,45.565158335073846],[32.77333922465823,45.56689313356526],[32.758306734735356,45.565030173463356],[32.750177256846115,45.55943726334968],[32.74340732630185,45.55261895849793],[32.73524549539499,45.54598788110354],[32.72031700779701,45.53735927760957],[32.70536040418847,45.53169142131733],[32.68589438933773,45.52663379187257],[32.66370583186284,45.52563107058867],[32.64312077736798,45.52188979044979],[32.525284074162556,45.45838108691365],[32.49490411219156,45.43524910229854],[32.48107654411925,45.408986638827514],[32.48514589713025,45.39458067125969],[32.51256939517424,45.34060655033625],[32.535915460470335,45.33777248012882],[32.57027153843481,45.32510892683359],[32.590830644991826,45.32038723212662],[32.66380378113439,45.320421746458976],[32.67760722618917,45.32609231279554],[32.71316246802607,45.353283572618125],[32.72817188836078,45.36074681043402],[32.750518060251466,45.36371725645313],[32.89973931692998,45.35412322462227],[32.941197846443885,45.34245505845169],[32.97701667405008,45.32596743563991],[33.04296090827762,45.2853982930032],[33.05274355585479,45.28154273654923],[33.06850284417635,45.27703461892352],[33.07825272648239,45.272210805127315],[33.089426322403455,45.25656353201492],[33.09897492343546,45.247820101667884],[33.12384611720435,45.238235755071685],[33.15767197859745,45.20755227709648],[33.172959979330074,45.19681657531794],[33.21837666514142,45.187878368659824],[33.24017433636709,45.180191106261134],[33.248571989896675,45.16588271012458],[33.259649216030766,45.155918961282026],[33.28309785485047,45.16064860772312],[33.31767999550894,45.17535522412791],[33.35458473323109,45.18598673360148],[33.39725661527919,45.18973663076909],[33.41344561756824,45.18490731877088],[33.468468576977216,45.149132412229676],[33.537128652906205,45.11719769268973],[33.56161328289443,45.094099022711475],[33.57837628774928,45.053145935448015],[33.58247744978442,45.027377243150454],[33.5851414316958,45.01816461606674],[33.6031021265521,44.993103583251695],[33.605922209331794,44.986905272229734],[33.60843524291815,44.97039962759274],[33.61943161357851,44.93184946652454],[33.619484500808824,44.90819321920554],[33.61549738593425,44.88894092276257],[33.608561183117274,44.871288478948514],[33.59889474705494,44.859790298912856],[33.55904244709464,44.850057575124595],[33.54667558363471,44.83724531175508],[33.53701832136994,44.81871953508235],[33.5303157846202,44.798338017069625],[33.5249116915937,44.78918633101301],[33.51669091675143,44.784809980590666],[33.524785531609865,44.77183212449111],[33.5302902535075,44.75724515985675],[33.53710734694323,44.73034290771247],[33.54650992495621,44.70989226909535],[33.5481286806762,44.699106546699085],[33.543995566510915,44.68230506537358],[33.53580273994743,44.6726082589706],[33.52337411931097,44.661863083605255],[33.515320778874354,44.6491266698327],[33.516377841582795,44.63464990118433],[33.52466971637648,44.62863961572572],[33.557474298027785,44.62473000923737],[33.5710648827386,44.620853511273225],[33.55105839203679,44.61506440493406],[33.499905706797676,44.61452599304897],[33.48451102966331,44.60992438254493],[33.47658499621011,44.60714391514574],[33.46705078205747,44.60616254193252],[33.44476599234898,44.607062134677875],[33.4353466482458,44.60509936890821],[33.413591053005575,44.593500212748125],[33.40543527945235,44.59055535193136],[33.37510958624222,44.58564691897425],[33.37074452434078,44.58851022190515],[33.372237834990756,44.576810695127364],[33.37913003799301,44.56412673079859],[33.48759131590526,44.51024086451031],[33.50011215135888,44.50041002882833],[33.517917009115365,44.49074142372788],[33.53836387802215,44.49164280212756],[33.56041892763031,44.4966411022441],[33.57822378538677,44.497542389459795],[33.59062975079095,44.48975808594983],[33.619577003408466,44.46229988129974],[33.62635433636015,44.45336293328907],[33.63175322871038,44.434828756313124],[33.645537634715026,44.42498521035591],[33.721007257593925,44.39946630464436],[33.74168386660085,44.39560878121904],[33.80727466517129,44.39454176175843],[33.81841706002561,44.39552670349164],[33.83909366903248,44.40143600575672],[33.85149963444792,44.40143600575945],[33.91467816197718,44.38387049706651],[33.938111652185,44.38083293528811],[33.957065210440874,44.38272116790142],[34.06614966692763,44.42019923628979],[34.088893936836286,44.42200415824283],[34.10279321289039,44.42487551014821],[34.135933345669,44.44163597968952],[34.14696087047267,44.44959070749778],[34.16058918507403,44.466287285335795],[34.170123399227776,44.48186111741296],[34.182759104731986,44.49267838558103],[34.22923417224524,44.49949719774551],[34.24301857824986,44.50744404277697],[34.263903954150294,44.53186886058606],[34.26631622520165,44.53555362837611],[34.26631622520165,44.54153064468656],[34.27033667695244,44.545378535987936],[34.2757355693048,44.54644280144541],[34.285384653508004,44.54562413743594],[34.299973149863405,44.54554227040174],[34.32260254971496,44.543577427039224],[34.3308731933177,44.54546040325087],[34.340292537420794,44.55798473830754],[34.38042135640006,44.631830317636684],[34.41495238900856,44.673669777529994],[34.424193090575585,44.68239452736094],[34.42959198292681,44.68884644523774],[34.469399167794535,44.730194532749294],[34.47376422969597,44.73011292571252],[34.47376422969597,44.72635887754967],[34.475142670296464,44.723502373339585],[34.499724861011515,44.74292382044041],[34.532800295801195,44.752620844929055],[34.61217550038418,44.76534519537847],[34.65065696715081,44.777088262503725],[34.72084256772871,44.811080759265764],[34.756796893391225,44.82094054159748],[34.82646979041766,44.81208604604609],[34.84289620758207,44.816893835303176],[34.856910353686715,44.82373813182468],[34.889648317948144,44.817871641692506],[34.90733830566026,44.820886440346584],[34.922960632465504,44.83050015059965],[34.92950822531711,44.83652826953224],[34.94179932067178,44.84019370922482],[34.95282684547897,44.841415470643284],[34.98567967978991,44.840275160795755],[35.0053224583441,44.83538786296728],[35.017958163849414,44.82219008824552],[35.02703289780189,44.80890779582285],[35.037933245998005,44.79869792240089],[35.08073333784134,44.793525442788905],[35.1080207326404,44.824553365795765],[35.130368105574235,44.86879838545747],[35.15485200090768,44.90071251697748],[35.17111229780758,44.90746386008772],[35.21522068940149,44.91421441031795],[35.233163085981715,44.925728224907715],[35.25636688416236,44.95896657181197],[35.27300098099195,44.96690119386028],[35.29748487632534,44.95605693543271],[35.30496087491386,44.96121482614441],[35.315240372954605,44.965711070514175],[35.31935217217088,44.96941359539801],[35.36757236298112,44.94362319076086],[35.36103086422793,44.97364475976596],[35.362152264014156,44.98593980935419],[35.374674561627444,44.997835734117416],[35.389439658813274,45.00180049366759],[35.42270785247763,45.00087540764923],[35.43504325012745,45.00470780964241],[35.43504325012745,45.011446929213974],[35.40631957913584,45.02015821022701],[35.40089948016896,45.025046135473445],[35.39790908073891,45.03482073400548],[35.40052568024015,45.042216617888045],[35.40631957913584,45.051328088783805],[35.40744097892215,45.06294640963205],[35.41734667704213,45.0708666385693],[35.469304867139925,45.10068964922732],[35.5070260597534,45.113341616151644],[35.54758335202416,45.12019982412133],[35.59019654390909,45.11993606213795],[35.63411803553862,45.11439677872579],[35.70669729572677,45.09480210570922],[35.771782422456766,45.06572995732262],[35.78430472007,45.057941041321754],[35.81250040352472,45.031852200991295],[35.81941570220667,45.021152336906454],[35.82763930064016,44.99895365027004],[35.848198296721705,44.99208088455586],[35.916977483614176,45.00172895661731],[35.99360646900681,44.997896355361604],[36.00893226608571,45.00926125333629],[36.02539976723364,45.03288661039673],[36.047827762958946,45.048074065419456],[36.078666257082034,45.03883000769565],[36.079137312377895,45.046610970582435],[36.135020401727616,45.02125162210126],[36.2241716847341,45.00751061631556],[36.24398308095806,45.011474706353084],[36.24828178013877,45.01649549321965],[36.25332807917695,45.03247980324494],[36.25743987839326,45.03842324279259],[36.267158676549116,45.043573724415154],[36.2783726744118,45.04555455542638],[36.36740852558336,45.04833265291825],[36.44029951169139,45.06787222615526],[36.45375630913995,45.07631970334319],[36.455251508854985,45.09202341204062],[36.44142091149291,45.10709638287736],[36.41432041665814,45.12872568311289],[36.40852651776157,45.149160473330085],[36.409997342308856,45.171615955386955],[36.418312796420764,45.23001671705953],[36.42672329481775,45.25186253492981],[36.43756477765089,45.27227491599612],[36.4497132753354,45.28542626329343],[36.45905827355429,45.28753019598713],[36.4814862692796,45.28845064200263],[36.4909554290368,45.29213135137758],[36.49637552800283,45.300940007322055],[36.49394582846682,45.305015191082816],[36.48871262946426,45.30935296803605],[36.48460083024801,45.315924724862185],[36.489647129296515,45.336413860372005],[36.502169426909745,45.34731734941451],[36.52104632331191,45.35033842661815],[36.544281237819945,45.34731734942025],[36.57455903204905,45.33601971904315],[36.585399229982954,45.333917585593355],[36.59810088537549,45.334837278577254],[36.630808379142394,45.34048649352954],[36.637536777859964,45.3511265071989],[36.63099527910589,45.3741073632589],[36.61359545390113,45.40895280985421],[36.59845655678569,45.421547717459106],[36.58331765967199,45.42731944465129],[36.566309762912795,45.42548305000767],[36.54836736633254,45.41210180010589],[36.53285466928139,45.4090840212946],[36.51565987255873,45.41957994832251],[36.49117597722616,45.44279525429408],[36.47043008117939,45.4458112314303],[36.411182792482634,45.43610707766504],[36.391371396258705,45.43991025572652],[36.35959840231365,45.45407156049933],[36.33960010612526,45.45695583486963],[36.33025510790637,45.454464879327446],[36.32053630976225,45.44856480887407],[36.31156511147125,45.4438443081136],[36.29885591389362,45.442795254299995],[36.3072664122906,45.46115087970253],[36.30016421364425,45.47320989503609],[36.283717016779036,45.476355300848866],[36.267082919949445,45.46704963343626],[36.25213092279836,45.46115087970253],[36.13681364478941,45.46219959214511],[36.11700224855986,45.45721803432335],[36.097003952371466,45.441483909606006],[36.06952965760803,45.43046741078453],[36.0655449627526,45.42553028973455],[36.05134056545904,45.39535242162091],[36.022557970944945,45.368441166003805],[35.986486277818386,45.362926059418186],[35.94723728529826,45.372380198658874],[35.87220216002379,45.404075760536614],[35.85388596351393,45.413916621802144],[35.84715756479628,45.426379251448395],[35.8524047739447,45.44386497541683],[35.85950697259193,45.45933624762881],[35.857824872912545,45.469953901705],[35.83278027768503,45.47087138287168],[35.8167068807486,45.46392436820739],[35.80362388324218,45.44963442058864],[35.79469305616038,45.42980210462429],[35.791889556694684,45.41209230278156],[35.772265060435046,45.39214572935421],[35.767405661361295,45.38873311015669],[35.75189296431793,45.386632934388984],[35.7481549650407,45.379938103368545],[35.746846665290036,45.369960021421576],[35.74423006578874,45.36076812520648],[35.71619507113218,45.34040932557082],[35.69451467527287,45.32989869277279],[35.51720627467216,45.29506847418358],[35.48038698168983,45.2979608697527],[35.33194061536096,45.371562726652314],[35.04491375777232,45.669545248704424],[35.00230056589345,45.7290693869553],[34.70631294999043,46.024929846739866],[34.35868883309806,46.106725558140795],[34.00905273547181,46.55925987559425]]]}}}},glyphs:"memfont://{fontstack}/{range}.pbf",layers:[{id:"background",type:"background",paint:{"background-color":"#d8f2ff"}},{id:"coastline",type:"line",source:"maplibre","source-layer":"countries",layout:{"line-cap":"round","line-join":"round"},paint:{"line-blur":.5,"line-color":"#198ec8","line-width":["interpolate",["linear"],["zoom"],0,2,6,6,14,9,22,18]}},{id:"countries-fill",type:"fill",source:"maplibre","source-layer":"countries",paint:{"fill-color":["match",["get","ADM0_A3"],["ARM","ATG","AUS","BTN","CAN","COG","CZE","GHA","GIN","HTI","ISL","JOR","KHM","KOR","LVA","MLT","MNE","MOZ","PER","SAH","SGP","SLV","SOM","TJK","TUV","UKR","WSM"],"#d6c7ff",["AZE","BGD","CHL","CMR","CSI","DEU","DJI","GUY","HUN","IOA","JAM","LBN","LBY","LSO","MDG","MKD","MNG","MRT","NIU","NZL","PCN","PYF","SAU","SHN","STP","TTO","UGA","UZB","ZMB"],"#ebca8a",["AGO","ASM","ATF","BDI","BFA","BGR","BLZ","BRA","CHN","CRI","ESP","HKG","HRV","IDN","IRN","ISR","KNA","LBR","LCA","MAC","MUS","NOR","PLW","POL","PRI","SDN","TUN","UMI","USA","USG","VIR","VUT"],"#c1e599",["ARE","ARG","BHS","CIV","CLP","DMA","ETH","GAB","GRD","HMD","IND","IOT","IRL","IRQ","ITA","KOS","LUX","MEX","NAM","NER","PHL","PRT","RUS","SEN","SUR","TZA","VAT"],"#e7e58f",["AUT","BEL","BHR","BMU","BRB","CYN","DZA","EST","FLK","GMB","GUM","HND","JEY","KGZ","LIE","MAF","MDA","NGA","NRU","SLB","SOL","SRB","SWZ","THA","TUR","VEN","VGB"],"#98dda1",["AIA","BIH","BLM","BRN","CAF","CHE","COM","CPV","CUB","ECU","ESB","FSM","GAZ","GBR","GEO","KEN","LTU","MAR","MCO","MDV","NFK","NPL","PNG","PRY","QAT","SLE","SPM","SYC","TCA","TKM","TLS","VNM","WEB","WSB","YEM","ZWE"],"#83d5f4",["ABW","ALB","AND","ATC","BOL","COD","CUW","CYM","CYP","EGY","FJI","GGY","IMN","KAB","KAZ","KWT","LAO","MLI","MNP","MSR","MYS","NIC","NLD","PAK","PAN","PRK","ROU","SGS","SVN","SWE","TGO","TWN","VCT","ZAF"],"#b1bbf9",["ATA","GRL"],"#ffffff","#eab38f"]}},{id:"countries-boundary",type:"line",source:"maplibre","source-layer":"countries",layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"rgba(255, 255, 255, 1)","line-width":["interpolate",["linear"],["zoom"],1,1,6,2,14,6,22,12],"line-opacity":["interpolate",["linear"],["zoom"],3,.5,6,1]}},{id:"capitals-label",type:"symbol",source:"capitals",layout:{"text-font":[m.font],"text-size":m.fontSize,"text-field":m.customText||["to-string",["get",m.langCode]]},paint:{"text-color":"rgba(8, 37, 77, 1)","text-halo-blur":["interpolate",["linear"],["zoom"],2,.2,6,0],"text-halo-color":"rgba(255, 255, 255, 1)","text-halo-width":["interpolate",["linear"],["zoom"],2,1,6,1.6]}},{id:"crimea-fill",type:"fill",source:"crimea",paint:{"fill-color":"#d6c7ff"}}]}),[m])}function O0({mapConfig:m}){const b=F0(m);return Ut.jsx(ap,{mapLib:Of,RTLTextPlugin:"https://unpkg.com/@mapbox/mapbox-gl-rtl-text@0.2.3/mapbox-gl-rtl-text.min.js",mapStyle:b,children:Ut.jsx(L0,{})})}const N0="_FullPage_14qpf_1",U0="_SidePanel_14qpf_5",j0="_MapPreview_14qpf_10",V0="_SectionWrapper_14qpf_45",Rc={FullPage:N0,SidePanel:U0,MapPreview:j0,SectionWrapper:V0},Ff=new Worker("worker.js");function $0(){const[m,b]=Ie.useReducer(I_,C_),{status:x,stacks:I,config:C}=m,T=Ie.useRef(I);T.current=I,Ie.useEffect(()=>(Ff.onmessage=function(L){b({type:"updateConversionStatus",data:L.data})},Of.addProtocol("memfont",(L,G)=>{var Z,Q;const $=new RegExp(/memfont:\/\/(.+)\/(\d+)-(\d+)\.pbf/),B=L.url.match($);if(B){const[V,K,Y,ne]=B,ce=`${Y}-${ne}.pbf`;if(K===Vh)fetch(`https://demotiles.maplibre.org/font/${K}/${ce}`).then(be=>be.arrayBuffer()).then(be=>G(null,new Uint8Array(be),null,null));else{const be=(Q=(Z=T.current.find(_e=>_e.id===K))==null?void 0:Z.data.glyphs)==null?void 0:Q.find(_e=>_e.name===ce);setTimeout(()=>{if(!be)throw Error(`Can't find range "${L.url}"`);G(null,new Uint8Array(be.buffer),null,null)},0)}}return{cancel:()=>{}}}),()=>{Ff.onmessage=null,Of.removeProtocol("memfont")}),[]);const P=Ie.useMemo(()=>({exampleLoad:async L=>{const G=await T_(L);b({type:"addFontStacks",stacks:[G]})},fontFilesUpload:L=>{if(L.length){const G=L.sort(($,B)=>$.name.localeCompare(B.name)).map(Nm);b({type:"addFontStacks",stacks:G})}},fontStacksChange:(L,G)=>{b({type:"setFontStacks",stacks:L,modifiedStackIds:G})},mapConfigChange:L=>{b({type:"updateMapConfig",changes:L})}}),[]);async function l(){const L=I.filter(G=>!Lc(G));b({type:"startConversion",toConvert:L});for(const G of L){const $=Fc([G]),B=await Promise.all($.map(Z=>Z.data.file.arrayBuffer()));Ff.postMessage({stackId:G.id,buffers:B},B)}}async function R(){const L=new Sg;for(const{data:{stackName:$,glyphs:B}}of I){const Z=L.folder($);for(const{name:Q,buffer:V}of B)Z.file(Q,V)}const G=await L.generateAsync({type:"blob"});kg.saveAs(G,`font-maker-${new Date().toISOString()}.zip`)}return Ut.jsxs("main",{className:Rc.FullPage,children:[Ut.jsxs("aside",{className:Rc.SidePanel,children:[Ut.jsxs("header",{children:[Ut.jsx("h1",{children:Ut.jsx("a",{href:"/font-maker",target:"_blank",children:"Font Maker"})}),Ut.jsx("a",{href:"https://github.com/maplibre/font-maker",target:"_blank",children:Ut.jsx(A_,{})})]}),Ut.jsxs("section",{className:Rc.SectionWrapper,children:[Ut.jsx("h2",{children:"Load Examples"}),Ut.jsx(M_,{status:x,onExampleLoad:P.exampleLoad})]}),Ut.jsxs("section",{className:Rc.SectionWrapper,children:[Ut.jsx("h2",{children:"Convert .otf or .ttf files"}),Ut.jsx(a0,{status:x,stacks:I,onFilesUpload:P.fontFilesUpload,onStacksChange:P.fontStacksChange,onConversionStart:l,onDownloadZip:R})]}),Ut.jsxs("section",{className:Rc.SectionWrapper,children:[Ut.jsx("h2",{children:"Map settings"}),Ut.jsx(h0,{stacks:I,mapConfig:C,onMapConfigChange:P.mapConfigChange})]})]}),Ut.jsx("div",{className:Rc.MapPreview,children:Ut.jsx(O0,{mapConfig:C})})]})}yg.createRoot(document.getElementById("root")).render(Ut.jsx(ln.StrictMode,{children:Ut.jsx($0,{})}));export{Uc as g};
